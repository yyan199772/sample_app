function DJc(a,b,c){b=ub(a,b.equals,b);0<=b&&b!=c&&(b=Ab(a,b,1),Ab(a,c,0,b[0]))}function J$(a,b){I(a,1,b)}dFa.prototype.tx=eU(50,function(a){var b=G(this.C,1),c=!Vc(b,3)||!Vc(b,4),d=!Vc(b,1)||!Vc(b,2),e=d?0:ad(b,1),f=a?Mo(a):0,f=d?f:ad(b,2),h=c?0:ad(b,3);a=a?a.lf():0;b=c?a:ad(b,4);return new Rh(e,h,f,b,c,d)});ue.prototype.MJ=eU(17,function(){return G(this,5)});dFa.prototype.MJ=eU(16,g("D"));qe.prototype.Cn=eU(15,function(){return ad(this,1)});se.prototype.Cn=eU(14,function(){return ad(this,1)});
ye.prototype.Cn=eU(13,function(){return ad(this,1)});Cd.prototype.getRelativityIndicatorsId=eU(7,function(){return G(this,5)});function EJc(a,b){var c=new Lg(b);a.B.Eg(function(a){a.Dc(c.contains(a.La()))})}function FJc(a,b){var c=eFa.Tc((new ue).oa(),b);return kFa(c,a.on,a.B,a.ws)}function GJc(a,b,c){function d(a){if(Vc(a,7)){var b=Math.min(e,c),d=Math.max(e,c);a=G(a,7);var l=G(a,1);l==e?J$(a,c):l>=b&&l<=d&&(e>c?J$(a,l+1):e<c&&J$(a,l-1))}}var e=lb(a.kq,b);DJc(a.kq,b,c);A(a.Un,d);A(a.zn,d)}
function HJc(a,b){function c(a){if(Vc(a,7)){var c=G(a,7),f=G(c,1);f==b?Yc(a,7):f>b&&J$(c,f-1)}}Db(a.kq,b);A(a.Un,c);A(a.zn,c)}function IJc(a){return a.kq}function JJc(a,b,c){null!=c?(zb(a.kq,b,c),b=function(a){if(Vc(a,7)){a=G(a,7);var b=G(a,1);b>=c&&J$(a,b+1)}},A(a.Un,b),A(a.zn,b)):a.kq.push(b)}
function KJc(a,b){var c=0,d=0,e=new Cd;b.le||(c=b.Rb(),I(e,1,c),c=b.wc(),I(e,2,c),c=2);b.$d()||(d=b.Pb(),I(e,3,d),d=b.Ec(),I(e,4,d),d=2);c=ritz.getRelativityIndicatorsId(c,c,d,d,!0);I(e,5,c);I(e,6,""+a);c=new Bd;I(c,2,0);I(c,1,e);return c}function LJc(a,b){I(a,3,b)}function MJc(a){return ad(a,3)}function NJc(a,b){I(a,2,b)}function K$(a){return G(a,4)}function OJc(a,b){I(a,8,b)}function PJc(a){return ad(a,8)}function QJc(a,b){I(a,2,b)}function RJc(a,b){I(a,3,b)}function SJc(a){return $c(a,2)}
function TJc(a){return G(a,2)}function UJc(a,b){var c=/\d+|\.\d+|\D+/g;if(a==b)return 0;if(!a)return-1;if(!b)return 1;for(var d=a.toLowerCase().match(c),e=b.toLowerCase().match(c),f=Math.min(d.length,e.length),h=0;h<f;h++){var c=d[h],k=e[h];if(c!=k)return d=parseInt(c,10),!isNaN(d)&&(e=parseInt(k,10),!isNaN(e)&&d-e)?d-e:c<k?-1:1}return d.length!=e.length?d.length-e.length:a<b?-1:1}function VJc(){var a=new $C;a.tc=p("goog-menu waffle-pivot-add-field-menu");return a}
var WJc={lNa:"waffle-pivot-zippy-expanded",kNa:"waffle-pivot-zippy-collapsed"};function XJc(a,b,c){var d=b.Rb();b=b.Pb();a=a?a.hd(d,b+c).getDisplayValue():"";""==a&&(a="Column "+Io(b+c));return a}function YJc(a,b,c){b=Array.prototype.splice.call(a,b,1);Array.prototype.splice.call(a,c,0,b[0])}function ZJc(a,b){return UJc(a,b)}function $Jc(a,b){XB.call(this,1602,b);this.C=a}z($Jc,XB);$Jc.prototype.Xd=p(47);$Jc.prototype.Td=function(){var a=new Sp,b=lFa(this.C);I(a,1,b);return a};function L$(a,b){M.call(this,a,b)}z(L$,M);function aKc(a){a=a||{};a=""+Ft(KZ(wt(a,{title:Bt("Report Editor"),Zf:Ct('<div id="waffle-pivot-pane"><div id="waffle-pivot-range-selection"><div class="input-selection-button goog-inline-block"></div><span class="waffle-pivot-label-text waffle-pivot-range-span" id="waffle-pivot-range-text"></span><span class="waffle-pivot-label-text waffle-pivot-range-span">&nbsp;-&nbsp;</span>'+Ft(Mt({Wd:"goog-inline-block waffle-pivot-label-button",content:Ct("Edit range..."),id:"waffle-pivot-range-selection-button",
style:4}))+'</div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+bKc({lx:Bt("Rows"),id:"waffle-pivot-add-field-row"})+'</div><div id="waffle-pivot-row-label" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+bKc({lx:Bt("Columns"),id:"waffle-pivot-add-field-column"})+'</div><div id="waffle-pivot-column-label" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+
bKc({lx:Bt("Values"),id:"waffle-pivot-add-field-value"})+'<div id="waffle-pivot-aggr"><span id="waffle-pivot-aggr-label" class="waffle-pivot-label-text">as:&nbsp;</span><div id="waffle-pivot-aggr-select"></div></div></div><div id="waffle-pivot-values" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+bKc({lx:Bt("Filter"),id:"waffle-pivot-add-field-filter"})+'</div><div id="waffle-pivot-filter" class="waffle-pivot-drop-target"></div></div><div id="waffle-pivot-button-container"><label><input type="radio" name="autoupdate" value="autoupdate" checked id="waffle-pivot-update-auto" />Update table on each change</label><br /><label><input type="radio" name="autoupdate" value="manual" id="waffle-pivot-update-manual"/>Manually</label><button id="waffle-pivot-button-update" disabled="true">Update table</button><br /></div></div>')})));
return mt(a)}function bKc(a){var b;b=""+('<strong id="'+Z(a.id)+'-field-label">'+Y(a.lx)+'</strong><span class="waffle-pivot-label-text">&nbsp;-&nbsp;</span>');var c;c=Bt("Add field");b+=Ft(Mt({Wd:"goog-inline-block waffle-pivot-label-button",content:c,attributes:Dt('aria-label="'+Z(a.lx)+" "+Z(c)+'"'),id:a.id,style:4}));return mt(b)}
function cKc(a){return mt('<div class="waffle-pivot-pill" role="group" tabindex="0"><table class="waffle-pivot-pill-main-table" role="presentation"><tbody><tr><td class="waffle-pivot-pill-main-table-text"><strong>'+Y(a.Pqa)+'&nbsp;</strong><span class="waffle-pivot-pill-title"></span></td><td class="waffle-pivot-pill-main-table-fill"><div class="waffle-pivot-pill-draghandle"></div></td><td class="waffle-pivot-pill-close waffle-pivot-pill-nodrag"></td></tr></tbody></table></div>')};function M$(a,b,c,d,e,f){S.call(this,f);this.L=a;this.Y=c;this.R=d;this.P=e;this.Sf(b)}z(M$,S);r=M$.prototype;r.jb=function(){this.qa=Ds(cKc,{Pqa:this.L})};r.$a=function(){M$.O.$a.call(this);var a=this.Z(),b=U(this);this.J=vm(a,"span","waffle-pivot-pill-title",this.getElement())[0];var c;c=new WD("\u2715",a,4);c.render(vm(a,"td","waffle-pivot-pill-close",this.getElement())[0]);yr(c.getElement(),"Close edit field and remove from pivot table");K(this,c);b.M(c,"action",this.Erb)};
r.Lx=function(){var a=new L$("pivot-pill-changed",this);a.B=this;this.dispatchEvent(a)};function N$(a,b){a.J&&(a.Z().Mg(a.J,b),yr(a.getElement(),"Edit field: "+(a.L+(" "+(b+".")))),a.J.title=b)}function dKc(a){return a.Z().nK(a.J)}function O$(a,b){return XJc(a.Ac(),a.P,b)}function P$(a,b,c){a=a.Z();return a.Ja("span",c,a.createTextNode(b+"\u00a0"))}function Q$(a){return a.Z().Ja("div","waffle-pivot-pill-nodrag")}
r.qI=function(a){var b=this.Z(),c=b.Ja("div","waffle-pivot-pill-section",arguments);1<fm(this.getElement()).length&&Br(c,"waffle-pivot-pill-section-top-border");b.appendChild(this.getElement(),c)};r.Mw=function(a){U(this).M(a.getElement(),"mouseover",this.J0).M(a.getElement(),"mouseout",this.J0)};r.J0=function(a){a=a.target;var b=!Ar(a,"waffle-pivot-select-hover");Fr(a,"waffle-pivot-select-hover",b)};r.tx=g("P");r.Ac=function(){var a=Pw(this.Y.B,this.R);return a?a.Ac():null};
r.Erb=function(){var a=new L$("pivot-remove-pill",this);a.B=this;this.dispatchEvent(a)};r.Kpa=p(!0);r.BFa=ha;function R$(){}z(R$,gD);ia(R$);R$.prototype.tc=p("waffle-pivot-select");R$.prototype.aJ=function(a){return a.Ja("div","goog-inline-block "+(this.tc()+"-dropdown"),"\u00a0\u25be")};function S$(a,b,c,d,e){M$.call(this,"Filter:",a,b,c,d,e);this.B=new mD("",null,R$.getInstance(),e);K(this,this.B)}z(S$,M$);r=S$.prototype;r.$a=function(){S$.O.$a.call(this);this.bb();N$(this,O$(this,eKc(this)));var a=P$(this,"Show:"),b=Q$(this);this.B.rb(b);this.B.Cv=!0;this.B.uK("Loading...");yr(this.B.qa,"Show:");var c=new T$;K(this,c);this.B.Nf(c);this.Mw(this.B);this.qI(a,b)};r.Sf=function(a){S$.O.Sf.call(this,a);N$(this,O$(this,eKc(this)))};function eKc(a){return a.bb().ih()-a.tx().Pb()}
function U$(a){return a.B.hc().B}r.Mw=function(a){S$.O.Mw.call(this,a);U(this).M(U$(this),"filters_selected",this.p2a).M(U$(this),"filtering_cancelled",this.q2a)};function fKc(a,b,c){var d=[];if(!c)return d;a=b.Pb()+a;var e=$h(b,"r");for(b=b.Rb()+1;b<e.end;b++){var f=c.hd(b,a);Rb(d,f.getDisplayValue(),ZJc)}return d}function gKc(a){var b=U$(a),c=SJc(TJc(a.bb())),d=new Lg(c),e=pb(b.getFilterChoices(),function(a,b){return d.contains(b)?a-1:a},b.getFilterChoices().length);EJc(b,c);hKc(a,e)}
function hKc(a,b){var c=U$(a);0==b?a.B.uK("All items"):(c=c.getFilterChoices().length-b,a.B.uK(null!=c?""+c+" items":"All items"))}r.p2a=function(a){this.B.ge(!1);hKc(this,a.gb.length);this.Lx()};r.q2a=function(){this.B.ge(!1);var a=this.B.qa;try{tf&&this.Z().Eb().body.focus(),a.focus()}catch(b){}gKc(this)};function T$(a){bD.call(this,a);this.B=new WZ([],!1,null,a)}z(T$,bD);T$.prototype.$a=function(){T$.O.$a.call(this);this.B.render(this.Ob());var a=new vD(this.B.qa,this.Z());wD(a);K(this,a)};
T$.prototype.DR=function(a){im(a.target)&&this.B.zk(a.target)||T$.O.DR.call(this,a)};function V$(a,b,c,d,e,f){M$.call(this,"Group by:",a,b,c,d,f);this.U=e}z(V$,M$);r=V$.prototype;
r.$a=function(){V$.O.$a.call(this);var a=this.bb();N$(this,O$(this,a.Cn()));var b=this.Z(),a=P$(this,"Order:"),c=Q$(this),d=new bD;d.cb(new XC(b.Yi("Ascending"),0),!0);d.cb(new XC(b.Yi("Descending"),1),!0);b=this.D=new mD("",d,R$.getInstance(),b);b.rb(c);b.ob(PJc(this.bb()));yr(b.getElement(),"Order:");this.Mw(b);this.qI(a,c);var b=this.Z(),c=P$(this,"Sort by:"),a=Q$(this),d=new bD,e=O$(this,this.bb().Cn());d.cb(new XC(e,-1),!0);d=this.K=new mD("",d,R$.getInstance(),b);d.rb(a);yr(d.getElement(),"Sort by:");
U(this).M(d.getElement(),"mouseover",this.J0).M(d.getElement(),"mouseout",this.J0).M(d,"action",this.nUa);b=v(b.Ja,b,"div",["goog-inline-block","waffle-pivot-pill-sort-by"]);c=b(c);this.H=b(a);this.qI(c,this.H);a=this.bb();a=ad(a,2);c=P$(this,"Show totals","waffle-pivot-pill-align-middle waffle-pivot-pill-nodrag");b=Q$(this);Br(b,"goog-inline-block");this.C=new zL;xL(this.C,c);this.C.Dc(a);this.C.render(b);U(this).M(this.C,"change",this.Lx);this.qI(b,c)};
r.Sf=function(a){V$.O.Sf.call(this,a);N$(this,O$(this,a.Cn()));this.C&&this.C.Dc(ad(a,2));this.D&&this.D.ob(PJc(a));iKc(this)};r.$d=g("U");r.nUa=function(a){a=new L$("pivot-sort-by-change",a.currentTarget);a.B=this;this.dispatchEvent(a)};r.oUa=function(a){a=new L$("pivot-sort-key-change",a.currentTarget);a.B=this;this.dispatchEvent(a)};function jKc(a){var b=[];if(a.B)for(var c=a.B.Gc(),d=0;d<c;d++)0<=a.B.Kc(d).La()&&b.push(a.B.Kc(d).lk());return b}
function kKc(a){if(!a.B){var b=a.Z(),c=Q$(a);Br(c,"waffle-pivot-multi-select");a.B=new MC("horizontal",null,b);a.B.rb(c);b.appendChild(a.H,c)}}function iKc(a){if(a.B)for(L(a.B),a.B=null;1<a.H.children.length;)dm(a.H.lastElementChild)}r.Mw=function(a){V$.O.Mw.call(this,a);U(this).M(a,"hide",this.Lx)};r.V=function(){V$.O.V.call(this);L(this.D);L(this.K);L(this.B);L(this.C);this.H=null};function lKc(){N.call(this);this.C="";this.B=!1}z(lKc,N);lKc.prototype.La=g("C");lKc.prototype.ob=function(a){this.C=a;this.B=!0;this.dispatchEvent("change")};function W$(a,b,c,d,e){M$.call(this,"Display:",a,b,c,d,e);this.D=this.H=this.B=null;this.C=0}z(W$,M$);var mKc="SUM COUNTA COUNT COUNTUNIQUE AVERAGE MAX MIN MEDIAN PRODUCT STDEV STDEVP VAR VARP".split(" "),nKc=["SUM"];r=W$.prototype;r.$a=function(){W$.O.$a.call(this);N$(this,oKc(this));pKc(this)};
function pKc(a){var b=a.bb();if(1==K$(b)){var c=new bD;A(mKc,function(a){c.cb(new XC(a),!0)});a.B=qKc(a,c,G(b,5).iA())}else{var d=G(b,6);a.D=rKc(a,"Name",ad(b,3));a.H=rKc(a,"Formula",MJc(d)||"=");c=new bD;A(nKc,function(a){c.cb(new XC(a),!0)});c.cb(new XC("Custom","CUSTOM"),!0);ad(d,4);a.B=qKc(a,c,sKc(a));U(a).M(a.B,"hide",v(a.gZa,a))}}
function qKc(a,b,c){var d=a.Z(),e=P$(a,"Summarize by:"),f=Q$(a);b=new mD("",b,R$.getInstance(),d);K(a,b);b.rb(f);b.ob(c);yr(b.qa,"Summarize by:");a.Mw(b);a.qI(e,f);return b}function rKc(a,b,c){var d=a.Z(),e=P$(a,b),f=Q$(a);b=new TU(b,d);K(a,b);b.render(f);b.ob(c);a.qI(e,f);c=new FD(b.qa);K(a,c);e=new Or(b.qa);K(a,e);U(a).M(c,"input",a.F4a).M(e,"focusout",a.E4a);return b}r.La=function(){return this.H?this.H.La():this.B.La()};function tKc(a){a=a.B.La();return"CUSTOM"==a?null:a}
r.Mw=function(a){W$.O.Mw.call(this,a);U(this).M(a,"hide",this.Lx)};r.gZa=function(){X.jma.qc()};r.Sf=function(a){var b=K$(a);null!=this.bb()&&K$(this.bb());W$.O.Sf.call(this,a);N$(this,oKc(this));1==b?null!=this.B&&this.B.ob(G(a,5).iA()):null!=this.D&&null!=this.H&&(Vc(a,3)&&this.D.ob(ad(a,3)),this.H.ob(MJc(G(a,6))||"="),this.B.ob(sKc(this)))};function oKc(a){var b=a.bb();return Vc(b,3)&&ad(b,3)?ad(b,3):1==K$(b)?O$(a,G(b,5).Cn()):"Calculated Field"}
r.F4a=function(){this.C&&(clearTimeout(this.C),this.C=0);this.C=setTimeout(v(function(){this.Lx();this.C=0},this),3E3)};r.E4a=function(){this.C&&(clearTimeout(this.C),this.C=0);this.Lx()};function sKc(a){a=a.bb();a=G(a,6);a=G(a,4);return null!=a?a:"CUSTOM"}r.Kpa=function(){return 1==K$(this.bb())};r.V=function(){W$.O.V.call(this);L(this.B)};r.BFa=function(){2==K$(this.bb())&&this.D.getElement().focus()};function X$(a,b,c,d,e){LZ.call(this,e);a=this.Z();var f=uKc,h=vKc;this.zb=b;this.Ub=c;this.D=d;this.C={};this.J=!0;this.Ab=null;this.U=new lKc;this.gb=new P(this);this.qb=new f_;this.$=[];this.sb=this.H=null;this.vb=new XC("No fields left to add",void 0,e);this.vb.Ta(!1);this.K=this.L=null;this.Na=tc(f.cJa,h.vX,f.aJa,h.cO,f.bJa,h.jna,f.$Ia,h.Fja);this.P=this.Y=null;b=new bD(a);b.cb(new XC("Columns",2,a),!0);b.cb(new XC("Rows",1,a),!0);this.R=new mD("",b,R$.getInstance(),a)}z(X$,LZ);
var uKc={vX:"waffle-pivot-values",cO:"waffle-pivot-filter",HJa:"waffle-pivot-column-label",hMa:"waffle-pivot-row-label",cJa:"waffle-pivot-add-field-value",aJa:"waffle-pivot-add-field-filter",bJa:"waffle-pivot-add-field-row",$Ia:"waffle-pivot-add-field-column",eJa:"waffle-pivot-aggr-select",fJa:"waffle-pivot-aggr",Mwb:"waffle-pivot-apply",vJa:"waffle-pivot-button-container",TPb:"waffle-pivot-range-selection",UPb:"waffle-pivot-range-selection-button",VPb:"waffle-pivot-range-text",goa:"waffle-pivot-button-update",
$Ma:"waffle-pivot-update-auto",aNa:"waffle-pivot-update-manual"},vKc={jna:"row-breakout",Fja:"col-breakout",cO:"filter",vX:"aggregation"};r=X$.prototype;r.jb=function(){this.qa=Ds(aKc,{id:this.getId()})};
r.$a=function(){function a(a,b){f.M(Pl(a),"click",b)}X$.O.$a.call(this);var b=this.Z(),c=uKc;R(b.getElement(c.vJa),!1);var d=vKc;this.K=tc(d.vX,b.getElement(c.vX),d.cO,b.getElement(c.cO),d.jna,b.getElement(c.hMa),d.Fja,b.getElement(c.HJa));this.Ab=b.getElement(c.goa);var d=qB(ID,""),e=VJc(),f=U(this),h;for(h in this.Na){var k=new hD("",new bD(b,e),d,b);K(this,k);k.rb(b.getElement(h));f.M(k,"show",this.$Xa).M(k.hc(),"action",this.ZXa)}a(c.goa,this.Nbb);a(c.$Ma,this.dxa);a(c.aNa,this.dxa);this.P=b.getElement(c.fJa);
R(this.P,!1);this.R.rb(b.getElement(c.eJa));f.M(this.R,"action",this.qYa);this.sb=new Or(this.Ob());f.M(this.sb,"focusin",this.Orb).M(this.sb,"focusout",this.Prb);wKc(this)};r.Orb=function(a){this.H=xKc(this,a.target)};r.Prb=function(a){if(a=a.relatedTarget){var b=this.Ob();sm(a,function(a){return a==b})||(this.H=null)}};
function xKc(a,b){if(!b)return null;var c=a.Z().GUa(b,"waffle-pivot-pill");if(!c)return null;var d=null,e=null;ac(a.C,function(a,b){return(d=sb(a,function(a){return a.getElement()==c}))?(e=b,!0):!1});return d?{container:e,label:dKc(d)}:null}
function yKc(a){var b=a.Z();if(a.H){var c=a.H.container,d=a.C[c];if(d&&a.H.label)for(var e=0,f;f=d[e];e++)if(dKc(f)==a.H.label){zKc(a,f.getElement());return}d&&0<d.length?zKc(a,d[d.length-1].getElement()):(d=ic(a.Na,function(a){return a==c}),zKc(a,b.getElement(d)))}}
r.Sf=function(a){X$.O.Sf.call(this,a);a?(AKc(this,function(){function b(a,b){if(a)for(;a.length>b;)L(a.pop())}function c(b,c,d){var k="row-breakout"==b;this.C[b]&&this.C[b][d]?(d=this.C[b][d],d.Sf(c),b=new L$("pivot-pill-model-updated"),b.B=d,this.dispatchEvent(b)):(d=new V$(c,this.D,a.on,Y$(this),k,this.Z()),d.render(),BKc(this,d,b))}var d=a.ws,d=ritz.renderPivotTableCalculatedFieldFormulas(a.aaa(),d);a=FJc(a,d);A(a.Ws,function(b,c){if(this.C.filter&&this.C.filter[c]){var d=this.C.filter[c];d.Sf(b)}else d=
new S$(b,this.D,a.on,Y$(this),this.Z()),d.render(),BKc(this,d,"filter")},this);A(a.Un,za(c,"row-breakout"),this);A(a.zn,za(c,"col-breakout"),this);A(a.kq,function(b,c){var d=null;this.C.aggregation&&this.C.aggregation[c]&&(d=this.C.aggregation[c]);if(d&&d.bb()&&K$(d.bb())==K$(b))d.Sf(b);else{var k=new W$(b,this.D,a.on,Y$(this),this.Z());k.render();d?CKc(this,d,k,"aggregation"):BKc(this,k,"aggregation")}},this);b(this.C["row-breakout"],a.Un.length);b(this.C["col-breakout"],a.zn.length);b(this.C.filter,
a.Ws.length);b(this.C.aggregation,a.kq.length);d=(d=(d=Pw(this.D.B,a.on))?d.B:null)?Ro(a.tx(DKc(this)),d):"#REF!";EKc(this,d);this.U.ob(d);(d=this.C.aggregation)&&2<=d.length?(R(this.P,!0),this.R.ob(a.MJ())):R(this.P,!1)}),X$.O.Sf.call(this,a),FKc(this,function(){var a=this.C.filter;a&&A(a,function(a){var b=U$(a),e;e=fKc(eKc(a),a.tx(),a.Ac());kVb(b,e);gKc(a)},this)})):this.reset()};r.focus=function(){X$.O.focus.call(this);zKc(this,Rl("waffle-sidebar-title",this.getElement()))};
function BKc(a,b,c){a.K[c].appendChild(b.getElement());a.C[c]||(a.C[c]=[]);a.C[c].push(b);b.Sc(a);GKc(a,b);wKc(a)}function CKc(a,b,c,d){a.Z().qM(c.getElement(),b.getElement());d=a.C[d];var e=lb(d,b);Ab(d,e,1,c);L(b);c.Sc(a);GKc(a,c);wKc(a)}function GKc(a,b){U(a).M(b,"pivot-remove-pill",a.Rrb).M(b,"pivot-pill-changed",a.Qrb).M(b.getElement(),"keydown",a.v4a);var c=new L$("pivot-pill-created");c.B=b;a.dispatchEvent(c)}
function wKc(a){a.gb.cc();L(a.qb);var b=a.qb=new f_;Yb(a.K,function(a){KVb(b,a)});b.Oe();a.gb.M(b,"beforedragstart",a.Lrb).M(b,"dragstart",a.Nrb).M(b,"dragend",a.Mrb)}r.reset=function(){Yb(this.C,function(a){A(a,L)});this.C={}};function EKc(a,b){var c=a.Z();c.Mg(c.getElement("waffle-pivot-range-text"),b)}
r.Rrb=function(a){var b=new L$("pivot-pill-removed",this);b.B=a.target;b.container=ic(this.C,function(b){return vb(b,a.target)});b.L=HKc(this,b.container,a.target);b.container&&(Cb(this.C[b.container],a.target),this.H={container:b.container,label:null},this.dispatchEvent(b))};r.Qrb=function(a){a.container=ic(this.C,function(b){return vb(b,a.target)})};r.v4a=function(a){!a.shiftKey||38!=a.keyCode&&40!=a.keyCode||IKc(this,a.target,38==a.keyCode)};
function IKc(a,b,c){var d=null,e=-1;ac(a.K,function(a,c){e=lb(a.childNodes,b);return 0<=e?(d=c,!0):!1});var f=a.C[d];if(!(!f||1>=f.length||(c=c?e-1:e+1,0>c||c>f.length-1))){YJc(f,e,c);var h=new L$("pivot-pill-changed",a);h.B=f[c];h.container=d;h.D=d;h.position=c;h.hb=!0;a.dispatchEvent(h)}}r.Nbb=function(){this.dispatchEvent("pivot-table-update")};r.dxa=function(a){a=this.J="autoupdate"==a.target.value;(this.Ab.disabled=a)&&this.dispatchEvent("pivot-table-update")};r.qYa=function(){this.dispatchEvent("pivot-aggregation-orientation-changed")};
r.MJ=function(){return this.R.La()};function JKc(a,b,c,d){Rf(a.L);XUb(a.zb,a.U,a.U.La(),!1,!1,!0,v(a.Gmb,a,b,c,!!d))}r.Gmb=function(a,b,c,d){var e=this.U,f=this.D;e.B=!1;var h=e.La();this.L=Pf(d,"afterhide",function(){if(e.B){var d=Po(e.La(),f.B,!0,!0);d?a(d):(e.ob(h),b())}else b();c||zKc(this,Pl("waffle-pivot-range-selection-button"))},!1,this)};
r.$Xa=function(a){var b=a.target.getParent(),c=b.hc();this.Y=this.Na[b.qa.id];AKc(this,function(){var a=this.Y,e=DKc(this),f=Y$(this),h=KKc(this,a);c.Od(!0);for(var k=$h(f,"c"),l=0,m=k.start;m<k.end;m++){var n=XJc(e,f,l);n&&!h[n]&&c.cb(new XC(n,l),!0);l++}"aggregation"==a&&(c.cb(new aD,!0),c.cb(new XC("Calculated Field",-1),!0));0==c.Gc()&&c.cb(this.vb,!0);kU(b,!0);b.vy();kU(b,!1)})};function zKc(a,b){try{tf&&a.Z().Eb().body.focus(),b.focus(),a.Ub.zc(2)}catch(c){}}
r.ZXa=function(a){var b=this.Y;a=a.target.La();var c=new L$("pivot-pill-added",this);c.container=b;c.J=a;this.H={container:b,label:null};this.dispatchEvent(c)};r.Lrb=function(a){for(var b=a.event.target||a.event.B.target;b instanceof Element&&!Ar(b,"waffle-pivot-pill");b=b.parentNode)if(Ar(b,"waffle-pivot-pill-nodrag")){a.preventDefault();break}};r.Nrb=function(a){var b=Nn(a.B).width;Dn(a.J,b)};
r.Mrb=function(a){var b,c,d,e,f=new L$("pivot-pill-changed",this);ac(this.K,function(c,d){e=lb(c.childNodes,a.B);return 0<=e?(b=d,!0):!1});ac(this.C,function(b,e){var l=sb(b,function(b){return b.getElement()==a.B}),m=lb(b,l);return l?(c=e,f.B=d=l,f.va=m,!0):!1});this.C[b]||(this.C[b]=[]);Cb(this.C[c],d);zb(this.C[b],d,e);f.container=b;f.D=c;f.position=e;this.dispatchEvent(f)};
function KKc(a,b){function c(a){a=h(a.dA()-k);f[a]=!0}function d(a){a=h(a.Cn());f[a]=!0}var e=a.bb(),f={},h=v(XJc,a,DKc(a),Y$(a)),k=Y$(a).Pb();if(e)switch(b){case "filter":A(e.Ws,c);break;case "row-breakout":case "col-breakout":A(e.Un,d),A(e.zn,d)}return f}function AKc(a,b){var c=LKc(a);if(c){var d=Y$(a),d=new Rh(d.Rb(),d.Pb(),d.Rb()+1,d.Ec());ml?MKc(a,d,b):Av(c.C,d,v(b,a),U(a))}else b.call(a)}function FKc(a,b){var c=LKc(a);c?ml?MKc(a,Y$(a),b):Av(c.C,Y$(a),v(b,a),U(a)):b.call(a)}
function MKc(a,b,c){b=yv(Gv(LKc(a)),b).addCallback(c,a);a.$.push(b);ij(b,za(Cb,a.$,b))}function LKc(a){var b=a.bb();return Pw(a.D.B,b.on)}function DKc(a){return(a=LKc(a))?a.Ac():null}function Y$(a){return a.bb().tx(DKc(a))}function HKc(a,b,c){return ub(a.C[b],function(a){return c.getElement()==a.getElement()})}r.V=function(){X$.O.V.call(this);Yb(this.C,function(a){kf(a)});this.C={};Rf(this.L);this.L=null;L(this.qb);L(this.gb);A(this.$,GC)};function NKc(a,b){J.call(this);this.B=a;this.F=b;this.C=new P(this);K(this,this.C);this.C.M(a,"pivot-pill-created",this.D).M(a,"pivot-pill-model-updated",this.D)}z(NKc,J);NKc.prototype.H=function(a){var b=a.B;a=a.target.La();iKc(b);-1==a?b.Lx():0<OKc(this,b).length&&!b.B?(kKc(b),b.B.getElement().focus(),PKc(this,b,-2,!0)):b.Lx()};
NKc.prototype.J=function(a){var b=a.B;a=a.target;var c=co(b.B,a),d=b.Z();for(c++;c<b.B.Gc();){var e=b.B.Kc(c),f=d.jaa(e.getElement());Ar(f,"waffle-pivot-select-divider")&&d.removeNode(f);b.B.removeChild(e,!0)}(0>a.La()||!PKc(this,b,-2,!0))&&b.Lx()};function QKc(a,b){a.C.M(b,"pivot-sort-by-change",a.H).M(b,"pivot-sort-key-change",a.J)}
NKc.prototype.D=function(a){var b=a.B;if(b instanceof V$){a=b.bb();for(var c=0<OKc(this,b).length,d=IJc(this.B.bb()),e=b.K,f=e.Uj()-1;1<=f;f--)e.jF(f);e.Ee(0).uK(O$(b,a.Cn()));e.Af(0);A(d,function(a,d){var f;if(Vc(a,3))f=G(a,3);else if(1==K$(a)){f=G(a,5).getFunctionName();var m=O$(b,G(a,5).Cn());f=c?f+(" of "+(m+" in...")):f+(" of "+m)}else f=MJc(G(a,6));e.Ye(new XC(f,d))});Vc(a,7)&&(d=G(a,7),a=$c(d,2),RKc(this,b,a)&&(d=G(d,1),e.ob(d),c&&(kKc(b),A(a,v(function(a){PKc(this,b,a,!1)},this)),PKc(this,
b,-1,!1))));QKc(this,b)}};
function PKc(a,b,c,d){var e=SKc(a,b);if(0==e.length)return!1;var f=b.B.Gc();a=OKc(a,b);if(f>=a.length)return!1;var h=O$(b,a[f].Cn()),f=b.Z();a=b.B.Gc();var k=new bD,l=new XC(h,-2);l.Ta(!1);k.cb(l,!0);k.cb(new XC(0==a?"Grand Total":"Total",-1),!0);for(l=0;l<e.length;l++)k.cb(new XC(e[l],l),!0);h=new mD(h,k,R$.getInstance(),f);h.ob(-2);b.B.cb(h,!0);0<a&&(a=f.Ja("div",["goog-inline-block","waffle-pivot-select-divider"],":"),f.MF(a,h.getElement()));U(b).M(h,"action",b.oUa);f=c;"string"==typeof c&&(f=
lb(e,c),-1==f&&(f=-2));h.ob(f);d&&(b.B.ag(h),h.ge(!0));return!0}function SKc(a,b){var c=TKc(a,b),d=jKc(b),e=d.length,f=[];A(c,function(a){a.length==e+1&&rb(d,function(b,c){return a[c]==b})&&Rb(f,a[e])});return f}function RKc(a,b,c){a=TKc(a,b);return 0==c.length||qb(a,function(a){return Qb(c,a)})}function OKc(a,b){return b.$d()?a.B.bb().zn:a.B.bb().Un}function TKc(a,b){return b.$d()?fFa(a.B.bb(),a.F):gFa(a.B.bb(),a.F)};function UKc(a,b){tq.call(this,1601,b,Th(a.B));this.C=a}z(UKc,tq);UKc.prototype.exec=ba();UKc.prototype.Xd=p(48);UKc.prototype.Td=function(){var a=new Tp,b=lFa(this.C);I(a,2,b);var b=this.C.B,c=new gd;I(c,1,""+this.C.ws);c.Wv(b.y);I(c,3,b.x);I(a,1,c);return a};function VKc(a,b,c,d,e){JZ.call(this,a,c);this.F=this.L=null;this.B=a;this.C=b;this.U=d;this.R=e;this.Y=new NKc(this.B,this.C);K(this,this.Y);b=b.B;c=a.Z();this.X.M(a,"pivot-table-update",this.Rbb).M(a,"pivot-pill-added",this.X7a).M(a,"pivot-pill-removed",this.Grb).M(a,"pivot-pill-changed",this.Frb).M(a,"pivot-aggregation-orientation-changed",this.pYa).M(Wm,"show-pivot-ritz",this.Irb).M(e,"activeCellChange",this.uia).M(e,"click",this.Jrb,!0).M(e,"pivot_table_zippy_toggle",this.Mcb).M(b,"ga",this.uia).M(b,
"ja",this.J$a).M(c.getElement("waffle-pivot-range-selection-button"),"click",this.s8a).M(c.getElement("waffle-pivot-range-selection-button"),"keypress",this.t8a);a=["jb"];a.push("xa");this.X.M(ju(b),a,this.uia)}z(VKc,JZ);r=VKc.prototype;r.Uh=function(){return X.mma};r.hv=function(){return X.kma};r.s8a=function(){WKc(this)};r.t8a=function(a){13==a.keyCode&&(a.preventDefault(),a.stopPropagation(),WKc(this))};function WKc(a){JKc(a.B,v(a.Hrb,a,XKc(a)),ha)}
r.Hrb=function(a,b){a.on=b.Wc;var c=KJc(b.Wc,b.rect);a.on=parseInt(G(c,1).wb(),10);a.C=c;Z$(this,a,this.B.J,!1);var c=a.ws,d=this.C.B;sy(d)!=c&&mN(d,c)};
r.Irb=function(){var a;cl.getInstance();var b=this.C.B.B;if(b&&0==b.getSheetType()){a=this.C;var c=b.wb(),b=Xx(b.Ac());a=fU(a,c,b)}else a=!1;if(a){c=this.B;if(!c.ib()){a=this.C.B.getActiveGrid();b=$$(this);if(!b&&a){this.B.reset();var c=a.C,b=a.Ac(),d=Zx(b),e=Xx(b);d?(ml?Cv(c,e,dc(Yg)):Ev(c,e,dc(Yg),this.X)).addCallback(v(this.$Fa,this,a)):this.$Fa(a,Rx(b));return}this.F=b;c.Sf(b)}this.hv().qc()}};
r.Frb=function(a){var b=a.container,c=a.D,d=a.B,e=a.va,f=d,h=this.B.bb().clone();if(d&&c&&b!=c){if(!d.Kpa()){Z$(this,$$(this),!1,!0);return}f=YKc(this,d.bb(),b);a:{var k=this.B,l;l=k.bb().on;switch(b){case "row-breakout":case "col-breakout":var m="row-breakout"==b,f=new V$(f,k.D,l,Y$(k),m,k.Z());break a;case "aggregation":f=new W$(f,k.D,l,Y$(k),k.Z());break a;case "filter":f=new S$(f,k.D,l,Y$(k),k.Z());break a;default:f=null}}f.render();CKc(this.B,d,f,b)}d=a.position;k=c==b;l=ZKc(this,f.bb());if(c)if(k){f=
f.bb();switch(b){case "row-breakout":DJc(h.Un,f,d);break;case "col-breakout":DJc(h.zn,f,d);break;case "filter":DJc(h.Ws,f,d);break;case "aggregation":GJc(h,f,d)}Zm("Field is now in position "+(d+1+"."))}else $Kc(this,b,h,l,d);else aLc(this,b,f,h);c&&!k&&null!=e&&bLc(e,c,h);Z$(this,h,this.B.J,!!a.hb)};
function YKc(a,b,c){switch(c){case "row-breakout":case "col-breakout":if(b instanceof qe)return b;break;case "aggregation":if(b instanceof re)return b;break;case "filter":if(b instanceof je)return b;break;default:return null}b=ZKc(a,b);-1==b&&(b=0);switch(c){case "row-breakout":case "col-breakout":return c=new qe,I(c,1,b),c;case "aggregation":return c=new re,a=new se,I(a,1,b),NJc(a,"SUM"),I(c,4,1),I(c,5,a),c;case "filter":return c=new je,new ke,a=b+cLc(a).Pb(),I(c,1,a),c;default:return null}}
function ZKc(a,b){if(b instanceof qe)return b.Cn();if(b instanceof re)switch(K$(b)){case 1:return G(b,5).Cn();case 2:return-1;default:return 0}return b instanceof je?b.ih()-cLc(a).Pb():0}function cLc(a){var b=$$(a);return b.tx(Pw(a.C.B,b.on).Ac())}r.X7a=function(a){var b=a.container,c=XKc(this);$Kc(this,b,c,a.J,a.position);Z$(this,c,this.B.J,!1);a=this.B;a.C[b]?(b=a.C[b],b=0<b.length?b[b.length-1]:null):b=null;b&&b.BFa()};
r.Grb=function(a){var b=XKc(this);bLc(a.L,a.container,b);L(a.B);Z$(this,b,this.B.J,!1)};r.pYa=function(){var a=XKc(this),b=this.B.MJ();a.D=b;Z$(this,a,this.B.J,!1)};
function $Kc(a,b,c,d,e){switch(b){case "row-breakout":a=new qe;I(a,1,d);null!=e?zb(c.Un,a,e):c.Un.push(a);break;case "col-breakout":a=new qe;I(a,1,d);null!=e?zb(c.zn,a,e):c.zn.push(a);break;case "filter":b=Pw(a.C.B,c.on);if(!b)break;b=b.Ac();b=fKc(d,c.tx(b),b);var f=new je;a=cLc(a).Pb()+d;I(f,1,a);dLc(f,b);null!=e?zb(c.Ws,f,e):c.Ws.push(f);break;case "aggregation":b=new re;if(-1==d){X.ima.qc();d=new te;LJc(d,"=");I(d,4,"SUM");I(b,4,2);I(b,6,d);d=IJc($$(a));for(var h=!1,f="",k=1;!h&&k<=d.length+1;k++){f=
"Calculated Field "+k;a:{for(var h=a,l=f,m=$$(h),n=m.kq,q=0;q<n.length;q++){var t=n[q];if(Vc(t,3)&&l==G(t,3)){h=!0;break a}if(1==K$(t)){var w=Pw(h.C.B,m.on).Ac();if(l==XJc(w,m.tx(w),G(t,5).Cn())){h=!0;break a}}}h=!1}h=!h}I(b,3,f)}else a=new se,I(a,1,d),NJc(a,"SUM"),I(b,4,1),I(b,5,a);JJc(c,b,e)}}function bLc(a,b,c){if(!(0>a))switch(b){case "row-breakout":Db(c.Un,a);break;case "col-breakout":Db(c.zn,a);break;case "filter":Db(c.Ws,a);break;case "aggregation":HJc(c,a)}}
function aLc(a,b,c,d){if("aggregation"==b)a=HKc(a.B,b,c),d=d.kq[a],null!=d&&(a=c.D?c.D.La():null,null!=a&&I(d,3,a),1==K$(d)?NJc(G(d,5),c.La()):(jb(2==K$(d)),d=G(d,6),LJc(d,c.La()),(a=tKc(c))?I(d,4,a):Yc(d,4)));else if("filter"==b)d=sb(d.Ws,function(a){return a.equals(c.bb())}),null!=d&&dLc(d,lVb(U$(c),!0));else if(d=sb("row-breakout"==b?d.Un:d.zn,function(a){return a.equals(c.bb())}),null!=d)if(QJc(d,c.C.isChecked()),OJc(d,c.D.La()),-1!=c.K.La()){var e=new pe;J$(e,c.K.La());A(jKc(c),function(a){Xc(e,
2,a)});RJc(e,c.D.La());I(d,7,e)}else Yc(d,7)}r.Rbb=function(){Z$(this,$$(this),!0,!1)};function Z$(a,b,c,d){b&&(c?(c=TB(a.C.B,b.ws),c=new UKc(b,c),a.U.xc(c),a.L=null):a.L=b,c=a.B.bb(),(d=d||!Dh(c.B,b.B))&&a.B.reset(),a.B.Sf(b),d&&yKc(a.B))}r.$Fa=function(a,b){var c=a.Ac(),d=Zx(c),c=Xx(c);d&&b.equals(c)?JKc(this.B,v(this.vta,this),v(this.bgb,this),!0):this.vta(new li(a.wb(),a.B,b))};r.bgb=function(){this.Uh().setVisible(!1);this.K.zc(3)};
r.vta=function(a){var b;b=new ue;var c=KJc(0,new Rh(0,0,1,1));I(b,6,c);I(b,5,2);b=kFa(b,0,new O(0,0),0);b.on=a.Wc;a=KJc(a.Wc,a.rect);b.on=parseInt(G(a,1).wb(),10);b.C=a;a=sy(this.C.B);this.U.xc(new $Jc(b,a))};function $$(a){return a.L?a.L:(a=a.C.B.B)&&0==a.getSheetType()?fHa(a.Ac()):null}function XKc(a){return(a=$$(a))?a.clone():null}
r.uia=function(a){var b=$$(this);if(("jb"==a.type||"xa"==a.type)&&!b&&this.F&&(a=this.C.B.getActiveGrid())&&(this.B.Ta(!0),a=a.Ac(),a.Nb()==this.F.ws)){var c=this.F.B;c&&($x(a,c),b=$$(this))}b?b.equals(this.F,this.C)||this.B.Sf(b):this.B.reset();this.F=b;a=!!b;vAb.B&&!this.Uh().ib()||this.Uh().setVisible(a&&!gI(this.C));this.B.Ta(!!b)};r.J$a=function(a){a=a.target;if(this.F&&this.F.ws==a.wb()&&this.B.ib()){a=this.B;var b=Eya(a.zb);b&&a.L&&b.setVisible(!1)}};
r.Jrb=function(a){var b=a.target;if(Ar(b,WJc.lNa)||Ar(b,WJc.kNa)){var b=du(this.R).bb(),c=Nx(b,a.Dg);eLc(this,b,c);a.stopPropagation()}};r.Mcb=function(a){var b=du(this.R).bb();a=Nx(b,a.Dg);eLc(this,b,a)};
function eLc(a,b,c){if(!gI(a.C)){var d=c.zq();b=gHa(b,c);if(c=d.Y$()){var e=c.length-1;c=c[e];for(var d="r"==d.iR()?b.Un[e]:b.zn[e],e=$c(d,3),f,h=0;h<e.length;h++)if(e[h].La()==c){f=e[h];var k=!G(f,3);I(f,3,k)}f||(f=new ne,f.ob(c),I(f,3,!0),Xc(d,3,f));Zm(G(f,3)?"Pivot table field collapsed":"Pivot table field expanded");Z$(a,b,!0,!1)}}}function dLc(a,b){var c=new ke;Yc(c,2);I(c,1,!1);A(b,function(a){Xc(c,2,a)});I(a,2,c)}r.V=function(){VKc.O.V.call(this)};function fLc(){J.call(this)}z(fLc,Dm);fLc.prototype.C=function(){return X$};fLc.prototype.B=function(){return VKc};Tm("ritzpivottables",fLc);
