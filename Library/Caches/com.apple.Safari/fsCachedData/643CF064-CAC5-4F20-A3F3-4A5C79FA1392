function m5b(a,b,c,d){var e=null;a.B.every(function(a,h,k){if(b&&(h>c||h==c&&k>=d))return!1;a.isEmpty()||(e=new O(k,h));return!0});return e}function n5b(a,b,c){var d=null;a.B.some(function(a,f,h){return(f>b||f==b&&h>c)&&!a.isEmpty()?(d=new O(h,f),!0):!1});return d}DL.prototype.Lt=MT(178,function(){return!!Ug(this,"ip")});
YK.prototype.eva=MT(169,function(a,b,c,d){for(var e=a-1,f=this.C.length;0<=e;){var h=this.C[e--];if(!(h.getSheetType()!=b||h.D&&d))return h}if(!c)return null;for(e=f-1;e>=a;)if(c=this.C[e--],!(c.getSheetType()!=b||c.D&&d))return c;return null});function o5b(a,b){var c=ry(a.C);Yb(a.U,function(a,e){var f=this.J.yp(a);Number(e)==c&&b?Ar(f,"docs-icon-comment-blank-highlighted"):Cr(f,"docs-icon-comment-blank-highlighted")},a)}
function p5b(a,b,c){var d=0,e=-1;b&&(d=b.y,e=b.x);var f=null;return f=c?m5b(a,!!b,d,e):n5b(a,d,e)}function q5b(a,b){if(!b)return null;var c=null;a.B.some(function(a,e,f){a=a.Zc();for(var h=0;h<a.length;h++)if(a[h]==b)return c=new O(f,e),!0;return!1});return c}function r5b(a){var b=new Lg;a.B.forEach(function(a){a.isEmpty()||Mg(b,a.Zc())});return b.Zc()}function s5b(a,b){var c=a.B.Ge(b.y,b.x);return c?c.Zc():[]}function x2(a){return a.B.hasUnpostedDocos()}
function t5b(a,b){for(var c=[],d=0;d<b.length;d++)c.push(a.C.B[b[d]]||0);a.B.deleteDocoPositions(c)}function u5b(a,b){var c={},d;for(d in b){var e=a.C.B[d]||0;if(e&&a.B.hasDoco(e)){var f=b[d];c[e]=new Docos.Point(f.x,f.y)}}return c}var v5b={DTb:1,HOVER:2,sMa:3};function y2(a,b,c){pq.call(this,10100,b);this.Db=a;this.C=b;this.H=c}z(y2,pq);y2.prototype.$d=p(35);y2.prototype.Wd=function(){var a=new Kp,b=oi(this.H,this.C);I(a,1,this.Db);I(a,2,b);return a};y2.prototype.wj=Gc;function w5b(a){this.B={};if(a)for(var b in a)this.set(b,a[b])}w5b.prototype.get=function(a){if(!(a in this.B))throw Error("No value for key "+a);return this.B[a]};w5b.prototype.set=function(a,b){this.B[a]=b};function x5b(a){this.B=new w5b;this.C=a||null}x5b.prototype.Vc=function(a){try{var b=Ub(a)}catch(c){return this.C&&this.C.log(Error("Invalid serialized anchor ID")),null}return this.B.get(b.type).Vc(b)};x5b.prototype.$b=function(a){return Wb(this.B.get(a.cb()).$b(a))};function z2(a,b){this.D=a;this.C=b}z2.prototype.cb=g("D");function y5b(a){z2.call(this,"range",0);this.F=a}z(y5b,z2);y5b.prototype.B=g("F");function z5b(){}ja(z5b);z5b.prototype.Vc=function(a){return new y5b(a.range)};z5b.prototype.$b=function(a){var b={};b.type=a.cb();b.uid=a.C;b.range=a.B();return b};function A2(a,b){z2.call(this,"workbook-range",0);this.H=a;this.F=!!b}z(A2,z2);A2.prototype.B=g("H");function A5b(){}ja(A5b);A5b.prototype.Vc=function(a){return new A2(a.range)};A5b.prototype.$b=function(a){var b={};b.type=a.F?"range":"workbook-range";b.uid=a.C;b.range=a.B();return b};function B2(){x5b.call(this);var a=z5b.getInstance();this.B.set("range",a);a=A5b.getInstance();this.B.set("workbook-range",a)}z(B2,x5b);ja(B2);B2.prototype.Vc=function(a){return(a=B2.O.Vc.call(this,a))?("range"==a.cb()&&(a=new A2(a.B(),!0)),a):null};function C2(a,b){if(!b)return null;var c=b.B();return"range"==b.cb()?(c=a.B[c],B5b(c)?c.cc().ue():null):(c=C5b(b))&&D5b(E5b(c))?E5b(c).ue():null}function C5b(a){var b=new Ch,c;try{c=ritz.getWorkbookRangeById(a.B(),!0)}catch(d){}return c?b.Vc((new Ed).oa(),ritz.getWorkbookRangeById(a.B(),!0)):null}function E5b(a){return new Rh(a.Rb(),a.Pb(),a.wc(),a.Fc())}
function D2(a,b,c){return c?"range"==c.cb()?(b=b.B[c.B()],B5b(b)?(b=b.Ob(),null!=b?F5b(a,b):null):null):(b=C5b(c))&&D5b(E5b(b))?F5b(a,parseInt(b.wb(),10)):null:null}function F5b(a,b){var c=Pw(a,b);return c?c.Bc():null}function B5b(a){return!!a&&a.B&&D5b(a.cc())}function D5b(a){return!!a&&Qga(a)&&ei(a)};function G5b(a,b,c,d,e,f,h,k,l,m,n){J.call(this);this.D=a;this.Ya=b;this.Y=c;this.tb=d;this.J=e;this.hb=f;this.$=h;this.Na=k;this.B=l;this.U=m;this.H=b.Ya;this.C=b.B;this.F=b.M;this.K=B2.getInstance();this.R={};this.P=new Lg;this.va=new ik(0);a=[this.va];Hb(n.C,a);Trb(n,a);n.B=Rrb(n.C);Srb(n);this.M=new P(this);H5b(this)}z(G5b,J);r=G5b.prototype;r.xha=!1;
function H5b(a){var b=nb(Nua,function(a){return!Qua[a]});a.M.L(a.tb,"activity-box-closed",a.n6a).L(a.J,"mouseover",E2(a,a.Icb)).L(a.J,"click",E2(a,a.Gcb)).L(a.J,"selectionChange",E2(a,a.Jcb)).L(a.J,"inputBoxActivate",E2(a,a.Ecb)).L(a.J,"hide_docos",E2(a,a.Hcb)).L(a.C,"ha",E2(a,a.Utb)).L(a.$,"view-comments",a.$$a).L(a.$,"comment-indicator-hover-start",a.Y$a).L(a.$,"comment-indicator-hover-end",a.X$a).L(a.J,"insert_doco",a.Rtb).L(new Vt(a.Na),"mousewheel",a.Stb).L(a.F,["add_named_range","delete_named_range"],
a.X6a).L(a.Ya,"docos_change",a.Scb).L(a.U,"$e",a.sYa).L(a.C,"ga",a.bza);var c=ju(a.C);a.M.L(c,b,a.Fcb);a.M.L(c,["Va"],E2(a,a.Ttb));pC(a.D,Docos.EventType.HOVER,E2(a,a.c1a));pC(a.D,Docos.EventType.SELECTED,E2(a,a.Qtb));pC(a.D,Docos.EventType.CREATED,a.Kxa,a);pC(a.D,Docos.EventType.UNRESOLVED,a.Kxa,a);pC(a.D,Docos.EventType.DELETED,a.Lxa,a);pC(a.D,Docos.EventType.RESOLVED,a.Lxa,a);pC(a.D,Docos.EventType.POSTED,a.A1a,a);pC(a.D,Docos.EventType.PENDING,a.e8a,a);X.Ks.Pc(jo,v(a.v4a,a));W.pw.Pc(jo,v(a.dYa,
a));W.mW.subscribe("action",v(a.J6a,a));W.nW.subscribe("action",v(a.S6a,a));W.oW.subscribe("action",v(a.T6a,a));a.bza()}r.bza=function(){var a=cJ(this.C);W.mW.Ta(a);W.nW.Ta(a);W.oW.Ta(a)};r.v4a=function(){this.D.setOption(Docos.OptionName.READONLY,!this.Ya.Az())};function E2(a,b){return v(function(a){this.xha||b.call(this,a)},a)}
r.Rtb=function(){var a=SB(this.C),b=Wx(a);if(b&&!x2(this.D)&&!I5b(this,a,b)){var c=ritz.getNewWorkbookRangeId();this.hb.zc(new y2(c,a.Ob(),Th(b)));a=this.K.$b(new A2(c));if(a=F2(this,a))this.B.dispatchEvent(new G2("hf",[a],b)),this.Y.Ac(2)}};function I5b(a,b,c){c=s5b(NB(a.H,b),c);return c.length?(b=a.D,a=a.K.$b(c[0]),b.B.highlightDoco(b.C.B[a]||0,!0),!0):!1}r.Kxa=function(a){A(a.B,function(a){H2(this,!0,a);this.P.add(a)},this)};r.Lxa=function(a){A(a.B,function(a){H2(this,!1,a);this.P.remove(a)},this)};
function H2(a,b,c,d,e){c=F2(a,c);d=d||D2(a.C,a.F,c);e=e||C2(a.F,c);if(c&&d&&e){var f=NB(a.H,d);if(b){var h=f.B.Ge(e.y,e.x)||new Lg;h.add(c);Kv(f.B,e.y,e.x,h)}else(h=f.B.Ge(e.y,e.x))&&h.remove(c);Kv(f.C,e.y,e.x,!0);f.F.Sb()||f.F.start();a.C.getActiveGrid()&&(d=d==SB(a.C),b?(a=a.B,(b=d?e:null)&&Dh(b,a.gL)&&a.B.add(c),a.dispatchEvent(new G2("af",[c],b))):(a=a.B,(b=d?e:null)&&Dh(b,a.gL)&&a.B.remove(c),a.Tt==c&&(a.Tt=null),a.dispatchEvent(new G2("kf",[c],b))))}else a.B.dispatchEvent("mf")}
function F2(a,b){if(!b)return null;if(!a.R[b]){var c=a.K.Vc(b);c&&(a.R[b]=c)}return a.R[b]}r.Utb=function(){this.B.reset()};r.c1a=function(a){a=F2(this,a.B.length?a.B[0]:null);var b=C2(this.F,a);this.B.dispatchEvent(new G2("ef",[a],b))};r.A1a=ba();r.e8a=function(){var a=this.va,b=this.D.B.hasPendingContent();jk(a,hk(a.Ua,4,b))};r.n6a=function(){this.Y.Ac(3)};
r.Qtb=function(a){if(!x2(this.D)){var b=F2(this,a.B.length?a.B[0]:null),c=C2(this.F,b);b&&c?(this.xha=!0,J5b(this.B,b,c)):b||a.F?this.B.reset():b||this.Y.Ac(3)}};r.sYa=function(){this.xha=!1};r.Hcb=function(){this.B.dispatchEvent("gf")};r.Jcb=function(){if(!this.U.isEmpty()&&!x2(this.D)){this.Y.Ac(3);var a=this.B,b=Wx(SB(this.C));Dh(a.VM,b)||!a.Tt&&!a.Jv&&Dh(a.gL,b)||(I2(a),a.dispatchEvent(new G2("df",[],b)))}};
r.Gcb=function(){var a=SB(this.C);if(!x2(this.D)&&a){var b=NB(this.H,a),c=(a=Wx(a))?s5b(b,a):[];c.length&&(b=this.B,c=c[0],Dh(b.VM,a)?(I2(b),b.dispatchEvent(new G2("bf",[],a))):b.dispatchEvent(new G2("bf",[c],a)))}};r.Ecb=function(){x2(this.D)||this.B.reset()};r.Ttb=function(){K5b(this.B)};r.Fcb=function(){K5b(this.B)};
r.X6a=function(a){var b=a.hf;if(b&&b.B)if(B5b(b)){var c;c=b.getId();c=this.K.$b(new y5b(c));a="add_named_range"==a.type;if(!a||this.P.contains(c)){var d=b.Ob();b.zf()&&null!=d&&(d=F5b(this.C,d))&&H2(this,a,c,d,b.cc().ue())}}else this.B.dispatchEvent("mf")};
r.Scb=function(a){a=a.docos||[];Jb(a);for(var b=0;b<a.length;b++){var c=this.K.$b(new A2(a[b]));if(c){var d=F2(this,c),e;a:{e=this.H;if(d){var f=void 0;for(f in e.B){var h=e.B[f],k=q5b(h,d);if(k){e={ub:h.Bc(),coord:k};break a}}}e=null}e?(H2(this,!1,c,e.ub,e.coord),H2(this,!0,c),this.B.dispatchEvent("mf")):this.P.contains(c)&&H2(this,!0,c)}}};
r.Icb=function(a){var b=SB(this.C);if(b){if((a=a.Fg)&&!nD(a)){var c=gx(b,a.y,a.x);a=c?c.ue():a}else a=null;b=NB(this.H,b);b=a?s5b(b,a):[];c=this.B;c.B.clear();Mg(c.B,b);c.gL=a;c.dispatchEvent(new G2("cf",b,a))}};r.$$a=function(){if(!x2(this.D)){var a=this.B;if(a.Jv&&a.nT)a.nT=!1;else{var b=!a.Jv;I2(a);a.Jv=b;a.dispatchEvent("jf")}}};r.Y$a=function(){if(!x2(this.D)){var a=this.B;a.Jv||(I2(a),a.nT=!0,a.Jv=!0,a.dispatchEvent("jf"))}};r.X$a=function(){if(!x2(this.D)){var a=this.B;a.Jv&&a.nT&&(I2(a),a.dispatchEvent("jf"))}};
r.Stb=function(a){a.stopPropagation()};r.PVa=function(a){var b=F2(this,a);a=D2(this.C,this.F,b);if(!b||!a)return"";b=C2(this.F,b);a=Nx(a,b).getDisplayValue();500<a.length&&(a=a.substring(0,499),a+="\u2026");return a};r.dYa=function(){var a;a=this.D;var b=a.B.getLinkedDoco();if(a=a.C.C[b]||null||"")(a=F2(this,a))?(b=C2(this.F,a),J5b(this.B,a,b)):W.pw.mc()};r.J6a=function(){var a=SB(this.C);I5b(this,a,Wx(a))};r.S6a=function(){L5b(this,!1)};r.T6a=function(){L5b(this,!0)};
function L5b(a,b){for(var c=M5b(a,b),d=qy(a.C),e=SB(a.C),f=Wx(e),h=NB(a.H,e),f=p5b(h,f,b),k=d;!f&&null!==k&&(k=c(k),e=k.Bc(),h=NB(a.H,e),f=p5b(h,null,b),k=k.kf,k!=d););f&&null!==k&&(c=s5b(h,f)[0],su(a.C,k,v(a.Vtb,a,e,c,f)))}function M5b(a,b){var c;c=b?v(a.C.eva,a.C):v(a.C.A_,a.C);return function(a){return c(a,0,!0,!0)}}r.Vtb=function(a,b,c){J5b(this.B,b,c);$x(a,c)};
r.V=function(){delete this.J;delete this.Na;delete this.K;delete this.R;delete this.D;delete this.H;delete this.F;delete this.hb;delete this.C;delete this.Ya;L(this.va);delete this.va;L(this.U);delete this.U;L(this.B);delete this.B;L(this.M);delete this.M;G5b.O.V.call(this)};function G2(a,b,c){M.call(this,a);this.docos=b;this.F=b.length?b[0]:null;this.fm=c||null}z(G2,M);function N5b(){N.call(this);this.B=new Lg}z(N5b,N);r=N5b.prototype;r.gL=null;r.VM=null;r.Tt=null;r.Jv=!1;r.nT=!1;function J5b(a,b,c){I2(a);a.Tt=b;a.VM=c;a.dispatchEvent(new G2("ff",[b],c))}r.Lt=g("Jv");function K5b(a){a.Jv||a.Tt||I2(a);a.dispatchEvent("nf")}r.reset=function(){I2(this);this.dispatchEvent("lf")};function I2(a){a.gL=null;a.B.clear();a.VM=null;a.Tt=null;a.Jv=!1;a.nT=!1}r.V=function(){delete this.gL;delete this.B;delete this.VM;delete this.Tt;N5b.O.V.call(this)};function O5b(a,b,c,d,e,f,h,k){hF.call(this,a,b,c,d,e,f,h,2,0,k)}z(O5b,hF);O5b.prototype.Y=function(a){return mUa(this,a,"range-border cell-border waffle-docos-target-cell-border")};function P5b(a,b,c,d,e,f,h){N.call(this);this.D=a;this.Na=b;this.F=c;this.Ya=d;this.J=e;this.B=f;this.P=b.Ya;this.C=b.B;this.K=b.M;this.M=B2.getInstance();this.$=h||Ll();this.H=new Lg;this.R=new Lg;this.Y=new Lg;this.U=new Lg;this.va=new P(this);Q5b(this);this.va.L(this.C,"ga",this.Ztb).L(this.B,"cf",this.DZa).L(this.B,"df",this.FZa).L(this.B,"bf",this.CZa).L(this.B,"ef",this.d1a).L(this.B,"ff",this.Wtb).L(this.B,"nf",this.Ytb).L(this.B,"lf",this.Xtb).L(this.B,"hf",this.z1a).L(this.B,"mf",this.M9a).L(this.B,
"af",this.b1a).L(this.B,"kf",this.e1a).L(this.B,"gf",this.f1a).L(this.B,"jf",this.j8a);R5b(this)}z(P5b,N);r=P5b.prototype;r.bv=null;r.w$="none";r.W1=500;r.iV=!1;r.f1a=function(){J2(this)};r.b1a=function(a){var b=a.F;b&&S5b(this,[b],!0);T5b(this,a.F)};r.e1a=function(a){var b=a.F;b&&U5b(this,[b]);T5b(this,a.F)};function T5b(a,b){var c=D2(a.C,a.K,b);if(c){var d=NB(a.P,c);Ufb(a.Ya,c.Ob(),r5b(d).length)}else V5b(a)}r.j8a=function(){J2(this);this.B.Lt()&&W5b(this)};r.FZa=function(){J2(this)};
r.CZa=function(a){if(a.F){var b=a.F;this.iV=!0;a=this.D;b=this.M.$b(b);a.B.highlightDoco(a.C.B[b]||0,void 0);this.iV=!1}else J2(this)};r.Ytb=function(){var a=this.B.Tt,b=this.H.isEmpty();this.B.Lt()?W5b(this):a?(X5b(this,[a]),b&&!this.H.isEmpty()&&(this.iV=!0,b=this.D,a=this.M.$b(a),b.B.highlightDoco(b.C.B[a]||0,void 0),this.iV=!1)):b||J2(this)};r.Xtb=function(){J2(this)};
function J2(a){a.H.clear();var b=a.D;b.B.flushDocoPositions(u5b(b,{}));b=a.D;b.B.highlightDoco(b.C.B[""]||0,void 0);Q(a.J,!1);L(a.bv);Y5b(a);Z5b(a);a.B.Lt()||$5b(a);a6b(a,a.B.Lt());R5b(a)}r.isEmpty=function(){return this.H.isEmpty()&&this.Y.isEmpty()&&this.R.isEmpty()&&this.U.isEmpty()};function R5b(a){var b=du(a.F);b&&(a.W1=kOa(b.C)/2,a.D.setOption(Docos.OptionName.MAX_DOCO_HEIGHT,a.W1))}function Z5b(a){kf(a.Y.Zc());a.Y.clear()}function Y5b(a){kf(a.R.Zc());a.R.clear()}
function $5b(a){A(a.U.Zc(),function(a){Cr(a,"waffle-docos-target-cell-header")});a.U.clear()}r.DZa=function(a){this.B.Tt||this.B.Lt()||(a=a.docos,a.length?X5b(this,a,!0):b6b(this,!1))};function X5b(a,b,c){x2(a.D)||U5b(a,Ng(a.H,b).Zc());S5b(a,b,c)}function W5b(a){var b=SB(a.C);b&&(b=NB(a.P,b),X5b(a,r5b(b),!0),c6b(a),d6b(a))}r.Wtb=function(a){e6b(this,a.F,a.fm)};
function e6b(a,b,c,d){var e=D2(a.C,a.K,b);if(e){var f=e.Ob();if(f6b(a,b)){var h=g6b(a,c),k=function(){h6b(this,c)&&!h.equals(Xx(e))?(by(e,h),e6b(this,b,c,d)):(Nx(e,c).Dk()&&yI(du(this.F)).setVisible(!1),i6b(this,c),X5b(this,[b],!0),Y5b(this),Z5b(this),$5b(this),j6b(this,c),a6b(this,this.B.Lt()),d&&Wj(function(){this.D.B.grabFocus()},0,this),this.dispatchEvent("$e"))};ml?zv(Gv(Pw(a.C,f)),v(e.eq,e,h)).addCallback(k,a):Bv(Gv(Pw(a.C,f)),v(e.eq,e,h),v(k,a),new P)}else XK(a.C,f,v(function(){this.D.B.grabFocus();
e6b(this,b,c,!0)},a))}else a.dispatchEvent("$e")}function i6b(a,b){var c=SB(a.C),d=du(a.F);if(!a.iV&&c&&d){var e=d.C,d=d.B,f=fB(e,"waffle",!1,!1),h=212;if(!e.Vb()){var k=Rl("docs-docos-activitybox");k&&In(k)&&(h+=f.right-Gn(k).left)}k=k6b(a,b);h=k.x-f.right+h;f=k.y-f.bottom+a.W1;if(!(0>=h&&0>=f)){d=d.B.ue();for(d=Sh(d.y,d.x,d.y,d.x);rOa(e,d).height<f;)d.height+=1;for(;rOa(e,d).width<h;)d.width+=1;e=d.height;d=d.width;cy(c,aGa(c,kx(c,Ux(c),d,e)))}}}
function h6b(a,b){var c=SB(a.C);return Dx(nv(c,"r"),b.y)&&Dx(nv(c,"c"),b.x)}function a6b(a,b){o5b(a.Ya,b)}function g6b(a,b){return gx(SB(a.C),b.y,b.x)||Th(b)}
r.d1a=function(a){if(!this.B.Lt()&&(Y5b(this),f6b(this,a.F)&&(b6b(this,!0),this.B.Tt!=a.F))){var b=this.M.$b(a.F),c=this.D;c.B.isDocoResolved(c.C.B[b]||0)?(b=a.fm,a=du(this.F),(c=SB(this.C))&&a&&b&&(b=gx(c,b.y,b.x)||Th(b),b=ZH(a,b,"waffle-docos-target-cell-resolved-rect"),eE($H(a),b,!0),b.setVisible(!0),this.R.add(b))):(c=a.fm,a=du(this.F),(b=SB(this.C))&&a&&c&&(c=gx(b,c.y,c.x)||Th(c),b=new O5b(b,a.M,a.R,a.J,a.C,a.B,new ZD(c),this.$),eE($H(a),b,!0),this.R.add(b),b.setVisible(!0)))}};
function l6b(a,b){b&&(Ar(b,"waffle-docos-target-cell-header"),a.U.add(b))}function j6b(a,b){var c=du(a.F),d=SB(a.C);d&&c&&b&&(d=gx(d,b.y,b.x)||Th(b),d=ZH(c,d,"waffle-docos-target-cell-rect"),eE($H(c),d,!0),a.Y.add(d),d.setVisible(!0),d.getElement()&&a.va.L(d.getElement(),["click","contextmenu","dblclick","mousedown","mouseup"],function(a){a.Fg=b;c.dispatchEvent(a)}))}function c6b(a){Z5b(a);var b={};A(a.H.Zc(),function(a){a=C2(this.K,a);var d=a.x+"-"+a.y;b[d]||(j6b(this,a),b[d]=!0)},a)}
function d6b(a){$5b(a);var b=SB(a.C),c=du(a.F);if(b&&c){var d=c.J,c=c.B,b=NB(a.P,b),e=c.xg("r"),f=c.wg("r"),h=c.xg("c"),k=c.wg("c");A(r5b(b),function(a){a=C2(this.K,a);a.x>=h&&a.x<=k&&l6b(this,ZOa(d,a.x));a.y>=e&&a.y<=f&&l6b(this,d.B.getElement(DB(d,"rh-",iy(d.D,a.y),null)))},a)}}r.M9a=function(){V5b(this)};function V5b(a){var b=ob(ec(a.P.B),Number);A(b,function(a){var b=F5b(this.C,a);b&&(b=NB(this.P,b),Ufb(this.Ya,a,r5b(b).length))},a)}
r.z1a=function(a){if(a.F){var b=this.M.$b(a.F),c=this.D;a=k6b(this,a.fm);a=u(a)?new Docos.Point(a.x,a.y):void 0;c.B.newDoco(b,a)}};
function S5b(a,b,c){for(var d={},e=[],f={},h=0;h<b.length;h++){var k=b[h],l=a.M.$b(k),m;m=a;var n=k;if(du(m.F)&&f6b(m,n)){var q=C2(m.K,n);m=m6b(m,g6b(m,q))?m.B.Lt()||m.B.Tt==n||vb(m.B.B.Zc(),n):!1}else m=!1;m?(m=C2(a.K,k),n=m=g6b(a,m),n=n.Rb()+"-"+n.wc()+"-"+n.Pb()+"-"+n.Fc()+"-"+n.B+"-"+n.qe,f[n]=f[n]||0,d[l]=k6b(a,m.ue(),f[n]),f[n]++,a.H.add(k)):e.push(k)}a.H.isEmpty()||b6b(a,!0);jc(d)||(b=a.D,b.B.updateDocoPositions(u5b(b,d)));x2(a.D)||U5b(a,e);if(c)for(c=a.H.Zc(),d=0;d<c.length;d++){e=a;b=c[d];
f=void 0;a:switch(f=b,f.cb()){case "range":break a;case "workbook-range":break a;default:throw Error("Invalid doco with type: "+f.cb());}f=C2(e.K,f);f=k6b(e,f);l=du(e.F);h=l.C;k=l.Sk;k=k.D(k.B()-1);m=ov(SB(e.C));l=l.B.wg("r");h=WA(h,new Fh(m,l),"r");h+=k;k=TA(SUb(du(e.F)),"c");f=h-(f.y-k);f<e.W1&&b&&(b=e.M.$b(b),e=e.D,e.B.setDocoMaxHeight(e.C.B[b]||0,125>f?125:f))}}
function U5b(a,b){var c=a.H.Qq(b).Zc();a.H.bc(c);c=ob(c,function(a){return this.M.$b(a)},a);c.length&&t5b(a.D,c);a.H.isEmpty()&&b6b(a,!1)}
function k6b(a,b,c){var d=du(a.F),e=SB(a.C),f=d.C,h=f.Vb(),k=g6b(a,b),l=gB(f,k),m=c?15*c:0;c=h?l.left-m:l.right+m;var k=l.top+m,n=a.B.Lt();a=Dh(a.B.VM,b);var q=Nx(e,b).Dk();n||a||!q?(b=k+125,0<b-kOa(f)&&(e=e.Go("r")-1,dB(f,b,"r","waffle")>=e&&(k-=50))):(a=yI(d),n=a.K,w0a(d,Qx(e,b).ue()),e=a.R.height?a.Ic:0,b=a.U.height,d=Math.min(TTa.height,e+b),b&&(d=d+30+12,d+=cF.top,d+=cF.bottom),e&&(d+=12,d+=cF.top,d+=cF.bottom),e=d,rD(a,n),k+=e);l=h?l.right+m+212:l.left-m-212;m=h?0>c-212:c+212>VA(f);e=h?l>VA(f):
0>l;m&&!e&&(c=l);return new O(h?ZA(f,c,"c"):c,k)}function f6b(a,b){var c=D2(a.C,a.K,b),d=SB(a.C);return!!c&&c==d}function m6b(a,b){if(!b)return!1;var c=TUb(du(a.F)),d=!1,e=b.ue();Uga(b,function(a,b){var k;if(k=a==e.y)k=null!=YF(c,new O(b,a));return k?d=!0:!1});return d}r.Ztb=function(){Q5b(this)};function Q5b(a){var b=du(a.F);b&&(a.$.appendChild(b.fP,a.J),a.D.setOption(Docos.OptionName.LAYOUT_RTL,b.C.Vb()),a.D.setOption(Docos.OptionName.ANCHOR_DIV,a.J),a.D.B.renderAnchorSurface())}
function b6b(a,b){var c,d=a.J.style;c="";"opacity"in d?c=d.opacity:"MozOpacity"in d?c=d.MozOpacity:"filter"in d&&(d=d.filter.match(/alpha\(opacity=([\d.]+)\)/))&&(c=String(d[1]/100));c=""==c?c:Number(c);c=sa(c)?1:c;In(a.J)||(c=0);d=b&&1>c?"in":!b&&0<c?"out":"none";"none"==d?(L(a.bv),Q(a.J,b)):a.bv&&1==a.bv.Ua&&a.w$==d||(L(a.bv),Q(a.J,!0),a.bv=new pE(a.J,c,"in"==d?1:0,250),a.w$=d,"out"==d&&Pf(a.bv,"finish",v(a.p2a,a)),a.bv.play())}r.p2a=function(){J2(this);var a=du(this.F);a&&lC(a)};
r.V=function(){delete this.F;delete this.J;delete this.M;delete this.D;delete this.H;delete this.B;delete this.P;delete this.$;delete this.w$;delete this.K;delete this.C;delete this.Na;L(this.bv);delete this.bv;Z5b(this);Y5b(this);$5b(this);L(this.va);delete this.va;P5b.O.V.call(this)};function n6b(a,b,c,d,e,f){J.call(this);this.M=a;this.R=u(b)?b:!0;this.P=u(c)?c:1;this.D=new av(v(this.FRa,this),d||1E3,e||6E4,f);K(this,this.D);this.H=new ej(void 0,this);this.B=null;this.J=[];this.F="DCS_Callback"+String(o6b++);this.K=this.C=null}z(n6b,J);var o6b=0;r=n6b.prototype;r.I9=function(){this.B=null;this.D.stop();this.H.Mb(this.J)};
r.asa=function(a){a instanceof fj||(a instanceof Cm&&3==a.code?this.I9():(this.B=null,this.J.push(a instanceof Error?a.message:""),0<this.P--?this.D.start():this.H.Kd(this.J)))};r.mfb=function(){this.D.Sb()||this.D.start();var a=new ej;jj(this.H,a);return a};
r.FRa=function(){if(this.R){this.C=new ME(this.M);this.C.gh=1E4;var a=v(this.I9,this);fa(this.F,a,void 0);this.K=this.C.send({callback:this.F},void 0,v(this.asa,this))}else this.B&&this.B.cancel(),this.B=BVb(this.M,"dcs_main_js",{timeout:1E4}),gj(this.B,this.I9,this.asa,this)};r.V=function(){this.B&&this.B.cancel();this.H.cancel();ea[this.F]&&(ea[this.F]=ha);this.C&&this.K&&this.C.cancel(this.K);n6b.O.V.call(this)};function p6b(){var a;a=""+('<div class="docs-docos-activitybox" role="dialog" aria-label="'+Gt("Comment stream box.")+'"><div class="docs-docos-activitybox-inner"></div></div>');return mt(a)};function K2(a,b){S.call(this,b);this.B=a}z(K2,S);r=K2.prototype;r.H9=null;r.UP=null;r.FQ=null;r.Rn=null;r.upa=!1;r.ob=function(){K2.O.ob.call(this);var a=this.Z(),b=Cs(p6b,{},{},a);this.qa=b;om(b,!0);this.UP=a.getElement("docs-docos-caret");this.H9=a.Xd("docs-docos-activitybox-inner",b);this.B&&(Ar(b,"docos-enable-new-header"),Ar(this.UP,"docos-enable-new-header"))};
r.$a=function(){this.FQ=new lu(this.getElement());this.FQ.fl("close-box",27);this.Rn=new Or(this.getElement(),"toggle_display");Pr(this.Rn,!0);var a=this.Rn;wva(a);a.Rca=!1;this.Rn.bta=!1;T(this).L(this.FQ,"shortcut",this.oab).L(this.Rn,"show",this.Vhb).L(this.Rn,"hide",this.Uhb).L(this.Rn,"beforeshow",this.Thb).L(this.Rn,"beforehide",this.Shb)};r.Nb=g("H9");r.Vhb=function(){Q(this.UP,!0);this.dispatchEvent("show")};r.Uhb=function(){Q(this.UP,!1)};r.Thb=function(){return this.dispatchEvent("beforeshow")};
r.Shb=function(){return this.upa?!1:this.dispatchEvent("hide")};r.setVisible=function(a){this.Rn.setVisible(a)};r.ib=function(){return!!this.Rn&&this.Rn.ib()};r.oab=function(a){switch(a.B){case "close-box":this.setVisible(!1)}};r.V=function(){L(this.FQ);delete this.FQ;delete this.UP;delete this.H9;L(this.Rn);delete this.Rn;K2.O.V.call(this)};function q6b(a,b,c,d){N.call(this);this.D=c||new Ml;this.B=a;this.M=!!b;this.C=new K2(this.B.isDocsStreamHeaderEnabled&&this.B.isDocsStreamHeaderEnabled(),this.D);this.X=new P(this);this.H=new BF(void 0,void 0,!0,QR.getInstance());this.F=d||W.nka;this.J=!1;this.K=Vf(Yf(),"docs-edll");this.B.onReady(v(this.$hb,this))}z(q6b,N);r=q6b.prototype;r.Oz=null;r.Bza=!1;r.render=ba();
r.$hb=function(){var a=this.D.getElement("docs-docos-commentsbutton");this.Oz=IZ(null);yB(this.Oz,16);this.Oz.rb(a);Vf(Yf(),"docosUnreadCommentsEnabled")&&(this.B.setListener(Docos.EventType.UNREAD_COMMENTS,this.yib,this),this.B.setOption(Docos.OptionName.ENABLE_UNREAD_COMMENTS,!0),W.pw.Pc(lo,this.vNa,this));GF(this.H,this.Oz,W.pw,HF);W.pw.Pc(lo,this.pmb,this);this.C.render(a.parentNode.parentNode);Q(this.C.getElement(),!1);W.pw.Ta(!0);this.B.setOption(Docos.OptionName.PANE_DIV,this.C.Nb());this.B.setOption(Docos.OptionName.PANE_KB_DIV,
this.C.getElement());this.B.setOption(Docos.OptionName.ENABLE_LAZY_LOADING,this.K);var b;this.K?(b=this.B.getLinkedDoco(),b=!!b&&(!this.B.hasDoco(b)||this.B.isDocoResolved(b)||!this.B.getDocoPosition(b))):b=!0;b?(this.B.renderPaneSurface(),this.J=!0):this.B.isLinkedDocoDeleted()&&(b=us("This comment has been deleted.","info",!0),ss.getInstance().postMessage(b));this.B.setListener(Docos.OptionName.DIALOG_OPENED,v(this.WCa,this));this.B.setListener(Docos.OptionName.DIALOG_CLOSED,v(this.WCa,this));this.B.setOption(Docos.OptionName.SORT_PANE,
!0);this.B.setOption(Docos.OptionName.STREAM_BUTTON,a);Docos.EventType.CREATE_DRAFT&&(this.B.setListener(Docos.EventType.CREATE_DRAFT,this.ZPa,this),this.F.Pc(jo,this.VCa,this),this.VCa(new gra("enabled",this.F.isEnabled(),!1)));this.M||this.B.setListener(Docos.EventType.NETWORK_ERROR,this.Ohb,this);this.X.L(this.C,["show","hide"],this.Cgb)};r.WCa=function(a){a=a.args.shouldOverrideHide()&&a.type==Docos.OptionName.DIALOG_OPENED;this.C.upa=a};
r.VCa=function(a){this.B.setOption(Docos.OptionName.ENABLE_COMMENT_BUTTON,a.newValue)};r.ZPa=function(a){this.C.setVisible(!1);var b=a.args.isInstantDoco()?W.qKa:this.F,c;if(a.args.isInstantDoco()){c=new no;var d=-1==a.args.getInstantDocoSpacerIndex();C(c,42,d?v5b.sMa:v5b.HOVER);c=ps(qs(new os,c),31).Ma()}b.mc(a.args,c)};r.pmb=function(){this.J||(this.B.renderPaneSurface(),this.J=!0);var a=this.C;a.Rn&&!xva(a.Rn)&&a.Rn.setVisible(!0)};
function r6b(a,b){if(0>b)throw Error("Number of unread comments cannot be negative");tB(a.Oz,"docs-docos-commentsbutton-unread",0<b);var c=a.D.getElement("docs-docos-commentsbutton");a.D.Ng(c,String(b))}r.yib=function(){var a=this.B.getUnreadCommentsCount();r6b(this,a)};r.vNa=function(){r6b(this,0);this.B.ackUnreadComments()};
r.Ohb=function(){if(!this.Bza&&W.ij.isEnabled()){if(this.B.hasPendingContent()){var a=us("Failed to post comment due to a network error.","warning",!0);ss.getInstance().postMessage(a)}this.B.setOption(Docos.OptionName.FATAL_READONLY,!0);this.B.setOption(Docos.OptionName.SHOW_ERRORS,!0);W.nka.Ta(!1,"docos-fatal-reason");this.Bza=!0}};r.Cgb=function(a){a="show"==a.type;this.B.isPaneSurfaceRendered()&&this.B.setOption(Docos.OptionName.SORT_PANE,!a);this.Oz.Ec(a);a?this.B.grabFocus():this.dispatchEvent("activity-box-closed")};
r.V=function(){L(this.Oz);delete this.Oz;L(this.X);delete this.X;L(this.C);delete this.C;L(this.H);delete this.H;delete this.B;q6b.O.V.call(this)};function s6b(){J.call(this)}z(s6b,Lm);r=s6b.prototype;r.RUa=function(){return n6b};r.nVa=function(){return q6b};r.kVa=function(){return G5b};r.lVa=function(){return N5b};r.mVa=function(){return P5b};Tm("docos",s6b);
