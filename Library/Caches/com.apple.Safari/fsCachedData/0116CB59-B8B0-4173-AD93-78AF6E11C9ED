window.onload=function(){if(a_fRC)initLogon();else redir()};function initLogon(){try{LogoffMime()}catch(e){}var re=/(^|; )logondata=acc=([0|1])&lgn=([^;]+)(;|$)/;var rg=re.exec(document.cookie);if(rg){gbid("username").value=rg[3];gbid("password").focus();gbid("rdoPrvt").click();if(rg[2]=="1"&&gbid("chkBsc"))gbid("chkBsc").click()}else{if(g_fFcs){try{gbid("username").focus()}catch(e){}}}if(IsOwaPremiumBrowser()&&gbid("chkBsc"))gbid("chkBsc").disabled=false;var sCN="cookieTest";document.cookie=sCN+"=1";var cookiesEnabled=document.cookie.indexOf(sCN+"=")!=-1;if(cookiesEnabled==false){shw(gbid("tblMid2"));hd(gbid("tblMid"))}}function redir(){var o=window;try{if(o.dialogArguments){var sWN=new String(Math.round(Math.random()*100000));var sF="toolbar=0,location=0,directories=0,status=1,menubar=0,scrollbars=1,resizable=1,width=800,height=600";var iT=Math.round((screen.availHeight-600)/2);var iL=Math.round((screen.availWidth-800)/2);sF+=",top="+iT+",left="+iL;var op=o.dialogArguments.opener;try{if(op)op.open(a_sCW,sWN,sF)}catch(e){}o.close();return}}catch(e){}var sUrl=a_sUrl;while(1){try{if(!(o.frameElement&&o.frameElement.ownerDocument))break;var oF=o.frameElement.ownerDocument.parentWindow||o.frameElement.ownerDocument.defaultView;if(!oF||(!oF.g_fOwa&&!oF.g_fEcp))break;o=oF;sUrl=o.GetReloadUrl?"&url="+encodeURIComponent(o.GetReloadUrl()):""}catch(e){break}}try{var oW=o.opener;if(oW&&(oW.g_fOwa||oW.g_fEcp)){var iX=Math.round((screen.availWidth-800)/2);var iY=Math.round((screen.availHeight-600)/2);o.moveTo(iX,iY);o.resizeTo(800,600);sUrl="&url="+encodeURIComponent(a_sCW)}}catch(e){}if(o.navigate)o.navigate(a_sLgn+sUrl);else o.location=a_sLgn+sUrl}function shw(o){o.style.display=""}function hd(o){o.style.display="none"}function clkExp(id){var o=gbid(id);if(o.tagName=="IMG")o=o.parentNode;switch(o){case gbid("lnkShwSec"):hd(gbid("lnkShwSec"));shw(gbid("lnkHdSec"));shw(gbid("trPubExp"));shw(gbid("trPrvtExp"));gbid("lnkHdSec").focus();break;case gbid("lnkHdSec"):shw(gbid("lnkShwSec"));hd(gbid("lnkHdSec"));hd(gbid("trPubExp"));hd(gbid("trPrvtExp"));gbid("lnkShwSec").focus();break}}function clkSec(){var c=gbid("rdoPrvt").checked;gbid("trPrvtWrn").style.display=c?"":"none";if(c){document.logonForm["flags"].value|=4}else{document.logonForm["flags"].value&=~4;var oD=new Date();oD.setTime(oD.getTime()-9999);document.cookie="logondata=; expires="+oD.toUTCString()}}function clkBsc(){var c=gbid("chkBsc").checked;gbid("trBscExp").style.display=c?"":"none";if(c)document.logonForm.flags.value|=1;else document.logonForm.flags.value&=~1}function clkLgn(){addPerfMarker("Logon.Start");if(gbid("rdoPrvt").checked){var oD=new Date();oD.setTime(oD.getTime()+2*7*24*60*60*1000);var sA="acc="+(gbid("chkBsc")&&gbid("chkBsc").checked?1:0);var sL="lgn="+gbid("username").value;document.cookie="logondata="+sA+"&"+sL+"; expires="+oD.toUTCString()}document.cookie="PBack=0; path=/"}function clkRtry(){window.location.reload()}function clkReLgn(){window.location.href='../'}function gbid(s){return document.getElementById(s)}function IsOwaPremiumBrowser(){var ua=navigator.userAgent;var av=navigator.appVersion;var mac=(av.indexOf('Mac')!=-1);var win=((av.indexOf('Win')!=-1)||(av.indexOf('NT')!=-1));var ie=(ua.indexOf("MSIE ")!=-1);var firefox=(ua.indexOf("Firefox/")!=-1&&ua.indexOf("Gecko/")!=-1&&Array.every);var safari=(ua.indexOf("Safari")!=-1&&ua.indexOf("WebKit")!=-1);var version=2.0;if(ie){version=parseFloat(ua.replace(/^.*MSIE /,''))}else if(firefox){version=parseFloat(ua.replace(/^.*Firefox\//,''))}else if(safari){version=parseFloat(ua.replace(/^.*Version\//,''))}else{version=parseInt(av)}if(win){if(ie)return(version>=7.0);else if(safari)return(version>=3.0);else if(firefox)return(version>=3.0)}else if(mac){if(safari)return(version>=2.0);else if(firefox)return(version>=3.0)}return false}function hres(iErr){return iErr+0xffffffff+1}function LogoffMime(){try{if((typeof(mimeLogoffE2k3)!="undefined"&&null!=mimeLogoffE2k3)&&IsMimeCtlInst("MimeBhvr.MimeCtlVer"))mimeLogoffE2k3.Logoff();if((typeof(mimeLogoffE2k7SP1)!="undefined"&&null!=mimeLogoffE2k7SP1)&&IsMimeCtlInst("OwaSMime.MimeCtlVer"))mimeLogoffE2k7SP1.Logoff();if((typeof(mimeLogoffE2k9)!="undefined"&&null!=mimeLogoffE2k9)&&IsMimeCtlInst("OwaSMime2.MimeCtlVer"))mimeLogoffE2k9.Logoff()}catch(e){}}function addPerfMarker(sItemName){try{if(window.msWriteProfilerMark){window.msWriteProfilerMark(sItemName)}}catch(e){}}