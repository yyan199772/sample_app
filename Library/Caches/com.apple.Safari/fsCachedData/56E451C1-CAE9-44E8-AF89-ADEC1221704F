function JJc(a,b,c){b=ub(a,b.equals,b);0<=b&&b!=c&&(b=Ab(a,b,1),Ab(a,c,0,b[0]))}function J$(a,b){I(a,1,b)}iFa.prototype.xx=MT(49,function(a){var b=G(this.C,1),c=!Vc(b,3)||!Vc(b,4),d=!Vc(b,1)||!Vc(b,2),e=d?0:ad(b,1),f=a?Lo(a):0,f=d?f:ad(b,2),h=c?0:ad(b,3);a=a?a.of():0;b=c?a:ad(b,4);return new Rh(e,h,f,b,c,d)});ue.prototype.UJ=MT(17,function(){return G(this,5)});iFa.prototype.UJ=MT(16,g("D"));qe.prototype.Dn=MT(15,function(){return ad(this,1)});se.prototype.Dn=MT(14,function(){return ad(this,1)});
ye.prototype.Dn=MT(13,function(){return ad(this,1)});Cd.prototype.getRelativityIndicatorsId=MT(7,function(){return G(this,5)});function KJc(a,b){var c=new Lg(b);a.B.Gg(function(a){a.Ec(c.contains(a.La()))})}function LJc(a,b){var c=jFa.Vc((new ue).oa(),b);return pFa(c,a.pn,a.B,a.Bs)}function MJc(a,b,c){function d(a){if(Vc(a,7)){var b=Math.min(e,c),d=Math.max(e,c);a=G(a,7);var l=G(a,1);l==e?J$(a,c):l>=b&&l<=d&&(e>c?J$(a,l+1):e<c&&J$(a,l-1))}}var e=lb(a.pq,b);JJc(a.pq,b,c);A(a.Vn,d);A(a.An,d)}
function NJc(a,b){function c(a){if(Vc(a,7)){var c=G(a,7),f=G(c,1);f==b?Yc(a,7):f>b&&J$(c,f-1)}}Db(a.pq,b);A(a.Vn,c);A(a.An,c)}function OJc(a){return a.pq}function PJc(a,b,c){null!=c?(zb(a.pq,b,c),b=function(a){if(Vc(a,7)){a=G(a,7);var b=G(a,1);b>=c&&J$(a,b+1)}},A(a.Vn,b),A(a.An,b)):a.pq.push(b)}
function QJc(a,b){var c=0,d=0,e=new Cd;b.qe||(c=b.Rb(),I(e,1,c),c=b.wc(),I(e,2,c),c=2);b.ke()||(d=b.Pb(),I(e,3,d),d=b.Fc(),I(e,4,d),d=2);c=ritz.getRelativityIndicatorsId(c,c,d,d,!0);I(e,5,c);I(e,6,""+a);c=new Bd;I(c,2,0);I(c,1,e);return c}function RJc(a,b){I(a,3,b)}function SJc(a){return ad(a,3)}function TJc(a,b){I(a,2,b)}function K$(a){return G(a,4)}function UJc(a,b){I(a,8,b)}function VJc(a){return ad(a,8)}function WJc(a,b){I(a,2,b)}function XJc(a,b){I(a,3,b)}function YJc(a){return $c(a,2)}
function ZJc(a){return G(a,2)}function $Jc(a,b){var c=/\d+|\.\d+|\D+/g;if(a==b)return 0;if(!a)return-1;if(!b)return 1;for(var d=a.toLowerCase().match(c),e=b.toLowerCase().match(c),f=Math.min(d.length,e.length),h=0;h<f;h++){var c=d[h],k=e[h];if(c!=k)return d=parseInt(c,10),!isNaN(d)&&(e=parseInt(k,10),!isNaN(e)&&d-e)?d-e:c<k?-1:1}return d.length!=e.length?d.length-e.length:a<b?-1:1}function aKc(){var a=new YC;a.tc=p("goog-menu waffle-pivot-add-field-menu");return a}
var bKc={tNa:"waffle-pivot-zippy-expanded",sNa:"waffle-pivot-zippy-collapsed"};function cKc(a,b,c){var d=b.Rb();b=b.Pb();a=a?a.jd(d,b+c).getDisplayValue():"";""==a&&(a="Column "+Ho(b+c));return a}function dKc(a,b,c){b=Array.prototype.splice.call(a,b,1);Array.prototype.splice.call(a,c,0,b[0])}function eKc(a,b){return $Jc(a,b)}function fKc(a,b){VB.call(this,1602,b);this.C=a}z(fKc,VB);fKc.prototype.$d=p(47);fKc.prototype.Wd=function(){var a=new Rp,b=qFa(this.C);I(a,1,b);return a};function L$(a,b){M.call(this,a,b)}z(L$,M);function gKc(a){a=a||{};a=""+Ft(UZ(zt(a,{title:Bt("Report Editor"),dg:Ct('<div id="waffle-pivot-pane"><div id="waffle-pivot-range-selection"><div class="input-selection-button goog-inline-block"></div><span class="waffle-pivot-label-text waffle-pivot-range-span" id="waffle-pivot-range-text"></span><span class="waffle-pivot-label-text waffle-pivot-range-span">&nbsp;-&nbsp;</span>'+Ft(Mt({Zd:"goog-inline-block waffle-pivot-label-button",content:Ct("Edit range..."),id:"waffle-pivot-range-selection-button",
style:4}))+'</div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+hKc({qx:Bt("Rows"),id:"waffle-pivot-add-field-row"})+'</div><div id="waffle-pivot-row-label" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+hKc({qx:Bt("Columns"),id:"waffle-pivot-add-field-column"})+'</div><div id="waffle-pivot-column-label" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+
hKc({qx:Bt("Values"),id:"waffle-pivot-add-field-value"})+'<div id="waffle-pivot-aggr"><span id="waffle-pivot-aggr-label" class="waffle-pivot-label-text">as:&nbsp;</span><div id="waffle-pivot-aggr-select"></div></div></div><div id="waffle-pivot-values" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+hKc({qx:Bt("Filter"),id:"waffle-pivot-add-field-filter"})+'</div><div id="waffle-pivot-filter" class="waffle-pivot-drop-target"></div></div><div id="waffle-pivot-button-container"><label><input type="radio" name="autoupdate" value="autoupdate" checked id="waffle-pivot-update-auto" />Update table on each change</label><br /><label><input type="radio" name="autoupdate" value="manual" id="waffle-pivot-update-manual"/>Manually</label><button id="waffle-pivot-button-update" disabled="true">Update table</button><br /></div></div>')})));
return mt(a)}function hKc(a){var b;b=""+('<strong id="'+Z(a.id)+'-field-label">'+Y(a.qx)+'</strong><span class="waffle-pivot-label-text">&nbsp;-&nbsp;</span>');var c;c=Bt("Add field");b+=Ft(Mt({Zd:"goog-inline-block waffle-pivot-label-button",content:c,attributes:Dt('aria-label="'+Z(a.qx)+" "+Z(c)+'"'),id:a.id,style:4}));return mt(b)}
function iKc(a){return mt('<div class="waffle-pivot-pill" role="group" tabindex="0"><table class="waffle-pivot-pill-main-table" role="presentation"><tbody><tr><td class="waffle-pivot-pill-main-table-text"><strong>'+Y(a.Zqa)+'&nbsp;</strong><span class="waffle-pivot-pill-title"></span></td><td class="waffle-pivot-pill-main-table-fill"><div class="waffle-pivot-pill-draghandle"></div></td><td class="waffle-pivot-pill-close waffle-pivot-pill-nodrag"></td></tr></tbody></table></div>')};function M$(a,b,c,d,e,f){S.call(this,f);this.M=a;this.Y=c;this.R=d;this.P=e;this.Uf(b)}z(M$,S);r=M$.prototype;r.ob=function(){this.qa=Cs(iKc,{Zqa:this.M})};r.$a=function(){M$.O.$a.call(this);var a=this.Z(),b=T(this);this.J=vm(a,"span","waffle-pivot-pill-title",this.getElement())[0];var c;c=new TD("\u2715",a,4);c.render(vm(a,"td","waffle-pivot-pill-close",this.getElement())[0]);xr(c.getElement(),"Close edit field and remove from pivot table");K(this,c);b.L(c,"action",this.Wrb)};
r.Px=function(){var a=new L$("pivot-pill-changed",this);a.B=this;this.dispatchEvent(a)};function N$(a,b){a.J&&(a.Z().Ng(a.J,b),xr(a.getElement(),"Edit field: "+(a.M+(" "+(b+".")))),a.J.title=b)}function jKc(a){return a.Z().tK(a.J)}function O$(a,b){return cKc(a.Bc(),a.P,b)}function P$(a,b,c){a=a.Z();return a.Ja("span",c,a.createTextNode(b+"\u00a0"))}function Q$(a){return a.Z().Ja("div","waffle-pivot-pill-nodrag")}
r.vI=function(a){var b=this.Z(),c=b.Ja("div","waffle-pivot-pill-section",arguments);1<fm(this.getElement()).length&&Ar(c,"waffle-pivot-pill-section-top-border");b.appendChild(this.getElement(),c)};r.Rw=function(a){T(this).L(a.getElement(),"mouseover",this.V0).L(a.getElement(),"mouseout",this.V0)};r.V0=function(a){a=a.target;var b=!zr(a,"waffle-pivot-select-hover");Er(a,"waffle-pivot-select-hover",b)};r.xx=g("P");r.Bc=function(){var a=Pw(this.Y.B,this.R);return a?a.Bc():null};
r.Wrb=function(){var a=new L$("pivot-remove-pill",this);a.B=this;this.dispatchEvent(a)};r.Upa=p(!0);r.MFa=ha;function R$(){}z(R$,eD);ja(R$);R$.prototype.tc=p("waffle-pivot-select");R$.prototype.gJ=function(a){return a.Ja("div","goog-inline-block "+(this.tc()+"-dropdown"),"\u00a0\u25be")};function S$(a,b,c,d,e){M$.call(this,"Filter:",a,b,c,d,e);this.B=new kD("",null,R$.getInstance(),e);K(this,this.B)}z(S$,M$);r=S$.prototype;r.$a=function(){S$.O.$a.call(this);this.bb();N$(this,O$(this,kKc(this)));var a=P$(this,"Show:"),b=Q$(this);this.B.rb(b);this.B.Hv=!0;this.B.AK("Loading...");xr(this.B.qa,"Show:");var c=new T$;K(this,c);this.B.Pf(c);this.Rw(this.B);this.vI(a,b)};r.Uf=function(a){S$.O.Uf.call(this,a);N$(this,O$(this,kKc(this)))};function kKc(a){return a.bb().kh()-a.xx().Pb()}
function U$(a){return a.B.hc().B}r.Rw=function(a){S$.O.Rw.call(this,a);T(this).L(U$(this),"filters_selected",this.A2a).L(U$(this),"filtering_cancelled",this.B2a)};function lKc(a,b,c){var d=[];if(!c)return d;a=b.Pb()+a;var e=$h(b,"r");for(b=b.Rb()+1;b<e.end;b++){var f=c.jd(b,a);Rb(d,f.getDisplayValue(),eKc)}return d}function mKc(a){var b=U$(a),c=YJc(ZJc(a.bb())),d=new Lg(c),e=pb(b.getFilterChoices(),function(a,b){return d.contains(b)?a-1:a},b.getFilterChoices().length);KJc(b,c);nKc(a,e)}
function nKc(a,b){var c=U$(a);0==b?a.B.AK("All items"):(c=c.getFilterChoices().length-b,a.B.AK(null!=c?""+c+" items":"All items"))}r.A2a=function(a){this.B.le(!1);nKc(this,a.gb.length);this.Px()};r.B2a=function(){this.B.le(!1);var a=this.B.qa;try{tf&&this.Z().Eb().body.focus(),a.focus()}catch(b){}mKc(this)};function T$(a){$C.call(this,a);this.B=new EZ([],!1,null,a)}z(T$,$C);T$.prototype.$a=function(){T$.O.$a.call(this);this.B.render(this.Nb());var a=new tD(this.B.qa,this.Z());uD(a);K(this,a)};
T$.prototype.XR=function(a){im(a.target)&&this.B.yk(a.target)||T$.O.XR.call(this,a)};function V$(a,b,c,d,e,f){M$.call(this,"Group by:",a,b,c,d,f);this.U=e}z(V$,M$);r=V$.prototype;
r.$a=function(){V$.O.$a.call(this);var a=this.bb();N$(this,O$(this,a.Dn()));var b=this.Z(),a=P$(this,"Order:"),c=Q$(this),d=new $C;d.fb(new VC(b.Yi("Ascending"),0),!0);d.fb(new VC(b.Yi("Descending"),1),!0);b=this.D=new kD("",d,R$.getInstance(),b);b.rb(c);b.jb(VJc(this.bb()));xr(b.getElement(),"Order:");this.Rw(b);this.vI(a,c);var b=this.Z(),c=P$(this,"Sort by:"),a=Q$(this),d=new $C,e=O$(this,this.bb().Dn());d.fb(new VC(e,-1),!0);d=this.K=new kD("",d,R$.getInstance(),b);d.rb(a);xr(d.getElement(),"Sort by:");
T(this).L(d.getElement(),"mouseover",this.V0).L(d.getElement(),"mouseout",this.V0).L(d,"action",this.vUa);b=v(b.Ja,b,"div",["goog-inline-block","waffle-pivot-pill-sort-by"]);c=b(c);this.H=b(a);this.vI(c,this.H);a=this.bb();a=ad(a,2);c=P$(this,"Show totals","waffle-pivot-pill-align-middle waffle-pivot-pill-nodrag");b=Q$(this);Ar(b,"goog-inline-block");this.C=new cR;aR(this.C,c);this.C.Ec(a);this.C.render(b);T(this).L(this.C,"change",this.Px);this.vI(b,c)};
r.Uf=function(a){V$.O.Uf.call(this,a);N$(this,O$(this,a.Dn()));this.C&&this.C.Ec(ad(a,2));this.D&&this.D.jb(VJc(a));oKc(this)};r.ke=g("U");r.vUa=function(a){a=new L$("pivot-sort-by-change",a.currentTarget);a.B=this;this.dispatchEvent(a)};r.wUa=function(a){a=new L$("pivot-sort-key-change",a.currentTarget);a.B=this;this.dispatchEvent(a)};function pKc(a){var b=[];if(a.B)for(var c=a.B.Hc(),d=0;d<c;d++)0<=a.B.Lc(d).La()&&b.push(a.B.Lc(d).jk());return b}
function qKc(a){if(!a.B){var b=a.Z(),c=Q$(a);Ar(c,"waffle-pivot-multi-select");a.B=new KC("horizontal",null,b);a.B.rb(c);b.appendChild(a.H,c)}}function oKc(a){if(a.B)for(L(a.B),a.B=null;1<a.H.children.length;)dm(a.H.lastElementChild)}r.Rw=function(a){V$.O.Rw.call(this,a);T(this).L(a,"hide",this.Px)};r.V=function(){V$.O.V.call(this);L(this.D);L(this.K);L(this.B);L(this.C);this.H=null};function rKc(){N.call(this);this.C="";this.B=!1}z(rKc,N);rKc.prototype.La=g("C");rKc.prototype.jb=function(a){this.C=a;this.B=!0;this.dispatchEvent("change")};function W$(a,b,c,d,e){M$.call(this,"Display:",a,b,c,d,e);this.D=this.H=this.B=null;this.C=0}z(W$,M$);var sKc="SUM COUNTA COUNT COUNTUNIQUE AVERAGE MAX MIN MEDIAN PRODUCT STDEV STDEVP VAR VARP".split(" "),tKc=["SUM"];r=W$.prototype;r.$a=function(){W$.O.$a.call(this);N$(this,uKc(this));vKc(this)};
function vKc(a){var b=a.bb();if(1==K$(b)){var c=new $C;A(sKc,function(a){c.fb(new VC(a),!0)});a.B=wKc(a,c,G(b,5).mA())}else{var d=G(b,6);a.D=xKc(a,"Name",ad(b,3));a.H=xKc(a,"Formula",SJc(d)||"=");c=new $C;A(tKc,function(a){c.fb(new VC(a),!0)});c.fb(new VC("Custom","CUSTOM"),!0);ad(d,4);a.B=wKc(a,c,yKc(a));T(a).L(a.B,"hide",v(a.qZa,a))}}
function wKc(a,b,c){var d=a.Z(),e=P$(a,"Summarize by:"),f=Q$(a);b=new kD("",b,R$.getInstance(),d);K(a,b);b.rb(f);b.jb(c);xr(b.qa,"Summarize by:");a.Rw(b);a.vI(e,f);return b}function xKc(a,b,c){var d=a.Z(),e=P$(a,b),f=Q$(a);b=new AU(b,d);K(a,b);b.render(f);b.jb(c);a.vI(e,f);c=new CD(b.qa);K(a,c);e=new Nr(b.qa);K(a,e);T(a).L(c,"input",a.Q4a).L(e,"focusout",a.P4a);return b}r.La=function(){return this.H?this.H.La():this.B.La()};function zKc(a){a=a.B.La();return"CUSTOM"==a?null:a}
r.Rw=function(a){W$.O.Rw.call(this,a);T(this).L(a,"hide",this.Px)};r.qZa=function(){X.zma.mc()};r.Uf=function(a){var b=K$(a);null!=this.bb()&&K$(this.bb());W$.O.Uf.call(this,a);N$(this,uKc(this));1==b?null!=this.B&&this.B.jb(G(a,5).mA()):null!=this.D&&null!=this.H&&(Vc(a,3)&&this.D.jb(ad(a,3)),this.H.jb(SJc(G(a,6))||"="),this.B.jb(yKc(this)))};function uKc(a){var b=a.bb();return Vc(b,3)&&ad(b,3)?ad(b,3):1==K$(b)?O$(a,G(b,5).Dn()):"Calculated Field"}
r.Q4a=function(){this.C&&(clearTimeout(this.C),this.C=0);this.C=setTimeout(v(function(){this.Px();this.C=0},this),3E3)};r.P4a=function(){this.C&&(clearTimeout(this.C),this.C=0);this.Px()};function yKc(a){a=a.bb();a=G(a,6);a=G(a,4);return null!=a?a:"CUSTOM"}r.Upa=function(){return 1==K$(this.bb())};r.V=function(){W$.O.V.call(this);L(this.B)};r.MFa=function(){2==K$(this.bb())&&this.D.getElement().focus()};function X$(a,b,c,d,e){PZ.call(this,e);a=this.Z();var f=AKc,h=BKc;this.zb=b;this.Qb=c;this.D=d;this.C={};this.J=!0;this.Ab=null;this.U=new rKc;this.gb=new P(this);this.qb=new SZ;this.$=[];this.sb=this.H=null;this.vb=new VC("No fields left to add",void 0,e);this.vb.Ta(!1);this.K=this.M=null;this.Na=tc(f.mJa,h.EX,f.kJa,h.iO,f.lJa,h.xna,f.jJa,h.Tja);this.P=this.Y=null;b=new $C(a);b.fb(new VC("Columns",2,a),!0);b.fb(new VC("Rows",1,a),!0);this.R=new kD("",b,R$.getInstance(),a)}z(X$,PZ);
var AKc={EX:"waffle-pivot-values",iO:"waffle-pivot-filter",RJa:"waffle-pivot-column-label",pMa:"waffle-pivot-row-label",mJa:"waffle-pivot-add-field-value",kJa:"waffle-pivot-add-field-filter",lJa:"waffle-pivot-add-field-row",jJa:"waffle-pivot-add-field-column",oJa:"waffle-pivot-aggr-select",pJa:"waffle-pivot-aggr",dxb:"waffle-pivot-apply",FJa:"waffle-pivot-button-container",jQb:"waffle-pivot-range-selection",kQb:"waffle-pivot-range-selection-button",lQb:"waffle-pivot-range-text",voa:"waffle-pivot-button-update",
hNa:"waffle-pivot-update-auto",iNa:"waffle-pivot-update-manual"},BKc={xna:"row-breakout",Tja:"col-breakout",iO:"filter",EX:"aggregation"};r=X$.prototype;r.ob=function(){this.qa=Cs(gKc,{id:this.getId()})};
r.$a=function(){function a(a,b){f.L(Pl(a),"click",b)}X$.O.$a.call(this);var b=this.Z(),c=AKc;Q(b.getElement(c.FJa),!1);var d=BKc;this.K=tc(d.EX,b.getElement(c.EX),d.iO,b.getElement(c.iO),d.xna,b.getElement(c.pMa),d.Tja,b.getElement(c.RJa));this.Ab=b.getElement(c.voa);var d=oB(FD,""),e=aKc(),f=T(this),h;for(h in this.Na){var k=new fD("",new $C(b,e),d,b);K(this,k);k.rb(b.getElement(h));f.L(k,"show",this.iYa).L(k.hc(),"action",this.hYa)}a(c.voa,this.Ybb);a(c.hNa,this.mxa);a(c.iNa,this.mxa);this.P=b.getElement(c.pJa);
Q(this.P,!1);this.R.rb(b.getElement(c.oJa));f.L(this.R,"action",this.zYa);this.sb=new Nr(this.Nb());f.L(this.sb,"focusin",this.isb).L(this.sb,"focusout",this.jsb);CKc(this)};r.isb=function(a){this.H=DKc(this,a.target)};r.jsb=function(a){if(a=a.relatedTarget){var b=this.Nb();sm(a,function(a){return a==b})||(this.H=null)}};
function DKc(a,b){if(!b)return null;var c=a.Z().OUa(b,"waffle-pivot-pill");if(!c)return null;var d=null,e=null;ac(a.C,function(a,b){return(d=sb(a,function(a){return a.getElement()==c}))?(e=b,!0):!1});return d?{container:e,label:jKc(d)}:null}
function EKc(a){var b=a.Z();if(a.H){var c=a.H.container,d=a.C[c];if(d&&a.H.label)for(var e=0,f;f=d[e];e++)if(jKc(f)==a.H.label){FKc(a,f.getElement());return}d&&0<d.length?FKc(a,d[d.length-1].getElement()):(d=ic(a.Na,function(a){return a==c}),FKc(a,b.getElement(d)))}}
r.Uf=function(a){X$.O.Uf.call(this,a);a?(GKc(this,function(){function b(a,b){if(a)for(;a.length>b;)L(a.pop())}function c(b,c,d){var k="row-breakout"==b;this.C[b]&&this.C[b][d]?(d=this.C[b][d],d.Uf(c),b=new L$("pivot-pill-model-updated"),b.B=d,this.dispatchEvent(b)):(d=new V$(c,this.D,a.pn,Y$(this),k,this.Z()),d.render(),HKc(this,d,b))}var d=a.Bs,d=ritz.renderPivotTableCalculatedFieldFormulas(a.naa(),d);a=LJc(a,d);A(a.bt,function(b,c){if(this.C.filter&&this.C.filter[c]){var d=this.C.filter[c];d.Uf(b)}else d=
new S$(b,this.D,a.pn,Y$(this),this.Z()),d.render(),HKc(this,d,"filter")},this);A(a.Vn,za(c,"row-breakout"),this);A(a.An,za(c,"col-breakout"),this);A(a.pq,function(b,c){var d=null;this.C.aggregation&&this.C.aggregation[c]&&(d=this.C.aggregation[c]);if(d&&d.bb()&&K$(d.bb())==K$(b))d.Uf(b);else{var k=new W$(b,this.D,a.pn,Y$(this),this.Z());k.render();d?IKc(this,d,k,"aggregation"):HKc(this,k,"aggregation")}},this);b(this.C["row-breakout"],a.Vn.length);b(this.C["col-breakout"],a.An.length);b(this.C.filter,
a.bt.length);b(this.C.aggregation,a.pq.length);d=(d=(d=Pw(this.D.B,a.pn))?d.B:null)?Qo(a.xx(JKc(this)),d):"#REF!";KKc(this,d);this.U.jb(d);(d=this.C.aggregation)&&2<=d.length?(Q(this.P,!0),this.R.jb(a.UJ())):Q(this.P,!1)}),X$.O.Uf.call(this,a),LKc(this,function(){var a=this.C.filter;a&&A(a,function(a){var b=U$(a),e;e=lKc(kKc(a),a.xx(),a.Bc());jVb(b,e);mKc(a)},this)})):this.reset()};r.focus=function(){X$.O.focus.call(this);FKc(this,Rl("waffle-sidebar-title",this.getElement()))};
function HKc(a,b,c){a.K[c].appendChild(b.getElement());a.C[c]||(a.C[c]=[]);a.C[c].push(b);b.Uc(a);MKc(a,b);CKc(a)}function IKc(a,b,c,d){a.Z().wM(c.getElement(),b.getElement());d=a.C[d];var e=lb(d,b);Ab(d,e,1,c);L(b);c.Uc(a);MKc(a,c);CKc(a)}function MKc(a,b){T(a).L(b,"pivot-remove-pill",a.lsb).L(b,"pivot-pill-changed",a.ksb).L(b.getElement(),"keydown",a.G4a);var c=new L$("pivot-pill-created");c.B=b;a.dispatchEvent(c)}
function CKc(a){a.gb.bc();L(a.qb);var b=a.qb=new SZ;Yb(a.K,function(a){IVb(b,a)});b.Qe();a.gb.L(b,"beforedragstart",a.esb).L(b,"dragstart",a.gsb).L(b,"dragend",a.fsb)}r.reset=function(){Yb(this.C,function(a){A(a,L)});this.C={}};function KKc(a,b){var c=a.Z();c.Ng(c.getElement("waffle-pivot-range-text"),b)}
r.lsb=function(a){var b=new L$("pivot-pill-removed",this);b.B=a.target;b.container=ic(this.C,function(b){return vb(b,a.target)});b.M=NKc(this,b.container,a.target);b.container&&(Cb(this.C[b.container],a.target),this.H={container:b.container,label:null},this.dispatchEvent(b))};r.ksb=function(a){a.container=ic(this.C,function(b){return vb(b,a.target)})};r.G4a=function(a){!a.shiftKey||38!=a.keyCode&&40!=a.keyCode||OKc(this,a.target,38==a.keyCode)};
function OKc(a,b,c){var d=null,e=-1;ac(a.K,function(a,c){e=lb(a.childNodes,b);return 0<=e?(d=c,!0):!1});var f=a.C[d];if(!(!f||1>=f.length||(c=c?e-1:e+1,0>c||c>f.length-1))){dKc(f,e,c);var h=new L$("pivot-pill-changed",a);h.B=f[c];h.container=d;h.D=d;h.position=c;h.hb=!0;a.dispatchEvent(h)}}r.Ybb=function(){this.dispatchEvent("pivot-table-update")};r.mxa=function(a){a=this.J="autoupdate"==a.target.value;(this.Ab.disabled=a)&&this.dispatchEvent("pivot-table-update")};r.zYa=function(){this.dispatchEvent("pivot-aggregation-orientation-changed")};
r.UJ=function(){return this.R.La()};function PKc(a,b,c,d){Rf(a.M);WUb(a.zb,a.U,a.U.La(),!1,!1,!0,v(a.Umb,a,b,c,!!d))}r.Umb=function(a,b,c,d){var e=this.U,f=this.D;e.B=!1;var h=e.La();this.M=Pf(d,"afterhide",function(){if(e.B){var d=Oo(e.La(),f.B,!0,!0);d?a(d):(e.jb(h),b())}else b();c||FKc(this,Pl("waffle-pivot-range-selection-button"))},!1,this)};
r.iYa=function(a){var b=a.target.getParent(),c=b.hc();this.Y=this.Na[b.qa.id];GKc(this,function(){var a=this.Y,e=JKc(this),f=Y$(this),h=QKc(this,a);c.Qd(!0);for(var k=$h(f,"c"),l=0,m=k.start;m<k.end;m++){var n=cKc(e,f,l);n&&!h[n]&&c.fb(new VC(n,l),!0);l++}"aggregation"==a&&(c.fb(new ZC,!0),c.fb(new VC("Calculated Field",-1),!0));0==c.Hc()&&c.fb(this.vb,!0);ST(b,!0);b.yy();ST(b,!1)})};function FKc(a,b){try{tf&&a.Z().Eb().body.focus(),b.focus(),a.Qb.Ac(2)}catch(c){}}
r.hYa=function(a){var b=this.Y;a=a.target.La();var c=new L$("pivot-pill-added",this);c.container=b;c.J=a;this.H={container:b,label:null};this.dispatchEvent(c)};r.esb=function(a){for(var b=a.event.target||a.event.B.target;b instanceof Element&&!zr(b,"waffle-pivot-pill");b=b.parentNode)if(zr(b,"waffle-pivot-pill-nodrag")){a.preventDefault();break}};r.gsb=function(a){var b=Mn(a.B).width;Cn(a.J,b)};
r.fsb=function(a){var b,c,d,e,f=new L$("pivot-pill-changed",this);ac(this.K,function(c,d){e=lb(c.childNodes,a.B);return 0<=e?(b=d,!0):!1});ac(this.C,function(b,e){var l=sb(b,function(b){return b.getElement()==a.B}),m=lb(b,l);return l?(c=e,f.B=d=l,f.va=m,!0):!1});this.C[b]||(this.C[b]=[]);Cb(this.C[c],d);zb(this.C[b],d,e);f.container=b;f.D=c;f.position=e;this.dispatchEvent(f)};
function QKc(a,b){function c(a){a=h(a.hA()-k);f[a]=!0}function d(a){a=h(a.Dn());f[a]=!0}var e=a.bb(),f={},h=v(cKc,a,JKc(a),Y$(a)),k=Y$(a).Pb();if(e)switch(b){case "filter":A(e.bt,c);break;case "row-breakout":case "col-breakout":A(e.Vn,d),A(e.An,d)}return f}function GKc(a,b){var c=RKc(a);if(c){var d=Y$(a),d=new Rh(d.Rb(),d.Pb(),d.Rb()+1,d.Fc());ml?SKc(a,d,b):Av(c.C,d,v(b,a),T(a))}else b.call(a)}function LKc(a,b){var c=RKc(a);c?ml?SKc(a,Y$(a),b):Av(c.C,Y$(a),v(b,a),T(a)):b.call(a)}
function SKc(a,b,c){b=yv(Gv(RKc(a)),b).addCallback(c,a);a.$.push(b);ij(b,za(Cb,a.$,b))}function RKc(a){var b=a.bb();return Pw(a.D.B,b.pn)}function JKc(a){return(a=RKc(a))?a.Bc():null}function Y$(a){return a.bb().xx(JKc(a))}function NKc(a,b,c){return ub(a.C[b],function(a){return c.getElement()==a.getElement()})}r.V=function(){X$.O.V.call(this);Yb(this.C,function(a){kf(a)});this.C={};Rf(this.M);this.M=null;L(this.qb);L(this.gb);A(this.$,EC)};function TKc(a,b){J.call(this);this.B=a;this.F=b;this.C=new P(this);K(this,this.C);this.C.L(a,"pivot-pill-created",this.D).L(a,"pivot-pill-model-updated",this.D)}z(TKc,J);TKc.prototype.H=function(a){var b=a.B;a=a.target.La();oKc(b);-1==a?b.Px():0<UKc(this,b).length&&!b.B?(qKc(b),b.B.getElement().focus(),VKc(this,b,-2,!0)):b.Px()};
TKc.prototype.J=function(a){var b=a.B;a=a.target;var c=bo(b.B,a),d=b.Z();for(c++;c<b.B.Hc();){var e=b.B.Lc(c),f=d.waa(e.getElement());zr(f,"waffle-pivot-select-divider")&&d.removeNode(f);b.B.removeChild(e,!0)}(0>a.La()||!VKc(this,b,-2,!0))&&b.Px()};function WKc(a,b){a.C.L(b,"pivot-sort-by-change",a.H).L(b,"pivot-sort-key-change",a.J)}
TKc.prototype.D=function(a){var b=a.B;if(b instanceof V$){a=b.bb();for(var c=0<UKc(this,b).length,d=OJc(this.B.bb()),e=b.K,f=e.Tj()-1;1<=f;f--)e.oF(f);e.Ge(0).AK(O$(b,a.Dn()));e.Bf(0);A(d,function(a,d){var f;if(Vc(a,3))f=G(a,3);else if(1==K$(a)){f=G(a,5).getFunctionName();var m=O$(b,G(a,5).Dn());f=c?f+(" of "+(m+" in...")):f+(" of "+m)}else f=SJc(G(a,6));e.gf(new VC(f,d))});Vc(a,7)&&(d=G(a,7),a=$c(d,2),XKc(this,b,a)&&(d=G(d,1),e.jb(d),c&&(qKc(b),A(a,v(function(a){VKc(this,b,a,!1)},this)),VKc(this,
b,-1,!1))));WKc(this,b)}};
function VKc(a,b,c,d){var e=YKc(a,b);if(0==e.length)return!1;var f=b.B.Hc();a=UKc(a,b);if(f>=a.length)return!1;var h=O$(b,a[f].Dn()),f=b.Z();a=b.B.Hc();var k=new $C,l=new VC(h,-2);l.Ta(!1);k.fb(l,!0);k.fb(new VC(0==a?"Grand Total":"Total",-1),!0);for(l=0;l<e.length;l++)k.fb(new VC(e[l],l),!0);h=new kD(h,k,R$.getInstance(),f);h.jb(-2);b.B.fb(h,!0);0<a&&(a=f.Ja("div",["goog-inline-block","waffle-pivot-select-divider"],":"),f.UF(a,h.getElement()));T(b).L(h,"action",b.wUa);f=c;"string"==typeof c&&(f=
lb(e,c),-1==f&&(f=-2));h.jb(f);d&&(b.B.fg(h),h.le(!0));return!0}function YKc(a,b){var c=ZKc(a,b),d=pKc(b),e=d.length,f=[];A(c,function(a){a.length==e+1&&rb(d,function(b,c){return a[c]==b})&&Rb(f,a[e])});return f}function XKc(a,b,c){a=ZKc(a,b);return 0==c.length||qb(a,function(a){return Qb(c,a)})}function UKc(a,b){return b.ke()?a.B.bb().An:a.B.bb().Vn}function ZKc(a,b){return b.ke()?kFa(a.B.bb(),a.F):lFa(a.B.bb(),a.F)};function $Kc(a,b){sq.call(this,1601,b,Th(a.B));this.C=a}z($Kc,sq);$Kc.prototype.exec=ba();$Kc.prototype.$d=p(48);$Kc.prototype.Wd=function(){var a=new Sp,b=qFa(this.C);I(a,2,b);var b=this.C.B,c=new gd;I(c,1,""+this.C.Bs);c.aw(b.y);I(c,3,b.x);I(a,1,c);return a};function aLc(a,b,c,d,e){QZ.call(this,a,c);this.F=this.K=null;this.B=a;this.C=b;this.R=d;this.P=e;this.U=new TKc(this.B,this.C);K(this,this.U);b=b.B;c=a.Z();this.X.L(a,"pivot-table-update",this.bcb).L(a,"pivot-pill-added",this.h8a).L(a,"pivot-pill-removed",this.Yrb).L(a,"pivot-pill-changed",this.Xrb).L(a,"pivot-aggregation-orientation-changed",this.yYa).L(Vm,"show-pivot-ritz",this.$rb).L(e,"activeCellChange",this.Iia).L(e,"click",this.asb,!0).L(e,"pivot_table_zippy_toggle",this.Xcb).L(b,"ga",this.Iia).L(b,
"ja",this.U$a).L(c.getElement("waffle-pivot-range-selection-button"),"click",this.D8a).L(c.getElement("waffle-pivot-range-selection-button"),"keypress",this.E8a);a=["jb"];a.push("xa");this.X.L(ju(b),a,this.Iia)}z(aLc,QZ);r=aLc.prototype;r.Vh=function(){return X.Bma};r.rv=function(){return X.Ama};r.D8a=function(){bLc(this)};r.E8a=function(a){13==a.keyCode&&(a.preventDefault(),a.stopPropagation(),bLc(this))};function bLc(a){PKc(a.B,v(a.Zrb,a,cLc(a)),ha)}
r.Zrb=function(a,b){a.pn=b.Yc;var c=QJc(b.Yc,b.rect);a.pn=parseInt(G(c,1).wb(),10);a.C=c;Z$(this,a,this.B.J,!1);var c=a.Bs,d=this.C.B;ry(d)!=c&&XK(d,c)};
r.$rb=function(){var a;cl.getInstance();var b=this.C.B.B;if(b&&0==b.getSheetType()){a=this.C;var c=b.wb(),b=Xx(b.Bc());a=OT(a,c,b)}else a=!1;if(a){c=this.B;if(!c.ib()){a=this.C.B.getActiveGrid();b=$$(this);if(!b&&a){this.B.reset();var c=a.C,b=a.Bc(),d=Zx(b),e=Xx(b);d?(ml?Cv(c,e,dc(Yg)):Ev(c,e,dc(Yg),this.X)).addCallback(v(this.kGa,this,a)):this.kGa(a,b.Tc());return}this.F=b;c.Uf(b)}this.rv().mc()}};
r.Xrb=function(a){var b=a.container,c=a.D,d=a.B,e=a.va,f=d,h=this.B.bb().clone();if(d&&c&&b!=c){if(!d.Upa()){Z$(this,$$(this),!1,!0);return}f=dLc(this,d.bb(),b);a:{var k=this.B,l;l=k.bb().pn;switch(b){case "row-breakout":case "col-breakout":var m="row-breakout"==b,f=new V$(f,k.D,l,Y$(k),m,k.Z());break a;case "aggregation":f=new W$(f,k.D,l,Y$(k),k.Z());break a;case "filter":f=new S$(f,k.D,l,Y$(k),k.Z());break a;default:f=null}}f.render();IKc(this.B,d,f,b)}d=a.position;k=c==b;l=eLc(this,f.bb());if(c)if(k){f=
f.bb();switch(b){case "row-breakout":JJc(h.Vn,f,d);break;case "col-breakout":JJc(h.An,f,d);break;case "filter":JJc(h.bt,f,d);break;case "aggregation":MJc(h,f,d)}Ym("Field is now in position "+(d+1+"."))}else fLc(this,b,h,l,d);else gLc(this,b,f,h);c&&!k&&null!=e&&hLc(e,c,h);Z$(this,h,this.B.J,!!a.hb)};
function dLc(a,b,c){switch(c){case "row-breakout":case "col-breakout":if(b instanceof qe)return b;break;case "aggregation":if(b instanceof re)return b;break;case "filter":if(b instanceof je)return b;break;default:return null}b=eLc(a,b);-1==b&&(b=0);switch(c){case "row-breakout":case "col-breakout":return c=new qe,I(c,1,b),c;case "aggregation":return c=new re,a=new se,I(a,1,b),TJc(a,"SUM"),I(c,4,1),I(c,5,a),c;case "filter":return c=new je,new ke,a=b+iLc(a).Pb(),I(c,1,a),c;default:return null}}
function eLc(a,b){if(b instanceof qe)return b.Dn();if(b instanceof re)switch(K$(b)){case 1:return G(b,5).Dn();case 2:return-1;default:return 0}return b instanceof je?b.kh()-iLc(a).Pb():0}function iLc(a){var b=$$(a);return b.xx(Pw(a.C.B,b.pn).Bc())}r.h8a=function(a){var b=a.container,c=cLc(this);fLc(this,b,c,a.J,a.position);Z$(this,c,this.B.J,!1);a=this.B;a.C[b]?(b=a.C[b],b=0<b.length?b[b.length-1]:null):b=null;b&&b.MFa()};
r.Yrb=function(a){var b=cLc(this);hLc(a.M,a.container,b);L(a.B);Z$(this,b,this.B.J,!1)};r.yYa=function(){var a=cLc(this),b=this.B.UJ();a.D=b;Z$(this,a,this.B.J,!1)};
function fLc(a,b,c,d,e){switch(b){case "row-breakout":a=new qe;I(a,1,d);null!=e?zb(c.Vn,a,e):c.Vn.push(a);break;case "col-breakout":a=new qe;I(a,1,d);null!=e?zb(c.An,a,e):c.An.push(a);break;case "filter":b=Pw(a.C.B,c.pn);if(!b)break;b=b.Bc();b=lKc(d,c.xx(b),b);var f=new je;a=iLc(a).Pb()+d;I(f,1,a);jLc(f,b);null!=e?zb(c.bt,f,e):c.bt.push(f);break;case "aggregation":b=new re;if(-1==d){X.yma.mc();d=new te;RJc(d,"=");I(d,4,"SUM");I(b,4,2);I(b,6,d);d=OJc($$(a));for(var h=!1,f="",k=1;!h&&k<=d.length+1;k++){f=
"Calculated Field "+k;a:{for(var h=a,l=f,m=$$(h),n=m.pq,q=0;q<n.length;q++){var t=n[q];if(Vc(t,3)&&l==G(t,3)){h=!0;break a}if(1==K$(t)){var w=Pw(h.C.B,m.pn).Bc();if(l==cKc(w,m.xx(w),G(t,5).Dn())){h=!0;break a}}}h=!1}h=!h}I(b,3,f)}else a=new se,I(a,1,d),TJc(a,"SUM"),I(b,4,1),I(b,5,a);PJc(c,b,e)}}function hLc(a,b,c){if(!(0>a))switch(b){case "row-breakout":Db(c.Vn,a);break;case "col-breakout":Db(c.An,a);break;case "filter":Db(c.bt,a);break;case "aggregation":NJc(c,a)}}
function gLc(a,b,c,d){if("aggregation"==b)a=NKc(a.B,b,c),d=d.pq[a],null!=d&&(a=c.D?c.D.La():null,null!=a&&I(d,3,a),1==K$(d)?TJc(G(d,5),c.La()):(jb(2==K$(d)),d=G(d,6),RJc(d,c.La()),(a=zKc(c))?I(d,4,a):Yc(d,4)));else if("filter"==b)d=sb(d.bt,function(a){return a.equals(c.bb())}),null!=d&&jLc(d,kVb(U$(c),!0));else if(d=sb("row-breakout"==b?d.Vn:d.An,function(a){return a.equals(c.bb())}),null!=d)if(WJc(d,c.C.isChecked()),UJc(d,c.D.La()),-1!=c.K.La()){var e=new pe;J$(e,c.K.La());A(pKc(c),function(a){Xc(e,
2,a)});XJc(e,c.D.La());I(d,7,e)}else Yc(d,7)}r.bcb=function(){Z$(this,$$(this),!0,!1)};function Z$(a,b,c,d){b&&(c?(c=RB(a.C.B,b.Bs),c=new $Kc(b,c),a.R.zc(c),a.K=null):a.K=b,c=a.B.bb(),(d=d||!Dh(c.B,b.B))&&a.B.reset(),a.B.Uf(b),d&&EKc(a.B))}r.kGa=function(a,b){var c=a.Bc(),d=Zx(c),c=Xx(c);d&&b.equals(c)?PKc(this.B,v(this.Eta,this),v(this.mgb,this),!0):this.Eta(new li(a.wb(),a.B,b))};r.mgb=function(){this.Vh().setVisible(!1);this.J.Ac(3)};
r.Eta=function(a){var b;b=new ue;var c=QJc(0,new Rh(0,0,1,1));I(b,6,c);I(b,5,2);b=pFa(b,0,new O(0,0),0);b.pn=a.Yc;a=QJc(a.Yc,a.rect);b.pn=parseInt(G(a,1).wb(),10);b.C=a;a=ry(this.C.B);this.R.zc(new fKc(b,a))};function $$(a){return a.K?a.K:(a=a.C.B.B)&&0==a.getSheetType()?jHa(a.Bc()):null}function cLc(a){return(a=$$(a))?a.clone():null}
r.Iia=function(a){var b=$$(this);if(("jb"==a.type||"xa"==a.type)&&!b&&this.F&&(a=this.C.B.getActiveGrid())&&(this.B.Ta(!0),a=a.Bc(),a.Ob()==this.F.Bs)){var c=this.F.B;c&&($x(a,c),b=$$(this))}b?b.equals(this.F,this.C)||this.B.Uf(b):this.B.reset();this.F=b;a=!!b;qCb.B&&!this.Vh().ib()||this.Vh().setVisible(a&&!dI(this.C));this.B.Ta(!!b)};r.U$a=function(a){a=a.target;if(this.F&&this.F.Bs==a.wb()&&this.B.ib()){a=this.B;var b=Kya(a.zb);b&&a.M&&b.setVisible(!1)}};
r.asb=function(a){var b=a.target;if(zr(b,bKc.tNa)||zr(b,bKc.sNa)){var b=du(this.P).bb(),c=Nx(b,a.Fg);kLc(this,b,c);a.stopPropagation()}};r.Xcb=function(a){var b=du(this.P).bb();a=Nx(b,a.Fg);kLc(this,b,a)};
function kLc(a,b,c){if(!dI(a.C)){var d=c.Dq();b=kHa(b,c);if(c=d.jaa()){var e=c.length-1;c=c[e];for(var d="r"==d.pR()?b.Vn[e]:b.An[e],e=$c(d,3),f,h=0;h<e.length;h++)if(e[h].La()==c){f=e[h];var k=!G(f,3);I(f,3,k)}f||(f=new oe,f.jb(c),I(f,3,!0),Xc(d,3,f));Ym(G(f,3)?"Pivot table field collapsed":"Pivot table field expanded");Z$(a,b,!0,!1)}}}function jLc(a,b){var c=new ke;Yc(c,2);I(c,1,!1);A(b,function(a){Xc(c,2,a)});I(a,2,c)}r.V=function(){aLc.O.V.call(this)};function lLc(){J.call(this)}z(lLc,Lm);lLc.prototype.C=function(){return X$};lLc.prototype.B=function(){return aLc};Tm("ritzpivottables",lLc);
