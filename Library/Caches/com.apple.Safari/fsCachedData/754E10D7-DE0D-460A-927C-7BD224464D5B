function H1b(a,b){return mg("input",{type:"hidden",name:a,value:b})}function I1b(a,b,c){var d,e,f=[];for(d in c)e=c[d],pa(e)?A(e,v(function(a){f.push(H1b(d,String(a)))},a)):f.push(H1b(d,String(e)));Kl(b,ng(f))}function J1b(a){S.call(this,a)}z(J1b,S);J1b.prototype.jb=function(){this.qa=this.Z().Ja("FORM",{method:"POST",style:"display:none"})};
BU.prototype.L=eU(191,function(a,b,c){sDb(this);this.H=a;a.addCallback(function(a){var e=!!c,f=this.F;this.C=new J1b(f);var h=$n(this.C,"docs-exporter-frame");this.B=f.Ja("IFRAME",{style:"display:none;",name:h,id:h});this.C.jb();f.Eb().body.appendChild(this.C.qa);f.Eb().body.appendChild(this.B);e&&(this.D=new FZ(this.B,!0),this.J.M(this.D,"ifload",this.K));e=this.C;f=e.getElement();f||(e.render(),f=e.getElement());f.action=a||"";f.target=h||"";I1b(e,f,b);f.submit()},this)});
function K1b(a){for(var b in a.B)a.Ta(b,!0)}function L1b(a,b){a.C=b}function M1b(a){return PH()?(new zH(a.K)).Hb("title"):""}function N1b(){return qb(navigator.plugins,function(a){return"Chrome PDF Viewer"==a.name})}function O1b(a,b){var c=Pj(a,b);return u(c)?String(Pj(a,b)):null}function P1b(a){return"%"+a.charCodeAt(0).toString(16)}var Q1b=/['()]/g;function R1b(a){return a.hk()+Oa(a.B)}function S1b(a,b,c,d,e,f,h,k){b=lg(b,null);return S1a(a,b,c,d,e,f,h,k)}
function T1b(a){a=Sa(String(a));Q1b.lastIndex=0;return Q1b.test(a)?a.replace(Q1b,P1b):a}function U1b(a){a=String(a);for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0);b[c+1]=Baa[d]||(31<e&&127>e?d:Daa(d))}b.push('"');return b.join("")}function V1b(a){return"<li class='nfd-format-pill'><div class='nfd-format-display'>"+Y(a.wUa)+"</div><div class='nfd-format-sample'>"+Y(a.$jb)+"</div></li>"};function W1b(a,b,c){S.call(this);this.Sf(a);this.C=b;this.B=c}z(W1b,S);r=W1b.prototype;r.jb=function(){var a=this.bb(),b=this.B?Aaa(hU(a),30):hU(a),a=this.B?gU(a,this.C):"";this.qa=vt(V1b,{wUa:b,$jb:a})};r.$a=function(){W1b.O.$a.call(this);om(this.getElement(),!0);var a=new St(this.getElement());K(this,a);U(this).M(a,"key",this.xtb).M(this.getElement(),"mousedown",this.wtb).M(this.getElement(),"dblclick",this.l1a)};
r.xtb=function(a){function b(a,b){for(;b=a(b);)if(Jn(b)){b.focus();break}}switch(a.keyCode){case 13:case 32:this.dispatchEvent("change");break;case 40:b(hm,this.getElement());break;case 38:b(kna,this.getElement())}};r.wtb=function(a){a.preventDefault();this.dispatchEvent("change")};r.l1a=function(){this.dispatchEvent("action")};function X1b(a,b,c){S.call(this);this.C=b;this.B=c;Y1b(this,a)}z(X1b,S);X1b.prototype.jb=function(){this.qa=this.Z().Ja("ul","nfd-pill-container")};function Y1b(a,b){A(b,function(a){this.cb(new W1b(a,this.C,this.B),!0)},a)}X1b.prototype.filter=function(a){a=a.toLowerCase();this.Eg(function(b){var c=Ka(Oa(a)),d=hU(b.bb()).toLowerCase(),c=c||Wa(d,a);R(b.getElement(),c)})};function P1(a){Sr.call(this,"nfd-dialog modal-dialog");this.D=a;this.input=this.O8();this.cb(this.input,!0);this.J=new S;this.cb(this.J,!0);a=this.u_();Jb(a,void 0,R1b);this.B=new X1b(a,this.lR(),this.iGa());this.J.cb(this.B,!0);cs(this,null);this.Li=!0}z(P1,Sr);r=P1.prototype;r.PHa=Ic;r.iGa=Hc;r.isEmpty=function(){return Ka(this.input.La())};r.xf=function(){return this.input.bb().xf()};r.jb=function(){P1.O.jb.call(this);var a=Wl("div","dialog-separator");cm(a,Ava(this))};
r.$a=function(){P1.O.$a.call(this);Br(this.J.getElement(),"nfd-dialog-content");U(this).M(this.B,"change",this.N2a).M(this.B,"action",this.aia).M(this.input.L,"action",this.aia).M(this.input,"afterhide",this.lYa);this.input.Rc&&U(this).M(this.input.Rc,"input",this.ptb);var a=this.input.U;a&&U(this).M(a,"key",this.qtb);a=this.u_()[0];this.input.vG(a)};r.lYa=function(a){a.stopPropagation()};r.N2a=function(a){this.input.vG(a.target.bb());Z1b(this.input,!1)};
r.ptb=function(){this.B.filter(this.input.La());Z1b(this.input,!this.input.bb().xf())};r.qtb=function(a){13==a.keyCode&&this.aia()};r.aia=function(){this.xf()&&!this.isEmpty()?(X.O4.qc(new WT(this.xV(),void 0,this.PHa())),this.setVisible(!1)):(Z1b(this.input,!0),this.input.Cta())};function Q1(a,b,c,d,e){XC.call(this,b,c,d,e);this.B=a}z(Q1,XC);Q1.prototype.lk=function(){var a=Q1.O.lk.call(this),b=this.getParent();return b&&b instanceof MC&&!b.ib()?this.B(a,this.bb()):a};function R1(a){S.call(this);this.J=new S;K(this,this.J);this.C=new TU("");K(this,this.C);this.L=new WD("");K(this,this.L);this.P=a;this.U=null}z(R1,S);r=R1.prototype;
r.$a=function(){R1.O.$a.call(this);var a=bo(this,"nfd-icwr");this.J.rb(a);this.cb(this.J);if(a=bo(this,"nfd-i"))this.C.rb(a),this.C.Sc(this.J),Dr(this.C.getElement(),"jfk-textinput"),a=new bF,a.rb(this.C.getElement()),K(this,a),this.Rc=a=new FD(this.C.getElement()),K(this,a),this.U=a=new St(this.C.getElement()),K(this,a),a=new Or(this.C.getElement()),U(this).M(a,"focusout",za(this.NHa,!1)).M(a,"focusin",za(this.NHa,!0)).M(this.Rc,"input",this.otb);a=bo(this,"nfd-a");this.L.rb(a);this.cb(this.L)};
r.La=function(){return this.C.La()};r.otb=function(){var a=this.bb(),b=this.La();I(a.fC,2,b);this.OHa()};r.OHa=Ic;r.NHa=function(a){Fr(this.J.getElement(),"nfd-input-focus",a)};r.vG=function(a){this.Sf(a.clone());this.C.ob(hU(a));try{this.C.getElement().focus()}catch(b){}};r.Cta=function(){this.C.getElement().focus()};function Z1b(a,b){var c=a.J.getElement();Fr(c,"nfd-invalid",b)};function $1b(a){var b;a=a||{};return mt('<input class="jfk-textinput'+(a.Wd?" "+Z(a.Wd):"")+'"'+(a.id?'id="'+Z(a.id)+'"':"")+(a.maxLength?'maxlength="'+Z(a.maxLength)+'"':"")+(a.v2&&a.Pvb?'label="'+Z(a.v2)+'"':"")+(a.name?'name="'+Z(a.name)+'"':"")+(a.v2?'placeholder="'+Z(a.v2)+'"':"")+'type="'+Z(null==(b=a.type)?"text":b)+'"'+(a.pattern?'pattern="'+Z(a.pattern)+'"':"")+(a.value?'value="'+Z(a.value)+'"':"")+(a.dir?'dir="'+Z(a.dir)+'"':"")+(a.attributes?" "+Ht(a.attributes):"")+">")};function a2b(a){return mt("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+Z(a.VS)+"'>"+b2b(a)+"</div>"+c2b(a)+"</div>")}function d2b(a){return mt("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+Z(a.VS)+"'></div>"+c2b(a)+"</div>")}
function e2b(a){return mt("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+Z(a.VS)+"'><div style='display: table-row;'><div class='nfd-inner-input' style='display: table-cell;'>"+b2b(a)+"</div><div class='nfd-inner-input-content' style='display: table-cell;'><div id='"+Z(a.beb)+"'></div></div></div></div>"+c2b(a)+"</div>")}
function f2b(){var a;return a=""+("<div class='cnf-sample-wrapper'><table class='cnf-sample-table'><tbody>"+g2b({label:""})+g2b({label:"Negative:"})+g2b({label:"Zero:"})+g2b({label:"Text:"})+"</tbody></table><a class='cnf-help-link' href='//support.google.com/drive/?p=drive_custom_numbers' target='_blank'>Help</a></div>")}function g2b(a){return"<tr><td class='nfd-sample-label'>"+Y(a.label)+"</td><td class='nfd-rendered-sample'></td></tr>"}
function c2b(a){a=""+Ft(Mt({id:a.Q7,style:2,Wd:"nfd-apply",content:Bt("Apply")}));return mt(a)}function b2b(a){return mt(Ft($1b({id:a.wAa,v2:a.xAa,Pvb:!0})))};function S1(a){R1.call(this,a);this.D=new S;this.B=new JD("")}z(S1,R1);r=S1.prototype;r.jb=function(){this.qa=vt(e2b,{VS:$n(this,"nfd-icwr"),wAa:$n(this,"nfd-i"),xAa:this.P,beb:$n(this,"nfd-ic"),Q7:$n(this,"nfd-a")})};r.$a=function(){S1.O.$a.call(this);var a=bo(this,"nfd-ic");this.D.rb(a);this.D.Sc(this.J);this.D.cb(this.B,!0);U(this).M(this.B,"aftershow",this.rtb).M(this.B,"action",this.Sxa).M(this.Rc,"input",za(this.EIa,null))};r.vG=function(a){S1.O.vG.call(this,a);a.B&&this.C.ob(cn[a.B][1]);this.EIa(a)};
r.EIa=function(a){a=a?a.B:void 0;var b=this.B;b.Nf(null);if(a){var c=this.bb(),d=c.B;h2b(this,c);c=bOb(d,cn[d][2]);c=new WT(i2b(c),NX[d],d);h2b(this,c);c=bOb(d,d+" "+cn[d][1]);d=new WT(i2b(c),NX[d],d);h2b(this,d)}else this.bb().B=null;var e="[$"+this.La()+"]",d=a?NX[a]:null,c=[];c.push(ritz.buildCurrencyPattern(e,2,!0));c.push(ritz.buildCurrencyPattern(e,0,!0));c.push(ritz.buildCurrencyPattern(e,2,!1));c.push(ritz.buildCurrencyPattern(e,0,!1));for(e=0;e<c.length;e++){var f=new WT(i2b(c[e]),d,a);h2b(this,
f)}b.Af(0);this.Sxa();Br(b.hc().getElement(),"number-format-menu")};function h2b(a,b){var c=new Q1(function(a){return Aaa(a,25)},gU(b,1E3),b);K(a,c);K(a,b);c.Qr(!0);for(var d=a.B,e=0;e<d.Uj();e++)if(d.Ee(e).lk()==c.lk())return;d.Ye(c)}r.Sxa=function(){for(var a=this.B,b=0;b<a.Uj();b++)a.Ee(b).Dc(!1);nD(a)};r.rtb=function(){this.B.$e().Dc(!0)};function i2b(a){var b=new md;I(b,2,a);b.bd(4);return b};function j2b(a){P1.call(this,a);Tr(this,"Custom currencies")}z(j2b,P1);r=j2b.prototype;r.lR=p(1000.12);r.O8=function(){return new S1("Custom currency")};r.u_=function(){BDb();for(var a=this.D,b=0;b<a.length;b++){var c=a[b],d=c.B;d?c.C=NX[d]:L1b(c,dOb(c.hk()))}var e=[];Yb(cn,function(a,b){var c=cOb(b);K(this,c);e.push(c)},this);var f=MYb();Nb(e,function(a,b){return f(hU(a),hU(b))});return a.concat(e)};r.xV=function(){var a=new md;a.bd(4);I(a,3,1);var b=this.input.B.$e().La().hk();I(a,2,b);return a};
r.PHa=function(){return this.input.bb().B};function k2b(a){S.call(this);a=Math.abs(a);var b=[];b.push(a);b.push(-1*a);b.push(0);this.B=b}z(k2b,S);k2b.prototype.jb=function(){var a=vt(f2b);this.D=Rl("nfd-sample-label",a);this.C=Zma("nfd-rendered-sample",a);this.qa=a};function T1(a,b){R1.call(this,a);this.B=new k2b(b);this.Sf(new WT(""))}z(T1,R1);T1.prototype.jb=function(){this.qa=vt(a2b,{wAa:$n(this,"nfd-i"),xAa:this.P,VS:$n(this,"nfd-icwr"),Q7:$n(this,"nfd-a")})};T1.prototype.$a=function(){T1.O.$a.call(this);this.cb(this.B,!0);l2b(this)};T1.prototype.OHa=function(){l2b(this)};T1.prototype.vG=function(a){T1.O.vG.call(this,a);l2b(this)};
function l2b(a){var b=a.bb();if(b){var c=a.B,d=b.hk().split(";").length-1;mm(c.D,0<d?"Positive:":"Sample:");for(var e=0;e<c.B.length;e++){var f=c.C[e],h=gU(b,c.B[e]);a=ritz.getColorForFormattedString(String(c.B[e]),b.hk());var k=e<=d;R(mna(f),k);mm(f,h);on(f,"color",a||"")}h=b.xf()?ritz.renderStringInNumberFormat("text",b.hk()):"Invalid format";a=ritz.getColorForFormattedString("text",b.hk());b=c.C[3];d=3<=d;c=h;R(mna(b),d);mm(b,c);on(b,"color",a||"")}};function U1(a){P1.call(this,a);Tr(this,"Custom number formats")}z(U1,P1);U1.prototype.lR=p(1234.56);U1.prototype.O8=function(){return new T1("Custom number format",1234.56)};
U1.prototype.u_=function(){var a=this.D;a.push(new WT("0"));a.push(new WT("0.00"));a.push(new WT("#,##0"));a.push(new WT("#,##0.00"));a.push(new WT("#,##0_);(#,##0)"));a.push(new WT("#,##0_);[Red](#,##0)"));a.push(new WT("#,##0.00_);(#,##0.00)"));a.push(new WT("#,##0.00_);[Red](#,##0.00)"));a.push(new WT("$#,##0_);($#,##0)"));a.push(new WT("$#,##0_);[Red]($#,##0)"));a.push(new WT("$#,##0.00_);($#,##0.00)"));a.push(new WT("$#,##0.00_);[Red]($#,##0.00)"));a.push(new WT("@"));a.push(new WT("0%"));a.push(new WT("0.00%"));
a.push(new WT("0.00E+00"));a.push(new WT("##0.0E+0"));a.push(new WT("# ?/?"));a.push(new WT("# ??/??"));a.push(new WT('_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)'));a.push(new WT('_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'));a.push(new WT('_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)'));a.push(new WT('_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'));return a};U1.prototype.xV=function(){var a=new md;a.bd(2);I(a,3,1);var b=this.input.La();I(a,2,b);return a};function V1(a,b){bD.call(this,b,new m2b(a))}z(V1,bD);r=V1.prototype;r.Oj=function(a,b,c){V1.O.Oj.call(this,a,b,c);a.Jc()&&this.Jc()&&a.getParent()==this&&W1(this)};r.$a=function(){V1.O.$a.call(this);W1(this)};r.Se=function(a){V1.O.Se.call(this,a);W1(this)};r.removeChild=function(a,b){var c=V1.O.removeChild.call(this,a,b);W1(this);return c};r.fs=function(a,b){var c=V1.O.fs.call(this,a,b);W1(this);return c};
r.tj=function(a){var b;if(!(b=37!=a.keyCode&&39!=a.keyCode)){a:{b=a.keyCode;var c=PC(this);if(c){b=39==b;this.Ue()&&(b=!b);var c=c.getElement(),c=lb(c.parentNode.childNodes,c),d;(d=PC(this))?(d=d.getElement(),d=Ana(d,n2b)):d=null;d=d?lb(d.parentNode.childNodes,d):-1;var e;e=d==this.getNumberOfColumns()-1;if(b||0==d)if(b&&!e)e=d+1;else{b=!1;break a}else e=d-1;e=o2b(this,e);b?b=o2b(this,d)-c+Math.min(c,e-1):(b=-(c+1),e>c&&(b-=e-1-c));this.m3(this.Bi+b);b=!0}else b=!1}b=!b}return b?V1.O.tj.call(this,
a):!0};r.getNumberOfColumns=function(){return this.getElement()?this.getElement().childNodes.length:0};function o2b(a,b){return 0==a.getNumberOfColumns()?0:(a.getElement()?a.getElement().childNodes[b]:null).childNodes.length}
function W1(a){for(var b=a.Qd(),c=a.Gc(),d=Gb(Ql("div",n2b,a.getElement())),e=a.getElement(),f=d.length;f<b.C&&f<c;f++)d[f]=a.Z().Ja("div",n2b),e.appendChild(d[f]);for(var e=d.length,b=Array(e),c=[],f=0,h=!1,k=0;k<a.Gc();k++)a.Kc(k)instanceof aD?(c.push(new p2b(f,k,!0)),f=k+1):a.Kc(k)instanceof UC&&(0==k?h=!0:(a.Kc(k-1),c.push(new p2b(f,k-1,!1)),f=k));k=a.Gc();0<c.length&&kb(c).end!=k-1&&c.push(new p2b(f,k-1,!1));f=h;h=a.Gc();if(0==c.length&&f)b[0]=h;else{f=c.length-Math.max(0,c.length-e);f=a.Gc()-
f;f=Math.ceil(f/e);if(0==c.length)for(h=0;h<e;h++)b[h]=(h+1)*f-1;else q2b(c,f,e);e=c.length;for(f=0;f<e;f++)b[f]=c[f].end}for(e=c=0;e<a.Gc();e++){for(;e>b[c];)++c;f=a.Kc(e);h=f.getElement();h.parentNode!=d[c]&&d[c].appendChild(h);e==b[c]&&f instanceof aD?R(h,!1):R(h,!0)}for(a=d.length-1;a>c;--a)d[a].parentNode.removeChild(d[a]),d[a]=null}
function q2b(a,b,c){function d(a){return a.end-a.start-(a.Tcb?1:0)}c=Math.max(0,a.length-c);for(var e=0;e<a.length-1;e++)a[e].B=d(a[e])+d(a[e+1]);for(e=0;e<c;e++){for(var f=32765,h=-1,k=!1,l=0;l<a.length-1;l++){var m=a[l].B;m<f&&(f=m,h=l);if(m<=b){a[l+1].start=a[l].start;Ab(a,l,1);k=!0;break}}k||(a[h+1].start=a[h].start,Ab(a,l,1))}}function p2b(a,b,c){this.start=a;this.end=b;this.Tcb=c}function m2b(a){$C.call(this);this.C=a}z(m2b,$C);var n2b="docs-multi-menu-col";function r2b(a){this.B=a}z(r2b,J);r2b.prototype.create=function(){return new V1(this.B)};function s2b(a,b){R1.call(this,a);this.R=new S;this.H=new X1;this.D=new S;var c=(new r2b(3)).create();c.cb(new UC("Date"),!0);c.cb(new XC("Day","DAY_TOKEN"),!0);c.cb(new XC("Month","MONTH_TOKEN"),!0);c.cb(new XC("Year","YEAR_TOKEN"),!0);c.cb(new UC("Time"),!0);c.cb(new XC("Hours","HOURS_TOKEN"),!0);c.cb(new XC("Minutes","MINUTES_TOKEN"),!0);c.cb(new XC("Seconds","SECONDS_TOKEN"),!0);c.cb(new XC("Milliseconds","MILLIS_TOKEN"),!0);c.cb(new XC("AM/PM","AM_PM_TOKEN"),!0);c.cb(new UC("Duration"),!0);c.cb(new XC("Elapsed hours",
"ELAPSED_HOURS_TOKEN"),!0);c.cb(new XC("Elapsed minutes","ELAPSED_MINUTES_TOKEN"),!0);c.cb(new XC("Elapsed seconds","ELAPSED_SECONDS_TOKEN"),!0);this.K=new KVa(c);this.B=b}z(s2b,R1);r=s2b.prototype;r.jb=function(){this.qa=vt(d2b,{VS:$n(this,"nfd-icwr"),Q7:$n(this,"nfd-a")})};
r.$a=function(){s2b.O.$a.call(this);Br(this.getElement(),"nfd-date-time-input");var a=bo(this,"nfd-icwr"),b=this.R;b.rb(a);b.Sc(this);b.cb(this.K,!0);Br(this.K.getElement(),"nfd-date-time-menu-button");Br(this.K.hc().getElement(),"nfd-date-time-menu");yr(this.K.qa,"Add a date or time format");b.cb(this.H,!0);wf||Br(this.H.getElement(),"nfd-date-time-left-most");a=this.D;b.cb(a,!0);on(a.getElement(),"display","inline");U(this).M(this,"Oe",za(this.QHa,"left")).M(this,"Se",za(this.Eya,"left")).M(this,
"Te",za(this.Eya,"right")).M(this,"Ue",za(this.bza,"left")).M(this,"Ve",za(this.bza,"right")).M(this,"Re",za(this.QHa,"right")).M(this.K,"action",this.m0a)};r.Cta=function(){this.R.getElement().focus()};
r.vG=function(a){this.Sf(a.clone());var b=this.D;b.Od(!0);mm(this.H.getElement(),"");a=ritz.renderDateAsTokens(this.B,a.hk());for(var c=0;c<a.length;c++){var d=a[c],e=d[0];"LITERAL_TOKEN"==e?0==c?mm(this.H.getElement(),d[2]):(e=b.Kc(b.Gc()-1),d=d[2],mm(e.$c.getElement(),qm(e.$c.getElement())+d)):t2b(this,e).ob(d[1])}0<b.Gc()&&b.Kc(b.Gc()-1).fc.getElement().focus()};
r.La=function(){for(var a=this.H.toString(),b=0;b<this.D.Gc();b++)a+=this.D.Kc(b).toString();for(var a=ritz.renderDateAsTokens(this.B,a),c="",d=!1,b=0;b<a.length;b++){var e=a[b][1];switch(a[b][0]){case "ELAPSED_HOURS_TOKEN":case "ELAPSED_MINUTES_TOKEN":case "ELAPSED_SECONDS_TOKEN":if(!d){d=!0;break}e=Ya(e,"[");e=Ya(e,"]")}c+=e}return c};r.m0a=function(a){a=a.target.La();t2b(this,a).fc.getElement().focus()};
function t2b(a,b){Z1b(a,!1);var c;switch(b){case "DAY_TOKEN":c=u2b(a);break;case "MONTH_TOKEN":c=v2b(a);break;case "YEAR_TOKEN":c=w2b(a);break;case "HOURS_TOKEN":c=x2b();break;case "MINUTES_TOKEN":c=y2b();break;case "SECONDS_TOKEN":c=z2b();break;case "MILLIS_TOKEN":c=A2b();break;case "AM_PM_TOKEN":c=B2b(a);break;case "ELAPSED_HOURS_TOKEN":c=C2b();break;case "ELAPSED_MINUTES_TOKEN":c=D2b();break;case "ELAPSED_SECONDS_TOKEN":c=E2b()}var d=c;d.cb(new aD,!0);d.cb(new XC("Delete"),!0);c=new F2b(c,"");
a.D.cb(c,!0);return c}r.QHa=function(a,b){var c=b.target,d;if(c instanceof X1){if(c===this.H&&"left"==a)return;d=c.getParent();if("right"==a&&(d=this.D.Kc(co(this.D,d)+1),!d))return}else d=c;var c=qm(d.$c.getElement()),e=d.getParent(),f=co(e,d);e.removeChild(d,!0);0==f?(e=this.H.getElement(),d=qm(e),mm(e,d+c),G2b(this.H,d.length)):(f--,e=e.Kc(f),d=qm(e.$c.getElement()),mm(e.$c.getElement(),qm(e.$c.getElement())+c),G2b(e.$c,d.length))};
r.bza=function(a,b){var c=b.target.getParent(),d="left"==a?0:1;(c=this.D.Kc(co(this.D,c)+d))&&c.fc.getElement().focus()};r.Eya=function(a,b){var c="left"==a?-1:0;(c=this.D.Kc(co(this.D,b.target)+c))||"left"!=a?c&&(c=c.$c):c=this.H;var d=qm(c.getElement()).length;G2b(c,"left"==a?d:0)};function F2b(a,b){S.call(this);this.fc=new JD("",a);this.cb(this.fc,!0);this.$c=new X1(b);this.cb(this.$c,!0)}z(F2b,S);r=F2b.prototype;
r.$a=function(){F2b.O.$a.call(this);on(this.getElement(),"display","inline-block");this.fc.Af(0);this.B=new St(this.fc.getElement());K(this,this.B);U(this).M(this.fc,"action",this.stb).M(this.B,"key",this.ttb)};r.stb=function(){nD(this.fc);this.fc.$e().bb()||this.dispatchEvent("Re")};r.ttb=function(a){switch(a.keyCode){case 8:case 46:a.repeat||(a.preventDefault(),this.dispatchEvent("Re"));break;case 37:a.preventDefault();this.dispatchEvent("Se");break;case 39:a.preventDefault(),this.dispatchEvent("Te")}};
r.toString=function(){return this.fc.$e().bb()+this.$c.toString()};r.ob=function(a){this.fc.ob(a)};function X1(a){S.call(this);this.B=a||""}z(X1,S);r=X1.prototype;r.jb=function(){var a=Wl("span");Sl(a,{contentEditable:!0});mm(a,this.B);var b=a.style;tf&&!Cf("8")?(b.whiteSpace="pre",b.wordWrap="break-word"):b.whiteSpace=wf?"-moz-pre-wrap":"pre-wrap";this.qa=a};r.$a=function(){X1.O.$a.call(this);var a=new St(this.getElement());K(this,a);U(this).M(a,"key",this.utb).M(this.getElement(),"paste",this.vtb)};
function G2b(a,b){if(0==qm(a.getElement()).length&&0==b)a.getElement().focus();else{var c=a.getElement().firstChild,c=VJ(c,b);a.getElement().focus();c.select()}}
r.utb=function(a){var b=pm(this.getElement()),c=BJ(),d=qm(this.getElement()).length,e=c?0==c.Gg()&&0==c.Jl():Ka(Oa(b)),b=c?c.Gg()==d&&c.Jl()==d:Ka(Oa(b));switch(a.keyCode){case 8:e&&(a.preventDefault(),this.dispatchEvent("Oe"));break;case 46:b&&(a.preventDefault(),this.dispatchEvent("Re"));break;case 40:this.dispatchEvent("Pe");break;case 38:this.dispatchEvent("Qe");break;case 37:e&&(a.preventDefault(),this.dispatchEvent("Ue"));break;case 39:b&&(a.preventDefault(),this.dispatchEvent("Ve"));break;
case 13:a.preventDefault()}};r.toString=function(){var a=kaa(qm(this.getElement())).replace(/"/g,'"\\""');return 0==Oa(a).length?"":'"'+a+'"'};r.vtb=function(){var a=v(function(){mm(this.getElement(),qm(this.getElement()))},this);Wj(a)};
function u2b(a){function b(a){return"Day ("+(a+")")}var c=[],d="d",e=ritz.renderFormattedString(a.B,d),f="Day without leading zero ("+(e+")");c.push(new Q1(za(b,e),f,d));d="dd";e=ritz.renderFormattedString(a.B,d);f="Day with leading zero ("+(e+")");c.push(new Q1(za(b,e),f,d));d="ddd";e=ritz.renderFormattedString(a.B,d);f="Day as abbreviation ("+(e+")");c.push(new Q1(za(b,e),f,d));d="dddd";e=ritz.renderFormattedString(a.B,d);a="Day as full name ("+(e+")");c.push(new Q1(za(b,e),a,d));d=new bD;for(e=
0;e<c.length;e++)d.cb(c[e],!0);return d}
function v2b(a){function b(a){return"Month ("+(a+")")}var c=[],d="m",e=ritz.renderFormattedString(a.B,d),f="Month without leading zero ("+(e+")");c.push(new Q1(za(b,e),f,d));d="mm";e=ritz.renderFormattedString(a.B,d);f="Month with leading zero ("+(e+")");c.push(new Q1(za(b,e),f,d));d="mmm";e=ritz.renderFormattedString(a.B,d);f="Month as abbreviation ("+(e+")");c.push(new Q1(za(b,e),f,d));d="mmmm";e=ritz.renderFormattedString(a.B,d);f="Month as full name ("+(e+")");c.push(new Q1(za(b,e),f,d));d="mmmmm";
e=ritz.renderFormattedString(a.B,d);a="First letter of the month ("+(e+")");c.push(new Q1(za(b,e),a,d));d=new bD;for(e=0;e<c.length;e++)d.cb(c[e],!0);return d}function w2b(a){function b(a){return"Year ("+(a+")")}var c=[],d="yy",e=ritz.renderFormattedString(a.B,d),f="Two digit year ("+(e+")");c.push(new Q1(za(b,e),f,d));d="yyyy";e=ritz.renderFormattedString(a.B,d);a="Full numeric year ("+(e+")");c.push(new Q1(za(b,e),a,d));d=new bD;for(e=0;e<c.length;e++)d.cb(c[e],!0);return d}
function x2b(){function a(a){return"Hour ("+(a+")")}var b=[],c="h",d="1",e="Hour without leading zero ("+(d+")");b.push(new Q1(za(a,d),e,c));c="hh";d="01";e="Hour with leading zero ("+(d+")");b.push(new Q1(za(a,d),e,c));c=new bD;for(d=0;d<b.length;d++)c.cb(b[d],!0);return c}
function y2b(){function a(a){return"Minute ("+(a+")")}var b=[],c="m",d="1",e="Minute without leading zero ("+(d+")");b.push(new Q1(za(a,d),e,c));c="mm";d="01";e="Minute with leading zero ("+(d+")");b.push(new Q1(za(a,d),e,c));c=new bD;for(d=0;d<b.length;d++)c.cb(b[d],!0);return c}
function z2b(){function a(a){return"Second ("+(a+")")}var b=[],c="s",d="1",e="Second without leading zero ("+(d+")");b.push(new Q1(za(a,d),e,c));c="ss";d="01";e="Second with leading zero ("+(d+")");b.push(new Q1(za(a,d),e,c));c=new bD;for(d=0;d<b.length;d++)c.cb(b[d],!0);return c}
function A2b(){function a(a){return"Milliseconds ("+(a+")")}var b=[],c="0",d="1",e="Precision to 1/10 of a second ("+(d+")");b.push(new Q1(za(a,d),e,c));c="00";d="01";e="Precision to 1/100 of a second ("+(d+")");b.push(new Q1(za(a,d),e,c));c="000";d="001";e="Precision to 1/1000 of a second ("+(d+")");b.push(new Q1(za(a,d),e,c));c=new bD;for(d=0;d<b.length;d++)c.cb(b[d],!0);return c}
function B2b(a){function b(a){return"AM/PM ("+(a+")")}var c=[],d="am/pm",e=ritz.renderFormattedString(a.B,d),f="Full ("+(e+")");c.push(new Q1(za(b,e),f,d));d="a/p";e=ritz.renderFormattedString(a.B,d);f="Shortened lowercase ("+(e+")");c.push(new Q1(za(b,e),f,d));d="A/P";e=ritz.renderFormattedString(a.B,d);a="Shortened uppercase ("+(e+")");c.push(new Q1(za(b,e),a,d));d=new bD;for(e=0;e<c.length;e++)d.cb(c[e],!0);return d}
function C2b(){function a(a){return"Elapsed hours ("+(a+")")}var b=[],c="[h]",d="1",e="Elapsed hours without leading zero ("+(d+")");b.push(new Q1(za(a,d),e,c));c="[hh]";d="01";e="Elapsed hours with leading zero ("+(d+")");b.push(new Q1(za(a,d),e,c));c=new bD;for(d=0;d<b.length;d++)c.cb(b[d],!0);return c}
function D2b(){function a(a){return"Elapsed minutes ("+(a+")")}var b=[],c="[m]",d="1",e="Elapsed minutes without leading zero ("+(d+")");b.push(new Q1(za(a,d),e,c));c="[mm]";d="01";e="Elapsed minutes with leading zero ("+(d+")");b.push(new Q1(za(a,d),e,c));c=new bD;for(d=0;d<b.length;d++)c.cb(b[d],!0);return c}
function E2b(){function a(a){return"Elapsed seconds ("+(a+")")}var b=[],c="[s]",d="1",e="Elapsed seconds without leading zero ("+(d+")");b.push(new Q1(za(a,d),e,c));c="[ss]";d="01";e="Elapsed seconds with leading zero ("+(d+")");b.push(new Q1(za(a,d),e,c));c=new bD;for(d=0;d<b.length;d++)c.cb(b[d],!0);return c};function H2b(a){P1.call(this,a);Tr(this,"Custom date and time formats")}z(H2b,P1);r=H2b.prototype;r.iGa=Gc;r.lR=p(11175.5628472222);r.isEmpty=function(){return Ka(VT(this.xV()))};r.xf=function(){return ritz.isValidFormatPattern(VT(this.xV()))};r.O8=function(){return new s2b("Custom date time format",11175.5628472222)};r.xV=function(){return I2b(this.input.La())};
r.u_=function(){for(var a=this.D,b=0;b<a.length;b++){var c=a[b],d=ritz.renderFormattedString(this.lR(),c.hk());c.C=d}c=J2b(this);Jb(c);for(b=0;b<c.length;b++)a.push(new WT(I2b(c[b]),ritz.renderFormattedString(this.lR(),c[b])));return a};
function J2b(a){var b=sG,c=ob(b.DATEFORMATS,function(a){return K2b(a)},a),d=ob(b.TIMEFORMATS,function(a){return K2b(a)},a),e=c.concat(d),b=b.DATETIMEFORMATS;Jb(b);a=ob(b,function(a){return K2b(a)},a);for(b=0;b<a.length;b++){var f=a[b],f=f.replace(/\{1\}/,c[0]),f=f.replace(/\{0\}/,d[0]);e.push(f)}return e}
function K2b(a){a=a.split(/('+)/);for(var b=!1,c=0;c<a.length;++c){var d=a[c].match(/'/g);if(d){for(var e="",f=0;f<a[c].length;f+=2)e+="'";a[c]=e}d&&1==d.length%2?(a[c]='"',b=!b):d||b||(d=a[c],d=d.replace(/E/gi,"d"),d=d.replace(/z/gi,""),d=d.replace(/a/gi,"am/pm"),d=d.replace(/\[/gi,""),d=d.replace(/\]/gi,""),d=d.replace(/\by\b/gi,"yyyy"),a[c]=d)}return Ra(a.join(""))}function I2b(a){var b=new md;b.bd(7);I(b,3,1);I(b,2,a);return b};function L2b(a,b){this.C=a;this.B=b}L2b.prototype.getUrl=g("C");function M2b(a){for(var b="",c=a.rFa,d=c.length,e=0;e<d;e++){var f=c[e],h=a.jlb[f.qP];f.getName();var k=f.Th(),f=f.Kdb,f='<div id="'+Z(h)+'" tabindex="0" role="link" class="ess-button" aria-label="'+Z(k)+'"><div class="ess-icon '+Z(f)+'"></div></div>',b=b+f}return b};function N2b(){};function O2b(a,b){S.call(this,b);this.B=a||[];this.D=[];this.C=null}z(O2b,S);r=O2b.prototype;r.w7=!0;r.e7=!1;r.vJ=null;r.Hsa=!1;r.Ta=function(a,b){this.w7=a;this.e7=b;if(this.Hsa)for(var c=this.Z(),d=0,e;e=this.B[d];d++){var f=c.getElement(this.vJ.gga+"-"+e.qP),h=a;Fr(f,"ess-button",h);Fr(f,"ess-disabled-button",!h);TD(f,e.getName(),e.Th())}};
r.jb=function(){this.qa=this.F.createElement("SPAN");var a={};a.gga=$n(this,"service");a.rFa=this.B;this.vJ=a;for(var b={},c=0,d;d=this.B[c];c++)b[d.qP]=this.vJ.gga+"-"+d.qP;a.jlb=b;this.vJ=a;Bs(this.getElement(),M2b,this.vJ);this.Hsa=!0};
r.ujb=function(a){if(this.w7)if(this.C&&this.C.hP(9),this.e7)this.dispatchEvent(new P2b(new Q2b));else{var b=this.C||void 0;a=a.getUrl(this.D);b&&b.hP(10);b={BWb:!0};b.target=b.target||a.target||"google_popup";b.width=b.width||690;b.height=b.height||500;(b=zu(a,b))&&b.focus()}};r.$a=function(){this.Ta(this.w7,this.e7);for(var a=this.Z(),b=U(this),c=0,d;d=this.B[c];c++){var e=a.getElement(this.vJ.gga+"-"+d.qP);Hi(b,e,v(this.ujb,this,d))}};
r.V=function(){O2b.O.V.call(this);delete this.D;delete this.B;this.C=null};function P2b(a,b){M.call(this,"We",b);this.context=a}z(P2b,M);function Q2b(){}z(Q2b,N2b);function Y1(a,b,c,d){this.C=b;this.B=c;this.Kdb=d;this.qP=R2b++}var R2b=0;Y1.prototype.getName=g("C");Y1.prototype.Th=g("B");function S2b(){Y1.call(this,0,"Facebook","Share via Facebook","ess-facebook-icon")}z(S2b,Y1);S2b.prototype.getUrl=function(a){var b=ob(a,function(a){return a.B});a=ob(a,function(a){return a.getUrl()});return"http://www.facebook.com/share.php?u="+Sa(a.join(","))+"&t="+Sa(b.join(","))};function T2b(){Y1.call(this,0,"Gmail","Share via Gmail","ess-gmail-icon")}z(T2b,Y1);T2b.prototype.getUrl=function(a){a=ob(a,function(a){return a.B+" - "+a.getUrl()});return"https://mail.google.com/mail/?view=cm&ui=2&cmid=0&fs=1&tf=1&body="+Sa(a.join("\n"))};function U2b(){Y1.call(this,0,"Google+","Share via Google+","ess-gplus-icon")}z(U2b,Y1);U2b.prototype.getUrl=function(a){return 0==a.length?"http://plus.google.com":"http://plus.google.com/share?url="+Sa(a[0].getUrl())};function V2b(){Y1.call(this,0,"Twitter","Share via Twitter","ess-twitter-icon")}z(V2b,Y1);V2b.prototype.getUrl=function(a){for(var b=va(void 0)?void 0:140,c=[],d=0,e=0;e<a.length;e++){var f=a[e].getUrl(),h=d+f.length+(d?1:0);if(h>b)break;else c.push(f),d=h}for(e=0;e<a.length;e++){var f=a[e].B,h=c[e]?" - ":"",k=b-d-h.length;if(k<f.length)if(4<=k)f=f.substring(0,k-3)+"\u2026";else break;d+=f.length+h.length;c[e]=f+h+(c[e]?c[e]:"")}a=c.join(" ");return"http://twitter.com/home?status="+Sa(a)};function Z1(a){S.call(this,a)}z(Z1,S);function W2b(a){a.dispatchEvent(new M("Xe"))}Z1.prototype.oR=function(){return{}};Z1.prototype.FE=Ic;Z1.prototype.bga=ha;function $1(a){S.call(this,a)}z($1,S);$1.prototype.D=Ic;$1.prototype.H=ha;$1.prototype.J=ha;function X2b(a){var b="",c="Make your content visible to anyone by publishing it to the web. You can link to or embed your document. "+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+T1b(a.locale)+'&answer=183965">Learn more</a>'),b=b+('<div class="pub-dialog-wrap"><div><div class="pub-dialog-info" aria-live="polite" id="pub-dialog-status-info"></div><div class="pub-dialog-option-vspacer"></div><div class="pub-dialog-info-help">'+c+'</div><div id="pub-dialog-links-tab-bar" class="pub-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="pub-dialog-link-tab" class="pub-dialog-tab goog-tab goog-tab-selected">Link</div><div id="pub-dialog-embed-tab" class="pub-dialog-tab goog-tab">Embed</div></div><div class="goog-tab-bar-clear"></div><div class="goog-tab-content"><div id="pub-dialog-link-tab-content"><div id="pub-dialog-link-options"></div><input id="pub-dialog-document-link" type="text" class="pub-dialog-document-link jfk-textinput" value="'+
Z(a.ETa)+'" readonly="readonly" aria-label="'+Gt("Link to published document.")+" "+Z(a.YDa)+'"><div id="pub-dialog-sharing-services" class="pub-dialog-link-content-div"><label for="pub-dialog-sharing-services-links">Or share this link using:</label><span id="pub-dialog-sharing-services-links"></span></div></div><div id="pub-dialog-embed-tab-content" style="display:none"><div id="pub-dialog-embed-options"></div><textarea id="pub-dialog-embed-code" rows="3" cols="60" class="pub-dialog-embed-code jfk-textinput" readonly="readonly" aria-label="'+
Gt("HTML embed code of published document.")+" "+Z(a.YDa)+'">'+Lxa(a.KTa)+'</textarea></div></div><div id="pub-dialog-links-notice"></div>'+Ft(Mt({id:"pub-dialog-publish-link-button",style:2,value:a.tjb}))+'<div class="pub-dialog-sep-div"><hr class="pub-dialog-sep"></div><div class="pub-dialog-settings"><div id="pub-dialog-settings-header" class="pub-dialog-zippy-header">'+Ft(ZD({Rs:"pub-dialog-settings-zippy-icon",icon:"docs-icon-img docs-zippy-closed"}))+'Published content & settings</div><div id="pub-dialog-settings-content" class="pub-dialog-zippy-content"><div id="pub-dialog-published-content"></div>'+
Ft(Mt({id:"pub-dialog-publish-button",value:a.rjb}))+'<div class="pub-dialog-checkbox-container">');a.oeb&&(c="Require viewers to sign in with their "+(Y(a.domain)+" account"),b+=Ft(yL({id:"pub-dialog-dom-signin-req",checked:a.Sp,disabled:a.cE}))+' <label for="pub-dialog-dom-signin-req" id="pub-dialog-dom-signin-req-label"'+(a.cE?'class="pub-dialog-disabled-text"':"")+">"+c+"</label><br>");a.yJ&&(b+=Ft(yL({id:"pub-dialog-auto-publish-checkbox"}))+' <label for="pub-dialog-auto-publish-checkbox" id="pub-dialog-auto-publish-checkbox-label">Automatically republish when changes are made</label>');
return mt(b+"</div></div></div></div>")};function a2(a,b,c,d,e,f,h,k,l,m){is.call(this);this.Ub=a||"";this.yl=b;this.fh=c;this.jg=d;this.Rf=l||"/publishsettings";this.B=new Y2b(e);this.Fc=new O2b([new U2b,new T2b,new S2b,new V2b]);this.cb(this.Fc);this.Y=new WD(null,this.Z());this.cb(this.Y);this.U=new WD(null,this.Z());this.cb(this.U);this.vb=new zL(void 0,this.Z());this.cb(this.vb);this.$=new zL(void 0,this.Z());this.cb(this.$);this.zb=0;this.fd=new Z2b;this.cb(this.fd);this.rc=this.Hc=null;this.J=f||new Z1;this.cb(this.J);this.D=h||new Z1;
this.cb(this.D);this.sb=k||new $1;this.cb(this.sb);this.L=this.K=null;this.Ib=new $L(void 0,$2b,this.Z(),2);K(this,this.Ib);this.Tk=this.Mh=null;this.Fm=m||new S;this.Ce=this.Ab=this.cd=null;this.Li=!0}z(a2,is);var $2b="Press "+((zf?"\u2318+C":"Ctrl+C")+" to copy.");r=a2.prototype;r.show=function(){a3b(this,v(function(){this.setVisible(!0)},this))};r.setVisible=function(a){a2.O.setVisible.call(this,a);var b=zm(this.Z());a?U(this).M(b,"resize",this.jl):U(this).ed(b,"resize",this.jl)};
r.jb=function(){a2.O.jb.call(this);var a=this.Z(),b=Ds(X2b,{oeb:!!this.B.domain,yJ:this.B.yJ(),Sp:this.B.Sp,domain:this.B.B,cE:this.B.cE,rjb:b3b(this),tjb:b2(this,c3b(this))?"Published":"Publish",ETa:this.B.dj?d3b(this,this.J.oR()):"",KTa:this.B.dj?e3b(this,this.D.oR()):"",locale:"en",YDa:$2b});a.appendChild(this.Ob(),b);Tr(this,"Publish to the web");cs(this,null);Br(this.Ob(),"pub-dialog-content")};
r.$a=function(){var a=this.Z(),b=a.getElement("pub-dialog-sharing-services-links");this.Fc.render(b);b=a.getElement("pub-dialog-link-options");this.J.render(b);b=a.getElement("pub-dialog-embed-options");this.D.render(b);this.cd=a.getElement("pub-dialog-links-notice");this.Fm.render(this.cd);b=a.getElement("pub-dialog-published-content");this.sb.render(b);a2.O.$a.call(this);var b=U(this),c=a.getElement("pub-dialog-dom-signin-req");c&&(this.vb.rb(c),xL(this.vb,a.getElement("pub-dialog-dom-signin-req-label")),
b.M(this.vb,"change",this.Nnb));this.B.yJ()&&(this.$.rb(a.getElement("pub-dialog-auto-publish-checkbox")),xL(this.$,a.getElement("pub-dialog-auto-publish-checkbox-label")),b.M(this.$,"change",this.Jnb));this.Hc=a.getElement("pub-dialog-link-tab-content");this.K=a.getElement("pub-dialog-document-link");this.rc=a.getElement("pub-dialog-embed-tab-content");this.L=a.getElement("pub-dialog-embed-code");WL(this.Ib,this.K);this.fd.rb(a.getElement("pub-dialog-links-tab-bar"));this.Mh=a.getElement("pub-dialog-sharing-services");
this.Tk=a.getElement("pub-dialog-status-info");this.Y.rb(a.getElement("pub-dialog-publish-link-button"));this.U.rb(a.getElement("pub-dialog-publish-button"));this.Ce=new QD("pub-dialog-settings-header","pub-dialog-settings-content",this.B.dj);K(this,this.Ce);b.M(this.fd,"select",this.h$a).M(this.K,"focus",this.dFa).M(this.L,"focus",this.dFa).M(this.U,"action",this.vjb).M(this.getElement(),"keyup",this.VSa).M(this.J,"Xe",this.tia).M(this.D,"Xe",this.tia).M(this.Y,"action",this.p8a).M(this.sb,"Ye",
this.q8a).M(this.Ce,"toggle",this.jl);c2(this)};function c2(a){if(a.Jc()){var b=a.Z(),c=a.B.dj,d=a.B.cE;a.sb.H(a.B.Ok);a.vb.Ta(!d);a.U.setContent(b3b(a));a.U.Ta(a.B.dj||!a.B.Ok||!a.B.Ok.isEmpty());a.B.yJ()&&a.$.Dc(a.B.Ms);a.tia();b=wm(b,"pub-dialog-state-publishing");A(b,function(a){R(a,c)});a.Tk.innerHTML=c?"This document is published to the web.":"This document is not published to the web.";a.jl()}}r.VSa=function(a){this.ib()&&27==a.keyCode&&a.stopPropagation()};
function f3b(a,b){var c=window.location.href,d=wj(c),c=Bj(c),e=Wa(c,"/"+a.jg+"/")?"/"+a.jg:"";a.B.Sp&&a.B.domain&&(e="/a/"+a.B.domain+e);var c=d[1],f=d[2],h=d[3],d=d[4],k;k=a.Ub;k=Zja.test(b)?b:Jj("/d/"+k,b);return vj(c,f,h,d,Jj(e,k))}
r.tia=function(){var a=this.J.FE();if(a=b2(this,a)){var b=this.B.dj?d3b(this,this.J.oR()):"";this.K.value=b;this.Fc.D=[new L2b(b,this.yl)]}R(this.K,a);R(this.Mh,a&&!this.B.cE);a=this.D.FE();if(a=b2(this,a))this.L.value=this.B.dj?e3b(this,this.D.oR()):"";R(this.L,a);a=b2(this,c3b(this));R(this.cd,a);this.Y.Ta(!a);this.Y.setContent(b2(this,c3b(this))?"Published":"Publish")};
r.h$a=function(a){a=a.target;this.Z();YL(this.Ib);"pub-dialog-link-tab"==a.getId()?(this.zb=0,R(this.Hc,!0),R(this.rc,!1),WL(this.Ib,this.K)):"pub-dialog-embed-tab"==a.getId()&&(this.zb=1,R(this.Hc,!1),R(this.rc,!0),WL(this.Ib,this.L));c2(this)};r.dFa=function(a){Wj(function(){a.target.select()},0)};r.Nnb=function(){this.B.dj?g3b(this,2):this.B.Sp=!this.B.Sp};r.Jnb=function(){this.B.dj?g3b(this,0):this.B.Ms=!this.B.Ms};function b3b(a){return a.B.dj?"Stop publishing":"Start publishing"}
function a3b(a,b){Ai(a.fh.bf(a.Rf).pf("id",a.Ub),v(function(a){this.B.dj=!!Pj(a,"published");this.B.Sp=!!Pj(a,"requireSignin");this.B.cE=!!Pj(a,"domainClosed");this.B.domain=O1b(a,"domain");this.B.B=O1b(a,"domainDisplay");this.B.Ms=!Number(Pj(a,"revision"));this.B.Ok=this.Yua(a.yf());b()},a)).we()}r.Yua=Ic;r.Lua=Ic;function h3b(a){return{Ms:a.B.Ms,dj:a.B.dj,Sp:a.B.Sp,Ok:a.B.Ok}}
function g3b(a,b){var c=h3b(a);switch(b){case 0:c.Ms=!c.Ms;break;case 1:c.dj=!c.dj;break;case 2:c.Sp=!c.Sp;break;default:throw Error("Unknown toggle op: "+b);}c.dj||(c.Ok=a.Lua());i3b(a,c,!0)}
function i3b(a,b,c){j3b(a,!1);zi(Ai(xi(Ci(a.fh.bf(a.Rf).pf("id",a.Ub),k3b(a,b)),2),v(function(){this.B.Ms=b.Ms;this.B.dj=b.dj;this.B.Sp=b.Sp;this.B.Ok=b.Ok;this.B.dj&&this.B.Ok&&(b2(this,this.J.FE())||this.J.bga(this.B.Ok),b2(this,this.D.FE())||this.D.bga(this.B.Ok));j3b(this,!0);c2(this);if(c&&this.B.dj)switch(this.zb){case 0:this.K.focus();this.K.select();break;case 1:this.L.focus();this.L.select();break;default:throw Error("Cannot handle selected link type "+this.zb);}},a)),v(function(){nVb("Error",
"An error occurred while saving publishing settings.",void 0,this.Jc()?this:void 0);j3b(this,!0);c2(this)},a)).we()}function k3b(a,b){var c={id:a.Ub,requireSignin:b.Sp,published:b.dj};a.B.yJ()&&!b.Ms&&(c.revision=a.B.C);if(b.Ok){var d=l3b(b.Ok);sc(c,d)}return c}function j3b(a,b){for(var c=[a.$,a.U,a.Y,a.vb],d=0;d<c.length;d++){var e=c[d];!b&&e.Bt()&&(a.Ab=e);e.Ta(b)}b&&a.Ab&&(a.ib()&&a.Ab.ib()&&(c=a.Ab.getElement())&&c.focus(),a.Ab=null);a.sb.J(b)}
r.vjb=function(a,b){if(b||window.confirm(this.B.dj?"Are you sure you want to stop publishing this document?":"Are you sure you want to publish this document?"))this.U.setContent("Saving..."),g3b(this,1)};function c3b(a){switch(a.zb){case 0:return a.J.FE();case 1:return a.D.FE();default:throw Error("Cannot handle selected link type "+a.zb);}}
r.p8a=function(){if(window.confirm("Are you sure you want to publish this selection?")){var a=c3b(this),b=h3b(this);b.dj=!0;a&&(b.Ok&&this.B.dj?b.Ok=m3b(b.Ok,a):b.Ok=a);this.Y.setContent("Publishing...");i3b(this,b,!0)}};r.q8a=function(){var a=this.sb.D();if(this.B.dj)if(a&&a.isEmpty())g3b(this,1);else{var b=h3b(this);b.Ok=a;i3b(this,b)}else this.B.Ok=a,c2(this)};function b2(a,b){var c;(c=a.B.dj)&&!(c=!b||!a.B.Ok)&&(c=a.B.Ok,c=c.D||!b.D&&rb(b.C.Xc(),c.n1,c)&&rb(b.B,c.j1,c));return c}
function Y2b(a){this.C=a;this.cE=this.Sp=this.dj=!1;this.Ms=!0;this.B=this.domain=""}Y2b.prototype.yJ=function(){return!!this.C};function Z2b(){k_.call(this)}z(Z2b,k_);Z2b.prototype.tj=function(a){return a.keyCode&&27==a.keyCode?!1:Z2b.O.tj.call(this,a)};function d2(a,b,c,d){this.C=a;this.Xg=b;this.Cl=c;this.B=d}function n3b(a,b){return new d2(!1,null,new o3b(a,b||"interactive"),null)}function o3b(a,b){this.id=a;this.format=b};function e2(a,b,c){this.D=a;this.C=new Lg(b);this.B=c}r=e2.prototype;r.n1=function(a){return this.D||this.C.contains(a)};function p3b(a,b){return qb(a.B,function(a){return a.id==b.id})}r.j1=function(a){return this.D||this.C.contains(a.Xg)||p3b(this,a)};function q3b(a,b){a.B=nb(a.B,function(a){return a.Xg!=b})}function r3b(a,b){p3b(a,b)&&(a.B=nb(a.B,function(a){return a.id!=b.id}))}
function m3b(a,b){var c=a.D||b.D;if(c)return new e2(c,[],[]);var d=a.clone();A(b.C.Xc(),function(a){d.C.contains(a)||(d.C.add(a),q3b(d,a))});A(b.B,function(a){d.j1(a)||d.B.push(a)});return d}function l3b(a){return a.D?{entireDocument:"true"}:{entireDocument:"false",sheets:a.C.Xc().join(","),charts:ob(a.B,function(a){return a.id}).join(",")}}r.isEmpty=function(){return!this.D&&this.C.isEmpty()&&wb(this.B)};r.clone=function(){return new e2(this.D,this.C.Xc(),Gb(this.B))};
r.equals=function(a){return this.D==a.D&&this.C.equals(a.C)&&Qb(this.B,a.B,function(a,c){return a.id==c.id&&a.Xg==c.Xg})};function s3b(a,b){this.id=a;this.Xg=b};function f2(a,b,c,d){S.call(this,void 0);this.B=c||new d2(!0,null,null,"html");this.J=d;this.L=a;this.K=b;this.C=new JD("",t3b(a,b));kU(this.C,!0);this.cb(this.C,!0);a=new bD;a.cb(new XC("Interactive","interactive"),!0);a.cb(new XC("Image","image"),!0);this.H=new JD("",a);this.cb(this.H,!0);a=new bD;a.cb(new XC("Web page","html"),!0);a.cb(new XC("Comma-separated values (.csv)","csv"),!0);a.cb(new XC("Tab-separated values (.tsv)","tsv"),!0);a.cb(new XC("PDF document (.pdf)","pdf"),!0);a.cb(new XC("Microsoft Excel (.xlsx)",
"xlsx"),!0);a.cb(new XC("OpenDocument spreadsheet (.ods)","ods"),!0);this.D=new JD("",a);this.cb(this.D,!0);u3b(this)}z(f2,Z1);var v3b=["xlsx","ods"],w3b=["csv","tsv"];
function t3b(a,b){var c=new bD;c.cb(new XC("Entire Document",new x3b("entireDocument",null)),!0);c.cb(new aD,!0);var d=b.C_();A(a.C,function(a){c.cb(new XC(a.B,new x3b("sheet",a.wb())),!0);if(a=d[a.wb()])for(var b=0;b<a.length;b++){var h=a[b];6==h.fb()&&h.isSaved()&&(h=new XC(M1b(h),new x3b("chart",Xz(h))),c.cb(h,!0),Br(h.Ob(),"pub-dialog-link-options-chart-menu-item"))}});return c}r=f2.prototype;
r.$a=function(){f2.O.$a.call(this);Br(this.getElement(),"pub-dialog-link-options-container");Br(this.C.getElement(),"pub-dialog-link-options-document-part-menu-button");Br(this.C.Ob(),"pub-dialog-link-options-document-part-menu-button-content");Br(this.C.hc().getElement(),"pub-dialog-link-options-document-part-menu");yr(this.C.qa,"Sheet or chart selection");yr(this.H.qa,"Chart format");yr(this.D.qa,"Sheet format");U(this).M(this.C,"change",this.d1a).M(this.H,"change",this.JZa).M(this.D,"change",this.I$a).M(this.C,
"afterhide",function(a){a.stopPropagation()}).M(this.H,"afterhide",function(a){a.stopPropagation()}).M(this.D,"afterhide",function(a){a.stopPropagation()})};r.d1a=function(){var a=this.C.$e().bb();switch(a.type){case "entireDocument":this.B=new d2(!0,null,null,this.B.B||"html");break;case "sheet":var a=a.id,b=this.B.B;b&&!y3b(this,a,b)&&(b=null);this.B=new d2(!1,a,null,b||"html");break;case "chart":this.B=n3b(a.id,this.B.Cl?this.B.Cl.format:null)}u3b(this);W2b(this)};
r.JZa=function(){var a=this.H.$e().bb();this.B.Cl&&(this.B.Cl.format=a,W2b(this))};r.I$a=function(){var a=this.D.$e().bb();this.B.B=a;W2b(this)};
function u3b(a){var b=kD(a.C.Hn()),b=sb(b,function(a){a=a.bb();if(!a)return!1;switch(a.type){case "entireDocument":return this.B.C;case "sheet":return null!=this.B.Xg&&a.id==this.B.Xg;case "chart":return null!=this.B.Cl&&a.id==this.B.Cl.id;default:return!1}},a);oD(a.C,b);b=!!a.B.Cl;R(a.H.getElement(),b);null!=a.B.Cl&&a.H.ob(a.B.Cl.format);R(a.D.getElement(),a.J&&mma&&!b);b||(z3b(a),a.D.ob(a.B.B))}
function z3b(a){for(var b=a.D.hc(),c=0;c<b.Uj();c++){var d;d=b.Ee(c);var e=d.La();d.Ta(null==a.B.Xg||y3b(a,a.B.Xg,e))}}function y3b(a,b,c){if(vb(v3b,c))return!1;a=gr(a.L,b);return null!=a&&1==a.getSheetType()&&vb(w3b,c)?!1:!0}r.oR=g("B");r.FE=function(){if(this.B.C)return new e2(!0,[],[]);if(null!=this.B.Xg)return new e2(!1,[this.B.Xg],[]);var a=this.K.getEmbeddedObject(this.B.Cl.id),a=new s3b(this.B.Cl.id,a.wb());return new e2(!1,[],[a])};
r.bga=function(a){if(!a.D){var b=a.C.Xc();0<b.length?this.B=new d2(!1,b[0],null,"html"):(a=a.B,0<a.length&&(this.B=n3b(a[0].id)));u3b(this)}};function x3b(a,b){this.type=a;this.id=b};function g2(a,b){hD.call(this,void 0,void 0,new ID,void 0);this.zb=a;this.qb=b;this.C=new e2(!0,[],[]);this.Na=!1;this.L=new ND("Entire Document");this.Ye(this.L);this.Ye(new aD);A3b(this);kU(this,!0);B3b(this)}z(g2,hD);function A3b(a){var b=a.qb.C_();A(a.zb.C,function(a){var d=new ND(a.B,a);this.Ye(d);(a=b[a.wb()])&&A(a,function(a){6==a.fb()&&a.isSaved()&&(a=new ND(M1b(a),a),this.Ye(a),Br(a.Ob(),"pub-dialog-published-content-chart-menu-item"))},this)},a)}
g2.prototype.$a=function(){g2.O.$a.call(this);Br(this.getElement(),"pub-dialog-published-content-menu-button");Br(this.Ob(),"pub-dialog-published-content-menu-button-content");Br(this.hc().getElement(),"pub-dialog-published-content-menu");U(this).M(this,"afterhide",function(a){a.stopPropagation()})};
g2.prototype.Vr=function(a){if(a.target==this.L){a=this.L.isChecked();var b=this.C;if(b.D=a)b.C.clear(),b.B=[]}else b=a.target,a=b.isChecked(),b=b.bb(),b instanceof Co?(b=b.wb(),a?(a=this.C,a.C.contains(b)||(a.C.add(b),q3b(a,b))):(a=this.C,a.C.contains(b)&&(a.C.remove(b),q3b(a,b)))):(b=new s3b(Xz(b),b.wb()),a?(a=this.C,a.j1(b)||a.B.push(b)):r3b(this.C,b));this.Na=!0;B3b(this)};g2.prototype.ge=function(a,b){g2.O.ge.call(this,a,b);!a&&this.Na&&(this.Na=!1,this.dispatchEvent(new M("Ye")))};
function B3b(a){var b=a.C.D;a.L.Dc(b);A(WUb(a.hc()),function(a){var d=a.bb();d&&(d instanceof Co?(a.Dc(this.C.n1(d.wb())),a.Ta(!b)):(d=new s3b(Xz(d),d.wb()),a.Dc(this.C.j1(d)),a.Ta(!this.C.n1(d.Xg))))},a);C3b(a)}
function C3b(a){var b;if(a.C.D)b="Entire Document";else{b=nb(a.zb.C,v(function(a){return this.C.n1(a.wb())},a));b=ob(b,function(a){return a.B});for(var c=[],d=a.C.B,e=0;e<d.length;e++){var f=a.qb.getEmbeddedObject(d[e].id);f&&c.push(M1b(f))}b=Fb(b,c);b=0<b.length?b.join(", "):"None"}a.setContent(b)};function h2(a,b){S.call(this,void 0);this.B=new g2(a,b);this.cb(this.B,!0);this.C=!1}z(h2,$1);h2.prototype.$a=function(){h2.O.$a.call(this);Br(this.getElement(),"pub-dialog-published-content-container")};h2.prototype.D=function(){return this.B.C};h2.prototype.H=function(a){var b=this.B;b.C=a.clone();B3b(b)};h2.prototype.J=function(a){!a&&this.B.Bt()&&(this.C=!0);this.B.Ta(a);a&&this.C&&(this.Jc()&&(a=this.B.getElement())&&a.focus(),this.C=!1)};function D3b(a){a=a||{};var b="";a='<span class="pub-dialog-chart-notice-emphasis">Note:</span> Viewers may be able to access the underlying data for published charts. '+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+T1b(a.locale)+'&answer=183965#publishcharts">Learn more</a>');return mt(b+('<div class="pub-dialog-chart-notice">'+a+"</div>"))};function E3b(a,b,c,d,e,f,h){var k=null!=h?n3b(h):null;h=new f2(c,d,k,!0);k=new f2(c,d,k,!1);a2.call(this,a,b,e,Bla,f,h,k,new h2(c,d),"/publishingsettings",new F3b);this.qn=c;this.Ff=d}z(E3b,a2);
E3b.prototype.Yua=function(a){if(a.entireDocument)return new e2(!0,[],[]);var b=a.charts||"";a=ob((a.sheets||"").split(","),function(a){return parseInt(a,10)});a=nb(a,function(a){return null!=gr(this.qn,a)},this);b=ob(b.split(","),function(a){return parseInt(a,10)});b=nb(b,v(function(a){return!!this.Ff.getEmbeddedObject(a)},this));b=ob(b,function(a){var b=this.Ff.getEmbeddedObject(a);return new s3b(a,b.wb())},this);return new e2(!1,a,b)};E3b.prototype.Lua=function(){return new e2(!0,[],[])};
function d3b(a,b){var c;if(b.C||null!=b.Xg){var d="html"==b.B;c=f3b(a,d?"/pubhtml":"/pub");null!=b.Xg&&(c=Ej(c,"gid",b.Xg,"single","true"));d||(c=Ej(c,"output",b.B))}else c=Ej(f3b(a,"/pubchart"),"oid",b.Cl.id,"format",b.Cl.format);return c}
function e3b(a,b){var c=d3b(a,b);if(b.C||null!=b.Xg)c=Ej(c,"widget","true","headers","false");var d;d=b.Cl?(d=a.Ff.getEmbeddedObject(b.Cl.id))?d.R:null:null;return"<iframe "+(d?'width="'+d.width+'" height="'+d.height+'" seamless frameborder="0" scrolling="no" ':"")+'src="'+Ua(c)+'"></iframe>'}function F3b(){}z(F3b,S);F3b.prototype.jb=function(){this.qa=Ds(D3b,{locale:"en"})};function G3b(a,b,c){return sVb(a||"There was a problem",b,void 0,c)};function H3b(a){return"<div><div>"+Lt(a.EPa)+"</div>"+yL({id:"waffle-confirm-suppress-checkbox",Wd:"waffle-confirm-suppress-checkbox"})+'<span id="waffle-confirm-suppress-label">'+Y(a.iha)+"</span></div>"};function I3b(a,b,c,d,e,f,h){var k;ra(c)?(k=new $r,k.set("ok",c.ok,!0),k.set("cancel",c.cancel,!1,!0)):k=Gva;return J3b(d||"Heads up!",a,b,k,e,f,h)}function J3b(a,b,c,d,e,f,h){var k;if(f){b=H3b({EPa:b,iha:f});k=new zL;var l=c;c=function(){l(k.isChecked())}}a=S1b(a,b,c,e||null,void 0,void 0,d,h);k&&(a.cb(k),k.rb(um(a.Z(),"waffle-confirm-suppress-checkbox")),b=um(a.Z(),"waffle-confirm-suppress-label"),xL(k,b),k.Dc(!1));return a};function i2(a,b){qq.call(this,36,null);this.C=a;this.Zc=b}z(i2,qq);i2.prototype.exec=Ic;i2.prototype.Xd=p(38);i2.prototype.Td=function(){var a=new rp;I(a,2,this.C);I(a,1,this.Zc);return a};i2.prototype.qf=function(){return G(this.C,1)?"Data validation applied.":"Data validation cleared."};function K3b(a,b){if("FORM"==a.tagName)for(var c=a.elements,d=0;a=c[d];d++)K3b(a,b);else 1==b&&a.blur(),a.disabled=b};function j2(){}z(j2,pB);ia(j2);r=j2.prototype;r.ut=ba();r.rb=function(a,b){uB(a,!1);AB(a,255);a.dg(32,!1);j2.O.rb.call(this,a,b);a.setContent(b.value);return b};r.ji=function(a){uB(a,!1);AB(a,255);a.dg(32,!1);return a.Z().Ja("TEXTAREA",{"class":this.Fq(a).join(" "),disabled:!a.isEnabled()},a.getContent()||"")};r.hF=function(a){return"TEXTAREA"==a.tagName};r.T_=ha;r.Ol=function(a){return a.isEnabled()};r.wA=ha;r.OR=function(a,b,c){j2.O.OR.call(this,a,b,c);(a=a.getElement())&&1==b&&(a.disabled=c)};
r.$q=ha;r.setContent=function(a,b){a&&(a.value=b)};r.tc=p("goog-textarea");function k2(a,b,c){tB.call(this,a,b||j2.getInstance(),c);uB(this,!1);EOa(this,!0);this.VK=""!=a;a||this.tG("")}z(k2,tB);var L3b=!(tf&&!(11<=Df));r=k2.prototype;r.xK=!1;r.Q0=!1;r.VK=!1;r.Qc=0;r.$va=0;r.sea=0;r.wza=!1;r.X1=!1;r.Zfa=!1;r.Yfa=!1;r.fM="";function M3b(a){return a.B.top+a.B.bottom+a.C.top+a.C.bottom}function N3b(a){var b=a.sea,c=a.getElement();b&&c&&a.X1&&(b-=M3b(a));return b}r.ob=function(a){this.setContent(String(a))};
r.La=function(){return this.getElement().value!=this.fM||O3b(this)||this.VK?this.getElement().value:""};r.setContent=function(a){k2.O.setContent.call(this,a);this.VK=""!=a;this.resize()};r.Ta=function(a){k2.O.Ta.call(this,a);this.getElement().disabled=!a};r.resize=function(){this.getElement()&&this.p0()};function O3b(a){a.getElement();return"placeholder"in a.getElement()}
function P3b(a){if(a.fM)if(O3b(a))a.getElement().placeholder=a.fM;else if(a.getElement()&&!a.VK&&!a.Q0){var b=a.getElement();Br(b,"textarea-placeholder-input");a.getElement().value=a.fM}}
r.$a=function(){k2.O.$a.call(this);var a=this.getElement();on(a,{overflowY:"hidden",overflowX:"auto",boxSizing:"border-box",MsBoxSizing:"border-box",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box"});this.B=Pn(a);this.C=zn(a);U(this).M(a,"scroll",this.p0).M(a,"focus",this.p0).M(a,"keyup",this.p0).M(a,"mouseup",this.Kfb).M(a,"blur",this.rOa);P3b(this);this.resize()};
function Q3b(a){if(!a.wza){var b=a.getElement().cloneNode(!1);on(b,{position:"absolute",height:"auto",top:"-9999px",margin:"0",padding:"1px",border:"1px solid #000",overflow:"hidden"});a.Z().Eb().body.appendChild(b);var c=b.scrollHeight;b.style.padding="10px";var d=b.scrollHeight;a.Zfa=d>c;b.style.borderWidth="10px";a.Yfa=b.scrollHeight>d;b.style.height="100px";100!=b.offsetHeight&&(a.X1=!0);dm(b);a.wza=!0}b=a.getElement();isNaN(a.B.top)&&(a.B=Pn(b),a.C=zn(b));var c=a.getElement().scrollHeight,e=
a.getElement(),d=e.offsetHeight-e.clientHeight;if(!a.Zfa)var f=a.B,d=d-(f.top+f.bottom);a.Yfa||(e=zn(e),d-=e.top+e.bottom);c=c+(0<d?d:0);a.X1?c-=M3b(a):(a.Zfa||(d=a.B,c+=d.top+d.bottom),a.Yfa||(a=zn(b),c+=a.top+a.bottom));return c}function l2(a,b){a.Qc!=b&&(a.Qc=b,a.getElement().style.height=b+"px")}function R3b(a){var b=a.getElement();b.style.height="auto";var c=b.value.match(/\n/g)||[];b.rows=c.length+1;a.Qc=0}r.rOa=function(){O3b(this)||(this.Q0=!1,""==this.getElement().value&&(this.VK=!1,P3b(this)))};
r.p0=function(a){if(!this.xK){var b=this.getElement();!O3b(this)&&a&&"focus"==a.type&&(b.value==this.fM&&this.fM&&!this.Q0&&(Dr(b,"textarea-placeholder-input"),b.value=""),this.Q0=!0,this.VK=""!=b.value);var c=!1;this.xK=!0;a=this.Qc;if(b.scrollHeight){var d=!1,e=!1,f=Q3b(this),h=b.offsetHeight,k=N3b(this),l;l=this.$va;var m=this.getElement();l&&m&&this.X1&&(l-=M3b(this));k&&f<k?(l2(this,k),d=!0):l&&f>l?(l2(this,l),b.style.overflowY="",e=!0):h!=f?l2(this,f):this.Qc||(this.Qc=f);d||e||!L3b||(c=!0)}else R3b(this);
this.xK=!1;c&&(b=this.getElement(),this.xK||(this.xK=!0,(e=b.scrollHeight)?(f=Q3b(this),c=N3b(this),c&&f<=c||(d=this.B,b.style.paddingBottom=d.bottom+1+"px",Q3b(this)==f&&(b.style.paddingBottom=d.bottom+e+"px",b.scrollTop=0,e=Q3b(this)-e,e>=c?l2(this,e):l2(this,c)),b.style.paddingBottom=d.bottom+"px")):R3b(this),this.xK=!1));a!=this.Qc&&this.dispatchEvent("resize")}};
r.Kfb=function(){var a=this.getElement(),b=a.offsetHeight;a.filters&&a.filters.length&&(a=a.filters.item("DXImageTransform.Microsoft.DropShadow"))&&(b-=a.offX);b!=this.Qc&&(this.Qc=this.sea=b)};function m2(){var a=new JD(null);kU(a,!0);return a};function S3b(a,b,c){N.call(this);this.D=a;this.Ff=b;this.tb=c;this.L=this.H=this.va=this.Y=this.P=this.F=null;this.fc=new TU;this.Ub=new TU;this.U=this.K=null;this.Ib=new TU;this.Hc=new TU;this.R=this.J=null;this.zb=new TU;this.Fc=new TU;this.Na=this.Kb=null;this.B=new k2("");this.vb=this.C=this.hb=this.gb=null;this.rc=this.$c=!1;this.sb=this.Ab=this.Md=this.qb=this.Ya=null;this.Rf=new Ch;this.fd=this.Ce=this.zf=this.cd=this.Lf=this.$=null;var d=this.D,e=b=null,f=c=null,h=null,k=null,l=null,m=null,
n=null,q=null,t=null,w,x,y=null,E=null,D=null,H=null,T=null,V=null,Q=d.Z(),ja=null,na=null,ja=Q.Ja("tr","waffle-dv-trrules",Q.Ja("td","waffle-dv-label",Q.Ja("span",{id:"waffle-dv-criteria"},"Criteria:")),Q.Ja("td",{OVb:"7"},n=Q.Ja("div","goog-inline-block"),na=Q.Ja("div","goog-inline-block"),l=Q.Ja("input",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),c=Q.Ja("input",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),h=Q.Ja("input",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"}),
a=Q.Ja("span","waffle-dv-separator","and"),m=Q.Ja("input",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),f=Q.Ja("input",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),k=Q.Ja("input",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"})));this.zb.rb(l);this.Fc.rb(m);this.Ib.rb(c);this.Hc.rb(f);this.fc.rb(h);this.Ub.rb(k);b=m2();Zn(b,n);y=m2();Zn(y,n);x=m2();Zn(x,n);w=m2();Zn(w,n);q=T3b(d,na);(t=b.getElement())&&tr(t,"labelledby","waffle-dv-criteria");e=Q.Ja("tr",
"waffle-dv-trrules",Q.Ja("td","waffle-dv-label",Q.Ja("span",{"class":"waffle-dv-label",id:"waffle-dv-on-invalid-data"},"On invalid data: ")),Q.Ja("td",{colspan:"7"},Q.Ja("div",{role:"radiogroup","aria-labelledby":"waffle-dv-on-invalid-data"},Q.Ja("input",{type:"radio",id:"showWarningOnInvalidData_radio",name:"onInvalidData",role:"radio"}),Q.Ja("label",{"for":"showWarningOnInvalidData_radio"},"Show warning"),Q.Ja("input",{type:"radio",id:"rejectInvalidData_radio",name:"onInvalidData",role:"radio"}),
Q.Ja("label",{"for":"rejectInvalidData_radio"},"Reject input"))));t=new o0(!0);p0(t,"onInvalidData",e);var ua,La=Q.Ja("tr","waffle-dv-trrules waffle-dv-trrules-appearance",Q.Ja("td",null,Q.Ja("span",{"class":"waffle-dv-label",id:"waffle-dv-appearance"},"Appearance:")),Q.Ja("td",{colspan:"7"},ua=Q.Ja("span","waffle-dv-label waffle-dv-checkbox-label","Display in-cell button to show list"))),D=new zL;xL(D,ua);Zn(D,ua);D.Ta(!1);if(E=D.getElement()){var xa=vr(E,"labelledby");tr(E,"labelledby","waffle-dv-appearance "+
xa)}H=Q.Ja("tr","waffle-dv-trrules",Q.Ja("td"),Q.Ja("td",{colspan:"6","class":"waffle-dv-show-dropdown"},xa=Q.Ja("span","waffle-dv-label waffle-dv-checkbox-label","Show help:"),T=Q.Ja("input",{type:"text","class":"waffle-dv-helptext jfk-textinput"}),V=Q.Ja("span",{"class":"menuMainLink waffle-dv-smalltext","aria-label":"Reset help text to default value."},"Reset")));om(V,!0);E=new zL;xL(E,xa);Zn(E,xa);var hb=E.getElement();hb&&(xa=vr(hb,"labelledby"),tr(hb,"labelledby","waffle-dv-appearance "+xa));
d=d.L.childNodes[0];Q.appendChild(d,ja);Q.appendChild(d,e);Q.appendChild(d,La);Q.appendChild(d,H);this.B.render(n);Q=this.B;Q.sea=29;Q.resize();Q=this.B;Q.$va=200;Q.resize();this.B.getElement().style.width="324px";U3b?this.B.getElement().placeholder="Enter items separated by a comma...":TD(this.B.getElement(),"Enter items separated by a comma...","Enter items separated by a comma...");if(Q=this.B.getElement())yr(Q,"Enter items separated by a comma..."),Cr(Q,["waffle-dv-list-options-textarea","jfk-textinput"]);
ima&&(d=new oE("Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday;Monday, Tuesday, Wednesday, Thursday, Friday;January, February, March, April, May, June, July, August, September, October, November, December;Alabama, Alaska, Arizona, Arkansas, California, Colorado, Connecticut, Delaware, District of Columbia, Florida, Georgia, Hawaii, Idaho, Illinois, Indiana, Iowa, Kansas, Kentucky, Louisiana, Maine, Maryland, Massachusetts, Michigan, Minnesota, Mississippi, Missouri, Montana, Nebraska, Nevada, New Hampshire, New Jersey, New Mexico, New York, North Carolina, North Dakota, Ohio, Oklahoma, Oregon, Pennsylvania, Rhode Island, South Carolina, South Dakota, Tennessee, Texas, Utah, Vermont, Virginia, Washington, West Virginia, Wisconsin, Wyoming;AK, AL, AR, AZ, CA, CO, CT, DC, DE, FL, GA, HI, IA, ID, IL, IN, KS, KY, LA, MA, MD, ME, MI, MN, MO, MS, MT, NC, ND, NE, NH, NJ, NM, NV, NY, OH, OK, OR, PA, RI, SC, SD, TN, TX, UT, VA, VT, WA, WI, WV, WY;United States of America, USA, Afghanistan, Albania, Algeria, Andorra, Angola, Antigua & Deps, Argentina, Armenia, Australia, Austria, Azerbaijan, Bahamas, Bahrain, Bangladesh, Barbados, Belarus, Belgium, Belize, Benin, Bhutan, Bolivia, Bosnia Herzegovina, Botswana, Brazil, Brunei, Bulgaria, Burkina, Burma, Burundi, Cambodia, Cameroon, Canada, Cape Verde, Central African Republic, Chad, Chile, China, People's Republic of China, Republic of China, Colombia, Comoros, Democratic Republic of the Congo, Republic of the Congo, Costa Rica, Croatia, Cuba, Cyprus, Czech Republic, Danzig, Denmark, Djibouti, Dominica, Dominican Republic, East Timor, Ecuador, Egypt, El Salvador, Equatorial Guinea, Eritrea, Estonia, Ethiopia, Fiji, Finland, France, Gabon, The Gambia, Georgia, Germany, Ghana, Greece, Grenada, Guatemala, Guinea, Guinea-Bissau, Guyana, Haiti, Holy Roman Empire, Honduras, Hungary, Iceland, India, Indonesia, Iran, Iraq, Republic of Ireland, Israel, Italy, Ivory Coast, Jamaica, Japan, Jonathanland, Jordan, Kazakhstan, Kenya, Kiribati, North Korea, South Korea, Kosovo, Kuwait, Kyrgyzstan, Laos, Latvia, Lebanon, Lesotho, Liberia, Libya, Liechtenstein, Lithuania, Luxembourg, Macedonia, Madagascar, Malawi, Malaysia, Maldives, Mali, Malta, Marshall Islands, Mauritania, Mauritius, Mexico, Micronesia, Moldova, Monaco, Mongolia, Montenegro, Morocco, Mount Athos, Mozambique, Namibia, Nauru, Nepal, Newfoundland, Netherlands, New Zealand, Nicaragua, Niger, Nigeria, Norway, Oman, Ottoman Empire, Pakistan, Palau, Palestine, Panama, Papua New Guinea, Paraguay, Peru, Philippines, Poland, Portugal, Prussia, Qatar, Romania, Rome, Russian Federation, Rwanda, St Kitts & Nevis, St Lucia, Saint Vincent, Grenadines, Samoa, San Marino, Sao Tome & Principe, Saudi Arabia, Senegal, Serbia, Seychelles, Sierra Leone, Singapore, Slovakia, Slovenia, Solomon Islands, Somalia, South Africa, Spain, Sri Lanka, Sudan, Suriname, Swaziland, Sweden, Switzerland, Syria, Tajikistan, Tanzania, Thailand, Togo, Tonga, Trinidad & Tobago, Tunisia, Turkey, Turkmenistan, Tuvalu, Uganda, Ukraine, United Arab Emirates, United Kingdom, Uruguay, Uzbekistan, Vanuatu, Vatican City, Venezuela, Vietnam, Yemen, Zambia, Zimbabwe;Pass, Fail;Yes, No;Approved, Rejected;Approved, Rejected, Pending;Complete, In Progress, Not Started;On Track, At Risk, Delayed;True, False;Q1, Q2, Q3, Q4;Small, Medium, Large;XS, S, M, L, XL;A+, A, A-, B+, B, B-, C+, C, C-, D, F".split(";"),
!0),e=new vE,ja=new AE(null,null,!1),d=new lE(d,e,ja),ja.B=d,ja.VR(Q),d.Qd().ZO=!0);this.C=T;b.setVisible(!0);T=b;Q=y;ja=V3b(this);W3b(this,ja,T);ja=X3b(this);W3b(this,ja,w);ja=Y3b(this);W3b(this,ja,Q);ja=Z3b(this);W3b(this,ja,x);$3b(this,b,w,y,x,l,m,c,f,h,k,a,n,q,H,D,ua,V,E,na,t);a4b(this)}z(S3b,N);
var U3b="placeholder"in document.createElement("input"),b4b=/\s*,\s*/,c4b=new Eg(9,"tc",10,"ntc",13,"te",14,"tem",15,"tu",16,"de",17,"deb",19,"dob",18,"dea",20,"doa",21,"dbw",22,"ndb",30,"isd",7,"bw",8,"nbw",3,"lt",4,"lte",1,"gt",2,"gte",5,"eq",6,"neq",23,"ofrb",24,"ofc",29,"cf"),d4b=c4b.aH();
function V3b(a){var b=a.fd;b||(b=[{Rg:"List from a range",type:4},{Rg:"List of items",type:3},{Rg:"Number",type:0},{Rg:"Text",type:1},{Rg:"Date",type:2}],b.push({Rg:"Custom formula is",type:5}),a.fd=b);return b}function Y3b(a){var b=a.Ce;b||(b=[{Rg:"contains",code:"tc",He:0,Ch:"Approved"},{Rg:"does not contain",code:"ntc",He:0,Ch:"Approved"},{Rg:"equals",code:"te",He:0,Ch:"Approved"},{Rg:"is valid email",code:"tem",He:-1,Ch:null},{Rg:"is valid url",code:"tu",He:-1,Ch:null}],a.Ce=b);return b}
function Z3b(a){var b=a.cd;b||(b=[{Rg:"is valid date",code:"isd",He:-1,Ch:null},{Rg:"equal to",code:"de",He:2,Ch:"11/15/2014"},{Rg:"before",code:"deb",He:2,Ch:"11/15/2014"},{Rg:"on or before",code:"dob",He:2,Ch:"11/15/2014"},{Rg:"after",code:"dea",He:2,Ch:"11/15/2014"},{Rg:"on or after",code:"doa",He:2,Ch:"11/15/2014"},{Rg:"between",code:"dbw",He:3,Ch:"11/15/2014",AJ:"11/15/2015"},{Rg:"not between",code:"ndb",He:3,Ch:"11/15/2014",AJ:"11/15/2015"}],a.cd=b);return b}
function e4b(a){var b=a.zf;b||(b=[{Rg:"range",code:"ofrb",He:6,Ch:null},{Rg:"range",code:"ofrbn",He:6,Ch:null},{Rg:"the list of items",code:"ofc",He:5,Ch:"Enter items separated by a comma..."},{Rg:"the list of items",code:"ofcn",He:5,Ch:"Enter items separated by a comma..."},{Rg:"range",code:"ofr",He:6,Ch:null},{Rg:"range",code:"ofrn",He:6,Ch:null}],a.zf=b);return b}
function X3b(a){var b=a.Lf;b||(b=[{Rg:"between",code:"bw",He:8,Ch:"10",AJ:"100"},{Rg:"not between",code:"nbw",He:8,Ch:"10",AJ:"100"},{Rg:"less than",code:"lt",He:7,Ch:"10"},{Rg:"less than or equal to",code:"lte",He:7,Ch:"10"},{Rg:"greater than",code:"gt",He:7,Ch:"10"},{Rg:"greater than or equal to",code:"gte",He:7,Ch:"10"},{Rg:"equal to",code:"eq",He:7,Ch:"10"},{Rg:"not equal to",code:"neq",He:7,Ch:"10"}],a.Lf=b);return b}function f4b(){return{Rg:"",code:"cf",He:0,Ch:"=ISODD(A1)"}}
function $3b(a,b,c,d,e,f,h,k,l,m,n,q,t,w,x,y,E,D,H,T,V){a.F=b;a.F.setVisible(!0);a.Y=c;a.P=e;a.va=d;a.Kb=q;a.J=f;a.R=h;a.K=k;a.U=l;a.H=m;a.L=n;a.Na=t;a.$=w;a.qb=H;a.gb=T;H.Dc(!1);K3b(a.C,!0);a.Ab=V;g4b(a,!1);a.hb=x;y.Dc(!0);a.Ya=y;a.Md=E;h4b(a);i4b(a);a.vb=D}function j4b(a,b){a.Ya.Ta(b);Fr(a.Md,"waffle-dv-label-disabled",!b)}function W3b(a,b,c){for(var d=0;d<b.length;d++){var e=a.D.Z(),e=new XC(b[d].Rg,null,e);c.Ye(e);e=e.getElement();sr(e,"menuitem")}c.Af(0)}r=S3b.prototype;
r.ica=function(){i4b(this);this.C.value=n2(this);this.dispatchEvent("change")};r.g4a=function(){h4b(this);i4b(this);this.C.value=n2(this);this.dispatchEvent("change")};
function a4b(a){a.sb=new P(a);var b=a.sb;b.M(a.F,"action",a.g4a);b.M(a.P,"action",a.ica);b.M(a.Y,"action",a.ica);b.M(a.va,"action",a.ica);b.M(a.C,"focus",function(){this.rc=!0});b.M(a.C,"blur",function(){this.rc=!1});b.M(a.C,"change",a.bca);b.M(a.C,"keyup",a.bca);k4b(a,[a.K,a.U,a.H,a.L,a.J,a.R]);b.M(a.qb,"change",v(a.Xya,a));Hi(b,a.vb,a.m9a)}function k4b(a,b){for(var c=0;c<b.length;c++)a.sb.M(b[c],"change",v(a.ppb,a,b[c])),a.sb.M(b[c],"keyup",v(a.b4a,a,b[c]))}
r.bca=function(a){if(!a||ava(a))this.$c=!0,this.vb.style.visibility=""};r.m9a=function(){this.$c=!1;this.C.value=n2(this)};r.Xya=function(){K3b(this.C,!this.qb.K)};r.ppb=function(a){this.C.value=n2(this);l4b(this,a)?(this.D.wl=0,o2(a),this.dispatchEvent("change")):(this.D.wl=1,p2(a),this.dispatchEvent("error"))};r.b4a=function(){this.dispatchEvent("keyup")};function l4b(a,b){if(0!=q2(a))return!0;var c=b.value;return null!=c&&Jn(b)?nn(c)||!isNaN(gb(c)):!0}
function p2(a){a.select();Br(a,"waffle-input-error")}function o2(a){a&&Dr(a,"waffle-input-error")}function q2(a){return V3b(a)[a.F.Eh()].type}function h4b(a){var b=q2(a),c=!1,d=!1,e=!1,f=!1,h=!1;0==b?d=!0:2==b?c=!0:1==b?e=!0:3==b?f=!0:4==b&&(h=!0);a.P.setVisible(c);a.Y.setVisible(d);a.va.setVisible(e);R(a.Na,f);R(a.gb,h);R(a.J,!1);R(a.R,!1);R(a.K,!1);R(a.U,!1);R(a.H,!1);R(a.L,!1);f&&a.B.resize();a.dispatchEvent("change")}
function m4b(a){var b;null!=n4b(a)?b=n4b(a):a.P.ib()?b=Z3b(a)[a.P.Eh()]:a.Y.ib()?b=X3b(a)[a.Y.Eh()]:5==q2(a)?b=f4b():b=Y3b(a)[a.va.Eh()];return b}function n4b(a){var b=e4b(a);return 4==q2(a)?(Jn(a.hb)&&a.Ya.isChecked(),b[0]):3==q2(a)?(Jn(a.hb)&&a.Ya.isChecked(),b[2]):null}
function i4b(a){var b=!1,c=!1,d=!1,e=!1,f=!1,h=!1,k=!1,l=!1,m=!1,n=m4b(a);-1!=n.He&&(0==n.He?d=!0:1==n.He?k=e=d=!0:2==n.He?f=!0:3==n.He?k=h=f=!0:7==n.He?b=!0:8==n.He?k=c=b=!0:5==n.He?l=!0:6==n.He&&(m=!0));n=m4b(a);if(3==q2(a))U3b?a.B.getElement().placeholder="Enter items separated by a comma...":TD(a.B.getElement(),"Enter items separated by a comma...","Enter items separated by a comma...");else if(n.Ch)if(0==n.He||1==n.He)GZ(a.Ib,"e.g., "+n.Ch),GZ(a.Hc,"e.g., "+n.AJ||"");else if(2==n.He||3==n.He)GZ(a.fc,
"e.g., "+n.Ch),GZ(a.Ub,"e.g., "+n.AJ||"");else if(7==n.He||8==n.He)GZ(a.zb,"e.g., "+n.Ch),GZ(a.Fc,"e.g., "+n.AJ||"");o2(a.B.getElement());o2(a.H);o2(a.L);o2(a.J);o2(a.R);o2(a.K);o2(a.U);o2(a.$.Uo());a.D.wl=0;a.dispatchEvent("change");R(a.J,b);R(a.R,c);R(a.K,d);R(a.U,e);R(a.H,f);R(a.L,h);R(a.Na,l);l&&a.B.resize();R(a.gb,m);j4b(a,l||m);R(a.Kb,k)}function o4b(a){var b=new Pd;b.bd(0);var c=new zd,d=new xd;I(d,1,2);I(d,2,a);c.ob(d);a=new md;a.bd(0);I(c,1,a);I(b,5,c);return b}
function r2(a,b,c){var d=p4b(a.D);if(""==b||null==d.Wc)return null;var e=d.rect,f=e.Rb(),e=e.Pb();return(b=ritz.parseConditionArgument(d.Wc+"",f,e,b,c,!0))?a.Rf.Tc(Pd.oa(),b):null}function q4b(a){var b=Ra(a.$.La());!a.tb.B.C[Ra(Oa(b).toLowerCase())]&&BN(a.tb,b)&&(b=Ubb(a.tb,b,!0));return b}
function n2(a){if(a.$c||a.rc)return a.C.value;var b="",c=!1,d=!1,d=q2(a),c=4==d,d=3==d||4==d;a.P.ib()?(d=Z3b(a)[a.P.Eh()],b=-1==d.He?b+"Enter a valid date":b+"Enter a date "):a.va.ib()?(d=Y3b(a)[a.va.Eh()],b="tem"==d.code?b+"Enter a valid email":"tu"==d.code?b+"Enter a valid url":b+"Enter text that "):d?(d=n4b(a),b+="Click and enter a value from "):5==q2(a)?(d=f4b(),b="Enter a value that satisfies the formula:"):(d=X3b(a)[a.Y.Eh()],b+="Enter a number ");-1!=d.He&&(b+=d.Rg);var e=q4b(a);r4b(d.code)&&
""!=e&&BN(a.tb,e)&&c&&(b+=" "+Ubb(a.tb,e,!0));Ka(Oa(a.K.value))||0!=d.He&&1!=d.He?Ka(Oa(a.H.value))||2!=d.He&&3!=d.He?Ka(Oa(a.J.value))||7!=d.He&&8!=d.He||(b+=" "+a.J.value):b+=" "+a.H.value:b+=" "+a.K.value;Ka(Oa(a.U.value))||1!=d.He?Ka(Oa(a.L.value))||3!=d.He?Ka(Oa(a.R.value))||8!=d.He||(b+=" and "+a.R.value):b+=" and "+a.L.value:b+=" and "+a.U.value;return b}function r4b(a){return"ofrb"==a||"ofrbn"==a||"ofr"==a||"ofrn"==a}
function g4b(a,b){q0(a.Ab,b?"rejectInvalidData_radio":"showWarningOnInvalidData_radio")}function s2(a,b){switch(b){case 0:a.F.Af(2);break;case 1:a.F.Af(3);break;case 2:a.F.Af(4);break;case 3:a.F.Af(1);break;case 4:a.F.Af(0);break;case 5:a.F.Af(5)}}
r.V=function(){L(this.sb);this.R=this.J=this.U=this.K=this.L=this.H=this.sb=null;L(this.B);this.hb=this.Ya=this.vb=this.C=this.Kb=this.B=null;L(this.$);this.$=null;L(this.Ya);this.Ya=null;L(this.va);this.va=null;L(this.Y);this.Y=null;L(this.P);this.P=null;L(this.F);this.F=null;S3b.O.V.call(this)};function t2(a,b,c,d,e){Sr.call(this);this.sb=a;this.Ab=b;this.vb=c;this.zb=d;this.U=e;this.Y=this.K=this.J=this.B=this.$=this.D=this.L=null;this.K=new $r;this.K.set("save","Save",!1);this.K.set("clear","Remove validation",!1,!1);this.K.set("cancel","Cancel",!1,!0);cs(this,this.K);Zr(this,!1);this.render();a=this.Ob();b=Ll(a);Tr(this,"Data validation");this.J||(c=b.Ja("div",{"class":u2.uJa}),d=b.Ja("div",{"class":u2.tJa},c),b.appendChild(a,d),this.J=new ss(d),this.J.bd("warning"),this.J.setContent(""),
this.J.render(c),Xva(this.J,!0),this.J.setVisible(!1));this.L=b.Ja("table",{cellSpacing:"0","class":u2.fI},b.Ja("tbody"));b.appendChild(a,this.L);a=this.Ob();a=Ll(a);b=a.Ja("tr",u2.WMa);b.appendChild(a.Ja("td","waffle-dv-label",a.Ja("label",{id:"waffle-dv-cell-range"},"Cell range: ")));c=a.Ja("td",{colspan:"7"});this.B=T3b(this,c);s4b(this);b.appendChild(c);a.appendChild(this.L.childNodes[0],b);(a=this.B.Uo())&&tr(a,"labelledby","waffle-dv-cell-range");this.D=new S3b(this,this.sb,this.U);ZI(this,
"save");a=this.$=new P(this);a.M(this,"dialogselect",this.opb);a.M(this.D,"error",this.a4a);a.M(this.D,"change",this.npb)}z(t2,Sr);var u2={fI:"waffle-dv-table",WMa:"waffle-dv-trrules",tJa:"waffle-input-error-butter-container",uJa:"waffle-input-error-butter-wrap",SKa:"waffle-input-error"};r=t2.prototype;r.wl=0;function s4b(a){if(a.B){var b=a.sb.getActiveGrid();b&&(b=Ro(BI(du(a.vb)),b.B),a.B.ob(b))}}r.a4a=function(){t4b(this)};r.npb=function(){t4b(this);Hva(this.K,"save",!0)};
r.opb=function(a){if("save"==a.key){var b;b=this.D;var c=q2(b);if(0==c){var c=b.J,d=b.R,e=l4b(b,c),f=l4b(b,d);e&&f?b.D.wl=0:(e||p2(c),f||p2(d),b.D.wl=1)}else 1==c?(c=b.K,d=b.U,e=!Jn(c)||!Ka(Oa(c.value)),f=!Jn(d)||!Ka(Oa(d.value)),e&&f?b.D.wl=0:(e||p2(c),f||p2(d),b.D.wl=6)):2==c?(c=b.H,d=b.L,e=!Jn(c)||!Ka(Oa(c.value)),f=!Jn(d)||!Ka(Oa(d.value)),e&&f?b.D.wl=0:(e||p2(c),f||p2(d),b.D.wl=7)):3==c||4==c?(c=0,4==q2(b)?(d=q4b(b),BN(b.tb,d)?(d=q4b(b),d=CN(b.tb,d),e=p4b(b.D),null!=d&&null!=e&&d.Wc==e.Wc&&d.rect.intersects(e.rect)&&
(c=4)):c=3):3==q2(b)&&b.B.getElement()&&Ka(Oa(b.B.La()))&&(c=5),d=c,c=0==d,b.D.wl=d,d=b.gb&&Jn(b.gb),b.Na&&Jn(b.Na)?(Fr(b.B.getElement(),"waffle-input-error",!c),b.B.getElement().select()):d&&(d=b.D.Z().vp(b.$.getElement()),Fr(d,"waffle-input-error",!c),b.$.focus()),c?b.dispatchEvent("change"):b.dispatchEvent("error")):b.D.wl=0;b=this.B.La();b=BN(this.U,b);2==this.wl&&b?this.wl=0:0!=this.wl||b||(this.wl=2);t4b(this);if(0!=this.wl)b=!1;else{b=this.D;c=b.Ab.isChecked("rejectInvalidData_radio");d=n2(b);
b.qb.isChecked()||(d="");b:{var e=new Sd,h=m4b(b);if(f=d4b.get(h.code)){var k=[];switch(h.He){case 0:k.push(r2(b,b.K.value,f));break;case 1:k.push(r2(b,b.K.value,f));k.push(r2(b,b.U.value,f));break;case 2:k.push(r2(b,b.H.value,f));break;case 3:k.push(r2(b,b.H.value,f));k.push(r2(b,b.L.value,f));break;case 7:k.push(r2(b,b.J.value,f));break;case 8:k.push(r2(b,b.J.value,f));k.push(r2(b,b.R.value,f));break;case 5:for(var h=b.B.La().split(","),l=0;l<h.length;l++)k.push(o4b(Ra(h[l])));break;case 6:h="="+
b.$.La(),h=Go(h,void 0),k.push(r2(b,h,f))}for(l=0;l<k.length;l++)if(!k[l]){f=null;break b}f=UZ(f,k);I(e,1,f);f=e}else f=null}f?(e=new Zd,I(e,1,f),I(e,2,d),I(e,3,c),b=Jn(b.hb)&&b.Ya.isChecked(),I(e,4,b),b=(b=u4b(this))?this.zb.xc(new i2(e,b)):!1):b=!1}if(!b){a.preventDefault();return}}else{if(b="clear"==a.key)b=(b=u4b(this))?this.zb.xc(new i2(new Zd,b)):!1,b=!b;if(b){a.preventDefault();return}}this.B&&this.B.Ta(!1)};
function t4b(a){var b=v4b(a.wl);b&&a.J.setContent(b);a.J.setVisible(0!=a.wl);var b=2==a.wl||4==a.wl,c=a.Z().vp(a.B.getElement());Fr(c,u2.SKa,b);b&&a.B.Uo().select()}
function v4b(a){switch(a){case 1:return"Please enter a valid number";case 2:return"Please enter a valid range";case 3:return"Please enter a valid range";case 4:return"The selected ranges cannot intersect";case 5:return"Please enter a valid list of items";case 6:return"Please enter valid text";case 7:return"Please enter a valid date"}return null}function u4b(a){var b;b=a.B.La();b=(b=CN(a.U,b))?b.rect:null;var c=a.B.La();a=(a=CN(a.U,c))?a.Wc:null;return b&&null!=a?oi(b,a):null}
function p4b(a){var b=a.B.La();return CN(a.U,b)}function T3b(a,b){var c=new s_(a.vb,v(a.mpb,a),!1,"e.g., Sheet1!A2:D5",!0,a.Z());U(a).M(c,"change",function(){var a=this.D;a&&(a.C.value=n2(a))});c.render(b);return c}r.setVisible=function(a){t2.O.setVisible.call(this,a);a&&this.Y&&(this.Y.focus(),this.Y=null)};r.mpb=function(a,b,c){this.Y=a.Uo();this.Ab.m4(this,a,b,c,!1,!0)};
r.show=function(){var a="",b=!1,c=UB(this.sb),c=Nx(c,Wx(c)).qm(),d=null,e=!1;c&&(c=c.B,d=G(c,1),a=G(c,2),b=G(c,3),e=G(c,4));var c=this.D,f=d,h=e;c.F.Af(0);c.P.Af(0);c.Y.Af(0);c.va.Af(0);c.C.value="";c.J.value="";c.R.value="";c.H.value="";c.L.value="";c.K.value="";c.U.value="";c.B.ob("");c.$.ob("");g4b(c,!1);var k=d=e=c.$c=!1,l=!1,m=!1,n=!1,q=!1,t=!1,w=!1,x=!1,y=!1,E=!1,D=!1,H=!1,T=!1,V=!1;if(f){for(var f=Td(f),Q=G(f,1),f=$c(f,2),ja=c4b.get(Q),na=e4b(c),ua=Z3b(c),La=X3b(c),xa=Y3b(c),hb=f4b(),Ha=Q=
0;Ha<na.length;Ha++)if(ja==na[Ha].code){Q=na[Ha].He;r4b(na[Ha].code)?(T=!0,s2(c,4)):(y=!0,s2(c,3));c.Ya.Dc(!!h);break}for(Ha=0;Ha<ua.length;Ha++)if(ja==ua[Ha].code){Q=ua[Ha].He;c.P.Af(Ha);s2(c,2);E=t=!0;break}for(Ha=0;Ha<La.length;Ha++)if(ja==La[Ha].code){Q=La[Ha].He;c.Y.Af(Ha);s2(c,0);D=w=!0;break}for(Ha=0;Ha<xa.length;Ha++)if(ja==xa[Ha].code){Q=xa[Ha].He;c.va.Af(Ha);s2(c,1);H=x=!0;break}ja==hb.code&&(Q=hb.He,s2(c,5),V=!0);if(E||H||D||y||T||V){if(Ha=p4b(c.D),h=Ha.rect.Rb(),E=Ha.rect.Pb(),D=Ha.Wc+
"",-1!=Q)if(0==Q)f=HC(f[0],D,h,E),c.Ib.ob(f),m=!0;else if(1==Q)Q=HC(f[0],D,h,E),q=HC(f[1],D,h,E),c.Ib.ob(Q),c.Hc.ob(q),n=m=q=!0;else if(2==Q)f=HC(f[0],D,h,E),c.fc.ob(f),e=!0;else if(3==Q)Q=HC(f[0],D,h,E),q=HC(f[1],D,h,E),c.fc.ob(Q),c.Ub.ob(q),d=e=q=!0;else if(7==Q)Q=HC(f[0],D,h,E),c.zb.ob(Q),k=!0;else if(8==Q)Q=HC(f[0],D,h,E),q=HC(f[1],D,h,E),c.zb.ob(Q),c.Fc.ob(q),l=k=q=!0;else if(5==Q){y=!0;Q=[];for(Ha=0;Ha<f.length;Ha++)Q.push(HC(f[Ha],D,h,E));c.B.ob(Q.join(","));c.B.resize()}else 6==Q&&(T=!0,f=
HC(f[0],D,h,E),null!=f&&(f=f.substring(1),f=(Q=Po(f,c.Ff,!1,!0))?Ro(Q.rect,Q.uh):f,c.$.ob(f)))}else c.F.Af(0),T=!0;R(c.Kb,q);c.P.setVisible(t);c.Y.setVisible(w);c.va.setVisible(x);R(c.H,e);R(c.L,d);R(c.K,m);R(c.U,n);R(c.J,k);R(c.R,l);R(c.hb,!0);R(c.Na,y);c.B.resize();R(c.gb,T);j4b(c,T||y)}else{if(ema){e=UB(c.Ff);d=Rx(e);k=new Lg;for(l=d.Rb();l<d.wc();l++)for(m=d.Pb();m<d.Ec();m++)n=e.hd(l,m),""!=n.getDisplayValue()&&Mg(k,n.getDisplayValue().split(b4b));k.isEmpty()?e=!1:(c.B.ob(k.Xc().join(",")),s2(c,
3),h4b(c),e=!0)}else e=!1;e||$3b(c,c.F,c.Y,c.va,c.P,c.J,c.R,c.K,c.U,c.H,c.L,c.Kb,c.Na,c.$,c.hb,c.Ya,c.Md,c.vb,c.qb,c.gb,c.Ab)}c.Xya();a=a||"";e=a.lastIndexOf("</strong>");-1!=e&&(a=Va(Ra(a.substring(e+9))));c.qb.Dc(!!a);a&&(n2(c)!=a&&c.bca(),c.C.value=a,K3b(c.C,!1));g4b(c,b);this.setVisible(!0);this.B&&this.B.Ta(!0);s4b(this);c=this.D;c.C.value=n2(c);c.B.resize()};r.V=function(){L(this.D);this.D=null;L(this.B);this.B=null;this.$.dispose();this.K=this.L=this.$=null;t2.O.V.call(this)};function v2(a,b,c,d,e){Sr.call(this);this.Ff=d.L;this.zb=c;this.Ib=d.B;this.sb=d;this.Ce=e;this.Ab=null;this.Hc=d.K;Tr(this,"Find and replace");Zr(this,!1);c=this.Ob();d=Ll(c);this.D=d.Ja("input",{"class":"jfk-textinput",style:"width: 20em;"});this.D.value=a;this.$=d.Ja("input",{"class":"jfk-textinput",style:"width: 20em;"});this.B=new JD(null);this.Rf=b;this.U=new s_(this.zb,v(this.Tpb,this),!1,"",!0);this.K=null;this.Y=new zL;this.vb=new zL;this.L=new zL;this.J=new zL;this.fd=this.rc=this.Fc=this.cd=
!1;this.Ub=d.Ja("span");tVb(this.Ub);this.Rc=new FD(this.D);K(this,this.Rc);a=w4b;d.Ja("label",{"for":a.xka},"Search");b=d.Ja("label",{"for":a.Bla},"Match case");e=d.Ja("label",{"for":a.Cla},"Match entire cell contents");var f=d.Ja("label",{},"Also search within formulas"),h=d.Ja("label",{"for":a.pna},"Search using regular expressions "),k=(new Ck(Cla)).toString(),l=d.Ja("span",null,d.Ja("a",{target:"_blank",href:k},"Help"));U(this).M(l,["keydown","keypress"],function(a){13==a.keyCode&&a.stopPropagation()});
var k=$n(this,"findLabel"),m=$n(this,"replaceLabel"),n=$n(this,"findScopeLabel"),q=d.Ja("div","goog-inline-block"),t=d.Ja("div",a.lMa),l=d.Ja("table",null,d.Ja("tbody",null,d.Ja("tr",null,d.Ja("td",a.I5,d.Ja("label",{id:k},"Find")),d.Ja("td",null,this.D)),d.Ja("tr",null,d.Ja("td",a.I5,d.Ja("label",{id:m},"Replace with")),d.Ja("td",null,this.$)),d.Ja("tr",null,d.Ja("td",null,d.Ja("label",{id:n},"Search")),d.Ja("td",null,q,t)),d.Ja("tr",null,d.Ja("td",null,""),d.Ja("td",null,b,d.Ja("br"),e,d.Ja("br"),
h,l,d.Ja("br"),f)),d.Ja("tr",null,d.Ja("td",{colspan:"2"},this.Ub))));this.B.render(q);Br(this.B.getElement(),a.xka);this.U.render(t);Zn(this.Y,b);xL(this.Y,b);this.Y.getElement().id=a.Bla;Zn(this.vb,e);xL(this.vb,e);this.vb.getElement().id=a.Cla;Zn(this.L,h);xL(this.L,h);this.L.getElement().id=a.pna;xL(this.J,f);Zn(this.J,f);tr(this.D,"labelledby",k);tr(this.$,"labelledby",m);tr(this.B.getElement(),"labelledby",n);d.appendChild(c,l);c=new $r;c.set("findNext","Find",!0);c.set("replace","Replace");
c.set("replaceAll","Replace all");c.set("done","Done",!1,!0);cs(this,c);ZI(this,"");U(this).M(this,"dialogselect",this.Upb).M(this.Rc,"input",this.yAa).M(this.L,"change",this.b$a).M(this.B,"change",this.A2a).M(this.U,"change",this.Vpb).M(this.J,"change",this.d$a);c=new bF;c.rb(this.D);K(this,c);c=new bF;c.rb(this.$);K(this,c);x4b(this);c=new Or(this.getElement());K(this,c);U(this).M(c,"focusin",this.uHa).M(this.getElement(),"mousedown",this.uHa)}z(v2,Sr);
var w4b={zxb:"waffle-find-replace-dialog-border",xka:"waffle-find-replace-find-scope-select",I5:"waffle-find-replace-dialog-label",Bla:"find-replace-case",Cla:"find-replace-cell",pna:"find-replace-regex",lMa:"waffle-find-replace-selection-input goog-inline-block"};
function x4b(a){var b=du(a.zb);if(b)var c=QB(b),d=gr(a.Ib,c.Wc).B;a.J.Dc(a.Hc);var e=new XC("All sheets",bp.cja),f=new XC("This sheet",bp.rMa),h=new XC("Specific range",bp.p6);a.B.Ye(e);a.B.Ye(f);a.B.Ye(h);f=c?TB(a.Ib,c.Wc):null;f=(f=c&&f?gx(f,c.rect.Rb(),c.rect.Pb()):null)?fi(f):1;c&&fi(c.rect)>f?oD(a.B,h):oD(a.B,e);b&&a.U.ob(Ro(c.rect,d))}function y4b(a){var b=a.B.$e().bb(),c=sy(a.zb.B);return 0==b?Po(a.U.La(),a.Ib,!1,!0):1!=b||null===c?null:new li(c,"",new Rh(0,0,1,1))}r=v2.prototype;
r.uHa=function(a){a.target==this.getElement()?this.focus():this.Ce.zc(2)};r.Vpb=function(){z4b(this)};r.d$a=function(){var a=this.J.isChecked();l$a(this.sb,a)};r.A2a=function(){z4b(this)};r.b$a=function(){this.L.isChecked()&&this.Y.Dc(!0)};
r.Upb=function(a){var b=A4b;if("findNext"==a.key)a.preventDefault(),this.cd&&(w2(this,null),B4b(this,b.wka));else if("replace"==a.key)a.preventDefault(),this.Fc&&(w2(this,null),B4b(this,b.Gma));else if("replaceAll"==a.key&&(a.preventDefault(),this.fd)){a=v(function(){w2(this,null);B4b(this,b.Fma)},this);var c=this.B.$e().bb();1<this.Ib.C.length&&2==c&&!this.rc?(S1b("Replace in all sheets?","This will replace values on all sheets. Are you sure?",a,null),this.rc=!0):a()}};
r.yAa=function(){var a=0==this.D.value.length;ds(this.C,"findNext").disabled=a;this.cd=!a;C4b(this,!a);this.Fc&&a&&D4b(this,!1)};r.Tpb=function(a,b,c){this.Ab=a.Uo();this.Rf.m4(this,a,b,c,!1,!0)};function z4b(a){var b=0==a.B.$e().bb();a.U.setVisible(b);L(a.K);a.K=null;var c=y4b(a),d=du(a.zb);b&&d&&c&&(a.K=iI(d,c.rect,"waffle-find-replace-dialog-border",2,1),a.K.render(),a.K.setVisible(!0),K(a,a.K))}
function B4b(a,b){if(0==a.B.$e().bb()&&null==y4b(a))Fr(a.U.C,"waffle-range-selection-error",!0),w2(a,"Invalid range");else{var c=a.B.$e().bb();a.dispatchEvent(new E4b(b,a.D.value,a.$.value,c,a.Y.isChecked(),a.vb.isChecked(),a.L.isChecked(),a.J.isChecked(),y4b(a)))}}r.setVisible=function(a){var b=this.sb.Ed();C4b(this,!b);D4b(this,!b);this.$.disabled=b;v2.O.setVisible.call(this,a);a&&this.Ab&&(this.Ab.focus(),this.Ab=null)};r.zlb=function(a){this.D.value=a};
r.focus=function(){this.Jc()&&this.ib()&&(this.D.focus(),this.Ce.zc(2),yE(this.D,this.D.value.length),this.yAa())};function D4b(a,b,c){b=b&&!a.sb.Ed()&&0==!a.D.value.length;a.Fc=b;a=ds(a.C,"replace");a.disabled=!b;c?a.title=c:a.removeAttribute("title")}function C4b(a,b){var c=!!sb(vbb(a.Ff),function(a){return!a.Im()});b=b&&!a.sb.Ed()&&!c&&0==!a.D.value.length;a.fd=b;var d=ds(a.C,"replaceAll");d.disabled=!b;c&&(d.title="This is disabled because there are protected cells in this spreadsheet.")}
function w2(a,b){var c=Ll(a.Ob()),d=a.Ub;b?(0<fm(d).length&&c.appendChild(d,c.Ja("br")),c.appendChild(d,c.Ja("b",null,c.createTextNode(b)))):c.Od(d)}r.V=function(){v2.O.V.call(this);this.rc=!1;l$a(this.sb,this.Hc)};function E4b(a,b,c,d,e,f,h,k,l){M.call(this,a);this.D=b;this.J=c;this.B=d;this.L=e;this.va=f;this.hb=h;this.qb=k;this.Kb=l||null}z(E4b,M);
function F4b(a){var b=new Lj;b.append("{");var c=a.D;b.append("fv:",null==c||0==c.length?"null":U1b(c),",");b.append("rv:",U1b(a.J),",");b.append("sas:",a.B==bp.cja?"true":"false",",");b.append("mc:",a.L?"true":"false",",");b.append("mec:",a.va?"true":"false",",");b.append("sbr:",a.hb?"true":"false");b.append("}");return b.toString()}var A4b={wka:"findnext",SCb:"findall",Gma:"replace",Fma:"replaceall",DONE:"done",Nxb:"canceled"};function G4b(a,b,c,d,e){J.call(this);var f=A4b;this.F=null;this.B=a;this.C=b;this.D=c;this.J=d;this.K=e;this.H=new P(this);K(this,this.H);this.H.M(a,f.Fma,this.i9a).M(a,f.Gma,this.j9a).M(a,f.wka,this.vya).M(a,f.DONE,this.k1a)}z(G4b,J);var x2={oH:"cg",pH:"cr",nH:"cc",vka:"loop"};r=G4b.prototype;r.anb=function(){this.B.setVisible(!0);H4b(this,null)};r.vya=function(a){if(gJ(this.C.B)){var b=du(this.C).bb(),c=this.F;c||(c=Wx(b),c=tc(x2.oH,b.Nb(),x2.pH,jy(b,c.y),x2.nH,ky(b,c.x)));I4b(this,a,b,c)}};
function I4b(a,b,c,d){var e=new Ch,f=J4b(b);K4b(f,c,d);c=e.$b(f);a=v(function(a){var c=e.Tc((new gp).oa(),a);a=G(f,1);var d=b.type;gJ(this.C.B)&&(c?Vc(c,1)?(d=G(c,1),c=tc(x2.oH,parseInt(d.wb(),10),x2.pH,d.qx(),x2.nH,d.ih(),x2.vka,G(c,2)),L4b(this,a,c)):(L4b(this,a,{}),"replace"==d&&this.B.focus()):M4b(this))},a);ritz.findNext(c,a)}function K4b(a,b,c){if(c){var d=""+c[x2.oH],e=new gd;I(e,1,d);e.Wv(gy(b,c[x2.pH],"r"));I(e,3,gy(b,c[x2.nH],"c"));I(a,10,e)}}
function J4b(a){var b=new ap;I(b,1,a.D);I(b,3,a.J);I(b,5,a.B);if(0==a.B||1==a.B){var c=a.Kb,d=new Ed;I(d,1,""+c.Wc);var e=c.rect.Rb();I(d,2,e);Fd(d,c.rect.wc());Gd(d,c.rect.Pb());Hd(d,c.rect.Ec());I(b,9,d)}I(b,6,a.L||!1);I(b,7,a.va||!1);I(b,8,a.hb||!1);b.bd(a.qb?1:0);I(b,11,0);return b}function L4b(a,b,c){c?c&&null!=c.cg?(b=c[x2.oH],c[x2.vka]&&w2(a.B,"No more results found, looping around"),mN(a.D,b,v(a.Spb,a,c))):(H4b(a,null),w2(a.B,"There are no entries matching "+b)):M4b(a)}
r.Spb=function(a){var b=du(this.C).bb(),c=a[x2.pH],d=a[x2.nH];a[x2.pH]=jy(b,c);a[x2.nH]=ky(b,d);H4b(this,a);a=new O(d,c);b=new li(b.Nb(),"",Th(a));IZ(this.D,b,v(this.FNa,this,a))};
r.FNa=function(a){if(!this.isDisposed()){this.B.focus();var b=du(this.C).bb();b.hd(a.y,a.x).hasFormula()&&!this.B.J.isChecked()&&D4b(this.B,!1,"Can't replace formula");var c=ix(b,a.y),d=jx(b,a.x);!c||!d||c.ib()&&d.ib()||(c=this.B,d=Qo(a),a=Nx(b,a).getDisplayValue(),w2(c,"A match was found in hidden cell "+(d+(' with value "'+(a+'".')))))}};function M4b(a){w2(a.B,"Error while searching spreadsheet. Please try again.")}
r.j9a=function(a){if(!this.K.Ed()){var b=this.F;if(b){var c=Pw(this.D,b[x2.oH]);if(c){var c=c.Ac(),d=gy(c,b[x2.pH],"r"),e=gy(c,b[x2.nH],"c"),f=c.hd(d,e);if(!f.hasFormula()||this.B.J.isChecked()){var h=!1,f=f.getDisplayValue(),k=null,k=new Ch,h=J4b(a);I(h,5,0);K4b(h,c,b);var l=new Ed;I(l,1,""+b[x2.oH]);I(l,2,d);Fd(l,d+1);Gd(l,e);Hd(l,e+1);I(h,9,l);b=k.$b(h);k=ritz.getReplaceResult(b);(h=this.J.xc(new m0(c,F4b(a),h)))&&null!==k&&w2(this.B,'Replaced "'+(f+('" with "'+(k+'"'))));this.vya(a)}}}}};
r.i9a=function(a){if(!this.K.Ed()&&gJ(this.C.B)){var b=this.D.getActiveGrid().Ac(),c=J4b(a);this.J.xc(new m0(b,F4b(a),c))?w2(this.B,'Replaced all instances of "'+(a.D+('" with "'+(a.J+'"')))):M4b(this)}};r.k1a=function(){H4b(this,null)};function H4b(a,b){a.F=b;var c=a.B;c&&D4b(c,null!=b)};function y2(a,b,c,d,e,f,h,k){Sr.call(this,void 0,void 0,k);this.U=a;this.Ab=b;this.Ib=d;this.zb=f;this.vb=new BU;this.$=h;this.sb=e;this.Y=!1;this.B={};this.D=new o0(!0,this.Z());this.J=new o0(!0,this.Z());this.K=new o0(!0,this.Z());this.L=null;a=new $r;es(a,{key:"ok",caption:"Print"},!0);es(a,gs,!1,!0);cs(this,a)}z(y2,Sr);var N4b={gMa:"print-repeat-row-headers",mOb:"print-omit-gridlines",OGb:"print-include-title",NGb:"print-include-sheet-names",MGb:"print-include-page-numbers"};r=y2.prototype;
r.rN=function(){if(!this.isDisposed()){var a=this.U,b=this.D;b.isChecked("print-active-sheet")?a.B=0:b.isChecked("print-all-sheets")?a.B=1:a.B=2;this.K.isChecked("print-fit")?a.D=0:a.D=1;b=!!this.J.isChecked("print-landscape");a.K=b;b=this.B["print-repeat-row-headers"].isChecked();a.R=b;b=this.B["print-omit-gridlines"].isChecked();a.L=b;b=this.B["print-include-title"].isChecked();a.J=b;b=this.B["print-include-sheet-names"].isChecked();a.H=b;b=this.B["print-include-page-numbers"].isChecked()?"CENTER":
"UNDEFINED";a.P=b;b=this.L.$e().bb();a.C=b;O4b(this)}};
function P4b(a){var b=a.U,c=a.D;0==b.B?q0(c,"print-active-sheet"):1==b.B?q0(c,"print-all-sheets"):q0(c,"print-selection");q0(a.K,0==b.D?"print-fit":"print-actual-size");q0(a.J,b.K?"print-landscape":"print-portrait");a.B["print-repeat-row-headers"].Dc(!!b.R);a.B["print-omit-gridlines"].Dc(!!b.L);a.B["print-include-title"].Dc(!!b.J);a.B["print-include-sheet-names"].Dc(!!b.H);a.B["print-include-page-numbers"].Dc("UNDEFINED"!=b.P);var d=a.L;d.hc().Eg(function(a){a.bb()==b.C&&oD(d,a)});O4b(a);tf&&(a.Ob().style.display=
"",nf(a.getElement().offsetHeight),a.Ob().style.display="block",nf(a.getElement().offsetHeight))}
r.c2a=function(a){if("ok"==a.key){this.rN();var b=this.U;a=this.Y&&N1b();var c=this.Ab,d=b.R,e=!b.K,f=0==b.D,h=0==b.B,k=2==b.B,l=b.L,m=b.J,n=b.H,q=b.P,t=new Kk;t.set("size",b.C);t.set("fzr",d);t.set("portrait",e);t.set("fitw",f);(h||k)&&t.set("gid",sy(c.D));k&&(b=UB(c.D),b=Rx(b),d=b.Rb(),e=b.Pb(),f=b.wc(),h=b.Ec(),t.set("r1",d),t.set("c1",e),t.set("r2",f),t.set("c2",h),t.set("ir",b.$d()),t.set("ic",b.le));t.set("gridlines",!l);t.set("printtitle",m);t.set("sheetnames",n);t.set("pagenum",q);l=new me;
c=Hra(c.D);for(m=0;m<c.length;m++)q=c[m],b=qy(q.Ac()),Zw(b)&&(b.getActiveFilterId(),n=new le,d=""+q.wb(),I(n,1,d),d=n,e=b.getFilterDelta(),I(d,3,e),q=oi(Yw(b),q.wb()),I(n,4,q),Xc(l,1,n));$c(l,1).length&&(c=new Ch,c.bu=!0,t.set("gridFiltersProto",Wb(c.$b(l))));null!=a&&t.set("attachment",!a);c=t.Nd();l=[];for(m=0;m<c.length;m++)l.push(c[m]+"="+t.get(c[m]));c=l.join(",");l={format:"pdf"};m=t.Nd();for(n=0;n<m.length;n++)l[m[n]]=t.get(m[n]);t=this.zb.bf("/export");a=v(this.vb.L,this.vb,lj(Tj(t)),l,a);
this.Y&&this.sb?(this.$(!1),m=this.sb,t=m.B,l=m.F,n=m.D?m.D.C:null,n||(n=(n=Rl("docs-title-inner"))?n.innerHTML:""),c=c?"id="+m.C+","+c:m.C,t.P9=!0,t.dispatchEvent("beforeshow"),t.dispatchEvent("show"),t.A$.Cqa(a),t.A$.Dqa(l,n,c),t.A$.B8(),t.dispatchEvent("aftershow")):(this.$(!0),a())}};function O4b(a){Q4b(a,a.K,"print-fit");Q4b(a,a.K,"print-actual-size");Q4b(a,a.J,"print-landscape");Q4b(a,a.J,"print-portrait")}
function Q4b(a,b,c){Fr(a.Z().yq(b.getElement(c)),"print-radio-checked",b.isChecked(c))}
r.$a=function(){y2.O.$a.call(this);ZI(this,"ok");var a=this.Ob(),b;b="";var c='<div id="print-warning">'+Y("Sheets with full-page charts and gadgets won't be printed. You can print all other sheets in your spreadsheet.")+'</div><hr class="print-divider"/><table width="100%" role="presentation"><tr><div class="waffle-dialog-header">'+Y("Options")+'</div><td width="50%" valign="center" class="print-options-container">',d;d=Bt("Print options: What to print");d=""+('<div role="radiogroup" aria-label="'+
Z(d)+'"><input type="radio" name="whatPartsGroup" id="print-active-sheet"/><label for="print-active-sheet">'+Y("Current sheet")+'</label><br/><input type="radio" name="whatPartsGroup" id="print-all-sheets"/><label for="print-all-sheets">'+Y("All sheets")+'</label><br/><input type="radio" name="whatPartsGroup" id="print-selection"/><label for="print-selection">'+Y("Selection")+"</label></div>");d=mt(d);c=c+d+'</td><td width="50%" valign="center" class="print-options-container">';d=Bt("Additional print options");
d=""+('<div role="group" aria-label="'+Z(d)+'"><span id="print-repeat-row-headers" class="jfk-checkbox"></span><label for="print-repeat-row-headers">'+Y("Repeat row headers on each page")+'</label><br/><span id="print-omit-gridlines" class="jfk-checkbox"></span><label for="print-omit-gridlines">'+Y("No gridlines")+'</label><br/><span id="print-include-title" class="jfk-checkbox"></span><label for="print-include-title">'+Y("Include document title")+'</label><br/><span id="print-include-sheet-names" class="jfk-checkbox"></span><label for="print-include-sheet-names">'+
Y("Include sheet names")+'</label><br/><span id="print-include-page-numbers" class="jfk-checkbox"></span><label for="print-include-page-numbers">'+Y("Include page numbers")+"</label></div>");d=mt(d);c=c+d+'</td></tr></table><hr class="print-divider"/><div class="waffle-dialog-header" id="dialog-paper-size-header">Paper size</div><table width="100%" role="presentation"><tr><td width="50%" valign="center" class="print-options-container">'+mt('<div id="print-paper-size" class="jfk-select goog-flat-menu-button" aria-labelledby="dialog-paper-size-header"></div>')+
'</td></tr></table><hr class="print-divider"/><div class="waffle-dialog-header">Layout</div>';d=Bt("Layout");d='<table width="100%" cellpadding=0 cellspacing=0 role="presentation"><tr>'+('<td role="radiogroup" aria-label="'+Z(d)+'"><table width="100%" cellpadding=0 cellspacing=0 role="presentation"><tr><td valign="top" align="center" class="print-layout-container" role="presentation"><input type="radio" name="print-layout-size" id="print-fit" /><br/><label for="print-fit">'+Y("Fit to width")+'<br/><div class="print-fit-icon">&nbsp;</div><div class="print-layout-caption" id="print-fit-caption"></div></label></td><td class="print-layout-divider"></td><td valign="top" align="center" class="print-layout-container" role="presentation"><input type="radio" name="print-layout-size"id="print-actual-size" /><br/><label for="print-actual-size">'+
Y("Actual size")+'<br/><div class="print-actual-size-icon">&nbsp;</div><div class="print-layout-caption" id="print-actual-size-caption"></div></label></td><td class="print-layout-divider-2"></td></tr></table></td>');var e;e=Bt("Orientation");d+='<td role="radiogroup" aria-label="'+Z(e)+'"><table width="100%" cellpadding=0 cellspacing=0 role="presentation"><tr><td class="print-layout-divider-3"></td><td valign="top" align="center" class="print-layout-container" role="presentation"><input type="radio" name="print-layout-orientation" id="print-portrait" /><br/><label for="print-portrait">'+
Y("Portrait")+'<br/><div class="print-portrait-icon">&nbsp;</div><div class="print-layout-caption" id="print-portrait-caption"></div></label></td><td class="print-layout-divider"></td><td valign="top" align="center" class="print-layout-container" role="presentation"><input type="radio" name="print-layout-orientation" id="print-landscape" /><br/><label for="print-landscape">'+Y("Landscape")+'<br/><div class="print-landscape-icon">&nbsp;</div><div class="print-layout-caption" id="print-landscape-caption"></div></label></td></tr></table></td></tr></table>';
d=mt(d);b=mt(b+(c+d));a.innerHTML=b;Br(this.getElement(),"print-dialog");b=this.Z();L(this.D);this.D=new o0(!0,this.Z());p0(this.D,"whatPartsGroup",a);L(this.J);this.J=new o0(!0,this.Z());p0(this.J,"print-layout-orientation",a);L(this.K);this.K=new o0(!0,this.Z());p0(this.K,"print-layout-size",a);for(var f in N4b)c=N4b[f],L(this.B[c]),a=this.B[c]=new zL,c=b.getElement(c),a.rb(c),xL(a,c.nextSibling);L(this.L);f=this.L=m2();f.rb(b.getElement("print-paper-size"));z2(this,"0",'Letter (8.5" x 11")',"Letter (8.5 inches x 11 inches)");
z2(this,"33",'Tabloid (11" x 17")',"Tabloid (11 inches x 17 inches)");z2(this,"2",'Legal (8.5" x 14")',"Legal (8.5 inches x 14 inches)");z2(this,"32",'Statement (5.5" x 8.5")',"Statement (5.5 inches x 8.5 inches)");z2(this,"30",'Executive (7.25" x 10.5")',"Executive (7.25 inches x 10.5 inches)");z2(this,"31",'Folio (8.5" x 13")',"Folio (8.5 inches x 13 inches)");z2(this,"6","A3 (297 mm x 420 mm)");z2(this,"7","A4 (210 mm x 297 mm)");z2(this,"8","A5 (148 mm x 210 mm)");z2(this,"18","B4 (250 mm x 353 mm)");
z2(this,"19","B5 (176 mm x 250 mm)");U(this).M(f,"action",this.rN).M(this.D,"action",this.Ccb).M(this.J,"action",this.C7a).M(this.K,"action",this.rN).M(this,"afterhide",this.rN).M(this,"dialogselect",this.c2a)};function z2(a,b,c,d){a.L&&(b=new XC(c,b),a.L.Ye(b),a=b.Ob(),d&&a&&yr(a,d))}r.C7a=function(){this.rN()};r.Ccb=function(){var a=this.B["print-repeat-row-headers"],b=this.U;this.D.isChecked("print-selection")&&a.isChecked()?(a.Dc(!1),b.F=!0):this.U.F&&(a.Dc(!0),b.F=!1);this.rN()};
r.show=function(a){this.Y=a;Tr(this,a?"Print settings":"Export to PDF");this.C.set("ok",a?"Print":"Export",!0);this.setVisible(!0);a=this.Z();var b=this.Ib;R(a.getElement("print-warning"),!1);hJ(b)?(K1b(this.D),this.D.Ta("print-selection",!1),2==this.U.B&&(this.U.B=0)):K1b(this.D);P4b(this)};r.V=function(){for(var a in this.B)L(this.B[a]);this.L.dispose();this.K.dispose();this.J.dispose();this.D.dispose();y2.O.V.call(this)};function R4b(a){a=""+(S4b({id:"waffle-resize-selection-custom",oBa:a.hra,Zf:Ct("<br />"+Ft($1b({id:"waffle-resize-input",Wd:"waffle-resize-inset-input"})))})+S4b({id:"waffle-resize-selection-auto",oBa:Bt("Fit to data"),Zf:Ct("")}));return mt(a)}function S4b(a){return mt('<div class="waffle-resize-option"><input type="radio" name="waffle-resize-selection" id="'+Z(a.id)+'"><label for="'+Z(a.id)+'" class="waffle-resize-label">'+Y(a.oBa)+"</label>"+Y(a.Zf)+"</div>")}
function T4b(a){a=a||{};return mt('<label for="waffle-resize-input" >'+Y(a.hra)+'</label><br /></br /><input id="waffle-resize-input" />')};function A2(a,b,c,d){Sr.call(this);this.K=a;this.U=b;var e=Rx(this.K).Pd();this.D=e;this.B=nb(this.K.Ek(),function(a){return a.Pd()==e});this.J=new TU;this.L=new o0(!0);this.Y=c;this.$=d}z(A2,Sr);var B2={Q4:"waffle-resize-selection-auto",XN:"waffle-resize-selection-custom",RKa:"waffle-resize-input",uLa:"waffle-resize-selection"};r=A2.prototype;
r.jb=function(){A2.O.jb.call(this);var a;var b=this.B[0];if("r"==this.D){a=b.Rb();var b=b.wc()-1,c=String(Jo(a)),d=String(Jo(b));a=1<this.B.length?"Resize selected rows":a==b?"Resize row "+c:"Resize rows "+(c+(" - "+d))}else a=b.Pb(),b=b.Ec()-1,c=Io(a),a=1<this.B.length?"Resize selected columns":a==b?"Resize column "+c:"Resize columns "+(c+(" - "+Io(b)));Tr(this,a);a="r"==this.D?T4b:R4b;this.Ob().appendChild(Ds(a,{hra:"r"==this.D?"Enter new row height in pixels. (Default: "+($q+")"):"Enter new column width in pixels. (Default: "+
(wx+")")}));ZI(this,"ok")};r.$a=function(){A2.O.$a.call(this);var a=this.Z();this.J.rb(a.getElement(B2.RKa));var a=Rx(this.K),b=a.Pd(),a=Lx(this.K,b,a.vg(b)).sj();this.J.ob(String(a));"c"==this.D&&(p0(this.L,B2.uLa),q0(this.L,B2.XN));U(this).M(this,"dialogselect",this.g$a).M(this.J.getElement(),"focus",this.acb)};r.acb=function(){"c"==this.D&&q0(this.L,B2.XN)};r.focus=function(){this.Jc()&&this.J.Ck()};
r.g$a=function(a){"ok"==a.key&&("r"==this.D||RYb(this.L)==B2.XN?(a=parseInt(this.J.La(),10),isNaN(a)?Xm("Entered value is not a number."):2>a||2E3<a?Xm("Size must be between 2 and 2000 pixels."):this.U.xc(new YM(this.K,this.B[0],a,this.B.slice(1)))):(a=du(this.Y),s$a(this.B,a.qn.B,this.$,this.U)))};function C2(a){wc(this,a,0,-1,null)}z(C2,vc);C2.prototype.fb=function(){return B(this,3)};C2.prototype.bd=function(a){C(this,3,a)};function D2(a){S.call(this,a);this.R=Cl("email");this.B=this.C=null}z(D2,S);r=D2.prototype;
r.jb=function(){var a=this.Z(),b;b=this.Z();this.B=new p_;K(this,this.B);this.C=new p_;K(this,this.C);var c=b.Ja("div","waffle-dialog-notifications-input");sr(c,"presentation");this.D=new m_;o_(this.D,b.Ja("label",null,"Any changes are made"));this.D.render(c);this.B.VF(this.D);var d=b.Ja("div","waffle-dialog-notifications-input");sr(d,"presentation");this.J=new m_;o_(this.J,b.Ja("label",null,"A user submits a form"));this.J.render(d);this.B.VF(this.J);var e=b.Ja("div","waffle-dialog-notifications-input");
sr(e,"presentation");this.H=new m_;o_(this.H,b.Ja("label",null,"Email - daily digest"));this.H.render(e);this.C.VF(this.H);var f=b.Ja("div","waffle-dialog-notifications-input");sr(f,"presentation");this.K=new m_;o_(this.K,b.Ja("label",null,"Email - right away"));this.K.render(f);this.C.VF(this.K);b=b.Ja("div",null,b.Ja("div","waffle-dialog-notifications-toplabel","Notify me at "+(this.R+" when...")),b.Ja("div",{role:"radiogroup","aria-label":"Notify me at "+(this.R+" when...")},c,d),b.Ja("div",{style:"padding: 5px"}),
b.Ja("div","waffle-dialog-notifications-label","Notify me with..."),b.Ja("div",{role:"radiogroup","aria-label":"Notify me with..."},e,f));c=this.Z();d=c.Ja("div");this.L=YD("Save",c);this.cb(this.L,!1);this.L.render(d);this.P=new WD("Cancel",c);this.cb(this.P,!1);this.P.render(d);this.qa=a.Ja("div","waffle-dialog-notifications",a.Ja("div",null,b),a.Ja("div",null,d))};
r.$a=function(){D2.O.$a.call(this);U(this).M(this.L,"action",this.xrb,!0).M(this.P,"action",v(this.dispatchEvent,this,new M("cancelRuleEdit"))).M(this.B,"change",this.Tha).M(this.C,"change",this.Tha)};r.Sf=function(a){D2.O.Sf.call(this,a);a?1==a.fb()?q_(this.B,this.D):2==a.fb()&&q_(this.B,this.J):q_(this.B,null);a?2==B(a,2)?q_(this.C,this.H):1==B(a,2)&&q_(this.C,this.K):q_(this.C,null);this.Tha()};r.focus=function(){var a=r_(this.B),b=this.B.B.Ee(0);(a||b).getElement().focus()};
r.setVisible=function(a){this.getElement()&&R(this.getElement(),a)};r.xrb=function(){this.dispatchEvent(new M("saveRule",U4b(this)))};function U4b(a){var b=new C2,c=a.bb();c&&(c=B(c,1),C(b,1,c));a.D.isChecked()?b.bd(1):a.J.isChecked()&&b.bd(2);a.K.isChecked()?C(b,2,1):a.H.isChecked()&&C(b,2,2);return b}r.Tha=function(){var a=(this.D.isChecked()||this.J.isChecked())&&(this.K.isChecked()||this.H.isChecked());this.L.Ta(a)};function E2(a,b){S.call(this,b);this.Sf(a)}z(E2,S);
E2.prototype.jb=function(){var a,b=this.bb(),c="";1==b.fb()?c="any changes are made":2==b.fb()&&(c="form submitted");a="";2==B(b,2)?a+="send digest email":1==B(b,2)&&(a+="send email");a="If "+(c+(" then "+a));var d=this.Z(),b=d.Ja("td",null),c=d.Ja("td",{width:"50px"});a=d.Ja("tr",{valign:"center"},d.Ja("td",null,d.Ja("span","waffle-notification-rule",a)),d.Ja("td",{align:"right"},d.Ja("table",null,d.Ja("tbody",null,d.Ja("tr",null,b,c)))));d=qB(JC,"waffle-notifications-add");this.C=new fD("Edit",
d,this.Z());this.C.Cf("goog-link-button");this.C.Cf("menuMainLink");this.cb(this.C,!1);this.C.render(b);this.B=new fD("Delete",d,this.Z());this.B.Cf("goog-link-button");this.B.Cf("menuMainLink");this.cb(this.B,!1);this.B.render(c);this.qa=a};E2.prototype.$a=function(){E2.O.$a.call(this);U(this).M(this.C,"action",this.H);U(this).M(this.B,"action",this.D)};E2.prototype.H=function(){this.dispatchEvent(new M("edit",this.bb()))};
E2.prototype.D=function(){var a=v(function(){this.dispatchEvent(new M("del",this.bb()))},this),b=v(function(){this.B.getElement().focus()},this);I3b("Are you sure you want to delete this notification rule?",a,void 0,void 0,b)};function F2(a){S.call(this,a);this.B=null}z(F2,S);F2.prototype.jb=function(){var a=this.Z();this.B=a.Ja("tbody");this.qa=a.Ja("table",{className:"waffle-dialog-notifications-list",width:"100%"},this.B)};F2.prototype.Ob=g("B");F2.prototype.setVisible=function(a){this.getElement()&&R(this.getElement(),a)};function G2(a,b,c){Sr.call(this);this.Y=a;this.K=b;Tr(this,"Set notification rules");Zr(this,!1);a=new $r;a.set("cancel","Done",!1,!0);cs(this,a);this.B=new D2(c);this.cb(this.B,!1);this.D=new F2;this.cb(this.D,!1);this.J=new fD("Add another notification rule",PD.getInstance(),this.Z());this.cb(this.J,!1)}z(G2,Sr);r=G2.prototype;
r.jb=function(){G2.O.jb.call(this);var a=this.Z(),b=icb(this.Y,new Ck(vla+"91588")).toString(),b=a.Ja("a",{target:"_blank",href:b},"Help"),c=a.Ja("div");this.J.render(c);this.U=a.Ja("div");this.L=a.Ja("div");var d=a.Ja("div","waffle-dialog-notifications-bounds",this.U,this.L),b=a.Ja("div",null,a.Ja("div",{align:"right"},b),d,c);a.appendChild(this.Ob(),b);ZI(this,"")};
r.$a=function(){G2.O.$a.call(this);this.D.render(this.U);this.B.render(this.L);U(this).M(this,"edit",this.Brb).M(this,"del",this.Arb).M(this.J,"action",this.zrb).M(this,"saveRule",this.Crb).M(this,"cancelRuleEdit",this.yrb)};r.rT=function(a){this.isDisposed()||(this.B.setVisible(!1),V4b(this,!1),yi(this.K,"/notifications/list",v(this.Drb,this,a)).we())};
r.Drb=function(a,b,c){if(!this.isDisposed()){b=c.yf();c=[];for(var d=0;d<b.length;d++)c[d]=new C2(b[d]);this.Sf(c);if(a&&0==c.length)W4b(this,null,!1);else{if(a=this.bb())if(b=this.D,b.Od(!0),b.Z().Od(b.Ob()),b.Sf(a),c=b.Z(),0==a.length)c.appendChild(b.Ob(),c.Ja("tr",null,c.Ja("td",{align:"center"},"No notification rules currently defined")));else for(d=0;d<a.length;d++)b.cb(new E2(a[d],c),!0);V4b(this,!0);this.focus()}}};
r.Crb=function(a){this.B.setVisible(!1);a=a.target;var b=a.$b();B(a,1)?Ci(yi(this.K,"/notifications/set",v(this.rT,this,!1)),{rule:b}).we():Ci(yi(this.K,"/notifications/create",v(this.rT,this,!1)),{rule:b}).we()};r.yrb=function(){this.B.setVisible(!1);this.rT(!1)};r.Brb=function(a){W4b(this,a?a.target:null,!0)};r.zrb=function(){W4b(this,null,!0)};function W4b(a,b,c){V4b(a,!1);var d=a.B;d.Sf(b);d.setVisible(!0);c&&a.B.focus()}
r.Arb=function(a){this.D.setVisible(!1);a=a.target;Ci(yi(this.K,"/notifications/delete",v(this.rT,this,!1)),{rule_id:B(a,1)}).we()};function V4b(a,b){a.D.setVisible(b);var c=Wr(a);R(c,b);a.J.setVisible(b)}r.show=function(){this.setVisible(!0);this.rT(!0)};function X4b(a){var b="",c='Display language: <a id="ds-settings-link" target="_blank">'+(Y(a.FQa)+"</a>"),b=b+('<div class="dialog-settings-general-settings-div"><div class="modal-dialog-title"><span class="modal-dialog-title-text">General settings</span></div><div><span>'+c+"</span></div>");a.lmb&&(b+='<div class="dialog-settings-english-name-div">'+Ft(yL({id:"waffle-settings-dialog-english-name-checkbox"}))+'<label for="waffle-settings-dialog-english-name-checkbox" id="waffle-settings-dialog-english-name-checkbox-label">Always use English function names</label></div>');
return mt(b+"</div>")};function H2(a,b,c){Sr.call(this);this.sb=a;this.Ab=b;this.D=c;this.B={};this.Y=this.L=!1;this.vb=this.$=this.U="";this.zb=new Ch;Tr(this,"Settings for this spreadsheet");this.K=!1;this.J=new zL;this.cb(this.J);this.B[0]=m2();this.B[1]=m2();this.B[2]=m2()}z(H2,Sr);var Y4b=null,Z4b={NW:0,QMa:1,mJa:2},$4b={bNa:"waffle-settings-dialog-english-name-checkbox",cNa:"waffle-settings-dialog-english-name-checkbox-label"},a5b=[["","On change"],["60000","On change and every minute"],["3600000","On change and every hour"]];
r=H2.prototype;
r.jb=function(){H2.O.jb.call(this);var a=this.Ob(),b=this.Z(),c=[b5b(b,"Locale","waffle-settings-label-locale"),c5b(this,b,"This affects formatting details such as functions, dates, and currency.",0,"waffle-settings-label-locale","waffle-settings-description-locale"),d5b(this),b5b(b,"Time zone","waffle-settings-label-timezone"),c5b(this,b,"Your spreadsheet's history will be recorded in this time zone. This will affect all time-related functions.",1,"waffle-settings-label-timezone","waffle-settings-description-timezone"),
d5b(this)];c.push(b5b(b,"Recalculation","waffle-settings-label-autorecalc"));c.push(c5b(this,b,"This affects how often NOW, TODAY, RAND, and RANDBETWEEN are updated.",2,"waffle-settings-label-autorecalc","waffle-settings-description-autorecalc"));c.push(d5b(this));c=b.Ja("table","dialog-settings",b.Ja("tbody",null,c));b.appendChild(a,c);b.appendChild(a,Ds(X4b,{FQa:this.$,lmb:this.K}));Y4b||(a=new $r(b),a.set("save","Save settings",!0),a.set("cancel","Cancel",!1,!0),Y4b=a);cs(this,Y4b);ZI(this,"save")};
function b5b(a,b,c){return a.Ja("tr",null,a.Ja("td",{id:c,"class":"dialog-settings-label"},b))}function c5b(a,b,c,d,e,f){b=b.Ja("tr",null,b.Ja("td","dialog-settings-input"),b.Ja("td",{id:f,"class":"dialog-settings-text"},c));a=a.B[d];a.render(b.firstChild);tr(a.getElement(),"labelledby",e);tr(a.getElement(),"describedby",f);return b}function d5b(a){a=a.Z();return a.Ja("tr",null,a.Ja("td",{colspan:2,"class":"dialog-settings-sep-td"},a.Ja("hr",{"class":"dialog-settings-sep"})))}
r.$a=function(){H2.O.$a.call(this);Mf(this,"dialogselect",v(this.Zrb,this));if(this.K){var a=this.Z().getElement($4b.bNa),b=this.Z().getElement($4b.cNa);this.J.rb(a);xL(this.J,b);this.J.Dc(!Bl||this.D.H.Xha())}};
r.setVisible=function(a){if(a){if(!this.L){e5b(this);return}var b=this.D.P;f5b(this,0,b.B);b=b.C||yhb().name();f5b(this,1,b);var b=this.zb.Tc((new cf).oa(),ritz.getWorkbookProperties()),c=G(b,3);Vc(c,4)?(b=G(b,3),b=""+G(b,4)):b="";f5b(this,2,b)}H2.O.setVisible.call(this,a);if(this.L&&!this.Y){if(a=Pl("ds-settings-link"))a.href=this.U;this.Y=!0}};
function e5b(a){Ai(a.Ab.bf("/info/settings").pf(g5b()),v(function(a){(a=a.yf())&&a.l&&a.tz&&(h5b(this,0,a.l),h5b(this,1,a.tz),h5b(this,2,a5b),this.U=a.dls,this.$=a.dln,this.vb=a.hl,this.K=Bl&&ritz.isFunctionLocalizationSupportedForLocale(this.vb),this.L=!0);this.setVisible(!0)},a)).we()}function g5b(){var a=Uk(Cl("win").location.href),b=Sk(a,"hl"),a=Sk(a,"forcehl");return["hl",b,"forcehl",a]}
function h5b(a,b,c){a=a.B[b];b=c.length;for(var d=0;d<b;d++){var e=c[d];a.Ye(new XC(e[1],e[0]))}a.hc().getElement().style.overflow="auto";kU(a,!0)}function f5b(a,b,c){(a=a.B[b])&&a.ob(c)}
r.Zrb=function(a){if("save"==a.key){if(this.K){a=!Bl||this.D.H.Xha();var b=this.J.isChecked();a!=b?(this.D.H.Qt(BC(),b),a=!0):a=!1}else a=!1;var c=this.B,b=this.D.P,d=c[Z4b.NW].$e().La(),e=c[Z4b.QMa].$e().La(),e=new pP(d,e);this.sb.xc(e);c=c[Z4b.mJa].$e().La();e=""===c?new KP(void 0):new KP(parseInt(c,10));this.sb.xc(e);(a||d!=b.B)&&Ika(this.D.C.B,this.Yrb)}};r.Yrb=function(){(new $hb).exec()};r.V=function(){Yb(this.B,L);delete this.B;H2.O.V.call(this)};function I2(a,b,c,d,e,f,h){Sr.call(this,void 0,!1,h);this.K=this.J=this.U=this.L=null;this.$=a;this.D=b;this.B=[];this.Y=new PMb(a,d,e,f)}z(I2,Sr);var i5b=null;r=I2.prototype;
r.jb=function(){I2.O.jb.call(this);var a=this.Z(),b=Rx(this.D),c=Qo(b.re()),d=Qo(new O(b.left+b.width-1,b.top+b.height-1));Tr(this,"Sort range from "+(c+(" to "+d)));i5b||(c=new $r,c.set("save","Sort"),c.set("cancel","Cancel",!1,!0),i5b=c);cs(this,i5b);ZI(this,"save");var e,c=a.Ja("div",{style:"overflow: hidden"},d=a.Ja("span","jfk-checkbox"),e=a.Ja("span",{style:"cursor: default"},"Data has header row")),f=this.K=new zL(void 0,a);f.rb(d);xL(f,e);1==b.height&&f.Ta(!1);fU(this.$,this.D.Nb(),b)||(f.Dc(!0),
f.Ta(!1));b=this.Ob();a.appendChild(b,c);this.L=a.Ja("div",{style:"overflow-y:auto;overflow-x:hidden;max-height:300px"},a.Ja("table",{cellSpacing:"0"},this.U=a.Ja("tbody")));a.appendChild(b,this.L);c=j5b(this);this.B.push(c);c=a.Ja("span","menuMainLink waffle-cf-add","+ Add another sort column");a.appendChild(b,c);om(c,!0);sr(c,"button");this.J=c};r.$a=function(){I2.O.$a.call(this);Hi(U(this).M(this,"dialogselect",this.Jsb),this.J,this.eYa).M(this.K,"change",this.o3a)};
function j5b(a){var b=a.Z(),c=0==a.B.length,d=new J2(a,c,a.D,0,b),e=b.Ja("tr",null,b.Ja("td",{colspan:"4"},b.Ja("div","waffle-sd-row-separator")));d.render(a.U);b.appendChild(a.U,e);c||Hi(U(a),d.C,v(a.kQa,a,d));a=k5b(a);l5b(d,a);return d}r.kQa=function(a){var b=this.B;if(1<b.length){var c=lb(b,a);-1!=c&&(Db(b,c),b=a.getElement(),b=hm(b),a.dispose(),dm(b),R(this.J,!0),this.J.focus(),Zm("Sort criteria removed."))}};
function k5b(a){var b=Rx(a.D),c=b.Pb(),b=b.Ec(),d=ob(a.B,function(a){return a.Bn()},a);if(d)for(var e=iy(a.D,d[d.length-1]),f=e+1<b?e+1:c;f!=e;f=f+1<b?f+1:c){var h=ky(a.D,f);if(!vb(d,h))return h}return null}r.o3a=function(){for(var a=this.B,b=0;b<a.length;b++)l5b(a[b])};r.eYa=function(){var a=ai(Rx(this.D),"c"),a=Math.max(10,a);this.B.length<a&&(this.B.push(j5b(this)),Zm("Sort criteria added."));yn(kb(this.B).getElement(),this.L,!0);this.L.scrollLeft=0;this.B.length>=a&&R(this.J,!1)};
r.Jsb=function(a){if("save"==a.key){a=[];for(var b=[],c=this.B,d=0;d<c.length;d++){var e=c[d];a.push(e.Bn());e=e.D.isChecked();b.push(e?1:0)}c=Rx(this.D);d=ai(c,"r");this.K.isChecked()&&1<d&&ZUb(c,c.Rb()+1,c.Pb(),c.wc(),c.Ec());a=new CX(a,b,this.D,c,this.K.isChecked());QMb(this.Y,this.D,a)}};r.V=function(){I2.O.V.call(this);kf(this.B)};function J2(a,b,c,d,e){S.call(this,e);this.H=this.K=this.D=this.B=this.C=null;this.P=-1;this.R=a;this.L=b;this.J=c}z(J2,S);
J2.prototype.Bn=function(){var a=this.B.$e();return a?a.La():-1};
J2.prototype.jb=function(){var a=this.Z(),b=this.L?"sort by":"then by",c=v(a.Yi,a),d,e,f,h=a.Ja("tr","waffle-sd-tr-rules",a.Ja("td","waffle-sd-delete",this.L?"":this.C=a.Ja("span",{title:"Remove sort criteria."},"x")),a.Ja("td","waffle-sd-td-rules",a.Ja("label",{id:$n(this,"csl")},b)),b=a.Ja("td","waffle-sd-column-selector"),a.Ja("td","waffle-sd-td-ascending",f=a.Ja("div",null,d=a.Ja("div",{title:"Ascending"}),e=a.Ja("div",{title:"Descending"}))));sr(f,"radiogroup");f=this.D=new m_(a,c(fo(!0,this.Ue())),
"ascending");f.render(d);a=this.K=new m_(a,c(fo(!1,this.Ue())),"descending");a.render(e);this.H=new p_([f,a]);q_(this.H,f);a=this.B=m2();a.render(b);tr(a.getElement(),"label",this.L?"Select first column to sort by:":"Select next column to sort by:");this.C&&(om(this.C,!0),sr(this.C,"button"),yr(this.C,"Remove sort criteria."));this.qa=h};
function l5b(a,b){var c=a.Z(),d=a.R.K.isChecked(),e=Rx(a.J),f=e.Rb(),h=e.Pb(),e=e.Ec();a.P=b||a.Bn();for(var k=a.B.Uj();0<k;k--)a.B.jF(0);for(k=h;k<e;k++)h=Xa(a.J.hd(f,k).getDisplayValue(),15),h=new XC(Ka(h)||!d?"Column "+Io(k):h,ky(a.J,k),c),a.B.Ye(h);a.B.Af(0);0<=a.P&&a.B.ob(a.P)}J2.prototype.V=function(){J2.O.V.call(this);this.B=this.C=this.J=this.R=null;L(this.D);L(this.K);L(this.H);this.H=this.K=this.D=null};function m5b(){J.call(this)}z(m5b,Dm);r=m5b.prototype;r.EUa=function(){return G3b};r.TUa=function(){return I3b};r.Yfb=function(a,b,c,d){var e=new bF;a=new YI(a,b,c,d,void 0,!0,void 0);ZI(a,"ok");b=v(e.rb,e);a.$ca=b;K(a,e);a.Li=!0;a.Jia=dba(Ka);return a};r.HVa=function(){return A2};r.XPa=function(a,b,c,d,e){return new I2(a,b,0,c,d,e,void 0)};r.$Ua=function(){return t2};r.zua=function(){return v2};r.kVa=function(){return G4b};r.UPa=function(a,b,c,d,e){return new y2(a,b,0,c,d,e,ha,void 0)};r.MVa=function(){return H2};
r.LVa=function(){return E3b};r.KVa=function(){return G2};r.WUa=function(){return U1};r.IVa=function(){return j2b};r.JVa=function(){return H2b};Tm("dialogs",m5b);
