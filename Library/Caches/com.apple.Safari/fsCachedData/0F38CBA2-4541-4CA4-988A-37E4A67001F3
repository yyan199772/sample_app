function YIc(a){var b=IYb(a);return b&&a.Ja(b)}function ZIc(a,b,c){Zt(a,function(a){a=a.Afb(b,c,this.yb,this.j);Xt(this,a);a.setVisible(!0);a.start()},"onepick")}function $Ic(a,b){Zt(a,function(a){var d=Tk("/convert/import"),d=a.Ifb(d,this.V,this.Zd,b);Xt(this,d);d.setVisible(!0);a.Hfb(d,this.j,this.cb)},"onepick")}function aJc(a){M.call(this,"sheet-imported");this.Tg=a}z(aJc,M);function bJc(a,b,c){this.V=a;bz.call(this,b,!0,c);eu(this,v(this.xb,this))}z(bJc,bz);
bJc.prototype.xb=function(a){switch(a.action){case "picked":this.V.dispatchEvent(new cJc(a.docs[0]));case "cancel":this.setVisible(!1)}};bJc.prototype.H=function(){this.V.tB("spreadsheetpicked")};function cJc(a){M.call(this,"spreadsheetpicked");this.j=a}z(cJc,M);function F$(a,b,c,d,e){J.call(this);this.C=a;this.B=d;this.o=e;this.j=new P(this)}z(F$,J);F$.prototype.F=function(a){this.j.K(a,"spreadsheetpicked",this.D)};
F$.prototype.D=function(a){if(tC(this.C.B))Wm("Sorry, you can't complete this action while offline.");else{var b=a.j.id;if(!b&&(a=a.j.url)){var c=/key=([a-zA-Z0-9-_]+)/.exec(a);c||(c=/\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/.exec(a));c&&(b=c[1]);if(!b){rs.getInstance().postMessage(ts("Can't copy sheet because the URL isn't valid.","error",!0));return}}a=this.B.j.ub();ZIc(this.o,a,Oa(b))}};F$.prototype.R=function(){F$.L.R.call(this);this.j.dispose()};function G$(a,b,c,d,e){Qr.call(this,void 0,!1,e);this.B=a;this.j=b;this.H=c;this.P=d}z(G$,Qr);G$.prototype.ib=function(){G$.L.ib.call(this);qr(yva(this),"live","assertive");Rr(this,"Copying sheet...");$r(this,!1);as(this,null);var a=this.Lb(),b=this.X();this.J=b.oa("img",{src:Bl("imgPath")+"spinner.gif"});b.appendChild(a,this.J)};G$.prototype.start=function(){xi(yi(this.H,"/copyto/sheet",v(this.F,this,this.B,this.j)).setTimeout(1E5),1).lf("gid",this.B,"did",this.j).pe()};
G$.prototype.F=function(a,b,c,d){if(this.gb()){$r(this,!0);as(this,fs());SI(this,"ok");var e,f;try{f=d.vf()["0"],c=0==f,e=d.vf().u}catch(h){c=!1}c?(f="Success copying worksheet. "+('<a target="_blank" href="'+e+'">Open target workbook</a>'),this.P.C.some(za(dJc,a),this)&&(f+="<br><br>Please note, some charts or gadgets were copied incompletely because data was on a different worksheet"),Rr(this,"Sheet copied successfully"),this.setContent(f)):(Rr(this,"Copy sheet error"),a="Oops.  A server error occurred.",
2==f?a="You do not have edit access to the spreadsheet. Make sure you are properly authenticated.":3==f&&(a="Too much data to copy to the old Google Sheets.  Please reduce the number of rows and/or columns before copying."),this.setContent(a));this.focus();this.$k()}};function dJc(a,b){if(b.ub()!=a)return!1;var c=Wz(b);if(c)for(var d=0;d<c.length;d++)if(c[d].Rc!=a)return!0;return!1};var eJc=Js(function(){var a={csv:{PREVIEW:!1,SHEET:!0,DELIMITED:!0},txt:{PREVIEW:!1,SHEET:!0,DELIMITED:!0},tsv:{PREVIEW:!1,SHEET:!0,DELIMITED:!0},tab:{PREVIEW:!1,SHEET:!0,DELIMITED:!0}};a.htm=a.html={PREVIEW:!1,SHEET:!0,DELIMITED:!1};a.xls={PREVIEW:!1,SHEET:!1,DELIMITED:!1};a.xlsx={PREVIEW:!1,SHEET:!1,DELIMITED:!1};a.xlsm={PREVIEW:!1,SHEET:!1,DELIMITED:!1};a.xlt={PREVIEW:!1,SHEET:!1,DELIMITED:!1};a.xltm={PREVIEW:!1,SHEET:!1,DELIMITED:!1};a.xltx={PREVIEW:!1,SHEET:!1,DELIMITED:!1};a.ods={PREVIEW:!1,
SHEET:!1,DELIMITED:!1};return a});function fJc(a){return eJc().hasOwnProperty(gJc(a))}function gJc(a){a=a.split(".");return 1==a.length?"":a[a.length-1].toLowerCase()};function hJc(a,b){J.call(this);this.B=a;this.o=b;this.j=new P(this);K(this,this.j)}z(hJc,J);hJc.prototype.D=function(a){this.j.K(a,"spreadsheetpicked",this.C)};hJc.prototype.C=function(a){if(tC(this.B.B))Wm("Sorry, you can't complete this action while offline.");else{var b=Oa(a.j.name);fJc(b)?$Ic(this.o,a.j):(a="Sorry, that file type isn't supported for import.<br/>Supported types are: "+(ec(eJc()).join(", ")+"."),b="<i>"+Ua(b)+"</i><br/><br/>"+a,Wm(b,"Import error",void 0,!0))}};function iJc(a){a=a||{};a=""+('<span class="dlgRitzImport, dlgRitzImportButterPane" aria-live="polite"><span id="badOptionButterPane">The selected option is not available for this file format.&nbsp;&nbsp;<a href="'+Z(It(a.GK))+'" target="_blank">'+Y(a.vda)+'</a></span><span id="formatButterPane">This file could not be imported.&nbsp;&nbsp;'+Y(a.MDa)+'.&nbsp;&nbsp;<a href="'+Z(It(a.GK))+'" target="_blank">'+Y(a.vda)+'</a></span><span id="replaceButterPane">All data currently in this spreadsheet will be replaced.</span></span>');
return et(a)};function jJc(a){a=a||{};a=""+('<div class="dlgRitzImport"><div id="divFileName" class="dlgImportSelectedFile">Importing:<span> '+Y(a.GTa)+' </span><span id="spanImportSpinner" class="waitSpinner" aria-label= \''+Et("Working ...")+'\' aria-live="polite"><img src="'+Z(Vxa(a.Iga))+'" alt="spinner"></img></span></div><div id="divUploadMsgs" class="uploadBox" style="display:none" aria-live="polite"></div><div id="optionPane"><div id="destinationOptionsHeader" class="dlgImportHeader">Import action</div><div id="destinationOptions" role="radiogroup" aria-labelledby="destinationOptionsHeader"><div role="presentation"><label><input type="radio" name="destination" value="NEW_SPREADSHEET" checked>Create new spreadsheet</label></div><div role="presentation"><label><input type="radio" name="destination" value="NEW_SHEET">Insert new sheet(s)</label></div><div role="presentation"><label><input type="radio" name="destination" value="REPLACE_SPREADSHEET">Replace spreadsheet</label></div><div role="presentation"><label><input type="radio" name="destination" value="REPLACE_SHEET">Replace current sheet</label></div><div role="presentation"><label><input type="radio" name="destination" value="APPEND_SHEET">Append rows to current sheet</label></div><div role="presentation"><label><input type="radio" name="destination" value="REPLACE_DATA">Replace data starting at selected cell</label></div></div><div id="delimiterOptionsPane"><div id="delimiterOptionHeader" class="dlgImportHeader">Separator character</div><div role="radiogroup" aria-labelledby="delimiterOptionHeader">'+
Dt(g_({checked:!0,label:zt("Detect automatically"),name:"delimiter",value:a.KNa}))+Dt(g_({label:zt("Tab"),name:"delimiter",value:a.tab}))+Dt(g_({label:zt("Comma"),name:"delimiter",value:a.WOa}))+'<div id="delimiterOptionCustom">'+Dt(g_({id:"dlgImportCustomOption",label:zt("Custom:"),name:"delimiter",value:a.BPa}))+'&nbsp;<input class="jfk-textinput" name="customDelimiter" id="customDelimiter" type="text" style="width:20px" maxlength="1" aria-labelledby="delimiterOptionCustom"></div></div></div></div><div class="dlgImportClear"></div></div>');
return et(a)}function kJc(a){a=a||{};var b;b=zt("Open now");a=""+('<span>File imported successfully.</span>&nbsp;<a href="'+Z(It(a.link))+'" target="_blank" id="ritzimport-success-link" role="button" aria-label="'+Z(b)+'"><b>'+Y(b)+" &raquo;</b></a>");return et(a)};function H$(a,b,c,d,e){Qr.call(this,void 0,!1,e);this.B=a;this.Y=d;this.qb=b;this.Zd=c}z(H$,Qr);var lJc={IW:"NEW_SPREADSHEET",sNb:"NEW_SHEET",lQb:"REPLACE_SPREADSHEET",kQb:"REPLACE_SHEET",pwb:"APPEND_SHEET",gQb:"REPLACE_DATA"};r=H$.prototype;
r.ib=function(){H$.L.ib.call(this);Rr(this,"Import file");var a=new Yr;a.set("import","Import",!1,!1);a.set("cancel","Cancel",!1,!0);as(this,a);SI(this,"import");var b=this.Lb(),c=this.X(),a=Bl("imgPath")+"spinner.gif",a=tt(jJc,{GTa:this.getFileName(),Iga:a,vda:"Learn more",MDa:"Supported formats: .xls, .xlsx, .csv, .tsv, .ods",KNa:"AUTO",tab:"TAB",WOa:",",BPa:"CUSTOM"},null,c);c.appendChild(b,a);b=Bs(iJc,{vda:"Learn more",GK:xla,MDa:"Supported formats: .xls, .xlsx, .csv, .tsv, .ods"});Ur(this).appendChild(b);
b=this.j=new j0(!0);k0(b,"destination",a);for(var c={},d=b.F,e=0;e<d.length;e++){var f=d[e];c[b.Ja(f)]=f}this.J=c;this.H=TVb("delimiter",a)};
r.Ua=function(){H$.L.Ua.call(this);var a=this.X();this.$k();R(a.getElement("formatButterPane"),!1);this.F=a.getElement("divUploadMsgs");this.tb=a.getElement("spanImportSpinner");this.P=a.getElement("delimiterOptionsPane");mJc(this,0);U(this).K(this,"dialogselect",this.Btb).K(this.H,"change",this.rua).K(this.j,"change",this.i0a).K(a.getElement("customDelimiter"),"keyup",this.rua)};
function nJc(a){var b=fJc(a.getFileName()),c=null!=(YIc(a.j)||null),d=!1;c&&(d=a.J[oJc(a)],d=a.j.isEnabled(d));bs(a.o,"import").disabled=!(b&&c&&d)}function pJc(a,b){var c=new Lg(["APPEND_SHEET","REPLACE_DATA","REPLACE_SHEET"]);"READ_ONLY"==a.V?(l0(a.j,a.J.NEW_SPREADSHEET),qJc(a,"NEW_SPREADSHEET"),Yb(lJc,function(a){"NEW_SPREADSHEET"!=a&&this.Dpa(!1,a)},a)):("NON_GRID"==a.V&&(b=!1),!b&&c.contains(oJc(a))&&(In(Nl("formatButterPane"))||rJc(a,"badOptionButterPane",!0)),Kg(c,v(a.Dpa,a,b)),nJc(a))}
r.Dpa=function(a,b){var c=this.J[b];this.j.Ma(c,a);Dr(this.X().iq(this.j.getElement(c)),"dlgImportDisabled",!a)};function qJc(a,b){a.B.vb("dst",b);var c=new Lg(["APPEND_SHEET","REPLACE_DATA","REPLACE_SHEET"]);rJc(a,"replaceButterPane","REPLACE_SPREADSHEET"==String(b)&&!In(Nl("formatButterPane")));c.contains(b)||(rJc(a,"badOptionButterPane",!1),nJc(a))}function oJc(a){return String(Nk(a.B,"dst"))}
function sJc(a){mJc(a,1);zi(Ai(xi(Qj(a.qb.Xe(a.B.toString()).lf("idi",Oa(a.Y.id),"esid",Qi(a.Zd)),"POST").setTimeout(135E3),1),function(a){tJc(this,a)},a),function(){tJc(this,null)},a).pe()}r.setMode=ca("V");function uJc(a){var b=UVb(a.H);return"CUSTOM"==b?a.X().getElement("customDelimiter").value:"TAB"==b?"\t":b}
function tJc(a,b){var c=null,d=null,e=null==b,f="Sorry, can't import this file right now. Try again later.";if(b)try{var h=b.vf();0==h["0"]?(c=h["1"],gc(h,"s")&&(d=h.s)):(e=!0,f=vJc(h.c))}catch(k){e=!0}e&&(h=a.X(),h=h.oa("div","dlgImportError",h.Ui(f)),$l(a.F),a.F.appendChild(h),R(a.F,!0),Ym(f));mJc(a,2);a.dispatchEvent(new wJc("import-done",a,c,d,e))}
function vJc(a){switch(a){case 1:return"Too large to import. Remove rows or columns and try again.";case 2:return"Couldn't be opened for import. If the file is password protected, try removing the password.";case 3:return"This file couldn't be imported because it may be damaged. Save a copy and try importing again.";case 4:return"Couldn't be imported. Save as a .csv, .xlsx or .ods and try importing again.";case 5:return"Couldn't be imported. You are trying to edit a protected cell or object.  Please contact the spreadsheet owner to remove protection if you need to edit.";
default:return"Sorry, can't import this file right now. Try again later."}}r.rua=function(){this.dispatchEvent("option-change")};r.i0a=function(){this.dispatchEvent("option-change")};function mJc(a,b){var c=1==b;R(a.F,2==b);R(a.tb,c);var d=bs(a.o,"import"),e=bs(a.o,"cancel");d&&(c&&e&&e.focus(),d.disabled=c)}r.getFileName=function(){return Oa(this.Y.name)};r.Btb=function(a){"import"==a.key&&(a.preventDefault(),this.dispatchEvent("import"))};
function rJc(a,b,c){R(Nl(b),c);Dr(Ur(a),"dlgRitzImportButterPane",In(Nl("badOptionButterPane"))||In(Nl("formatButterPane"))||In(Nl("replaceButterPane")))}r.R=function(){H$.L.R.call(this);this.P=this.F=null;L(this.j);this.j=null;L(this.H);this.H=null};function wJc(a,b,c,d,e){M.call(this,a,b);this.Fc=c||null;this.Tg=d||null;this.Yc=!!e}z(wJc,M);function I$(a,b,c){J.call(this);this.j=a;this.B=eJc();this.o=b;this.Vb=c;c=this.o.j;if(this.o.Bd())a.setMode("READ_ONLY");else if($I(c)&&!$H(b)){a.setMode("NORMAL");var d=QB(c);b=Ux(d);c=b.y;d=d.Mb();a.B.vb("c",b.x);a.B.vb("r",c);a.B.vb("agi",d)}else a.setMode("NON_GRID");this.U=new P(this);this.U.K(a,"option-change",this.F).K(a,"import",this.D).K(a,"import-done",this.C);qJc(a,"NEW_SPREADSHEET");b=this.j.getFileName();b=this.B[gJc(b)];pJc(a,!b||!!b.SHEET);b=this.j.getFileName();b=(b=this.B[gJc(b)])&&
!!b.DELIMITED;a.B.vb("del","AUTO");R(a.P,b);a.$k()}z(I$,J);I$.prototype.C=function(a){if(!a.Yc){var b=this.o.o.j;ik(b,gk(b.Na,4,!0));ik(b,gk(b.Na,4,!1));var b=this.j,c;c=a.Tg;c=(Bl("userDashPrefix")||"")+"/spreadsheets/d/"+a.Fc+"/edit"+(c?"#gid="+c:"");"NEW_SPREADSHEET"==oJc(b)?(a=Bs(kJc,{link:c}),$l(b.F),b.F.appendChild(a),R(b.F,!0),b.X().getElement("ritzimport-success-link").focus(),Ym("File imported successfully.")):(b.setVisible(!1),null!==a.Tg&&(a=Number(a.Tg))&&this.Vb.dispatchEvent(new aJc(a)))}};
I$.prototype.D=function(){sJc(this.j)};I$.prototype.F=function(){var a=this.j,b=String(Nk(a.B,"del"))!=uJc(a),a=oJc(a)!=(YIc(a.j)||null);if(b||a)b=this.j,a=uJc(b),b.B.vb("del",a),qJc(b,YIc(b.j)||null)};I$.prototype.R=function(){I$.L.R.call(this);this.U.dispose();this.B={}};function xJc(){J.call(this)}z(xJc,Cm);r=xJc.prototype;r.yfb=function(a,b,c){return new F$(a,0,0,b,c)};r.Efb=function(a,b){return new hJc(a,b)};r.zfb=function(a){return new bJc(a,Bl("onePickSheetPickerUrl"))};r.Ffb=function(a){return new bJc(a,Bl("onePickImportPickerUrl"))};r.Afb=function(a,b,c,d){return new G$(a,b,c,d,void 0)};r.Hfb=function(a,b,c){new I$(a,b,c)};r.Ifb=function(a,b,c,d){return new H$(a,b,c,d)};Sm("onepick",xJc);
