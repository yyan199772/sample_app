function cJc(a){var b=RYb(a);return b&&a.La(b)}function dJc(a,b,c){au(a,function(a){a=a.Sfb(b,c,this.Ab,this.B);Zt(this,a);a.setVisible(!0);a.start()},"onepick")}function eJc(a,b){au(a,function(a){var d=Uk("/convert/import"),d=a.$fb(d,this.Y,this.ke,b);Zt(this,d);d.setVisible(!0);a.Zfb(d,this.B,this.gb)},"onepick")}function fJc(a){M.call(this,"sheet-imported");this.Xg=a}z(fJc,M);function gJc(a,b,c){this.Y=a;dz.call(this,b,!0,c);gu(this,v(this.zb,this))}z(gJc,dz);
gJc.prototype.zb=function(a){switch(a.action){case "picked":this.Y.dispatchEvent(new hJc(a.docs[0]));case "cancel":this.setVisible(!1)}};gJc.prototype.K=function(){this.Y.FB("spreadsheetpicked")};function hJc(a){M.call(this,"spreadsheetpicked");this.B=a}z(hJc,M);function F$(a,b,c,d,e){J.call(this);this.F=a;this.D=d;this.C=e;this.B=new P(this)}z(F$,J);F$.prototype.J=function(a){this.B.M(a,"spreadsheetpicked",this.H)};
F$.prototype.H=function(a){if(zC(this.F.D))Xm("Sorry, you can't complete this action while offline.");else{var b=a.B.id;if(!b&&(a=a.B.url)){var c=/key=([a-zA-Z0-9-_]+)/.exec(a);c||(c=/\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/.exec(a));c&&(b=c[1]);if(!b){ts.getInstance().postMessage(vs("Can't copy sheet because the URL isn't valid.","error",!0));return}}a=this.D.B.wb();dJc(this.C,a,Oa(b))}};F$.prototype.V=function(){F$.O.V.call(this);this.B.dispose()};function G$(a,b,c,d,e){Sr.call(this,void 0,!1,e);this.D=a;this.B=b;this.K=c;this.U=d}z(G$,Sr);G$.prototype.jb=function(){G$.O.jb.call(this);tr(Ava(this),"live","assertive");Tr(this,"Copying sheet...");bs(this,!1);cs(this,null);var a=this.Ob(),b=this.Z();this.L=b.Ja("img",{src:Cl("imgPath")+"spinner.gif"});b.appendChild(a,this.L)};G$.prototype.start=function(){xi(yi(this.K,"/copyto/sheet",v(this.J,this,this.D,this.B)).setTimeout(1E5),1).pf("gid",this.D,"did",this.B).we()};
G$.prototype.J=function(a,b,c,d){if(this.ib()){bs(this,!0);cs(this,hs());ZI(this,"ok");var e,f;try{f=d.yf()["0"],c=0==f,e=d.yf().u}catch(h){c=!1}c?(f="Success copying worksheet. "+('<a target="_blank" href="'+e+'">Open target workbook</a>'),this.U.F.some(za(iJc,a),this)&&(f+="<br><br>Please note, some charts or gadgets were copied incompletely because data was on a different worksheet"),Tr(this,"Sheet copied successfully"),this.setContent(f)):(Tr(this,"Copy sheet error"),a="Oops.  A server error occurred.",
2==f?a="You do not have edit access to the spreadsheet. Make sure you are properly authenticated.":3==f&&(a="Too much data to copy to the old Google Sheets.  Please reduce the number of rows and/or columns before copying."),this.setContent(a));this.focus();this.jl()}};function iJc(a,b){if(b.wb()!=a)return!1;var c=Yz(b);if(c)for(var d=0;d<c.length;d++)if(c[d].Wc!=a)return!0;return!1};var jJc=Ls(function(){var a={csv:{PREVIEW:!1,SHEET:!0,DELIMITED:!0},txt:{PREVIEW:!1,SHEET:!0,DELIMITED:!0},tsv:{PREVIEW:!1,SHEET:!0,DELIMITED:!0},tab:{PREVIEW:!1,SHEET:!0,DELIMITED:!0}};a.htm=a.html={PREVIEW:!1,SHEET:!0,DELIMITED:!1};a.xls={PREVIEW:!1,SHEET:!1,DELIMITED:!1};a.xlsx={PREVIEW:!1,SHEET:!1,DELIMITED:!1};a.xlsm={PREVIEW:!1,SHEET:!1,DELIMITED:!1};a.xlt={PREVIEW:!1,SHEET:!1,DELIMITED:!1};a.xltm={PREVIEW:!1,SHEET:!1,DELIMITED:!1};a.xltx={PREVIEW:!1,SHEET:!1,DELIMITED:!1};a.ods={PREVIEW:!1,
SHEET:!1,DELIMITED:!1};return a});function kJc(a){return jJc().hasOwnProperty(lJc(a))}function lJc(a){a=a.split(".");return 1==a.length?"":a[a.length-1].toLowerCase()};function mJc(a,b){J.call(this);this.D=a;this.C=b;this.B=new P(this);K(this,this.B)}z(mJc,J);mJc.prototype.H=function(a){this.B.M(a,"spreadsheetpicked",this.F)};mJc.prototype.F=function(a){if(zC(this.D.D))Xm("Sorry, you can't complete this action while offline.");else{var b=Oa(a.B.name);kJc(b)?eJc(this.C,a.B):(a="Sorry, that file type isn't supported for import.<br/>Supported types are: "+(ec(jJc()).join(", ")+"."),b="<i>"+Ua(b)+"</i><br/><br/>"+a,Xm(b,"Import error",void 0,!0))}};function nJc(a){a=a||{};a=""+('<span class="dlgRitzImport, dlgRitzImportButterPane" aria-live="polite"><span id="badOptionButterPane">The selected option is not available for this file format.&nbsp;&nbsp;<a href="'+Z(Kt(a.WK))+'" target="_blank">'+Y(a.Nda)+'</a></span><span id="formatButterPane">This file could not be imported.&nbsp;&nbsp;'+Y(a.SGa)+'.&nbsp;&nbsp;<a href="'+Z(Kt(a.WK))+'" target="_blank">'+Y(a.Nda)+'</a></span><span id="replaceButterPane">All data currently in this spreadsheet will be replaced.</span></span>');
return mt(a)};function oJc(a){a=a||{};a=""+('<div class="dlgRitzImport"><div id="divFileName" class="dlgImportSelectedFile">Importing:<span> '+Y(a.dUa)+' </span><span id="spanImportSpinner" class="waitSpinner" aria-label= \''+Gt("Working ...")+'\' aria-live="polite"><img src="'+Z(Wxa(a.Zga))+'" alt="spinner"></img></span></div><div id="divUploadMsgs" class="uploadBox" style="display:none" aria-live="polite"></div><div id="optionPane"><div id="destinationOptionsHeader" class="dlgImportHeader">Import action</div><div id="destinationOptions" role="radiogroup" aria-labelledby="destinationOptionsHeader"><div role="presentation"><label><input type="radio" name="destination" value="NEW_SPREADSHEET" checked>Create new spreadsheet</label></div><div role="presentation"><label><input type="radio" name="destination" value="NEW_SHEET">Insert new sheet(s)</label></div><div role="presentation"><label><input type="radio" name="destination" value="REPLACE_SPREADSHEET">Replace spreadsheet</label></div><div role="presentation"><label><input type="radio" name="destination" value="REPLACE_SHEET">Replace current sheet</label></div><div role="presentation"><label><input type="radio" name="destination" value="APPEND_SHEET">Append rows to current sheet</label></div><div role="presentation"><label><input type="radio" name="destination" value="REPLACE_DATA">Replace data starting at selected cell</label></div></div><div id="delimiterOptionsPane"><div id="delimiterOptionHeader" class="dlgImportHeader">Separator character</div><div role="radiogroup" aria-labelledby="delimiterOptionHeader">'+
Ft(l_({checked:!0,label:Bt("Detect automatically"),name:"delimiter",value:a.hOa}))+Ft(l_({label:Bt("Tab"),name:"delimiter",value:a.tab}))+Ft(l_({label:Bt("Comma"),name:"delimiter",value:a.tPa}))+'<div id="delimiterOptionCustom">'+Ft(l_({id:"dlgImportCustomOption",label:Bt("Custom:"),name:"delimiter",value:a.ZPa}))+'&nbsp;<input class="jfk-textinput" name="customDelimiter" id="customDelimiter" type="text" style="width:20px" maxlength="1" aria-labelledby="delimiterOptionCustom"></div></div></div></div><div class="dlgImportClear"></div></div>');
return mt(a)}function pJc(a){a=a||{};var b;b=Bt("Open now");a=""+('<span>File imported successfully.</span>&nbsp;<a href="'+Z(Kt(a.link))+'" target="_blank" id="ritzimport-success-link" role="button" aria-label="'+Z(b)+'"><b>'+Y(b)+" &raquo;</b></a>");return mt(a)};function H$(a,b,c,d,e){Sr.call(this,void 0,!1,e);this.D=a;this.$=d;this.sb=b;this.ke=c}z(H$,Sr);var qJc={VW:"NEW_SPREADSHEET",CNb:"NEW_SHEET",tQb:"REPLACE_SPREADSHEET",sQb:"REPLACE_SHEET",Lwb:"APPEND_SHEET",oQb:"REPLACE_DATA"};r=H$.prototype;
r.jb=function(){H$.O.jb.call(this);Tr(this,"Import file");var a=new $r;a.set("import","Import",!1,!1);a.set("cancel","Cancel",!1,!0);cs(this,a);ZI(this,"import");var b=this.Ob(),c=this.Z(),a=Cl("imgPath")+"spinner.gif",a=vt(oJc,{dUa:this.getFileName(),Zga:a,Nda:"Learn more",SGa:"Supported formats: .xls, .xlsx, .csv, .tsv, .ods",hOa:"AUTO",tab:"TAB",tPa:",",ZPa:"CUSTOM"},null,c);c.appendChild(b,a);b=Ds(nJc,{Nda:"Learn more",WK:xla,SGa:"Supported formats: .xls, .xlsx, .csv, .tsv, .ods"});Wr(this).appendChild(b);
b=this.B=new o0(!0);p0(b,"destination",a);for(var c={},d=b.J,e=0;e<d.length;e++){var f=d[e];c[b.La(f)]=f}this.L=c;this.K=bWb("delimiter",a)};
r.$a=function(){H$.O.$a.call(this);var a=this.Z();this.jl();R(a.getElement("formatButterPane"),!1);this.J=a.getElement("divUploadMsgs");this.vb=a.getElement("spanImportSpinner");this.U=a.getElement("delimiterOptionsPane");rJc(this,0);U(this).M(this,"dialogselect",this.Wtb).M(this.K,"change",this.xxa).M(this.B,"change",this.C0a).M(a.getElement("customDelimiter"),"keyup",this.xxa)};
function sJc(a){var b=kJc(a.getFileName()),c=null!=(cJc(a.B)||null),d=!1;c&&(d=a.L[tJc(a)],d=a.B.isEnabled(d));ds(a.C,"import").disabled=!(b&&c&&d)}function uJc(a,b){var c=new Lg(["APPEND_SHEET","REPLACE_DATA","REPLACE_SHEET"]);"READ_ONLY"==a.Y?(q0(a.B,a.L.NEW_SPREADSHEET),vJc(a,"NEW_SPREADSHEET"),Yb(qJc,function(a){"NEW_SPREADSHEET"!=a&&this.Vsa(!1,a)},a)):("NON_GRID"==a.Y&&(b=!1),!b&&c.contains(tJc(a))&&(Jn(Pl("formatButterPane"))||wJc(a,"badOptionButterPane",!0)),Kg(c,v(a.Vsa,a,b)),sJc(a))}
r.Vsa=function(a,b){var c=this.L[b];this.B.Ta(c,a);Fr(this.Z().yq(this.B.getElement(c)),"dlgImportDisabled",!a)};function vJc(a,b){a.D.xb("dst",b);var c=new Lg(["APPEND_SHEET","REPLACE_DATA","REPLACE_SHEET"]);wJc(a,"replaceButterPane","REPLACE_SPREADSHEET"==String(b)&&!Jn(Pl("formatButterPane")));c.contains(b)||(wJc(a,"badOptionButterPane",!1),sJc(a))}function tJc(a){return String(Sk(a.D,"dst"))}
function xJc(a){rJc(a,1);zi(Ai(xi(Sj(a.sb.bf(a.D.toString()).pf("idi",Oa(a.$.id),"esid",Qi(a.ke)),"POST").setTimeout(135E3),1),function(a){yJc(this,a)},a),function(){yJc(this,null)},a).we()}r.setMode=ca("Y");function zJc(a){var b=cWb(a.K);return"CUSTOM"==b?a.Z().getElement("customDelimiter").value:"TAB"==b?"\t":b}
function yJc(a,b){var c=null,d=null,e=null==b,f="Sorry, can't import this file right now. Try again later.";if(b)try{var h=b.yf();0==h["0"]?(c=h["1"],gc(h,"s")&&(d=h.s)):(e=!0,f=AJc(h.c))}catch(k){e=!0}e&&(h=a.Z(),h=h.Ja("div","dlgImportError",h.Yi(f)),am(a.J),a.J.appendChild(h),R(a.J,!0),Zm(f));rJc(a,2);a.dispatchEvent(new BJc("import-done",a,c,d,e))}
function AJc(a){switch(a){case 1:return"Too large to import. Remove rows or columns and try again.";case 2:return"Couldn't be opened for import. If the file is password protected, try removing the password.";case 3:return"This file couldn't be imported because it may be damaged. Save a copy and try importing again.";case 4:return"Couldn't be imported. Save as a .csv, .xlsx or .ods and try importing again.";case 5:return"Couldn't be imported. You are trying to edit a protected cell or object.  Please contact the spreadsheet owner to remove protection if you need to edit.";
default:return"Sorry, can't import this file right now. Try again later."}}r.xxa=function(){this.dispatchEvent("option-change")};r.C0a=function(){this.dispatchEvent("option-change")};function rJc(a,b){var c=1==b;R(a.J,2==b);R(a.vb,c);var d=ds(a.C,"import"),e=ds(a.C,"cancel");d&&(c&&e&&e.focus(),d.disabled=c)}r.getFileName=function(){return Oa(this.$.name)};r.Wtb=function(a){"import"==a.key&&(a.preventDefault(),this.dispatchEvent("import"))};
function wJc(a,b,c){R(Pl(b),c);Fr(Wr(a),"dlgRitzImportButterPane",Jn(Pl("badOptionButterPane"))||Jn(Pl("formatButterPane"))||Jn(Pl("replaceButterPane")))}r.V=function(){H$.O.V.call(this);this.U=this.J=null;L(this.B);this.B=null;L(this.K);this.K=null};function BJc(a,b,c,d,e){M.call(this,a,b);this.Hc=c||null;this.Xg=d||null;this.$c=!!e}z(BJc,M);function I$(a,b,c){J.call(this);this.B=a;this.D=jJc();this.C=b;this.Yb=c;c=this.C.B;if(this.C.Ed())a.setMode("READ_ONLY");else if(gJ(c)&&!gI(b)){a.setMode("NORMAL");var d=UB(c);b=Wx(d);c=b.y;d=d.Nb();a.D.xb("c",b.x);a.D.xb("r",c);a.D.xb("agi",d)}else a.setMode("NON_GRID");this.X=new P(this);this.X.M(a,"option-change",this.J).M(a,"import",this.H).M(a,"import-done",this.F);vJc(a,"NEW_SPREADSHEET");b=this.B.getFileName();b=this.D[lJc(b)];uJc(a,!b||!!b.SHEET);b=this.B.getFileName();b=(b=this.D[lJc(b)])&&
!!b.DELIMITED;a.D.xb("del","AUTO");R(a.U,b);a.jl()}z(I$,J);I$.prototype.F=function(a){if(!a.$c){var b=this.C.C.B;jk(b,hk(b.Ua,4,!0));jk(b,hk(b.Ua,4,!1));var b=this.B,c;c=a.Xg;c=(Cl("userDashPrefix")||"")+"/spreadsheets/d/"+a.Hc+"/edit"+(c?"#gid="+c:"");"NEW_SPREADSHEET"==tJc(b)?(a=Ds(pJc,{link:c}),am(b.J),b.J.appendChild(a),R(b.J,!0),b.Z().getElement("ritzimport-success-link").focus(),Zm("File imported successfully.")):(b.setVisible(!1),null!==a.Xg&&(a=Number(a.Xg))&&this.Yb.dispatchEvent(new fJc(a)))}};
I$.prototype.H=function(){xJc(this.B)};I$.prototype.J=function(){var a=this.B,b=String(Sk(a.D,"del"))!=zJc(a),a=tJc(a)!=(cJc(a.B)||null);if(b||a)b=this.B,a=zJc(b),b.D.xb("del",a),vJc(b,cJc(b.B)||null)};I$.prototype.V=function(){I$.O.V.call(this);this.X.dispose();this.D={}};function CJc(){J.call(this)}z(CJc,Dm);r=CJc.prototype;r.Qfb=function(a,b,c){return new F$(a,0,0,b,c)};r.Wfb=function(a,b){return new mJc(a,b)};r.Rfb=function(a){return new gJc(a,Cl("onePickSheetPickerUrl"))};r.Xfb=function(a){return new gJc(a,Cl("onePickImportPickerUrl"))};r.Sfb=function(a,b,c,d){return new G$(a,b,c,d,void 0)};r.Zfb=function(a,b,c){new I$(a,b,c)};r.$fb=function(a,b,c,d){return new H$(a,b,c,d)};Tm("onepick",CJc);
