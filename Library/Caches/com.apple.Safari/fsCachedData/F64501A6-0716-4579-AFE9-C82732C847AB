Type.createNamespace("Owa.Components");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/pipes.js".toLowerCase()])(function(){Owa.PipeType={Small:1,Large:2};var PipeNode=function PipeNode(oParentElement,oItemPart,stopElement,childConnectorElement){this._oItemPart=oItemPart;this._stopElement=stopElement;this._childConnectorElement=childConnectorElement;this._stopElement.set_IsShown(false);this._childConnectorElement.set_IsShown(false);oParentElement.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,this._stopElement);oParentElement.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,this._childConnectorElement)};PipeNode.prototype.get_StopElement=function PipeNode$prototype$get_StopElement(){return this._stopElement};PipeNode.prototype.get_ChildConnectorElement=function PipeNode$prototype$get_ChildConnectorElement(){return this._childConnectorElement};PipeNode.prototype.get_ItemPart=function PipeNode$prototype$get_ItemPart(){return this._oItemPart};PipeNode.prototype.dispose=function PipeNode$prototype$dispose(){if(this._stopElement){this._stopElement.remove(true)}if(this._childConnectorElement){this._childConnectorElement.remove(true)}};Owa.Components.Pipes=function Owa$Components$Pipes(oParentElement,iType){this._oParentElement=oParentElement;this._rgPipeStops=new Array();this._iType=iType;this._initPipeComponents()};Owa.Components.Pipes.prototype.dispose=function Owa$Components$Pipes$prototype$dispose(){this.clearPipes();this.oPpPH.remove(true);this.oPpPV.remove(true);this.oPsP2.remove(true);this.oPsP1.remove(true);this.oPpA.remove(true);this.oPsA.remove(true);this.oBkg.remove(true);this.oPpPH=null;this.oPpPV=null;this.oPsP2=null;this.oPsP1=null;this.oPpA=null;this.oPsA=null;this.oBkg=null};Owa.Components.Pipes.prototype.drawPipes=function Owa$Components$Pipes$prototype$drawPipes(oItemPart){this.clearPipes();this._rgPipeStops.add(new PipeNode(this._oParentElement,oItemPart,this.oPsP1.clone(true),this.oPpPH.clone(true)));oItemPart=oItemPart.get_ParentItemPart();while(oItemPart!=null){this._rgPipeStops.add(new PipeNode(this._oParentElement,oItemPart,(this._rgPipeStops.get_Length()==1?this.oPsP2:this.oPsA).clone(true),(this._rgPipeStops.get_Length()==1?this.oPpPV:this.oPpA).clone(true)));oItemPart=oItemPart.get_ParentItemPart()}this._oBkg=this.oBkg.clone(true);this._oParentElement.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,this._oBkg);this.updatePipes()};Owa.Components.Pipes.prototype.updatePipes=function Owa$Components$Pipes$prototype$updatePipes(){if(this._rgPipeStops.get_Length()<2){return}var oStopElement=this._rgPipeStops[0].get_StopElement();var oChildConnectorElement=this._rgPipeStops[0].get_ChildConnectorElement();var iPipeStopOffset=(oStopElement.get_Height()-1)/2;var iPipeHorizontalOffset=(oChildConnectorElement.get_Height()-1)/2;var rgPipeConnectorTops=new Array();for(var iPipe=0;iPipe<this._rgPipeStops.get_Length();++iPipe){rgPipeConnectorTops.add(this._rgPipeStops[iPipe].get_ItemPart().get_PipeConnectorTop())}if(rgPipeConnectorTops[0]==rgPipeConnectorTops[1]){return}var iMinTop=rgPipeConnectorTops[0]-iPipeStopOffset;var iMaxTop=iMinTop;oStopElement.set_Top(rgPipeConnectorTops[0]-iPipeStopOffset);oStopElement.set_IsShown(true);oChildConnectorElement.set_Top(rgPipeConnectorTops[0]-iPipeHorizontalOffset);oChildConnectorElement.set_IsShown(true);for(var iPipe=1;iPipe<this._rgPipeStops.get_Length();++iPipe){oStopElement=this._rgPipeStops[iPipe].get_StopElement();oChildConnectorElement=this._rgPipeStops[iPipe].get_ChildConnectorElement();var iTop=rgPipeConnectorTops[iPipe]-iPipeStopOffset;oStopElement.set_Top(iTop);oStopElement.set_IsShown(true);oChildConnectorElement.set_IsShown(true);if(iTop<iMinTop){iMinTop=iTop}if(iTop>iMaxTop){iMaxTop=iTop}var iPrevItemPartPipeOffset=iPipe==1?iPipeHorizontalOffset:iPipeStopOffset;var iPipeHeight=0;if(rgPipeConnectorTops[iPipe]<rgPipeConnectorTops[iPipe-1]){oChildConnectorElement.set_Top(rgPipeConnectorTops[iPipe]+iPipeStopOffset);iPipeHeight=rgPipeConnectorTops[iPipe-1]-rgPipeConnectorTops[iPipe]-(iPrevItemPartPipeOffset+iPipeStopOffset)}else{oChildConnectorElement.set_Top(rgPipeConnectorTops[iPipe-1]+iPrevItemPartPipeOffset);iPipeHeight=rgPipeConnectorTops[iPipe]-rgPipeConnectorTops[iPipe-1]-(iPrevItemPartPipeOffset+iPipeStopOffset)}oChildConnectorElement.set_Height(iPipeHeight>0?iPipeHeight:0)}this._oBkg.set_Top(iMinTop);this._oBkg.set_Height(iMaxTop-iMinTop)};Owa.Components.Pipes.prototype.clearPipes=function Owa$Components$Pipes$prototype$clearPipes(){for(var iPipe=0;iPipe<this._rgPipeStops.get_Length();++iPipe){this._rgPipeStops[iPipe].dispose()}this._rgPipeStops=new Array();if(this._oBkg)this._oBkg.remove(true)};Owa.Components.Pipes.prototype._initPipeComponents=function Owa$Components$Pipes$prototype$_initPipeComponents(){var fL=(this._iType==Owa.PipeType.Large);var sPipePositionClass=Owa.Strings.CssClass.LeftPipe;var sStopPositionClass=fL?Owa.Strings.CssClass.LeftStopLarge:Owa.Strings.CssClass.LeftStopSmall;var sChildStopPositionClass=fL?Owa.Strings.CssClass.LeftChildStopLarge:Owa.Strings.CssClass.LeftChildStopSmall;if(g_fRtl){sPipePositionClass=Owa.Strings.CssClass.RightPipe;sStopPositionClass=fL?Owa.Strings.CssClass.RightStopLarge:Owa.Strings.CssClass.RightStopSmall;sChildStopPositionClass=fL?Owa.Strings.CssClass.RightChildStopLarge:Owa.Strings.CssClass.RightChildStopSmall}var oStop=Owa.Components.CssSprites.getImageElement(fL?"pipe-stop-l.png":"pipe-stop-s.png");var oClr=Owa.Dom.Document.get_Current().createElement("IMG");oClr._get_DomNode().src=getThmF("clear1x1.gif");this.oBkg=oClr.clone();this.oBkg.addCssClass(Owa.Strings.CssClass.PipeBackground);this.oBkg.set_Title(L_PipesTooltip);this.oPsP1=oStop.clone();this.oPsP1.addCssClass(fL?Owa.Strings.CssClass.ParentStopLarge:Owa.Strings.CssClass.ParentStopSmall);this.oPsP2=this.oPsP1.clone();this.oPsP1.addCssClass(sChildStopPositionClass);this.oPsP2.addCssClass(sStopPositionClass);this.oPpPH=oClr.clone();this.oPpPH.addCssClass(Owa.Strings.CssClass.ChildPipe);this.oPpPH.addCssClass(sPipePositionClass);this.oPpPV=oClr.clone();this.oPpPV.addCssClass(Owa.Strings.CssClass.ParentPipe);this.oPpPV.addCssClass(sPipePositionClass);this.oPsA=oStop.clone();this.oPsA.addCssClass(fL?Owa.Strings.CssClass.AncestorStopLarge:Owa.Strings.CssClass.AncestorStopSmall);this.oPsA.addCssClass(sStopPositionClass);this.oPpA=oClr.clone();this.oPpA.addCssClass(Owa.Strings.CssClass.AncestorPipe);this.oPpA.addCssClass(sPipePositionClass)}})();g_fModuleLoaded[".\\components/pipes.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/itempart.js".toLowerCase()])(function(){var FIX_BRD=0x1;var FIX_SZ=0x2;var FIX_FORCESZ=0x04;var FIX_PIPE=0x8;var FIX_ASYNC=0x10;var FIX_ALL=FIX_BRD|FIX_SZ|FIX_PIPE;var PP_OFFST=10;var INFICN_PPI=20;var IMGFLT_BLOCK=2;var IMGFLT_SHOW=3;var IMGFLT_USER=4;var SORT_NB=0x8;var RDCNV_NS="ReadConversation";var RM_NS="ReadMessage";var IMAGE_FLT_MARKER="__OWA_FLT000__".toLowerCase();Owa.UIControls.ItemPart=function Owa$UIControls$ItemPart(oDomElement,oParentControl){Owa.UIControls.ItemPart.constructBase(this,[oDomElement,oParentControl]);this._sItmId=this._getAttribute("sItmId");this._fLocal=this._getIntAttribute("fLocal");this._sCK=this._getAttribute("sCK");this._sT=this._getAttribute("sT");this._fExp=this._getIntAttribute("fExp");this.sFId=this._getAttribute("sFId");this._sPId=this._getAttribute("sPId");this.fR=this._getIntAttribute("fR");this.iImgFlt=this._getIntAttribute("iImgFlt");this.fSup=this._getIntAttribute("fSup");this.fReadRcp=this._getIntAttribute("fReadRcp");this.fDraft=this._getIntAttribute("fDraft");this.fPhishing=this._getIntAttribute("fPhsh");this._fInJunkFolder=this._getIntAttribute("fJnk");this.fMeetingRequest=this._getIntAttribute("fMR");this.fResponseRequested=this._getIntAttribute("fRR");this._iInternetMId=this._getIntAttribute("iInternetMId");this._fSel=false;this._fPendingAlignWellTitles=false;this._fExpansionInitialized=false};Owa.UIControls.ItemPart.create=function Owa$UIControls$ItemPart$create(oDomElement,oParentControl){var sT=oDomElement.getAttribute("sT");if(sT==Owa.Strings.ObjectClass.MeetingRequest||sT==Owa.Strings.ObjectClass.MeetingCancellation){return new Owa.UIControls.MeetingItemPart(oDomElement,oParentControl)}else if(sT==Owa.Strings.ObjectClass.SharingMessage){return new Owa.UIControls.SharingItemPart(oDomElement,oParentControl)}else{return new Owa.UIControls.ItemPart(oDomElement,oParentControl)}};Owa.UIControls.ItemPart.prototype.initialize=function Owa$UIControls$ItemPart$initialize(){Owa.UIControls.ItemPart.callBase(this,"initialize");if(this.get_IsExpanded()){this.initializeExpansion()}this._attachEvent(this._get_Element().getChildById("imgEC"),"click",this.onClkEC);this._attachEvent(this._get_Element().getChildById("divClps"),"click",this.onClkClps);this._attachEvent(this._get_Element().getChildById("divClps"),"contextmenu",this.onContextMenu);this.initBranchTab();this.initHdr(this._get_Element().getChildById("divClps"))};Owa.UIControls.ItemPart.prototype.initHdr=function Owa$UIControls$ItemPart$initHdr(div){var divInfIc=div.getDescendantById("divInfIc");var iC=INFICN_PPI*divInfIc._get_DomNode().childNodes.length;divInfIc.set_Width(iC);var divSm=div.getDescendantById("divSm");if(divSm){var divDt=div.getDescendantById("divDt");var iR=divDt.get_Width()+iC+5;if(!g_fRtl){divSm.set_Right(iR)}else{divSm.set_Left(iR)}}var spnAct=div.getDescendantById("spnActions");var divHdr=div.getDescendantById("divExpHdr");if(spnAct&&divHdr){if(!this._get_Parent()._iActionsW){var spnTemp=Document.get_Current().createElement("span");spnTemp.set_TextContent(spnAct.get_TextContent());divHdr.appendChild(spnTemp);this._get_Parent()._iActionsW=spnTemp._get_DomNode().offsetWidth;spnTemp.remove(true)}var iWN=this._get_Parent()._iActionsW+30;var divAct=div.getDescendantById("divActions");divAct.set_Width(iWN);var divInfIc=div.getDescendantById("divInfIc");if(divInfIc){if(!g_fRtl){divInfIc.set_Right(iWN+40)}else{divInfIc.set_Left(iWN+40)}}}};Owa.UIControls.ItemPart.prototype.dispose=function Owa$UIControls$ItemPart$dispose(){if(!this.get_IsDisposed()){if(this.iExpPrgTmr){this._clearTimeout(this.iExpPrgTmr);this.iExpPrgTmr=0}if(this._fExpansionInitialized){this.disposeExpansion()}this._get_Element().getChildById("imgEC").detachAllEvents();this._get_Element().getChildById("divClps").detachAllEvents();this.oPrv=0;this.oNxt=0;Owa.UIControls.ItemPart.callBase(this,"dispose")}};Owa.UIControls.ItemPart.prototype.initializeExpansion=function Owa$UIControls$ItemPart$initializeExpansion(){this.initPrsnc();this._attachEvent(this._get_Element().getChildById("divExp"),"click",this.onClkExp);this._attachEvent(this._getDescendant("divExp"),"contextmenu",this.onContextClick);this._attachEvent(this._getDescendant("divActions"),"click",this.onContextClick);var oLink=this._getDescendant("aOrig");this._attachEvent(oLink,"click",this.openItemPart);this._attachEvent(oLink,"mouseover",this.onMouseOverOrig);this._attachEvent(oLink,"mouseout",this.onMouseOutOrig);var divP=this.get_BranchText();if(divP){var spnSnd=divP.getDescendantById("spnBrSn");if(spnSnd){this._attachEvent(spnSnd,"click",this.onClkBr)}}var oInfobar=new Owa.UIControls.Infobar(this._getDescendant("divInfobar"));if(!this.fSup){var oDivNotSupMessage=replaceOrInsertInfobarMessageInCurrentInfobar(oInfobar,this._get_Parent().L_TypeNotSup,"divNotSup");oLink=oDivNotSupMessage.getDescendantById("aIbNotSup");this._attachEvent(oLink,"click",this.openItemPart)}if(this.fReadRcp){var oDivReadRcpMessage=replaceOrInsertInfobarMessageInCurrentInfobar(oInfobar,this._get_Parent().L_ReadRcp,"divReadRcp");oLink=oDivReadRcpMessage.getDescendantById("aIbReadRcp");this._attachEvent(oLink,"click",this.onReadRcp)}this.initImgFlt();if(this.fDraft){var divDraft=Document.get_Current().createElement("div");divDraft.set_Id("divDraft");divDraft.set_InnerHtml(this._get_Parent().L_Draft);var divTx=this._getDescendant("divExpHdr").getChildById("divSn").getChildById("divTx");divTx.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,divDraft)}if(this.fPhishing){var oLink=this._getDescendant("aIbBlk");if(oLink){this._attachEvent(oLink,"click",this._onClickDisablePhishing)}}var oExp=this._get_Element().getChildById("divExp");this.fReplyRestricted=oExp.getIntAttribute("fRplR");this.fReplyAllRestricted=oExp.getIntAttribute("fRAR");this.fForwardRestricted=oExp.getIntAttribute("fFR");this.fCopyRestricted=oExp.getIntAttribute("fCR");this.fPrintRestricted=oExp.getIntAttribute("fPR");this.fRemoveRestriction=oExp.getIntAttribute("fRmR");if(this.fRemoveRestriction){var oLink=this._getDescendant("aIbRR");if(oLink){this._attachEvent(oLink,"click",this._onClickRemoveRestriction)}}var oSelHdr=this._getDescendant("divPrtBk");oSelHdr.addCssClass("divPrtBk");oSelHdr.removeCssClass("divPrtBkSel");this.initHdr(oExp);this._get_Parent().fixPrts(FIX_PIPE|FIX_ASYNC);this._fExpansionInitialized=true};Owa.UIControls.ItemPart.prototype.disposeExpansion=function Owa$UIControls$ItemPart$disposeExpansion(){this._get_Element().getChildById("divExp").detachAllEvents();this._getDescendant("divExpHdr").detachAllEvents();var divP=this.get_BranchText();if(divP){var spnSnd=divP.getDescendantById("spnBrSn");if(spnSnd){spnSnd.detachAllEvents()}}if(!this.fSup){var oLink=this._getDescendant("aIbNotSup");if(oLink){oLink.detachAllEvents()}}if(this.fReadRcp){var oLink=this._getDescendant("aIbReadRcp");if(oLink){oLink.detachAllEvents()}}this._getDescendant("divActions").detachAllEvents();this._getDescendant("aOrig").detachAllEvents();var oLink=this._getDescendant("aIbBlk");if(oLink){oLink.detachAllEvents()}};Owa.UIControls.ItemPart.prototype.initPrsnc=function Owa$UIControls$ItemPart$initPrsnc(){if(!g_fIsIMEnab)return;var oExp=this._get_Element().getChildById("divExp");var oFrom=oExp.getDescendantById("spnFrom");if(oFrom)updRSpnPrsnc(oFrom,1);var rgsArr=[TO,CC,BCC];for(var i=0;i<rgsArr.length;i++){var oRw=oExp.getDescendantById(rgsArr[i]);if(oRw){updRwPrsnc(oRw)}}};Owa.UIControls.ItemPart.prototype.initImgFlt=function Owa$UIControls$ItemPart$initImgFlt(){var oBdy=this._get_Element().getDescendantById("divBdy");var fBlocked=false;var rg=oBdy.getDescendantsByTagName("IMG");for(var i=0;i<rg.length;i++){var img=rg[i];var sSrc=img.getAttribute("src");if(!sSrc)continue;var iT=sSrc.toLowerCase().indexOf(IMAGE_FLT_MARKER);if(iT>=0){img.setAttribute("_src",sSrc.substring(iT+IMAGE_FLT_MARKER.length));img.setAttribute("src","");if(this.iImgFlt==IMGFLT_SHOW){img.setAttribute("src",img.getAttribute("_src"));img.set_BorderWidth(Owa.Style.Side.Top,0);img.set_BorderWidth(Owa.Style.Side.Bottom,0);img.set_BorderWidth(Owa.Style.Side.Left,0);img.set_BorderWidth(Owa.Style.Side.Right,0)}else{img.setAttribute("src",getThmF("clear1x1.gif"));fBlocked=true}}}var oInfobar=new Owa.UIControls.Infobar(this._getDescendant("divInfobar"));if(fBlocked){if(this.iImgFlt==IMGFLT_USER){var oDivImgFltMessage=replaceOrInsertInfobarMessageInCurrentInfobar(oInfobar,this._get_Parent().L_ImgFltBlock,"divImgFlt");var oLink=oDivImgFltMessage.getDescendantById("aIbBlk");this._attachEvent(oLink,"click",this.onClkImgFlt)}else{if(this.iImgFlt==IMGFLT_BLOCK){replaceOrInsertInfobarMessageInCurrentInfobar(oInfobar,this._get_Parent().L_ImgFltCompBlock,"divImgFlt")}}}};Owa.UIControls.ItemPart.prototype.fixPrtSz=function Owa$UIControls$ItemPart$fixPrtSz(){var iCW=Document.get_Current().getElementById("divItmPrts").get_ClientWidth();var iCWPad=30;this._get_Element().set_Width(g_fRtl?iCW-iCWPad:null);if(!this.get_IsExpanded())return;var oExp=this._get_Element().getChildById("divExp");var divExpHdr=oExp.getChildById("divExpHdr");var divRws=oExp.getChildById("divRws");var divWellAttach=this._getDescendant("divWellAttach");var divWellCategories=this._getDescendant("divWellCategories");var divInfobar=this._getDescendant("divInfobar");var divExpSubHdr=this._getDescendant("divExpSubHdr");if(divExpHdr)divExpHdr.set_Width(null);if(divRws)divRws.set_Width(null);if(divWellAttach)divWellAttach.set_Width(null);if(divWellCategories)divWellCategories.set_Width(null);if(divInfobar)divInfobar.set_Width(null);if(divExpSubHdr)divExpSubHdr.set_Width(null);var divBdy=this._get_Element().getChildById("divExp").getChildById("divBdy");if(divBdy.get_ScrollWidth()>divBdy.get_ClientWidth()){this._get_Element().set_Width(divBdy.get_ScrollWidth()+20);if(divExpHdr)divExpHdr.set_Width(iCW-13-iCWPad);if(divRws)divRws.set_Width(iCW+2-iCWPad);if(divWellAttach)divWellAttach.set_Width(iCW+2-iCWPad);if(divWellCategories)divWellCategories.set_Width(iCW+2-iCWPad);if(divInfobar)divInfobar.set_Width(iCW-13-iCWPad);if(divExpSubHdr)divExpSubHdr.set_Width(iCW-10-iCWPad)}};Owa.UIControls.ItemPart.prototype.onReadRcp=function Owa$UIControls$ItemPart$onReadRcp(){var oR=new oeReq("ReadMessage","SRR",0,Owa.Utility.createDelegate(this,this.cbReadRcp));oR.add("Id",this.get_Id());oR.send()};Owa.UIControls.ItemPart.prototype.cbReadRcp=function Owa$UIControls$ItemPart$cbReadRcp(oR){if(this.get_IsDisposed()){return}if(!cbOeh(oR)){shwErrDlg(oR);return}var oIbReadRcp=this._getDescendant("aIbReadRcp");if(oIbReadRcp){oIbReadRcp.detachAllEvents();this.fReadRcp=false}var divMsg=this._get_Element().getDescendantById("divReadRcp");divMsg.set_InnerHtml(oR.sBody)};Owa.UIControls.ItemPart.prototype._onClickDisablePhishing=function Owa$UIControls$ItemPart$prototype$_onClickDisablePhishing(oEvent){var oR=new oeReq(RM_NS,"Save",0,Owa.Utility.createDelegate(this,this.cbDisablePhishing),POST);oR.add("Id",this.get_Id());oR.add("CK",this._sCK);if(this.fPhishing){oR.add("StLnkEnbl",1)}oR.send()};Owa.UIControls.ItemPart.prototype._onClickRemoveRestriction=function Owa$UIControls$ItemPart$prototype$_onClickRemoveRestriction(oEvent){var oR=new oeReq("ReadMessage","RMR",0,Owa.Utility.createDelegate(this,this.cbRemoveRestriction));oR.add("Id",this.get_Id());oR.send()};Owa.UIControls.ItemPart.prototype.cbRemoveRestriction=function Owa$UIControls$ItemPart$cbRemoveRestriction(oR){if(!cbOeh(oR)){shwErrDlg(oR);return}this._get_Parent().rfrsh()};Owa.UIControls.ItemPart.prototype.onClkImgFlt=function Owa$UIControls$ItemPart$onClkImgFlt(e){if(this.get_IsDisposed()){return}var oR=new oeReq(RM_NS,"Save",0,Owa.Utility.createDelegate(this,this.cbImgFlt),POST);oR.add("Id",this.get_Id());oR.add("CK",this._sCK);oR.add("AlWbBcn",1);if(this.fPhishing){oR.add("StLnkEnbl",1)}oR.send();this.iImgFlt=IMGFLT_SHOW;var oBdy=this._get_Element().getDescendantById("divBdy");var rg=oBdy.getDescendantsByTagName("IMG");for(var i=0;i<rg.length;i++){var img=rg[i];if(img.getAttribute("src")){img.setAttribute("src",img.getAttribute("_src"));img.set_BorderWidth(Owa.Style.Side.Top,0);img.set_BorderWidth(Owa.Style.Side.Bottom,0);img.set_BorderWidth(Owa.Style.Side.Left,0);img.set_BorderWidth(Owa.Style.Side.Right,0)}}var oInfobar=new Owa.UIControls.Infobar(this._getDescendant("divInfobar"));var oImgFltMessage=oInfobar.getMessageById("divImgFlt");oInfobar.removeMessage(oImgFltMessage);safeResizeBodies();this._get_Parent().fixPrts(FIX_ALL|FIX_ASYNC)};Owa.UIControls.ItemPart.prototype.cbDisablePhishing=function Owa$UIControls$ItemPart$cbDisablePhishing(oR){if(!cbOeh(oR)){shwErrDlg(oR);return}this._get_Parent().rfrsh()};Owa.UIControls.ItemPart.prototype.cbImgFlt=function Owa$UIControls$ItemPart$cbImgFlt(oR){if(!cbOeh(oR)){shwErrDlg(oR);return}var oD=Document.get_Current().createElement("div");Document.get_Current().appendChild(oD);oD.set_InnerHtml(oR.sBody);var oCK=oD.getChildById("ck");this._sCK=oCK.get_TextContent();oD.remove(true)};Owa.UIControls.ItemPart.prototype._onBeforeUnload=function Owa$UIControls$ItemPart$prototype$_onBeforeUnload(){};Owa.UIControls.ItemPart.prototype.onClkBr=function Owa$UIControls$ItemPart$onClkBr(e){var rgSel=new Array(this.get_ParentId());this._get_Parent().setSel(rgSel,0,1);this._get_Parent().scrTo(this.get_ParentId())};Owa.UIControls.ItemPart.prototype.onMouseOverOrig=function Owa$UIControls$ItemPart$onMouseOverOrig(e){var aOrig=this._get_Element().getDescendantById("aOrig");aOrig.setAttribute("src",getThmF("view-orig-h.png"))};Owa.UIControls.ItemPart.prototype.onMouseOutOrig=function Owa$UIControls$ItemPart$onMouseOutOrig(e){var aOrig=this._get_Element().getDescendantById("aOrig");aOrig.setAttribute("src",getThmF("view-orig.png"))};Owa.UIControls.ItemPart.prototype.onClkEC=function Owa$UIControls$ItemPart$onClkEC(e){this.exp(this.get_IsExpanded());this._get_Parent().onTouchItemPart(this)};Owa.UIControls.ItemPart.prototype.onClkClps=function Owa$UIControls$ItemPart$onClkClps(e){this._get_Parent().onClkItemPart(this,e)};Owa.UIControls.ItemPart.prototype.onClkExp=function Owa$UIControls$ItemPart$onClkExp(oEvent){var oTarget=oEvent.get_Target();var nsIds=Owa.Strings.Ids;var fPreventDefaultAndBubble=false;while(oTarget!=null&&oTarget.get_Id()!=nsIds.ItemPartExpansion){switch(oTarget.get_Id()){case nsIds.FromSpan:case nsIds.RecipientSpan:case nsIds.AttachmentLink:fPreventDefaultAndBubble=true;break;case nsIds.ItemPartExpansionHeader:if(this.get_IsSelected()){this.exp(true);fPreventDefaultAndBubble=true;break}break;case nsIds.ItemPartDraftSpan:this.openItemPart();fPreventDefaultAndBubble=true;break}if(fPreventDefaultAndBubble){oEvent.preventDefault();oEvent.cancelBubble();return}oTarget=oTarget.get_ParentElement()}this._get_Parent().onClkItemPart(this,oEvent)};Owa.UIControls.ItemPart.prototype.onContextClick=function Owa$UIControls$ItemPart$prototype$onContextClick(oEvent){var oTarget=oEvent.get_Target();var nsIds=Owa.Strings.Ids;while(oTarget!=null&&oTarget.get_Id()!=nsIds.ItemPartExpansion){switch(oTarget.get_Id()){case nsIds.AttachmentLink:{var oParent=oTarget.get_ParentElement();if(oParent!=null){var sUrl=oParent.getAttribute("_url");if(sUrl){oTarget.setAttribute("href",sUrl)}else{if(!(oParent.getAttribute("_idx"))){oTarget.setAttribute("href",gtAttUrl(oParent))}}}return}case nsIds.ItemPartExpansionHeader:this.onContextMenu(oEvent);return;case nsIds.ItemPartActionsButton:oEvent._oDivAct=oTarget;this.onContextMenu(oEvent);canEvt(oEvent);return}oTarget=oTarget.get_ParentElement()}};Owa.UIControls.ItemPart.prototype.onContextMenu=function Owa$UIControls$ItemPart$prototype$onContextMenu(e){e.preventDefault();if(!this._fSel){this._get_Parent().onClkItemPart(this,e,true)}else{this.exp()}this._get_Parent().onContextMenu(e)};Owa.UIControls.ItemPart.prototype.openItemPart=function Owa$UIControls$ItemPart$openItemPart(e){var sAction="Open";var sItemType=this.get_ItemType();var sApplicationElement=getApplicationElementForItem("Item",sAction,sItemType);var sUrl="?ae="+sApplicationElement+"&a="+sAction+"&t="+urlEnc(sItemType)+"&id="+urlEnc(this.get_Id());if(this.fDraft){sUrl+="&s=Draft"}openItm(sUrl);if(e)canEvt(e)};Owa.UIControls.ItemPart.prototype.addRcSeg=function Owa$UIControls$ItemPart$addRcSeg(oBox,sSeg,fSh,fUnsel){var o=Document.get_Current().createElement("div");o.set_Id("divRc");o.addCssClass("rc"+(fSh?"-sh":""));o.addCssClass(sSeg);if(fUnsel)o.addCssClass("unselBrd");else if(!fSh)o.addCssClass("selBrd");o.setAttribute("_fSh",fSh?"1":"0");oBox.appendChild(o)};Owa.UIControls.ItemPart.prototype.sel=function Owa$UIControls$ItemPart$sel(f){var oClps=this._getDescendant("divClps");var oExp=this._getDescendant("divExp");var oBoxClps=oClps.getChildById("divRcBox");if(f&&!oBoxClps)return;if(!oBoxClps){oBoxClps=Document.get_Current().createElement("div");oBoxClps.set_Id("divRcBox");this.addRcSeg(oBoxClps,"rc-t");this.addRcSeg(oBoxClps,"rc-tl");this.addRcSeg(oBoxClps,"rc-l");this.addRcSeg(oBoxClps,"rc-bl");this.addRcSeg(oBoxClps,"rc-b");this.addRcSeg(oBoxClps,"rc-br");this.addRcSeg(oBoxClps,"rc-r");this.addRcSeg(oBoxClps,"rc-tr");this.addRcSeg(oBoxClps,"rc-sh-bl "+Owa.Components.CssSprites.getImageClass("shw-bl.png"),1);this.addRcSeg(oBoxClps,"rc-sh-b",1);this.addRcSeg(oBoxClps,"rc-sh-br "+Owa.Components.CssSprites.getImageClass("shw-br.png"),1);this.addRcSeg(oBoxClps,"rc-sh-r",1);this.addRcSeg(oBoxClps,"rc-sh-tr "+Owa.Components.CssSprites.getImageClass("shw-tr.png"),1);oClps.appendChild(oBoxClps)}var oBoxExp;if(oExp){oBoxExp=oExp.getChildById("divRcBox");if(!oBoxExp){oBoxExp=oClps.getChildById("divRcBox").clone(true);oExp.appendChild(oBoxExp)}}oBoxClps.set_IsShown(!f);if(oExp){oBoxExp.set_IsShown(!f)}if(oExp){var oSelHdr=oExp.getChildById("divPrtBk");oSelHdr.addCssClass(f?"divPrtBk":"divPrtBkSel");oSelHdr.removeCssClass(f?"divPrtBkSel":"divPrtBk")}oClps=oClps.getChildById("divPrtBk");oClps.set_IsShown(!f);var oBrd=this._get_Element().getChildById("divBrd");if(oBrd){oBrd.set_IsShown(false)}this.selectBranchTab(f);this.showSelUI(f);this.moveToLayer(f?1:2);this._get_Parent().fixPrts(FIX_ALL|FIX_ASYNC);this._fSel=!f};Owa.UIControls.ItemPart.prototype.moveToLayer=function Owa$UIControls$ItemPart$moveToLayer(iLayer){this._get_Element().addCssClass("cnvLayer"+iLayer);for(var i=0;i<3;i++){if(i!=iLayer){this._get_Element().removeCssClass("cnvLayer"+i)}}};Owa.UIControls.ItemPart.prototype.exp=function Owa$UIControls$ItemPart$exp(f){if(!f&&this.get_IsExpanded()){return}if(this._get_Parent().get_IsRefreshing())this._get_Parent().fceRptRf();if(!f&&!this._get_Element().getChildById("divExp")){this.gtExp();return}var oExp=this._getDescendant("divExp");if(oExp){oExp.set_IsShown(!f)}this._get_Element().getChildById("divClps").set_IsShown(f);Owa.Components.CssSprites.updateImage(this._get_Element().getChildById("imgEC"),f?(g_fRtl?Owa.Strings.Icons.CollapsedRtl:Owa.Strings.Icons.Collapsed):(g_fRtl?Owa.Strings.Icons.ExpandedRtl:Owa.Strings.Icons.Expanded));this._fExp=!f;var divP=this.get_BranchText();if(divP){divP.set_IsShown(!f)}this._get_Parent().clrPipe();this._get_Parent().fixPrts(FIX_ALL|FIX_FORCESZ|FIX_ASYNC);this._get_Parent().onExpandCollapseItemPart()};Owa.UIControls.ItemPart.prototype.gtExp=function Owa$UIControls$ItemPart$gtExp(){if(this.fGtExp)return;this.fGtExp=1;this._get_Parent().cnclPrts(FIX_ALL);var oR=new oeReq(RDCNV_NS,"ExpIP",0,Owa.Utility.createDelegate(this,this.cbGtExp),POST);oR.add("CnvId",this._get_Parent().sCnvId);oR.addRg("IPId",[this.get_Id()]);oR.send();this.iExpPrgTmr=this.stTmout("shwExpPrg",2000,true)};Owa.UIControls.ItemPart.prototype.cbGtExp=function Owa$UIControls$ItemPart$cbGtExp(oR){if(!cbOeh(oR)){if(this.iExpPrgTmr){this._clearTimeout(this.iExpPrgTmr);this.iExpPrgTmr=0}this.shwExpPrg(false);return}var oD=Document.get_Current().createElement("div");oD.set_InnerHtml(oR.sBody);var oExp=oD.getDescendantById("divExp");this.insertExpandedPart(oExp);this.fGtExp=0};Owa.UIControls.ItemPart.prototype.insertExpandedPart=function Owa$UIControls$ItemPart$insertExpandedPart(oExp){if(oExp.getIntAttribute("itemNotFound")){var oParent=this._get_Parent();oParent.rmvIPs([this.get_Id()],true);oParent.rfrsh()}else{this._get_Element().insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,oExp);this.stTmout("fnshGtExp",1)}};Owa.UIControls.ItemPart.prototype.fnshGtExp=function Owa$UIControls$ItemPart$fnshGtExp(){if(this.iExpPrgTmr){this._clearTimeout(this.iExpPrgTmr);this.iExpPrgTmr=0}if(this.get_IsDisposed()){return}this.shwExpPrg(false);this.initializeExpansion();this.exp();this.sel(!this.get_IsSelected());if(this.fEnsureInView){this._get_Parent().ensureInView(this.get_Id())}};Owa.UIControls.ItemPart.prototype.shwExpPrg=function Owa$UIControls$ItemPart$shwExpPrg(f){this._get_Element().getChildById("imgEC").set_IsShown(!f);this._get_Element().getChildById("imgPrg").set_IsShown(f)};Owa.UIControls.ItemPart.prototype.stRS=function Owa$UIControls$ItemPart$stRS(fR){this.fR=!!fR;var o=this._get_Element();if(fR)o.removeCssClass("itmPrtUr");else o.addCssClass("itmPrtUr")};Owa.UIControls.ItemPart.prototype.showSelUI=function Owa$UIControls$ItemPart$showSelUI(f){var oExp=this._get_Element().getChildById("divExp");if(!oExp)return;var oSelDisplay=oExp.getChildById("divSelDisplay");oSelDisplay.set_IsShown(!f);if(!f){this.alignWellTitles()}var divExpHdr=oExp.getChildById("divExpHdr");var divAct=divExpHdr.getChildById("divActions");var divOrig=divExpHdr.getChildById("divOrig");divAct.set_IsShown(!f);divOrig.set_IsShown(!f)};Owa.UIControls.ItemPart.prototype._get_IsShown=function Owa$UIControls$ItemPart$_get_IsShown(){return Owa.UIControls.SubPage.get_Instance().get_IsShown(true)};Owa.UIControls.ItemPart.prototype.onShowHide=function Owa$UIControls$ItemPart$onShowHide(fShow){if(fShow&&this._fPendingAlignWellTitles){this._fPendingAlignWellTitles=false;this.alignWellTitles()}};Owa.UIControls.ItemPart.prototype.alignWellTitles=function Owa$UIControls$ItemPart$prototype$alignWellTitles(){if(!this._get_IsShown()){this._fPendingAlignWellTitles=true;return}if(!this._wellsAligned){var rgWellIds=["divToL","divCcL","divBccL","divCategoriesL","divWhenL","divLocationL","divAttachL"];var maxWidth=0;for(var iWellId=0;iWellId<rgWellIds.length;++iWellId){var oWellTitle=this._getDescendant(rgWellIds[iWellId]);if(oWellTitle){maxWidth=Math.max(maxWidth,oWellTitle.get_OffsetWidth())}}for(var iWellId=0;iWellId<rgWellIds.length;++iWellId){var oWellTitle=this._getDescendant(rgWellIds[iWellId]);if(oWellTitle){oWellTitle.set_Width(maxWidth)}}this._wellsAligned=true}};Owa.UIControls.ItemPart.prototype.getSender=function Owa$UIControls$ItemPart$prototype$getSender(){return this._get_Element().getDescendantById("spnFrom")};Owa.UIControls.ItemPart.prototype.get_ParentItemPart=function Owa$UIControls$ItemPart$prototype$get_ParentItemPart(){if(this.get_ParentId()!=null){return this._get_Parent().oItemParts[this.get_ParentId()]}else{return null}};Owa.UIControls.ItemPart.prototype.get_BranchText=function Owa$UIControls$ItemPart$prototype$get_BranchText(){var divP=this._get_Element().get_PreviousSibling();if(divP&&divP.get_Id()=="divBrTxt")return divP;return null};Owa.UIControls.ItemPart.prototype.get_BranchGap=function Owa$UIControls$ItemPart$prototype$get_BranchGap(){if(this._get_Parent().iSort&SORT_NB){var divP=this.get_BranchText();if(divP){divP=divP.get_PreviousSibling()}}else{divP=this._get_Element().get_NextSibling()}if(divP&&divP.get_Id()=="divBrGap")return divP;return null};Owa.UIControls.ItemPart.prototype.initBranchTab=function Owa$UIControls$ItemPart$initBranchTab(){var divBr=this.get_BranchText();if(!divBr)return;var divBrTab=divBr.getChildById("divBrTab");divBrTab.addCssClass("unselTab");var oBox=Document.get_Current().createElement("div");oBox.set_Id("divRcBox");this.addRcSeg(oBox,"rc-t",0,1);this.addRcSeg(oBox,"rc-tl",0,1);this.addRcSeg(oBox,"rc-l",0,1);this.addRcSeg(oBox,"rc-r",0,1);this.addRcSeg(oBox,"rc-tr",0,1);this.addRcSeg(oBox,"rc-sh-r",1);this.addRcSeg(oBox,"rc-sh-tr "+Owa.Components.CssSprites.getImageClass("shw-tr.png"),1);divBrTab.appendChild(oBox)};Owa.UIControls.ItemPart.prototype.selectBranchTab=function Owa$UIControls$ItemPart$selectBranchTab(f){var divBr=this.get_BranchText();if(!divBr)return;var divBrTab=divBr.getChildById("divBrTab");var rg=divBrTab.getAllDescendantsById("divRc");for(var i=0;i<rg.length;i++){var oRc=rg[i];if(oRc.getIntAttribute("_fSh")){oRc.set_IsShown(!f)}else{oRc.removeCssClass(f?"selBrd":"unselBrd");oRc.addCssClass(f?"unselBrd":"selBrd")}}divBrTab.removeCssClass(f?"selTab":"unselTab");divBrTab.addCssClass(f?"unselTab":"selTab")};Owa.UIControls.ItemPart.prototype.get_PipeConnectorTop=function Owa$UIControls$ItemPart$prototype$get_PipeConnectorTop(){return this._get_Element().get_PositionalTop()+PP_OFFST};Owa.UIControls.ItemPart.prototype.get_IsSelected=function Owa$UIControls$ItemPart$prototype$get_IsSelected(){return this._fSel};Owa.UIControls.ItemPart.prototype.get_IsLocal=function Owa$UIControls$ItemPart$prototype$get_IsLocal(){return this._fLocal};Owa.UIControls.ItemPart.prototype.get_IsExpanded=function Owa$UIControls$ItemPart$prototype$get_IsExpanded(){return this._fExp};Owa.UIControls.ItemPart.prototype.get_HasExpansionData=function Owa$UIControls$ItemPart$get_HasExpansionData(){return(this.fGtExp||this._get_Element().getChildById("divExp"))};Owa.UIControls.ItemPart.prototype.get_Id=function Owa$UIControls$ItemPart$prototype$get_Id(){return this._sItmId};Owa.UIControls.ItemPart.prototype.get_ChangeKey=function Owa$UIControls$ItemPart$prototype$get_ChangeKey(){return this._sCK};Owa.UIControls.ItemPart.prototype.get_ParentId=function Owa$UIControls$ItemPart$prototype$get_ParentId(){return this._sPId};Owa.UIControls.ItemPart.prototype.set_ParentId=function Owa$UIControls$ItemPart$prototype$set_ParentId(sValue){this._sPId=sValue};Owa.UIControls.ItemPart.prototype.get_InternetMId=function Owa$UIControls$ItemPart$prototype$get_InternetMId(){return this._iInternetMId};Owa.UIControls.ItemPart.prototype.get_ItemType=function Owa$UIControls$ItemPart$prototype$get_ItemType(){return this._sT};Owa.UIControls.ItemPart.prototype.get_IsInJunkFolder=function Owa$UIControls$ItemPart$prototype$get_IsInJunkFolder(){return this._fInJunkFolder};Owa.UIControls.ItemPart.createClass("Owa.UIControls.ItemPart",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/itempart.js".toLowerCase()]=1;Type.createNamespace("Owa.Components");Type.createNamespace("Owa.Components.MeetingHelpers");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/meetinghelpers.js".toLowerCase()])(function(){Owa.Components.MeetingHelpers.Operations={SaveInvitation:OP_SAV,SaveCalendarItem:0x40,EditResponseFromCalendar:0x80,EditResponseFromInvite:0x100,SendResponse:0x200,DontSendResponse:0x400,SaveCancellation:0x800,SaveResponse:0x1000};Owa.Components.MeetingHelpers.ItemTypes={MeetingMessage:10,MeetingRequest:11,MeetingResponse:12,MeetingCancellation:13};Owa.Components.MeetingHelpers.getResponseAction=function Owa$Components$MeetingHelpers$getResponseAction(oDomElement){while(oDomElement){var sId=oDomElement.get_Id();if(sId=="tblacceptMnu")return R_ACC;if(sId=="tbltentativeMnu")return R_TNT;if(sId=="tbldeclineMnu")return R_DEC;oDomElement=oDomElement.get_ParentElement()}};Owa.Components.MeetingHelpers.showCalendar=function(dtST,sItemId,sParentFolderId){var sUrl='?ae=Folder&t=IPF.Appointment&d='+urlEnc(dtST.toIsoString())+"&sid="+urlEnc(sItemId)+"&srp=0";if(isDf(typeof(sParentFolderId))&&sParentFolderId!=null&&sParentFolderId!=""){sUrl+="&id="+urlEnc(sParentFolderId)}opnWin(sUrl)};Owa.Components.MeetingHelpers.onClickAppointment=function(oNode){oNode=Owa.Dom.Node.wrapDomNode(oNode);var sId=oNode.get_Id();var sGId=oNode.getAttribute("gid");var sFId=oNode.getAttribute("fid");openItm("?ae=PreFormAction&a=Open&t=IPM.Appointment&id="+urlEnc(sId)+(sGId?"&gid="+urlEnc(sGId):"")+(sFId?"&fid="+urlEnc(sFId):""))}})();g_fModuleLoaded[".\\components/meetinghelpers.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/meetingitempart.js".toLowerCase()])(function(){var MeetingHelpers=Owa.Components.MeetingHelpers;Owa.UIControls.MeetingItemPart=function Owa$UIControls$MeetingItemPart(oDomElement,oParentControl){Owa.UIControls.MeetingItemPart.constructBase(this,[oDomElement,oParentControl]);this._oToolbar=null;this._oActionTable=null;this._oActionTable=new Owa.Components.ClientActionTable();this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.Accept));this._oActionTable.getAction(Owa.Strings.Ids.Accept).get_ActionEventHandlers().add(this._createCallback(this._onAccept));this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.Tentative));this._oActionTable.getAction(Owa.Strings.Ids.Tentative).get_ActionEventHandlers().add(this._createCallback(this._onTentative));this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.Decline));this._oActionTable.getAction(Owa.Strings.Ids.Decline).get_ActionEventHandlers().add(this._createCallback(this._onDecline));this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.Remove));this._oActionTable.getAction(Owa.Strings.Ids.Remove).get_ActionEventHandlers().add(this._createCallback(this._onRemove));this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.ShowCalendar));this._oActionTable.getAction(Owa.Strings.Ids.ShowCalendar).get_ActionEventHandlers().add(this._createCallback(this._onShowCalendar));this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.EditResponse));this._oActionTable.getAction(Owa.Strings.Ids.EditResponse).get_ActionEventHandlers().add(this._createCallback(this._onEditResponse));this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.SendResponse));this._oActionTable.getAction(Owa.Strings.Ids.SendResponse).get_ActionEventHandlers().add(this._createCallback(this._onSendResponse));this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.NoResponse));this._oActionTable.getAction(Owa.Strings.Ids.NoResponse).get_ActionEventHandlers().add(this._createCallback(this._onNoResponse));this._iItemType=this.get_ItemType()==Owa.Strings.ObjectClass.MeetingRequest?MeetingHelpers.ItemTypes.MeetingRequest:MeetingHelpers.ItemTypes.MeetingCancellation;this._dtST=null};Owa.UIControls.MeetingItemPart.prototype.initializeExpansion=function Owa$UIControls$MeetingItemPart$initializeExpansion(){Owa.UIControls.MeetingItemPart.callBase(this,"initializeExpansion");this._oToolbar=new Owa.UIControls.Toolbar(this._getDescendant("mpToolbar"),this);this._oToolbar.initialize(this._oActionTable);if(this.fPhishing||this.sFId==this._get_Parent()._sDeletedItemsId){this._oActionTable.getAction("accept").disable();this._oActionTable.getAction("tentative").disable();this._oActionTable.getAction("decline").disable()}var oExp=this._getDescendant("divExp");this._dtST=eval(oExp.getAttribute("dtST"));this._sCK=oExp.getAttribute("sCK");this._pCFId=oExp.getAttribute("pCFId")};Owa.UIControls.MeetingItemPart.prototype.disposeExpansion=function Owa$UIControls$MeetingItemPart$disposeExpansion(){this._oToolbar.dispose();this._oToolbar=null;Owa.UIControls.MeetingItemPart.callBase(this,"disposeExpansion")};Owa.UIControls.MeetingItemPart.prototype._onAccept=function Owa$UIControls$MeetingItemPart$prototype$_onAccept(oDomElement){this._processAction(MeetingHelpers.Operations.DontSendResponse,"NoResponse",R_ACC)};Owa.UIControls.MeetingItemPart.prototype._onDecline=function Owa$UIControls$MeetingItemPart$prototype$_onDecline(oDomElement){this._processAction(MeetingHelpers.Operations.DontSendResponse,"NoResponse",R_DEC)};Owa.UIControls.MeetingItemPart.prototype._onTentative=function Owa$UIControls$MeetingItemPart$prototype$_onTentative(oDomElement){this._processAction(MeetingHelpers.Operations.DontSendResponse,"NoResponse",R_TNT)};Owa.UIControls.MeetingItemPart.prototype._onRemove=function Owa$UIControls$MeetingItemPart$prototype$_onRemove(oDomElement){var oR=new oeReq("EditMeetingInvite","RemCal",0,this._createCallback(this._onProcessItemResponse));oR.add("Id",this.get_Id());oR.send()};Owa.UIControls.MeetingItemPart.prototype._onShowCalendar=function Owa$UIControls$MeetingItemPart$prototype$_onShowCalendar(oDomElement){MeetingHelpers.showCalendar(this._dtST,this.get_Id(),this._pCFId)};Owa.UIControls.MeetingItemPart.prototype._onEditResponse=function Owa$UIControls$MeetingItemPart$prototype$_onEditResponse(oDomElement){var iResponseAction=MeetingHelpers.getResponseAction(oDomElement);this._processAction(MeetingHelpers.Operations.EditResponseFromInvite,"EditResponseInvite",iResponseAction)};Owa.UIControls.MeetingItemPart.prototype._onNoResponse=function Owa$UIControls$MeetingItemPart$prototype$_onNoResponse(oDomElement){var iResponseAction=MeetingHelpers.getResponseAction(oDomElement);this._processAction(MeetingHelpers.Operations.DontSendResponse,"NoResponse",iResponseAction)};Owa.UIControls.MeetingItemPart.prototype._onSendResponse=function Owa$UIControls$MeetingItemPart$prototype$_onSendResponse(oDomElement){var iResponseAction=MeetingHelpers.getResponseAction(oDomElement);this._processAction(MeetingHelpers.Operations.SendResponse,"SendResponse",iResponseAction)};Owa.UIControls.MeetingItemPart.prototype._processAction=function Owa$UIControls$MeetingItemPart$prototype$_processAction(iOp,sC,iR){if(Owa.Components.OehRequest.hasPendingRequests())return;var oC=new Object();oC.iOp=iOp;oC.iR=iR;var oR=new oeReq("EditMeetingInvite",sC,oC,this._createCallback(this._onProcessItemResponse));oR.add("Id",this.get_Id());oR.add("CK",this.get_ChangeKey());if(iR){oR.add("ItemType",this._iItemType);oR.add("Rsp",iR)}oR.send()};Owa.UIControls.MeetingItemPart.prototype._onProcessItemResponse=function cbProcItm(oR){var oC=oR.oCtx;var iOp=oC.iOp;var iR=oC.iR;var sEr=null;var iEr=0;var fTxt=0;var oDivResponse=Owa.Dom.Document.get_Current().createElement("div");oDivResponse.set_InnerHtml(oR.sBody);if(oR.sErr){if(oR.fST)popLgn();sEr=oR.sErr;iEr=oR.iErr}else{var oErr=oDivResponse.getChildById("err");if(oErr){sEr=oErr.getAttribute("_msg");fTxt=1;if(oErr._cd)iEr=getInt(oErr.getAttribute("_cd"))}}if(!sEr){var oChangeKey=oDivResponse.getChildById("ck");if(oChangeKey)this._sCK=oChangeKey.get_TextContent();switch(iOp){case MeetingHelpers.Operations.SaveInvitation:case MeetingHelpers.Operations.SaveCancellation:{break}case MeetingHelpers.Operations.EditResponseFromInvite:{var sIdR=urlEnc(oDivResponse.getChildById("divOp").get_TextContent());var sUrl=gtMtRspUrl(sIdR,iR);if(this.get_Id()){sUrl+="&mid="+urlEnc(this.get_Id())}opnWin(sUrl);Owa.Dom.Window.get_Current().close();break}default:{Owa.Dom.Window.get_Current().close();break}}this._get_Parent().rfrsh(2000,true)}else{shwErrDlg(oR)}};Owa.UIControls.MeetingItemPart.createClass("Owa.UIControls.MeetingItemPart",Owa.UIControls.ItemPart)})();g_fModuleLoaded[".\\uicontrols/meetingitempart.js".toLowerCase()]=1;Type.createNamespace("Owa.Components");Type.createNamespace("Owa.Components.SharingMessageHelpers");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/SharingMessageHelpers.js".toLowerCase()])(function(){Owa.Components.SharingMessageHelpers.HandleUserAction=function Owa$Components$SharingMessageHelpers$HandleUserAction(sAction,sId,sCK,oCaller){switch(sAction){case Owa.Strings.Ids.AddThisCalendar:Owa.Components.SharingMessageHelpers.SendSharingActionRequest("AddSharedCalendar",sId,sCK,oCaller,Owa.Components.SharingMessageHelpers._cbAddSharedCalendar);break;case Owa.Strings.Ids.Accept:Owa.Components.SharingMessageHelpers.SendSharingActionRequest("AllowSharingRequest",sId,sCK,oCaller,Owa.Components.SharingMessageHelpers._cbActionOnRequest);break}};Owa.Components.SharingMessageHelpers.SendSharingActionRequest=function Owa$Components$SharingMessageHelpers$SendSharingActionRequest(sAction,sId,sCK,oCaller,cb){var oR=new oeReq("SharingMessage",sAction,oCaller,cb,POST);oR.add("Id",sId);oR.add("CK",sCK);oR.send()};Owa.Components.SharingMessageHelpers._cbAddSharedCalendar=function Owa$Components$SharingMessageHelpers$_cbAddSharedCalendar(oR){var ERROR_NOTFOUND="notfound";var ERROR_TOEXTERNALADDL="toExternalADDL";var ERROR_FROMEOLDERVERSION="fromOlderVersion";var ERROR_MSGCORRUPTED="msgCorrupted";var oCaller=oR.oCtx;var oDivErrorInfobar=oCaller._getDescendant("divErr");if(oR.sErr){if(oR.fST){popLgn()}showErr(oDivErrorInfobar,oR.sErr,oR.sErrDbg)}else{var oDiv=Owa.Dom.Document.get_Current().createElement("div");oDiv.set_InnerHtml(oR.sBody);var oDivErr=oDiv.getDescendantById("err");if(oDivErr){var sErr=oDivErr.getAttribute("_msg");if(sErr==ERROR_NOTFOUND){alrt(L_UnableOpnFdr,0,Owa.BUTTON_DIALOG_ICON.ERROR)}else if(sErr==ERROR_TOEXTERNALADDL){alrt(L_ErrorSharingToExternalADDL,0,Owa.BUTTON_DIALOG_ICON.ERROR)}else if(sErr==ERROR_FROMEOLDERVERSION){alrt(L_ErrorOpenOlderExchangeSecondaryCalendar,0,Owa.BUTTON_DIALOG_ICON.ERROR)}else if(sErr==ERROR_MSGCORRUPTED){alrt(L_ErrorSharingMessageCorrupted,0,Owa.BUTTON_DIALOG_ICON.ERROR)}}else{if(oDivErrorInfobar){hideErr(oDivErrorInfobar)}var oW=Owa.Utility.getRootOwaWindow();try{var oEd=oW.getGlobalVariable("g_oEd");if(oEd)oEd.fire.call(oEd,"ReloadNavigationTree",oR)}catch(e){}var oDivSubscribInfo=oDiv.getDescendantById("subInfo");var oInfobar=new Owa.UIControls.Infobar(oCaller._getDescendant("divInfobar"));oInfobar.buildReplaceOrInsertMessageAndRefresh(htmlEnc(L_InfoCalAdded),"divInfoAddCal");var oCK=oDiv.getDescendantById("ck");oCaller._sCK=oCK.get_TextContent();oInfobar.buildReplaceOrInsertMessageAndRefresh(htmlEnc(oDivSubscribInfo.get_TextContent()),"divInfoAddCal")}}};Owa.Components.SharingMessageHelpers._cbActionOnRequest=function Owa$Components$SharingMessageHelpers$_cbActionOnRequest(oR){var sEr=null;var iEr=0;var fTxt=0;var oDivResponse=Owa.Dom.Document.get_Current().createElement("div");oDivResponse.set_InnerHtml(oR.sBody);if(oR.sErr){if(oR.fST)popLgn();sEr=oR.sErr;iEr=oR.iErr}else{var oErr=oDivResponse.getChildById("err");if(oErr){sEr=oErr.getAttribute("_msg");fTxt=1;if(oErr._cd)iEr=getInt(oErr.getAttribute("_cd"))}}var oCaller=oR.oCtx;var oDivError=oCaller._getDescendant("divErr");if(!sEr){if(oDivError){hideErr(oDivError)}var sId=urlEnc(oDivResponse.getChildById("divOp").get_TextContent());opnWin("?ae=Item&a=New&s=Draft&t=IPM.Sharing&id="+sId);if(typeof(a_fPrv)!="undefined"&&!a_fPrv){if(!a_fInvOrAcptOfReq&&!a_fPrv){Owa.Dom.Window.get_Current().close()}}}}})();g_fModuleLoaded[".\\components/SharingMessageHelpers.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/SharingItemPart.js".toLowerCase()])(function(){var SharingMessageHelpers=Owa.Components.SharingMessageHelpers;Owa.UIControls.SharingItemPart=function Owa$UIControls$SharingItemPart(oDomElement,oParentControl){Owa.UIControls.SharingItemPart.constructBase(this,[oDomElement,oParentControl]);this._oToolbar=null;this._oActionTable=new Owa.Components.ClientActionTable();this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.Accept));this._oActionTable.getAction(Owa.Strings.Ids.Accept).get_ActionEventHandlers().add(this._createCallback(this._onAccept));this._oActionTable.addAction(new Owa.Components.ClientAction(Owa.Strings.Ids.AddThisCalendar));this._oActionTable.getAction(Owa.Strings.Ids.AddThisCalendar).get_ActionEventHandlers().add(this._createCallback(this._onAddThisCalendar))};Owa.UIControls.SharingItemPart.prototype.initializeExpansion=function Owa$UIControls$SharingItemPart$initializeExpansion(){Owa.UIControls.SharingItemPart.callBase(this,"initializeExpansion");var oToolbarDomObj=this._getDescendant("divShareToolbar");if(oToolbarDomObj){this._oToolbar=new Owa.UIControls.Toolbar(oToolbarDomObj,this);this._oToolbar.initialize(this._oActionTable)}};Owa.UIControls.SharingItemPart.prototype.disposeExpansion=function Owa$UIControls$SharingItemPart$disposeExpansion(){if(this._oToolbar!=null){this._oToolbar.dispose();this._oToolbar=null}Owa.UIControls.SharingItemPart.callBase(this,"disposeExpansion")};Owa.UIControls.SharingItemPart.prototype._onAccept=function Owa$UIControls$SharingItemPart$prototype$_onAccept(oDomElement){Owa.Components.SharingMessageHelpers.HandleUserAction(Owa.Strings.Ids.Accept,this.get_Id(),this.get_ChangeKey(),this)};Owa.UIControls.SharingItemPart.prototype._onAddThisCalendar=function Owa$UIControls$SharingItemPart$prototype$_onAddThisCalendar(oDomElement){Owa.Components.SharingMessageHelpers.HandleUserAction(Owa.Strings.Ids.AddThisCalendar,this.get_Id(),this.get_ChangeKey(),this)};Owa.UIControls.SharingItemPart.createClass("Owa.UIControls.SharingItemPart",Owa.UIControls.ItemPart)})();g_fModuleLoaded[".\\uicontrols/SharingItemPart.js".toLowerCase()]=1;(function(){var States={Unload:0,Loading:1,Loaded:2,Showing:3};Owa.UIControls.FolderPickerDialog=function Owa$UIControls$FolderPickerDialog(){Owa.UIControls.FolderPickerDialog.constructBase(this);this._sId=g_sFPDId+Owa.UIControls.FolderPickerDialog._iIndex;Owa.UIControls.FolderPickerDialog._iIndex++;this._attachEvent(Owa.Dom.Window.get_Current(),"unload",this._dispose);g_oEd.attachEvent("RenameFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.attachEvent("NewFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.attachEvent("MoveFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.attachEvent("CopyFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.attachEvent("DeleteFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.attachEvent("EmptyFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.attachEvent("RemoveNavigation",this,"_cbClearHtmlCacheAfterOEH");g_oEd.attachEvent("RenameNavigation",this,"_cbClearHtmlCacheAfterOEH");g_oEd.attachEvent("NewNavigation",this,"_cbClearHtmlCacheAfterOEH");g_oEd.attachEvent("UpdateCount",this,"_cbClearHtmlCacheAfterCountChanged")};Owa.UIControls.FolderPickerDialog.createClass("Owa.UIControls.FolderPickerDialog",Owa.UIControls.UIControl);Owa.UIControls.FolderPickerDialog._iIndex=0;Owa.UIControls.FolderPickerDialog.prototype._iDefaultButtonIndex=0;Owa.UIControls.FolderPickerDialog.prototype._sState=States.Unload;Owa.UIControls.FolderPickerDialog.prototype._iTreeHeight=300;Owa.UIControls.FolderPickerDialog.prototype._iTreeWidth=260;Owa.UIControls.FolderPickerDialog.prototype._fIsShowPublicFolder=true;Owa.UIControls.FolderPickerDialog.prototype._sTitle="";Owa.UIControls.FolderPickerDialog.get_Default=function Owa$UIControls$FolderPickerDialog$get_Default(){if(!Owa.Dom.Window.get_Current().equals(Owa.Utility.getIFrameParentOwaWindow())){var oTopOwa=Owa.Utility.getIFrameParentOwaWindow().getGlobalVariable("Owa");return oTopOwa.UIControls.FolderPickerDialog.get_Default()}if(!this._oDefault)this._oDefault=new Owa.UIControls.FolderPickerDialog();return this._oDefault};Owa.UIControls.FolderPickerDialog.prototype._get_State=function Owa$UIControls$FolderPickerDialog$_get_State(){return this._sState};Owa.UIControls.FolderPickerDialog.prototype._set_State=function Owa$UIControls$FolderPickerDialog$_set_State(sState){this._sState=sState};Owa.UIControls.FolderPickerDialog.prototype.set_Title=function Owa$UIControls$FolderPickerDialog$set_Title(sTitle){if(this._get_State()==States.Showing)throw new Error("Can't change title when folder picker dialog is showing");this._sTitle=sTitle};Owa.UIControls.FolderPickerDialog.prototype.set_TreeHtml=function Owa$UIControls$FolderPickerDialog$set_TreeHtml(sTreeHtml){if(this._get_State()==States.Showing){throw new Error("Can't change tree html when folder picker dialog is showing")}this._sCustomTreeHtml=sTreeHtml};Owa.UIControls.FolderPickerDialog.prototype.set_SourceTreeNode=function Owa$UIControls$FolderPickerDialog$set_SourceTreeNode(oNode){if(this._get_State()==States.Showing)throw new Error("Can't set the source tree node when folder picker dialog is showing");this._oSourceTreeNode=oNode};Owa.UIControls.FolderPickerDialog.prototype.get_SourceTreeNode=function Owa$UIControls$FolderPickerDialog$get_SourceTreeNode(){return this._oSourceTreeNode};Owa.UIControls.FolderPickerDialog.prototype.get_Title=function Owa$UIControls$FolderPickerDialog$get_Title(){return this._sTitle};Owa.UIControls.FolderPickerDialog.prototype.set_IsShowPublicFolder=function Owa$UIControls$FolderPickerDialog$set_IsShowPublicFolder(fIsShowPublicFolder){if(this._get_State()==States.Showing)throw new Error("Can't change title when folder picker dialog is showing");if(this._fIsShowPublicFolder!=fIsShowPublicFolder){this._fIsShowPublicFolder=fIsShowPublicFolder;this._set_State(States.Unload)}};Owa.UIControls.FolderPickerDialog.prototype.set_TreeWidth=function Owa$UIControls$FolderPickerDialog$set_TreeWidth(iValue){this._iTreeWidth=iValue};Owa.UIControls.FolderPickerDialog.prototype.get_TreeWidth=function Owa$UIControls$FolderPickerDialog$get_TreeWidth(){return this._iTreeWidth};Owa.UIControls.FolderPickerDialog.prototype.set_TreeHeight=function Owa$UIControls$FolderPickerDialog$set_TreeHeight(iValue){this._iTreeHeight=iValue};Owa.UIControls.FolderPickerDialog.prototype.get_TreeHeight=function Owa$UIControls$FolderPickerDialog$get_TreeHeight(){return this._iTreeHeight};Owa.UIControls.FolderPickerDialog.prototype.set_ButtonCaptions=function Owa$UIControls$FolderPickerDialog$set_ButtonCaptions(rgButtonCaption){if(this._get_State()==States.Showing)throw new Error("Can't change button when folder picker dialog is showing");this._rgButtonCaption=rgButtonCaption};Owa.UIControls.FolderPickerDialog.prototype.get_ButtonCaptions=function Owa$UIControls$FolderPickerDialog$get_ButtonCaptions(){return this._rgButtonCaption};Owa.UIControls.FolderPickerDialog.prototype.set_DefaultButtonIndex=function Owa$UIControls$FolderPickerDialog$set_DefaultButtonIndex(iDefaultButtonIndex){this._iDefaultButtonIndex=iDefaultButtonIndex};Owa.UIControls.FolderPickerDialog.prototype.get_DefaultButtonIndex=function Owa$UIControls$FolderPickerDialog$get_DefaultButtonIndex(){return this._iDefaultButtonIndex};Owa.UIControls.FolderPickerDialog.prototype.getButton=function Owa$UIControls$FolderPickerDialog$getButton(sButtonCaption){if(!sButtonCaption)return null;return this._get_ButtonDialog().getButton(sButtonCaption)};Owa.UIControls.FolderPickerDialog.prototype.get_DefaultButton=function Owa$UIControls$FolderPickerDialog$get_DefaultButton(){return this.getButton(this.get_ButtonCaptions()[this.get_DefaultButtonIndex()])};Owa.UIControls.FolderPickerDialog.prototype.show=function Owa$UIControls$FolderPickerDialog$show(){if(this._get_State()==States.Showing)throw new Error("Dialog already showed");if(this._get_State()==States.Unload){this._load();return}if(this._get_State()==States.Loading){return}this._show()};Owa.UIControls.FolderPickerDialog.prototype._show=function Owa$UIControls$FolderPickerDialog$_show(){this._createButtonDialog();var oTreeContainer=this._get_TreeControl()._get_Element().get_ParentElement();this._get_ButtonDialog().show();oTreeContainer.get_ParentElement().get_ParentElement().get_ParentElement().set_Width(this._iTreeWidth);oTreeContainer.get_ParentElement().get_ParentElement().get_ParentElement().set_Height(this._iTreeHeight);this._set_State(States.Showing)};Owa.UIControls.FolderPickerDialog.prototype._load=function Owa$UIControls$FolderPickerDialog$_load(){if(this._sCustomTreeHtml){this._sHtml=this._sCustomTreeHtml;this._set_State(States.Loaded);this._show()}else{var oRequest=new oeReq("Navigation","GetFolderPickerTree",null,this._createCallback(this._cbLoad));oRequest.add("pTr",this._fIsShowPublicFolder?1:0);oRequest.send();this._set_State(States.Loading)}};Owa.UIControls.FolderPickerDialog.prototype._cbLoad=function Owa$UIControls$FolderPickerDialog$_cbLoad(oResponse){if(!cbOeh(oResponse)){this._set_State(States.Unload);return}this._sHtml=oResponse.sBody;this._set_State(States.Loaded);this._show()};Owa.UIControls.FolderPickerDialog.prototype._createButtonDialog=function Owa$UIControls$FolderPickerDialog$_createButtonDialog(){var iMargin=52;var rgButton=this.get_ButtonCaptions();rgButton=rgButton.slice();rgButton.unshift(L_CrtNewFldElps);this._oButtonDialog=new BtnDlg(this._sId,this._sHtml,this.get_Title(),rgButton,this._iTreeWidth+iMargin,null,this._createCallback(this._cbOnButtonClick));this._oDialogElement=$(this._sId);var oTreeElement=this._oDialogElement.getDescendantById("fptree").get_FirstChild();var oTreeContainer=oTreeElement.get_ParentElement();var oTree=new Owa.UIControls.FolderTree(oTreeElement,1);if(this._oTree)unmakeTreeScrollArea(this._oTree);this._oTree=oTree;oTree.clrSel();oTreeContainer.get_ParentElement().get_ParentElement().get_ParentElement().set_Width(this._iTreeWidth);oTreeContainer.get_ParentElement().get_ParentElement().get_ParentElement().set_Height(this._iTreeHeight);makeTreeScrollArea(oTree);oTree.onSelChng=Owa.Utility.createDelegate(this,this._cbOnTreeSelectionChange);oTree.onAfEdt=Owa.Utility.createDelegate(this,this._cbOnTreeAfterEdit);oTree.onNwFld=Owa.Utility.createDelegate(this,this._cbOnTreeNewFolder);this._attachEvent(oTree.root,"dblclick",this._cbOnTreeDoublcClick);this.enableAllDialogButton(false);this._set_State(States.Loaded)};Owa.UIControls.FolderPickerDialog.prototype._dispose=function Owa$UIControls$FolderPickerDialog$_dispose(){var oTree=this._get_TreeControl();if(this._get_State()==States.Showing)this._detachEvent(oTree.root,"dblclick",this._cbOnTreeDoublcClick);g_oEd.detachEvent("RenameFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("NewFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("MoveFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("CopyFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("DeleteFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("EmptyFolder",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("RemoveFromView",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("RemoveNavigation",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("RenameNavigation",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("NewNavigation",this,"_cbClearHtmlCacheAfterOEH");g_oEd.detachEvent("UpdateCount",this,"_cbClearHtmlCacheAfterCountChanged")};Owa.UIControls.FolderPickerDialog.prototype._get_TreeControl=function Owa$UIControls$FolderPickerDialog$_get_TreeControl(){return this._oTree};Owa.UIControls.FolderPickerDialog.prototype._get_ButtonDialog=function Owa$UIControls$FolderPickerDialog$_get_ButtonDialog(){return this._oButtonDialog};Owa.UIControls.FolderPickerDialog.prototype.enableButton=function Owa$UIControls$FolderPickerDialog$enableButton(sButtonCaption,fEnable){this._oButtonDialog.enableButton(sButtonCaption,fEnable)};Owa.UIControls.FolderPickerDialog.prototype.enableAllDialogButton=function Owa$UIControls$FolderPickerDialog$enableAllDialogButton(fEnable){var rgButton=this.get_ButtonCaptions();for(var i=0;i<rgButton.length;i++)this._oButtonDialog.enableButton(rgButton[i],fEnable);this._oButtonDialog.enableButton(L_CrtNewFldElps,fEnable)};Owa.UIControls.FolderPickerDialog.prototype._cbOnTreeNewFolder=function Owa$UIControls$FolderPickerDialog$_cbOnTreeNewFolder(oNewTreeNode){this._get_TreeControl().selNd(oNewTreeNode);this.enableAllDialogButton(true);this._onCheckCustomButtons()};Owa.UIControls.FolderPickerDialog.prototype._cbOnButtonClick=function Owa$UIControls$FolderPickerDialog$_cbOnButtonClick(iButtonIndex,oContext){var fCancelClose=false;var oTree=this._get_TreeControl();if(-1==iButtonIndex){if(oTree._edting)oTree.qtEdtNd()}else{if(0==iButtonIndex){oTree.nwFld(oTree.gtSelNd(),1,null);this.enableAllDialogButton(false);fCancelClose=true}else{fCancelClose=this._onButtonClick(iButtonIndex-1)}}if(!fCancelClose||-1==iButtonIndex){if(this._onBeforeClose()){fCancelClose=true}if(!fCancelClose||-1==iButtonIndex){this._sHtml=this._oDialogElement.getDescendantById("divFPTrR").get_OuterHtml();this._get_TreeControl().dispose();this._oTree=null;this._set_State(States.Loaded)}}return fCancelClose};Owa.UIControls.FolderPickerDialog.prototype._cbOnTreeDoublcClick=function Owa$UIControls$FolderPickerDialog$_cbOnTreeDoublcClick(oEvent){if(!this._get_TreeControl()._edting){var oDefaultButton=this.get_DefaultButton();if(oDefaultButton)oDefaultButton.click()}};Owa.UIControls.FolderPickerDialog.prototype._cbOnTreeSelectionChange=function Owa$UIControls$FolderPickerDialog$_cbOnTreeSelectionChange(oOriginSelectedTreeNode,oNewSelectedTreeNode){this.enableAllDialogButton(true);this.enableButton(L_CrtNewFldElps,oNewSelectedTreeNode?oNewSelectedTreeNode.canCrt():false);this._onCheckCustomButtons()};Owa.UIControls.FolderPickerDialog.prototype._cbOnTreeAfterEdit=function Owa$UIControls$FolderPickerDialog$_cbOnTreeAfterEdit(){var oSelectedTreeNode=this._get_TreeControl().gtSelNd();this.enableAllDialogButton(true);this.enableButton(L_CrtNewFldElps,oSelectedTreeNode?oSelectedTreeNode.canCrt():false);this._onCheckCustomButtons()};Owa.UIControls.FolderPickerDialog.prototype._cbClearHtmlCacheAfterOEH=function Owa$UIControls$FolderPickerDialog$_cbClearHtmlCacheAfterOEH(oResponse){if(oResponse.isErr())return;if(this._get_State()==States.Loaded)this._set_State(States.Unload)};Owa.UIControls.FolderPickerDialog.prototype._cbClearHtmlCacheAfterCountChanged=function Owa$UIControls$FolderPickerDialog$_cbClearHtmlCacheAfterCountChanged(sFolderId){if(this._get_State()==States.Loaded)this._set_State(States.Unload)};Owa.UIControls.FolderPickerDialog.prototype._onButtonClick=function Owa$UIControls$FolderPickerDialog$_onButtonClick(){if(this.onButtonClick)return this.onButtonClick.apply(this,arguments)};Owa.UIControls.FolderPickerDialog.prototype._onBeforeClose=function Owa$UIControls$FolderPickerDialog$_onBeforeClose(){if(this.onBeforeClose)return this.onBeforeClose.apply(this,arguments)};Owa.UIControls.FolderPickerDialog.prototype._onCheckCustomButtons=function Owa$UIControls$FolderPickerDialog$_onCheckCustomButtons(){if(this.onCheckCustomButtons)return this.onCheckCustomButtons.apply(this,arguments)}})();if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/conversationsreadingpane.js".toLowerCase()])(function(){var FIX_BRD=0x1;var FIX_SZ=0x2;var FIX_FORCESZ=0x04;var FIX_PIPE=0x8;var FIX_ASYNC=0x10;var FIX_ALL=FIX_BRD|FIX_SZ|FIX_PIPE;var SCR_BFR_TP=25;var SCR_MIN_V=4;var SCR_INT=100;var SORT_NT=0x4;var RDCNV_NS="ReadConversation";var ON_SELECTION_CHANGED="onSelectionChanged";var ON_MARK_AS_READ="onMarkAsRead";var ON_CONVERSATION_OUTOFSCOPE="onConversationOutOfScope";var ON_CONVERSATION_REFRESHED="onConversationRefreshed";var ON_EXPAND_COLLAPSE="onExpandCollapse";var CONVERSATION_TOO_LONG_PART_ID="conversationTooLongPart";var RP_DO_NOT_REFRESH_TIMEOUT=1000;var RP_REFRESH_DELAY_ITEMNOTFOUND=1000;var RP_REFRESH_DELAY=300;Owa.UIControls.ConversationReadingPane=function Owa$UIControls$ConversationReadingPane(oDomElement,oParentControl){Owa.UIControls.ConversationReadingPane.constructBase(this,[oDomElement,oParentControl]);this.sCnvId=this._getAttribute("sCnvId");this.iMR=this._getIntAttribute("iMR");this.iMRDly=this._getIntAttribute("iMRDly");this.fMSR=0;this._iMaxItmPrts=this._getIntAttribute("iMaxItemPrts");this._iSort=this._getIntAttribute("iSort");this._fDeletedItemsHidden=this._getIntAttribute("fHideDelItems");this._sDeletedItemsId=this._getAttribute("sDeletedItemsId");this._fIsConversationIgnored=this._getIntAttribute("fIsConversationIgnored");this._oMarkedAsUnread={};this._fItemRemoved=false;this._fFlags=0;this._fCopyRestrictedConv=false;this._fPrintRestrictedConv=false;this._fSuppressOnExpandCollapse=false;this.L_ImgFltBlock=this._getAttribute("L_ImgFltBlock");this.L_ImgFltCompBlock=this._getAttribute("L_ImgFltCompBlock");this.L_TypeNotSup=this._getAttribute("L_TypeNotSup");this.L_ReadRcp=this._getAttribute("L_ReadRcp");this.L_Draft=this._getAttribute("L_Draft");this._iGlobalMessageCount=this._getIntAttribute("iGC");this._iCurrentFolderMessageCount=this._getIntAttribute("iC");this.oItemParts=new Object();this.oSel=new Object();this._rgSelIds=new Array();this.sScrMkr=0;this.fMkrScr=1;this._fPndRf=0;this.fRptRf=0;this.fIgnScr=0;this._oPipes=new Owa.Components.Pipes(this._getDescendant("divItmPrts"),Owa.PipeType.Large);this._oContextMenu=Owa.UIControls.ContextMenu.create($("divVwm"));this._oContextMenu.get_OnSelect().add(Owa.Utility.createDelegate(this,this._onContextMenuClick));this._fContextActionProcessing=false;this._fContextMenuEnabled=false;this._oDoNotRefreshTimer=null;this._fDoNotRefresh=false;this._iRefreshTimerExpiresAtTicks=0;this._oRefreshTimer=null;this._fForce_TimerRefresh=false;this._iUdUC_TimerRefresh=-1;this._iUdTC_TimerRefresh=-1;this._iUdUC_TimerRefresh=-1};Owa.UIControls.ConversationReadingPane.prototype.initialize=function Owa$UIControls$ConversationReadingPane$initialize(){Owa.UIControls.ConversationReadingPane.callBase(this,"initialize");this._insertCnvTooLongPart();var o=this._getDescendant("divItmPrtsScr");var sSelId=this._initializeItemParts();if(this._fCopyRestrictedConv){this._attachEvent(this._oElement,"copy",canEvt);this._attachEvent(this._oElement,"dragstart",canEvt);this._attachEvent(this._oElement,"selectstart",canEvt);this._attachEvent(this._oElement,"contextmenu",canEvt)}if(this._fPrintRestrictedConv){var divItmPrtsNoPrnt=this._getDescendant("divItmPrtsNoPrnt");this._getDescendant("divItmPrts").addCssClass("noPrint");divItmPrtsNoPrnt.addCssClass("noScreen");divItmPrtsNoPrnt.removeCssClass("hiddenMsg")}this.fixPrts(FIX_ALL|FIX_ASYNC);if(sSelId){this.setSel([sSelId]);this.scrTo(sSelId,1)}this._attachEvent(o,"selectstart",this.onSS);this._attachEvent(o,"scroll",this.onScr);this._attachEvent(o,"mousewheel",this._stpScrAnm);this._attachEvent(Window.get_Current(),"resize",this.onRsz)};Owa.UIControls.ConversationReadingPane.prototype.dispose=function Owa$UIControls$ConversationReadingPane$dispose(){if(!this.get_IsDisposed()){this.onBeforeUnload();this._disposeItemParts();this._oContextMenu.dispose();if(this._oPipes){this._oPipes.dispose()}this._getDescendant("divItmPrtsScr").detachAllEvents();if(this._oRefreshTimer){this._clearTimeout(this._oRefreshTimer)}Owa.UIControls.ConversationReadingPane.callBase(this,"dispose")}};Owa.UIControls.ConversationReadingPane.prototype.onShowHide=function Owa$UIControls$ConversationReadingPane$onShowHide(fShow){for(var sId in this.oItemParts){this.oItemParts[sId].onShowHide(fShow)}};Owa.UIControls.ConversationReadingPane.prototype._initializeItemParts=function Owa$UIControls$ConversationReadingPane$_initializeItemParts(){this._fItemRemoved=false;this._fCopyRestrictedConv=false;this._fPrintRestrictedConv=false;var oPrv=0;var sSelId;for(var i=0;;i++){var o=this._getDescendant("divIP"+i);if(!o)break;var oIP=Owa.UIControls.ItemPart.create(o,this);oIP.initialize();if(oIP.fCopyRestricted){this._fCopyRestrictedConv=true}if(oIP.fPrintRestricted){this._fPrintRestrictedConv=true}if(!sSelId&&oIP.get_IsExpanded())sSelId=oIP.get_Id();this.oItemParts[oIP.get_Id()]=oIP;if(oPrv){oIP.oPrv=oPrv;oPrv.oNxt=oIP}oPrv=oIP}return sSelId};Owa.UIControls.ConversationReadingPane.prototype._disposeItemParts=function Owa$UIControls$ConversationReadingPane$_disposeItemParts(){for(var sId in this.oItemParts){var o=this.oItemParts[sId];if(o)o.dispose();delete this.oItemParts[sId]}};Owa.UIControls.ConversationReadingPane.prototype.stOnMkRd=function Owa$UIControls$ConversationReadingPane$stOnMkRd(fn){this.onMkRd=fn};Owa.UIControls.ConversationReadingPane.prototype._get_ItemPartsCount=function Owa$UIControls$ConversationReadingPane$_get_ItemPartsCount(){return this._iMaxItmPrts>this._iGlobalMessageCount?this._iGlobalMessageCount:this._iMaxItmPrts};Owa.UIControls.ConversationReadingPane.prototype._get_LocalItemPartsCount=function Owa$UIControls$ConversationReadingPane$_get_LocalItemPartsCount(){var returnValue=0;for(var sId in this.oItemParts){if(this.oItemParts[sId].get_IsLocal()){returnValue++}}return returnValue};Owa.UIControls.ConversationReadingPane.prototype._get_LocalUnreadItemPartsCount=function Owa$UIControls$ConversationReadingPane$_get_LocalUnreadItemPartsCount(){var returnValue=0;for(var sId in this.oItemParts){if(this.oItemParts[sId].get_IsLocal()&&!this.oItemParts[sId].fR){returnValue++}}return returnValue};Owa.UIControls.ConversationReadingPane.prototype.get_Id=function Owa$UIControls$ConversationReadingPane$get_Id(){return this.sCnvId};Owa.UIControls.ConversationReadingPane.prototype.get_IsContextActionProcessing=function Owa$UIControls$ConversationReadingPane$prototype$get_IsContextActionProcessing(){return this._fContextActionProcessing};Owa.UIControls.ConversationReadingPane.prototype.get_IsRefreshing=function Owa$UIControls$ConversationReadingPane$get_IsRefreshing(){return this._fPndRf};Owa.UIControls.ConversationReadingPane.prototype.get_OnSelectionChanged=function Owa$UIControls$ConversationReadingPane$prototype$get_OnSelectionChanged(){return this._getEventHandlerCollection(ON_SELECTION_CHANGED)};Owa.UIControls.ConversationReadingPane.prototype.get_OnMarkAsRead=function Owa$UIControls$ConversationReadingPane$prototype$get_OnMarkAsRead(){return this._getEventHandlerCollection(ON_MARK_AS_READ)};Owa.UIControls.ConversationReadingPane.prototype.get_OnConversationOutOfScope=function Owa$UIControls$ConversationReadingPane$prototype$get_OnConversationOutOfScope(){return this._getEventHandlerCollection(ON_CONVERSATION_OUTOFSCOPE)};Owa.UIControls.ConversationReadingPane.prototype.get_OnConversationRefreshed=function Owa$UIControls$ConversationReadingPane$prototype$get_OnConversationRefreshed(){return this._getEventHandlerCollection(ON_CONVERSATION_REFRESHED)};Owa.UIControls.ConversationReadingPane.prototype.get_OnExpandCollapse=function Owa$UIControls$ConversationReadingPane$prototype$get_OnExpandCollapse(){return this._getEventHandlerCollection(ON_EXPAND_COLLAPSE)};Owa.UIControls.ConversationReadingPane.prototype.get_ContextMenuEnabled=function Owa$UIControls$ConversationReadingPane$prototype$get_ContextMenuEnabled(){return this._fContextMenuEnabled};Owa.UIControls.ConversationReadingPane.prototype.set_ContextMenuEnabled=function Owa$UIControls$ConversationReadingPane$prototype$set_ContextMenuEnabled(fEnabled){this._fContextMenuEnabled=fEnabled};Owa.UIControls.ConversationReadingPane.prototype.get_IsNewestOnTop=function Owa$UIControls$ConversationReadingPane$prototype$get_IsNewestOnTop(){return((this._iSort&SORT_NT)>0)};Owa.UIControls.ConversationReadingPane.prototype.get_IsConversationIgnored=function Owa$UIControls$ConversationReadingPane$prototype$get_IsConversationIgnored(){return this._fIsConversationIgnored};Owa.UIControls.ConversationReadingPane.prototype._onContextMenuClick=function Owa$UIControls$ConversationReadingPane$prototype$_onContextMenuClick(oC){var sC=oC.sCommand;var oV=oC.oMenuItem;this._fContextActionProcessing=true;switch(sC){case"MvToF":this._showMoveCopyDialog(false);break;case"CpToF":this._showMoveCopyDialog(true);break;default:if(this.onContextAction){this.onContextAction(sC,oV)}}this._fContextActionProcessing=false};Owa.UIControls.ConversationReadingPane.prototype.onContextMenu=function Owa$UIControls$ConversationReadingPane$prototype$onContextMenu(oEvent){if(this.get_ContextMenuEnabled()){this._fixContextMenuButtons();if(oEvent._oDivAct&&!g_fRtl){this._oContextMenu.showUnder(oEvent._oDivAct,0,false)}else{this._oContextMenu.showAtEvent(oEvent)}}};Owa.UIControls.ConversationReadingPane.prototype.onScr=function Owa$UIControls$ConversationReadingPane$onScr(){if(this.fIgnScr)return;if(this.iScrTmr){this._clearTimeout(this.iScrTmr);this.iScrTmr=0}this.iScrTmr=this._setTimeout(this._stActScr,1000)};Owa.UIControls.ConversationReadingPane.prototype.onRsz=function Owa$UIControls$ConversationReadingPane$onRsz(e){this.fixPrts(FIX_SZ|FIX_PIPE|FIX_ASYNC)};Owa.UIControls.ConversationReadingPane.prototype.onSS=function Owa$UIControls$ConversationReadingPane$onSS(e){if(isShftKD(e)||isCtrlKD(e))canEvt(e)};Owa.UIControls.ConversationReadingPane.prototype.onClkItemPart=function Owa$UIControls$ConversationReadingPane$onClkItemPart(oIP,e,fDontScroll){if(e.isShiftKeyDown()){var sLstSel=this._rgSelIds.length==0?null:this._rgSelIds[0];if(!e.isCtrlKeyDown())this._clrSel();if(!sLstSel||sLstSel==oIP.get_Id()){this._selIP(oIP.get_Id())}else{var oS=oIP;var oE=this.oItemParts[sLstSel];var iD=oE._get_Element().get_PositionalTop()-oS._get_Element().get_PositionalTop();while(1){this._selIP(oS.get_Id());if(oS==oE)break;oS=(iD>0)?oS.oNxt:oS.oPrv}}}else if(e.isCtrlKeyDown()){var f=!!this.oSel[oIP.get_Id()];this._selIP(oIP.get_Id(),f)}else{this.setSel([oIP.get_Id()],fDontScroll||oIP.get_IsSelected())}this._dispatchEvent(ON_SELECTION_CHANGED)};Owa.UIControls.ConversationReadingPane.prototype.onTouchItemPart=function Owa$UIControls$ConversationReadingPane$onTouchItemPart(oIP){this.sScrMkr=oIP.get_Id();this.fMkrScr=0};Owa.UIControls.ConversationReadingPane.prototype.onExpandCollapseItemPart=function Owa$UIControls$ConversationReadingPane$onExpandCollapseItemPart(){this._fireExpandCollapse()};Owa.UIControls.ConversationReadingPane.prototype.onBeforeUnload=function Owa$UIControls$ConversationReadingPane$prototype$onBeforeUnload(){for(var sId in this.oItemParts){var oItemPart=this.oItemParts[sId];oItemPart._onBeforeUnload()}};Owa.UIControls.ConversationReadingPane.prototype.isDeletedItem=function(sId){var oItemPart=this.oItemParts[sId];return oItemPart&&oItemPart.sFId==this._sDeletedItemsId};Owa.UIControls.ConversationReadingPane.prototype.isJunkItem=function(sId){var oItemPart=this.oItemParts[sId];return oItemPart&&oItemPart.get_IsInJunkFolder()};Owa.UIControls.ConversationReadingPane.prototype.setSel=function Owa$UIControls$ConversationReadingPane$setSel(rgIds,fDontScroll,fFireSelChange){var oNewSel=new Object();for(var i=0;i<rgIds.length;i++)oNewSel[rgIds[i]]=1;for(var sId in this.oSel){if(!oNewSel[sId])this._selIP(sId,1)}for(var sId in oNewSel){if(this.oItemParts[sId]&&!this.oSel[sId])this._selIP(sId)}if(rgIds.length>0&&this.oItemParts[rgIds[0]]){var oIP=this.oItemParts[rgIds[0]];if(oIP.get_IsExpanded()&&!fDontScroll){this.ensureInView(oIP.get_Id())}else{oIP.fEnsureInView=1}oIP.exp()}if(fFireSelChange){this._dispatchEvent(ON_SELECTION_CHANGED)}};Owa.UIControls.ConversationReadingPane.prototype.gtSel=function Owa$UIControls$ConversationReadingPane$gtSel(){var returnValue=new Array();for(var iSelId=0;iSelId<this._rgSelIds.length;++iSelId){returnValue.add(this._rgSelIds[iSelId])}return returnValue};Owa.UIControls.ConversationReadingPane.prototype.stRSAll=function Owa$UIControls$ConversationReadingPane$stRSAll(fR,sFId){var rg=new Array();for(var sId in this.oItemParts){if(sFId&&sFId==this.oItemParts[sId].sFId)continue;rg.push(sId)}this.stRS(rg,fR)};Owa.UIControls.ConversationReadingPane.prototype.stRS=function Owa$UIControls$ConversationReadingPane$stRS(rgIds,fR){for(var i=0;i<rgIds.length;i++){var o=this.oItemParts[rgIds[i]];if(o)o.stRS(fR);if(!fR){this._oMarkedAsUnread[rgIds[i]]=1}else{delete this._oMarkedAsUnread[rgIds[i]]}}this._startDoNotRefreshTimer()};Owa.UIControls.ConversationReadingPane.prototype.ensureInView=function Owa$UIControls$ConversationReadingPane$ensureInView(sId){this._setTimeout(this._ensureInViewEx,1,sId)};Owa.UIControls.ConversationReadingPane.prototype.scrTo=function Owa$UIControls$ConversationReadingPane$scrTo(sId,fNoAn,fBot){var oIP=this.oItemParts[sId];if(!oIP)return;this._stpScrAnm();var oB=this._getDescendant("divItmPrtsScr");var iWT=oB.get_ScrollTop();var iWH=oB.get_ClientHeight();var iPT=oIP._get_Element().get_PositionalTop();var iPH=oIP._get_Element().get_OffsetHeight();var iWB=iWT+iWH;var iPB=iPT+iPH;var iEP;if(fBot){if(iPH>iWH){iEP=iPT-SCR_BFR_TP}else{iEP=iPT-(iWH-iPH)+SCR_BFR_TP}}else{iEP=iPT-SCR_BFR_TP}var iMxST=oB.get_ScrollHeight()-iWH;if(iEP>iMxST)iEP=iMxST;var iCP=iWT;if(iCP==iEP)return;if(fNoAn){this._getDescendant("divItmPrtsScr").set_ScrollTop(iEP)}else{var o=new Object();o.iCP=iCP;o.iEP=iEP;o.iV=SCR_MIN_V;o.iD=(o.iEP>o.iCP)?1:-1;o.iTmr=this._setInterval(this._scrAnm,SCR_INT);this.oScrAnm=o;this.fIgnScr=1;this._scrAnm()}};Owa.UIControls.ConversationReadingPane.prototype.fceRptRf=function Owa$UIControls$ConversationReadingPane$fceRptRf(){this.fRptRf=1};Owa.UIControls.ConversationReadingPane.prototype.rfrsh=function Owa$UIControls$ConversationReadingPane$rfrsh(iDelay,fF,iUdGC,iUdTC,iUdUC,fNotFound){if(this._fDoNotRefresh)return;if(!iDelay||iDelay<RP_REFRESH_DELAY){iDelay=RP_REFRESH_DELAY}this._updateRefreshTimer(iDelay,fF,iUdGC,iUdTC,iUdUC,fNotFound)};Owa.UIControls.ConversationReadingPane.prototype.cnclPrts=function Owa$UIControls$ConversationReadingPane$cnclPrts(f){this._fFlags&=~f};Owa.UIControls.ConversationReadingPane.prototype.fixPrts=function Owa$UIControls$ConversationReadingPane$fixPrts(f){this._fFlags|=(f&(FIX_ALL|FIX_FORCESZ));if(f&FIX_ASYNC){this._setTimeout(this._fixPrtsEx,1)}else{this._fixPrtsEx()}};Owa.UIControls.ConversationReadingPane.prototype.rmvIPs=function Owa$UIControls$ConversationReadingPane$rmvIPs(rgIds,fForceRemove){var oNextSelectionItemParts=new Object();for(var i=0;i<rgIds.length;i++){var o=this.oItemParts[rgIds[i]];if(!o)continue;var sParentId=o.get_ParentId();var fCollapse=false;if(!this.isDeletedItem(rgIds[i])&&!this._fDeletedItemsHidden&&!fForceRemove){this._fItemRemoved=true;fCollapse=true}if(o.get_IsSelected()){if(o.oNxt){oNextSelectionItemParts[o.oNxt.get_Id()]=o.oNxt}else if(o.oPrv){oNextSelectionItemParts[o.oPrv.get_Id()]=o.oPrv}}if(fCollapse){o.exp(1)}else{this._selIP(rgIds[i],1,1);if(o.oPrv)o.oPrv.oNxt=o.oNxt;if(o.oNxt)o.oNxt.oPrv=o.oPrv;for(var sId in this.oItemParts){if(this.oItemParts[sId].get_ParentId()==rgIds[i]){this.oItemParts[sId].set_ParentId(sParentId)}}var oT=o.get_BranchText();if(oT)oT.remove(true);oT=o.get_BranchGap();if(oT)oT.remove(true);o.set_RemoveElementInDisposing(true);o.dispose();delete this.oItemParts[rgIds[i]];this._iGlobalMessageCount--}if(oNextSelectionItemParts[rgIds[i]]){delete oNextSelectionItemParts[rgIds[i]]}}var oTmpSelectedItemPart=this.oItemParts[sNextSelectionId];for(var id in oNextSelectionItemParts){oTmpSelectedItemPart=oNextSelectionItemParts[id];break}var sNextSelectionId=null;while(oTmpSelectedItemPart){if(oNextSelectionItemParts[oTmpSelectedItemPart.get_Id()]){sNextSelectionId=oTmpSelectedItemPart.get_Id()}oTmpSelectedItemPart=this.oItemParts[oTmpSelectedItemPart.get_Id()].oNxt}if(sNextSelectionId){this.setSel([sNextSelectionId],0,1)}};Owa.UIControls.ConversationReadingPane.prototype.clrPipe=function Owa$UIControls$ConversationReadingPane$prototype$clrPipe(){this._oPipes.clearPipes()};Owa.UIControls.ConversationReadingPane.prototype.get_GlobalMessageCount=function Owa$UIControls$ConversationReadingPane$prototype$get_GlobalMessageCount(){return this._iGlobalMessageCount};Owa.UIControls.ConversationReadingPane.prototype.expandAll=function Owa$UIControls$ConversationReadingPane$expandAll(){var rg=[];for(var sId in this.oItemParts){if(!this.oItemParts[sId].get_HasExpansionData()){rg.push(sId)}}if(rg.length){var oR=new oeReq(RDCNV_NS,"ExpIP",0,this._createCallback(this._cbExpandAll));oR.add("CnvId",this.sCnvId);oR.addRg("IPId",rg);oR.send()}else{this._internalExpandAll()}};Owa.UIControls.ConversationReadingPane.prototype.collapseAll=function Owa$UIControls$ConversationReadingPane$collapseAll(){this._fSuppressOnExpandCollapse=true;for(var sId in this.oItemParts){var oItemPart=this.oItemParts[sId];if(oItemPart.get_IsExpanded()){oItemPart.exp(1)}}this._fSuppressOnExpandCollapse=false;this._fireExpandCollapse()};Owa.UIControls.ConversationReadingPane.prototype.get_AreAllItemPartsExpanded=function Owa$UIControls$ConversationReadingPane$get_AreAllItemPartsExpanded(){var fAllExpanded=true;for(var sId in this.oItemParts){fAllExpanded&=this.oItemParts[sId].get_IsExpanded()}return fAllExpanded};Owa.UIControls.ConversationReadingPane.prototype._startDoNotRefreshTimer=function Owa$UIControls$ConversationReadingPane$prototype$_startDoNotRefreshTimer(){if(this._oDoNotRefreshTimer){this._clearTimeout(this._oDoNotRefreshTimer)}this._fDoNotRefresh=true;this._oDoNotRefreshTimer=this._setTimeout(function(){this._fDoNotRefresh=false;this._oDoNotRefreshTimer=null},RP_DO_NOT_REFRESH_TIMEOUT,null)};Owa.UIControls.ConversationReadingPane.prototype._updateRefreshTimer=function Owa$UIControls$ConversationReadingPane$prototype$_updateRefreshTimer(iDelay,fF,iUdGC,iUdTC,iUdUC,fNotFound){this._fForce_TimerRefresh=fF?true:this._fForce_TimerRefresh;this._iUdGC_TimerRefresh=iUdGC?iUdGC:this._iUdGC_TimerRefresh;this._iUdTC_TimerRefresh=iUdTC?iUdTC:this._iUdTC_TimerRefresh;this._iUdUC_TimerRefresh=iUdUC?iUdUC:this._iUdUC_TimerRefresh;var iNewTimerEnd=(new Date()).valueOf()+iDelay;if(iNewTimerEnd>this._iRefreshTimerExpiresAtTicks){if(this._oRefreshTimer){this._clearTimeout(this._oRefreshTimer)}this._iRefreshTimerExpiresAtTicks=iNewTimerEnd;this._oRefreshTimer=this._setTimeout(function Owa$UIControls$ConversationReadingPane$prototype$_updateRefreshTimer$Callback(){this._iRefreshTimerExpiresAtTicks=0;this._oRefreshTimer=null;if(!this.get_IsDisposed()){this._refreshReadingPane(this._fForce_TimerRefresh,this._iUdGC_TimerRefresh,this._iUdTC_TimerRefresh,this._iUdUC_TimerRefresh,fNotFound);this._fForce_TimerRefresh=false;this._iUdGC_TimerRefresh=-1;this._iUdTC_TimerRefresh=-1;this._iUdUC_TimerRefresh=-1}},iDelay,null)}};Owa.UIControls.ConversationReadingPane.prototype._removeFromSelection=function Owa$UIControls$ConversationReadingPane$prototype$_removeFromSelection(sId){delete this.oSel[sId];this._rgSelIds.remove(sId)};Owa.UIControls.ConversationReadingPane.prototype._addToSelection=function Owa$UIControls$ConversationReadingPane$prototype$_addToSelection(sId,oIP){this.oSel[sId]=oIP;this._rgSelIds.add(sId)};Owa.UIControls.ConversationReadingPane.prototype._fixContextMenuButtons=function Owa$UIControls$ConversationReadingPane$prototype$_fixContextMenuButtons(){var rgSel=this.gtSel();var sId=rgSel[0];if(!sId){return}var fShowDeliveryReport=true;if(rgSel.length>1){var rgItms=["divR","divRA","divPR","divF","divMIA","divMIT","divMID","divS1","divS2"];if(wda("divCR"))rgItms.push("divCR");if(wda("divCht"))rgItms.push("divCht");this._oContextMenu.showMenuItems(["divMR","divMU"],1);this._oContextMenu.showMenuItems(rgItms,0);if(isJnkEnbl()){this._oContextMenu.showMenuItems(["divJnk","divS5"],0)}fShowDeliveryReport=false}else{var fR=this.oItemParts[sId].fR;var fPhsh=this.oItemParts[sId].fPhishing;var fPst=(this.oItemParts[sId].get_ItemType()==IT_PST);var fCRpl=canItmRpl(this.oItemParts[sId].get_ItemType());this._oContextMenu.showMenuItem("divMU",fR);this._oContextMenu.showMenuItem("divMR",!fR);this._oContextMenu.showMenuItem("divIgnCnv",!this._fIsConversationIgnored);this._oContextMenu.showMenuItem("divCanIgnCnv",this._fIsConversationIgnored);if(this.oItemParts[sId].get_IsInJunkFolder()||fPhsh){this._oContextMenu.showMenuItems(["divR","divRA","divPR"],0);if(wda("divCht"))this._oContextMenu.showMenuItem("divCht",0);this._oContextMenu.showMenuItems(["divMIA","divMIT","divMID"],0)}else{if(fCRpl){this._oContextMenu.showMenuItem("divR",1);if(wda("divCht")){this._oContextMenu.showMenuItem("divCht",1);if(gtMstr()&&gtMstr().g_iIM_SI)this._oContextMenu.showMenuItem("divCht",0)}this._oContextMenu.showMenuItem("divRA",!fPst);this._oContextMenu.showMenuItem("divPR",fPst);this._oContextMenu.enableMenuItem("divPR",fPst)}else{this._oContextMenu.showMenuItems(["divR","divRA","divPR"],0);if(wda("divCht"))this._oContextMenu.showMenuItem("divCht",0)}var fSmr=this.oItemParts[sId].fMeetingRequest&&this.oItemParts[sId].fResponseRequested&&!this.isDeletedItem(sId)&&!fPhsh;this._oContextMenu.showMenuItems(["divMIA","divMIT","divMID","divS2"],fSmr)}this._oContextMenu.showMenuItems(["divF","divS1"],1);if(wda("divCR")){this._oContextMenu.showMenuItem("divCR",fCRpl);this._oContextMenu.enableMenuItem("divCR",!isWP()&&!fPst)}if(isJnkEnbl()){this._oContextMenu.showMenuItems(["divJnk","divS5"],true);if(this.oItemParts[sId].get_IsInJunkFolder()){if(fPhsh){this._oContextMenu.showMenuItems(["divNtJnk","divS11"],0)}else{this._oContextMenu.showMenuItems(["divNtJnk","divS11"],1)}}else{this._oContextMenu.showMenuItems(["divNtJnk","divS11"],0)}}if(this.oItemParts[sId].fDraft=="1"){fShowDeliveryReport=false}}if(this._oContextMenu._getDescendant("divDelPtg")){this._oContextMenu.showMenuItem("divDelPtg",1);Owa.UIControls.DeletePolicyContextMenu.get_Instance().set_SelectedIds(rgSel)}if(this._oContextMenu._getDescendant("divMvPtg")){var sId=rgSel[0];if(this.oItemParts[sId].get_IsInJunkFolder()||!g_oFldrMgr.isMyFId(this.oItemParts[sId].sFId)){this._oContextMenu.showMenuItem("divMvPtg",0)}else{this._oContextMenu.showMenuItem("divMvPtg",1);Owa.UIControls.MovePolicyContextMenu.get_Instance().set_SelectedIds(rgSel)}}if(isSWP())this._oContextMenu.showMenuItems(["divS6","divMvToF","divCpToF"],0);var fAR=0;for(var i=0;i<rgSel.length&&!fAR;i++)fAR|=this.oItemParts[rgSel[i]].get_ItemType()==IT_APV_RQ;this._oContextMenu.showMenuItems(["divFIA","divF"],!fAR);showEm(wda("divS3"),fAR);var fSharing=0;if(isFtEnab(FT_CAL)){for(var i=0;i<rgSel.length&&!fSharing;i++)fSharing|=isOfClss(this.oItemParts[rgSel[i]].get_ItemType(),IT_SHR)}var fReplyRestricted=0;var fReplyAllRestricted=0;var fForwardRestricted=0;for(var i=0;i<rgSel.length;i++){fReplyRestricted|=this.oItemParts[rgSel[i]].fReplyRestricted;fReplyAllRestricted|=this.oItemParts[rgSel[i]].fReplyAllRestricted;fForwardRestricted|=this.oItemParts[rgSel[i]].fForwardRestricted}this._oContextMenu.enableMenuItem("divF",!fSharing&&!fForwardRestricted);this._oContextMenu.enableMenuItem("divFIA",!fForwardRestricted);this._oContextMenu.enableMenuItem("divR",!fReplyRestricted);this._oContextMenu.enableMenuItem("divRA",!fReplyAllRestricted);if(g_oFldrMgr.gtFL(this.oItemParts[sId].sFId)==FL_AMB){fShowDeliveryReport=false}if(this._oContextMenu._getDescendant("divOpDlvRp")){this._oContextMenu.showMenuItems(["divSODL","divOpDlvRp"],fShowDeliveryReport)}var oDivSep=$("divCustomSep");if(!oDivSep)return;oDivSep.set_IsShown(false);this._oContextMenu.showMenuItems(this._oContextMenu.get_CustomMenuIds(),false)};Owa.UIControls.ConversationReadingPane.prototype._stActScr=function Owa$UIControls$ConversationReadingPane$_stActScr(){this.iScrTmr=0;this.fMkrScr=1};Owa.UIControls.ConversationReadingPane.prototype._gtScrdTo=function Owa$UIControls$ConversationReadingPane$_gtScrdTo(){var oB=this._getDescendant("divItmPrtsScr");var iTh=oB.get_ScrollTop()+oB.get_ClientHeight()/3;for(var i=0;i<this._get_ItemPartsCount();i++){var o=oB.getDescendantById("divIP"+i);if(!o)continue;var iY1=o.get_PositionalTop();var iY2=o.get_OffsetHeight()+iY1;if((iY1<=iTh)&&(iY2>=iTh)){this.sScrMkr=o.getAttribute("sItmId");break}}};Owa.UIControls.ConversationReadingPane.prototype._clrSel=function Owa$UIControls$ConversationReadingPane$_clrSel(sKeepSelectionId){for(var sId in this.oSel){if(sId!=sKeepSelectionId){this._selIP(sId,1)}}};Owa.UIControls.ConversationReadingPane.prototype._selIP=function Owa$UIControls$ConversationReadingPane$_selIP(sId,f,fC){var oIP=this.oItemParts[sId];if(f){this._removeFromSelection(sId)}else{this._addToSelection(sId,oIP)}this.sScrMkr=sId;this.fMkrScr=0;if(!oIP.fGtExp)oIP.sel(f)};Owa.UIControls.ConversationReadingPane.prototype._ensureInViewEx=function Owa$UIControls$ConversationReadingPane$_ensureInViewEx(sId){var oIP=this.oItemParts[sId];if(!oIP){return}var oB=this._getDescendant("divItmPrtsScr");var iWT=oB.get_ScrollTop();var iWH=oB.get_ClientHeight();var iPT=oIP._get_Element().get_PositionalTop();var iPH=oIP._get_Element().get_OffsetHeight();var iWB=iWT+iWH;var iPB=iPT+iPH;var fTopCut=iPT<iWT;var fBotCut=iPB>iWB;if(fTopCut==fBotCut){return}else if(fBotCut){this.scrTo(oIP.get_Id(),false,true)}else if(fTopCut){this.scrTo(oIP.get_Id())}};Owa.UIControls.ConversationReadingPane.prototype._scrAnm=function Owa$UIControls$ConversationReadingPane$_scrAnm(){var o=this.oScrAnm;var iV=Math.floor(Math.abs(o.iEP-o.iCP)/2.0);if(iV>o.iV*2)iV=o.iV*2;if(iV<SCR_MIN_V)iV=SCR_MIN_V;o.iCP+=o.iD*iV;if((o.iCP-o.iEP)*o.iD>=0)o.iCP=o.iEP;this._getDescendant("divItmPrtsScr").set_ScrollTop(o.iCP);o.iV=iV;if(o.iCP==o.iEP)this._stpScrAnm()};Owa.UIControls.ConversationReadingPane.prototype._stpScrAnm=function Owa$UIControls$ConversationReadingPane$_stpScrAnm(){if(this.oScrAnm){this._clearInterval(this.oScrAnm.iTmr);this.oScrAnm=0}this.fIgnScr=0};Owa.UIControls.ConversationReadingPane.prototype._refreshReadingPane=function Owa$UIControls$ConversationReadingPane$_refreshReadingPane(fF,iUdGC,iUdTC,iUdUC,fNotFound){this.onBeforeUnload();if(!fF&&iUdGC==0&&this._get_ItemPartsCount()==0){this._dispatchEvent(ON_CONVERSATION_OUTOFSCOPE,this.get_Id());return}if(!fF&&(iUdGC<0||iUdGC==this._get_ItemPartsCount())&&(iUdTC<0||iUdTC==this._get_LocalItemPartsCount())&&(iUdUC<0||iUdUC==this._get_LocalUnreadItemPartsCount())&&!this._fItemRemoved)return;if(this._fPndRf)return;this._fPndRf=1;var oCtx={};oCtx.fNotFound=fNotFound;var oR=new oeReq(RDCNV_NS,"Rfrsh",oCtx,Owa.Utility.createDelegate(this,this._cbRfrsh),POST,0,0,1);oR.add("CnvId",this.sCnvId);var rgExp=new Array();var rgExpInternetMIds=new Array();for(var sId in this.oItemParts){if(this.oItemParts[sId].get_IsExpanded()){rgExp.push(sId);if(this.oItemParts[sId].get_InternetMId()){rgExpInternetMIds.push(this.oItemParts[sId].get_InternetMId())}}}oR.addRg("ExpIds",rgExp);oR.addRg("ExpInternetMIds",rgExpInternetMIds);oR.send()};Owa.UIControls.ConversationReadingPane.prototype._cbRfrsh=function Owa$UIControls$ConversationReadingPane$_cbRfrsh(oR){if(this.get_IsDisposed()){return}this._fPndRf=0;if(this.fRptRf){this.fRptRf=0;this.rfrsh(0,1);return}if(!cbOehST(oR)||oR.sErr){if(oR.sErr==L_ErrorItemNotFound){if(oR.oCtx&&oR.oCtx.fNotFound){return}this.rfrsh(RP_REFRESH_DELAY_ITEMNOTFOUND,1,0,0,0,true)}else{shwErrDlg(oR)}return}this._initRfrsh(oR);this._dispatchEvent(ON_CONVERSATION_REFRESHED,this.get_Id())};Owa.UIControls.ConversationReadingPane.prototype._initRfrsh=function Owa$UIControls$ConversationReadingPane$_initRfrsh(oR){var oD=Document.get_Current().createElement("div");oD.set_IsShown(false);oD.set_InnerHtml(oR.sBody);var oRf=oD.getChildById("divRfrsh");if(!oRf)return;if(oRf.getAttribute("iGC")){this._iGlobalMessageCount=oRf.getIntAttribute("iGC");this._iCurrentFolderMessageCount=oRf.getIntAttribute("iC");this._iSort=oRf.getIntAttribute("iSort")}if(this._iCurrentFolderMessageCount==0){this._dispatchEvent(ON_CONVERSATION_OUTOFSCOPE,this.get_Id());return}if(this.fMkrScr)this._gtScrdTo();var oDivItm=this._getDescendant("divItmPrts");var oDivItmScr=this._getDescendant("divItmPrtsScr");var oIP=this.oItemParts[this.sScrMkr];var sMkrNw=0;var iDlt=0;if(oIP){while(!sMkrNw&&oIP){for(var i=0;;i++){var o=oRf.getDescendantById("divIP"+i);if(!o)break;var sItmId=o.getAttribute("sItmId");var iInternetMId=o.getIntAttribute("iInternetMId");if(sItmId.startsWith(oIP.get_Id())||(iInternetMId&&iInternetMId==oIP.get_InternetMId())){sMkrNw=oIP.get_Id();break}}if(!sMkrNw)oIP=oIP.oNxt}if(sMkrNw){var oIPEl=oIP._get_Element();iDlt=oIPEl.get_PositionalTop()-oDivItmScr.get_ScrollTop()}}var rgSel=this.gtSel();var oSelInternetMId=new Array();var oSel=new Array();for(var iSel=0;iSel<rgSel.length;++iSel){oSel[rgSel[iSel]]=1;if(this.oItemParts[rgSel[iSel]].get_InternetMId()){oSelInternetMId[this.oItemParts[rgSel[iSel]].get_InternetMId()]=1}}this.oSel=new Object();this._rgSelIds=new Array();this._disposeItemParts();this._removeCnvTooLongPart();oDivItm.set_InnerHtml(oRf.get_InnerHtml());var fPrevCopyRestriction=this._fCopyRestrictedConv;var fPrevPrintRestrictedConv=this._fPrintRestrictedConv;this.oItemParts=new Object();this._insertCnvTooLongPart();this._initializeItemParts();if(this._fCopyRestrictedConv&&!fPrevCopyRestriction){this._attachEvent(this._oElement,"copy",canEvt);this._attachEvent(this._oElement,"dragstart",canEvt);this._attachEvent(this._oElement,"selectstart",canEvt);this._attachEvent(this._oElement,"contextmenu",canEvt)}else if(!this._fCopyRestrictedConv&&fPrevCopyRestriction){this._detachEvent(this._oElement,"copy",canEvt);this._detachEvent(this._oElement,"dragstart",canEvt);this._detachEvent(this._oElement,"selectstart",canEvt);this._detachEvent(this._oElement,"contextmenu",canEvt)}if(this._fPrintRestrictedConv&&!fPrevPrintRestrictedConv){var oDivNoPrnt=this._getDescendant("divItmPrtsNoPrnt");oDivItm.addCssClass("noPrint");oDivNoPrnt.addCssClass("noScreen");oDivNoPrnt.removeCssClass("hiddenMsg")}else if(!this._fPrintRestrictedConv&&fPrevPrintRestrictedConv){var oDivNoPrnt=this._getDescendant("divItmPrtsNoPrnt");oDivNoPrnt.addCssClass("hiddenMsg");oDivNoPrnt.removeCssClass("noScreen");oDivItm.removeCssClass("noPrint")}for(var sId in this.oItemParts){if(oSel[sId]||oSelInternetMId[this.oItemParts[sId].get_InternetMId()]){this._selIP(sId)}}if(sMkrNw){var oIPMkr=this.oItemParts[sMkrNw];if(oIPMkr){var oIPMkrEl=oIPMkr._get_Element();oDivItmScr.set_ScrollTop(Math.max(oIPMkrEl.get_PositionalTop()-iDlt,0))}}oD.remove(true);this.fixPrts(FIX_ALL|FIX_ASYNC);if(this._iCurrentFolderMessageCount==0){this._dispatchEvent(ON_CONVERSATION_OUTOFSCOPE,this.get_Id())}};Owa.UIControls.ConversationReadingPane.prototype._fixPrtsEx=function Owa$UIControls$ConversationReadingPane$_fixPrtsEx(){var f=this._fFlags;if(f&FIX_SZ)this._fixPrtsSz(f&FIX_FORCESZ);if(f&FIX_BRD)this._fixPrtsBrd();if(f&FIX_PIPE)this._refPipe()};Owa.UIControls.ConversationReadingPane.prototype._fixPrtsBrd=function Owa$UIControls$ConversationReadingPane$_fixPrtsBrd(){var i=0;for(var sId in this.oItemParts){i++;var o=this.oItemParts[sId];var oBrd=o._get_Element().getChildById("divBrd");if(!oBrd){oBrd=Document.get_Current().createElement("div");oBrd.set_Id("divBrd");oBrd.addCssClass("unselBrd");o._get_Element().appendChild(oBrd)}if(!o.get_IsSelected()){var divP=o._get_Element().get_PreviousSibling();var fGap=(divP&&((divP.get_Id()=="divBrGap")||(divP.get_Id()=="divBrTxt"))&&divP.get_IsShown());var fHide=((!o.oPrv&&!o.get_IsExpanded())||(o.oPrv&&o.oPrv.get_IsSelected()&&!fGap));oBrd.set_IsShown(!fHide)}else{oBrd.set_IsShown(false)}}this._fFlags&=~FIX_BRD};Owa.UIControls.ConversationReadingPane.prototype._fixPrtsSz=function Owa$UIControls$ConversationReadingPane$_fixPrtsSz(fForce){var iCW=this._getDescendant("divItmPrts").get_ClientWidth();if(!fForce&&(iCW==this._iCW))return;this._iCW=iCW;for(var sId in this.oItemParts){var o=this.oItemParts[sId];o.fixPrtSz()}if(this._getDescendant(CONVERSATION_TOO_LONG_PART_ID)){this._getDescendant(CONVERSATION_TOO_LONG_PART_ID).set_Width(this._getDescendant("divItmPrts").get_ClientWidth())}this._fFlags&=~(FIX_SZ|FIX_FORCESZ)};Owa.UIControls.ConversationReadingPane.prototype._refPipe=function Owa$UIControls$ConversationReadingPane$_refPipe(){if(this.gtSel()[0]){this._oPipes.drawPipes(this.oItemParts[this.gtSel()[0]])}else{this.clrPipe()}this._fFlags&=~FIX_PIPE};Owa.UIControls.ConversationReadingPane.prototype._insertCnvTooLongPart=function(){if(this._iGlobalMessageCount>this._iMaxItmPrts){var sDotDivs="<div>"+Owa.Components.CssSprites.getImageMarkup("pipe-stop-l.png")+"</div>";var sDescriptionLine1="<div>"+L_ConversationTooLongLine1+"</div>";var sDescriptionLine2="<div>"+L_ConversationTooLongLine2+"</div>";var sConversationTooLong=null;if((this._iSort&SORT_NT)>0){sConversationTooLong="<div id='"+CONVERSATION_TOO_LONG_PART_ID+"' style='padding-bottom:30px;'>"+sDotDivs+"<br/>"+sDotDivs+"<br/>"+sDotDivs+"<br/>"+sDescriptionLine1+sDescriptionLine2+"</div>";this._getDescendant("divItmPrts").insertAdjacentHtml(Owa.ElementInsertionPoint.BeforeEnd,sConversationTooLong)}else{sConversationTooLong="<div id='"+CONVERSATION_TOO_LONG_PART_ID+"'>"+sDescriptionLine1+sDescriptionLine2+"<br/>"+sDotDivs+"<br/>"+sDotDivs+"<br/>"+sDotDivs+"</div>";this._getDescendant("divItmPrts").insertAdjacentHtml(Owa.ElementInsertionPoint.AfterBegin,sConversationTooLong)}}};Owa.UIControls.ConversationReadingPane.prototype._removeCnvTooLongPart=function(){var oCnvTooLongPart=this._getDescendant(CONVERSATION_TOO_LONG_PART_ID);if(oCnvTooLongPart){oCnvTooLongPart.remove(true)}};Owa.UIControls.ConversationReadingPane.prototype._showMoveCopyDialog=function Owa$UIControls$ConversationReadingPane$_showMoveCopyDialog(fCopy){var oFolderPickerDialog=Owa.UIControls.FolderPickerDialog.get_Default();oFolderPickerDialog.set_IsShowPublicFolder(true);oFolderPickerDialog.set_ButtonCaptions([fCopy?L_Cp:L_Mv]);oFolderPickerDialog.set_Title(fCopy?L_CpToFld:L_MvToFld);oFolderPickerDialog.onCheckCustomButtons=updateFolderPickerCopyMoveItemButton;oFolderPickerDialog.onButtonClick=cbCopyMoveItem;cbCopyMoveItem.fnCallback=Owa.Utility.createDelegate(this,this._cbMoveCopy);oFolderPickerDialog.show()};Owa.UIControls.ConversationReadingPane.prototype._cbMoveCopy=function Owa$UIControls$ConversationReadingPane$_cbMoveCopy(sDstFId,fD,sFT,fC){var rgSel=this.gtSel();var fDeletedItems=false;for(var i=0;i<rgSel.length;i++){if(!isMoveAllow(sFT,this.oItemParts[rgSel[i]].get_ItemType())){alrt(L_MvUnmtchTyp);return}if(!fDeletedItems&&this.isDeletedItem(rgSel[i])){fDeletedItems=true}}var sFolderId=fDeletedItems?this._sDeletedItemsId:null;g_oFldrMgr.cpMvItms(wt(),this.get_SubPage(),sFolderId,this.gtSel(),sDstFId,fC)};Owa.UIControls.ConversationReadingPane.prototype._cbExpandAll=function Owa$UIControls$ConversationReadingPane$_cbExpandAll(oR){if(!cbOeh(oR)){return}var oData=Document.get_Current().createElement("div");oData.set_InnerHtml(oR.sBody);this._internalExpandAll(oData)};Owa.UIControls.ConversationReadingPane.prototype._internalExpandAll=function Owa$UIControls$ConversationReadingPane$_internalExpandAll(oData){this._fSuppressOnExpandCollapse=true;for(var sId in this.oItemParts){var oItemPart=this.oItemParts[sId];if(oItemPart.get_IsExpanded()){continue}if(oData&&oData.getChildById(sId)){var oExp=oData.getChildById(sId).getChildById("divExp");oItemPart.insertExpandedPart(oExp)}else{oItemPart.exp()}}this._fSuppressOnExpandCollapse=false;this._fireExpandCollapse()};Owa.UIControls.ConversationReadingPane.prototype._fireExpandCollapse=function Owa$UIControls$ConversationReadingPane$_fireExpandCollapse(){if(this._fSuppressOnExpandCollapse){return}this._dispatchEvent(ON_EXPAND_COLLAPSE)};Owa.UIControls.ConversationReadingPane.createClass("Owa.UIControls.ConversationReadingPane",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/conversationsreadingpane.js".toLowerCase()]=1;var Node=Owa.Dom.Node;var Document=Owa.Dom.Document;var Window=Owa.Dom.Window;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded["freadcnv.js".toLowerCase()])(function(){Type.createNamespace("Owa.Pages");Owa.Pages.ReadConversationPage=function Owa$Pages$ReadConversationPage(oElement){Owa.Pages.ReadConversationPage.constructBase(this,[oElement])};var _oPrototype=Owa.Pages.ReadConversationPage.prototype;_oPrototype.initialize=function Owa$Pages$ReadConversationPage$initialize(){Owa.Pages.ReadConversationPage.callBase(this,"initialize");var oRdCnv=new Owa.UIControls.ConversationReadingPane(Document.get_Current().get_Body(),null);this.get_SubPageController().setExpando("oRdCnv",oRdCnv);this._oConversationReadingPane=oRdCnv;oRdCnv.initialize();var oParentController=Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().get_ParentController();if(oParentController){oParentController.invokeFunction("onLoadReadingPane")}initIM();addPerfMarker("ReadConversaton.Init.End")};_oPrototype.dispose=function Owa$Pages$ReadConversationPage$dispose(){dispIM();if(Owa.Utility.isDefined(typeof(this._oConversationReadingPane))&&this._oConversationReadingPane){this._oConversationReadingPane.dispose();this._oConversationReadingPane=null}this.get_SubPageController().setExpando("oRdCnv",null);Owa.Pages.ReadConversationPage.callBase(this,"dispose")};_oPrototype._onNewItem=function Owa$Pages$ReadConversationPage$_onNewItem(){newMail(false,this)};_oPrototype._onUserAction=function Owa$Pages$ReadConversationPage$_onUserAction(sAction,oContext){switch(sAction){case"close":window.close();break;default:Owa.Pages.ReadConversationPage.callBase(this,"_onUserAction",[sAction,oContext]);break}};_oPrototype.onIsVisibleChanged=onIsVisibleChanged;Owa.Pages.ReadConversationPage.createClass("Owa.Pages.ReadConversationPage",Owa.UIControls.SubPage)})();g_fModuleLoaded["freadcnv.js".toLowerCase()]=1;stJS("freadcnv.js");