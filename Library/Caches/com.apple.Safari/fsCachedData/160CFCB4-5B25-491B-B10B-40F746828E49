function iJc(a){var b=PYb(a);return b&&a.La(b)}function jJc(a,b,c){au(a,function(a){a=a.cgb(b,c,this.Ab,this.B);Zt(this,a);a.setVisible(!0);a.start()},"onepick")}function kJc(a,b){au(a,function(a){var d=Uk("/convert/import"),d=a.kgb(d,this.Y,this.pe,b);Zt(this,d);d.setVisible(!0);a.jgb(d,this.B,this.gb)},"onepick")}function lJc(a){M.call(this,"sheet-imported");this.$g=a}z(lJc,M);function mJc(a,b,c){this.Y=a;cz.call(this,b,!0,c);gu(this,v(this.zb,this))}z(mJc,cz);
mJc.prototype.zb=function(a){switch(a.action){case "picked":this.Y.dispatchEvent(new nJc(a.docs[0]));case "cancel":this.setVisible(!1)}};mJc.prototype.K=function(){this.Y.MB("spreadsheetpicked")};function nJc(a){M.call(this,"spreadsheetpicked");this.B=a}z(nJc,M);function F$(a,b,c,d,e){J.call(this);this.F=a;this.D=d;this.C=e;this.B=new P(this)}z(F$,J);F$.prototype.J=function(a){this.B.L(a,"spreadsheetpicked",this.H)};
F$.prototype.H=function(a){if(xC(this.F.D))Wm("Sorry, you can't complete this action while offline.");else{var b=a.B.id;if(!b&&(a=a.B.url)){var c=/key=([a-zA-Z0-9-_]+)/.exec(a);c||(c=/\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/.exec(a));c&&(b=c[1]);if(!b){ss.getInstance().postMessage(us("Can't copy sheet because the URL isn't valid.","error",!0));return}}a=this.D.B.wb();jJc(this.C,a,Oa(b))}};F$.prototype.V=function(){F$.O.V.call(this);this.B.dispose()};function G$(a,b,c,d,e){Rr.call(this,void 0,!1,e);this.D=a;this.B=b;this.K=c;this.U=d}z(G$,Rr);G$.prototype.ob=function(){G$.O.ob.call(this);sr(Hva(this),"live","assertive");Sr(this,"Copying sheet...");as(this,!1);bs(this,null);var a=this.Nb(),b=this.Z();this.M=b.Ja("img",{src:Cl("imgPath")+"spinner.gif"});b.appendChild(a,this.M)};G$.prototype.start=function(){xi(yi(this.K,"/copyto/sheet",v(this.J,this,this.D,this.B)).setTimeout(1E5),1).rf("gid",this.D,"did",this.B).ye()};
G$.prototype.J=function(a,b,c,d){if(this.ib()){as(this,!0);bs(this,gs());VI(this,"ok");var e,f;try{f=d.Af()["0"],c=0==f,e=d.Af().u}catch(h){c=!1}c?(f="Success copying worksheet. "+('<a target="_blank" href="'+e+'">Open target workbook</a>'),this.U.F.some(za(oJc,a),this)&&(f+="<br><br>Please note, some charts or gadgets were copied incompletely because data was on a different worksheet"),Sr(this,"Sheet copied successfully"),this.setContent(f)):(Sr(this,"Copy sheet error"),a="Oops.  A server error occurred.",
2==f?a="You do not have edit access to the spreadsheet. Make sure you are properly authenticated.":3==f&&(a="Too much data to copy to the old Google Sheets.  Please reduce the number of rows and/or columns before copying."),this.setContent(a));this.focus();this.il()}};function oJc(a,b){if(b.wb()!=a)return!1;var c=aA(b);if(c)for(var d=0;d<c.length;d++)if(c[d].Yc!=a)return!0;return!1};var pJc=Ls(function(){var a={csv:{PREVIEW:!1,SHEET:!0,DELIMITED:!0},txt:{PREVIEW:!1,SHEET:!0,DELIMITED:!0},tsv:{PREVIEW:!1,SHEET:!0,DELIMITED:!0},tab:{PREVIEW:!1,SHEET:!0,DELIMITED:!0}};a.htm=a.html={PREVIEW:!1,SHEET:!0,DELIMITED:!1};a.xls={PREVIEW:!1,SHEET:!1,DELIMITED:!1};a.xlsx={PREVIEW:!1,SHEET:!1,DELIMITED:!1};a.xlsm={PREVIEW:!1,SHEET:!1,DELIMITED:!1};a.xlt={PREVIEW:!1,SHEET:!1,DELIMITED:!1};a.xltm={PREVIEW:!1,SHEET:!1,DELIMITED:!1};a.xltx={PREVIEW:!1,SHEET:!1,DELIMITED:!1};a.ods={PREVIEW:!1,
SHEET:!1,DELIMITED:!1};return a});function qJc(a){return pJc().hasOwnProperty(rJc(a))}function rJc(a){a=a.split(".");return 1==a.length?"":a[a.length-1].toLowerCase()};function sJc(a,b){J.call(this);this.D=a;this.C=b;this.B=new P(this);K(this,this.B)}z(sJc,J);sJc.prototype.H=function(a){this.B.L(a,"spreadsheetpicked",this.F)};sJc.prototype.F=function(a){if(xC(this.D.D))Wm("Sorry, you can't complete this action while offline.");else{var b=Oa(a.B.name);qJc(b)?kJc(this.C,a.B):(a="Sorry, that file type isn't supported for import.<br/>Supported types are: "+(ec(pJc()).join(", ")+"."),b="<i>"+Ua(b)+"</i><br/><br/>"+a,Wm(b,"Import error",void 0,!0))}};function tJc(a){a=a||{};a=""+('<span class="dlgRitzImport, dlgRitzImportButterPane" aria-live="polite"><span id="badOptionButterPane">The selected option is not available for this file format.&nbsp;&nbsp;<a href="'+Z(Kt(a.bL))+'" target="_blank">'+Y(a.Zda)+'</a></span><span id="formatButterPane">This file could not be imported.&nbsp;&nbsp;'+Y(a.cHa)+'.&nbsp;&nbsp;<a href="'+Z(Kt(a.bL))+'" target="_blank">'+Y(a.Zda)+'</a></span><span id="replaceButterPane">All data currently in this spreadsheet will be replaced.</span></span>');
return mt(a)};function uJc(a){a=a||{};a=""+('<div class="dlgRitzImport"><div id="divFileName" class="dlgImportSelectedFile">Importing:<span> '+Y(a.lUa)+' </span><span id="spanImportSpinner" class="waitSpinner" aria-label= \''+Gt("Working ...")+'\' aria-live="polite"><img src="'+Z(bya(a.mha))+'" alt="spinner"></img></span></div><div id="divUploadMsgs" class="uploadBox" style="display:none" aria-live="polite"></div><div id="optionPane"><div id="destinationOptionsHeader" class="dlgImportHeader">Import action</div><div id="destinationOptions" role="radiogroup" aria-labelledby="destinationOptionsHeader"><div role="presentation"><label><input type="radio" name="destination" value="NEW_SPREADSHEET" checked>Create new spreadsheet</label></div><div role="presentation"><label><input type="radio" name="destination" value="NEW_SHEET">Insert new sheet(s)</label></div><div role="presentation"><label><input type="radio" name="destination" value="REPLACE_SPREADSHEET">Replace spreadsheet</label></div><div role="presentation"><label><input type="radio" name="destination" value="REPLACE_SHEET">Replace current sheet</label></div><div role="presentation"><label><input type="radio" name="destination" value="APPEND_SHEET">Append rows to current sheet</label></div><div role="presentation"><label><input type="radio" name="destination" value="REPLACE_DATA">Replace data starting at selected cell</label></div></div><div id="delimiterOptionsPane"><div id="delimiterOptionHeader" class="dlgImportHeader">Separator character</div><div role="radiogroup" aria-labelledby="delimiterOptionHeader">'+
Ft(ZZ({checked:!0,label:Bt("Detect automatically"),name:"delimiter",value:a.rOa}))+Ft(ZZ({label:Bt("Tab"),name:"delimiter",value:a.tab}))+Ft(ZZ({label:Bt("Comma"),name:"delimiter",value:a.DPa}))+'<div id="delimiterOptionCustom">'+Ft(ZZ({id:"dlgImportCustomOption",label:Bt("Custom:"),name:"delimiter",value:a.iQa}))+'&nbsp;<input class="jfk-textinput" name="customDelimiter" id="customDelimiter" type="text" style="width:20px" maxlength="1" aria-labelledby="delimiterOptionCustom"></div></div></div></div><div class="dlgImportClear"></div></div>');
return mt(a)}function vJc(a){a=a||{};var b;b=Bt("Open now");a=""+('<span>File imported successfully.</span>&nbsp;<a href="'+Z(Kt(a.link))+'" target="_blank" id="ritzimport-success-link" role="button" aria-label="'+Z(b)+'"><b>'+Y(b)+" &raquo;</b></a>");return mt(a)};function H$(a,b,c,d,e){Rr.call(this,void 0,!1,e);this.D=a;this.$=d;this.sb=b;this.pe=c}z(H$,Rr);var wJc={cX:"NEW_SPREADSHEET",TNb:"NEW_SHEET",KQb:"REPLACE_SPREADSHEET",JQb:"REPLACE_SHEET",cxb:"APPEND_SHEET",FQb:"REPLACE_DATA"};r=H$.prototype;
r.ob=function(){H$.O.ob.call(this);Sr(this,"Import file");var a=new Zr;a.set("import","Import",!1,!1);a.set("cancel","Cancel",!1,!0);bs(this,a);VI(this,"import");var b=this.Nb(),c=this.Z(),a=Cl("imgPath")+"spinner.gif",a=vt(uJc,{lUa:this.getFileName(),mha:a,Zda:"Learn more",cHa:"Supported formats: .xls, .xlsx, .csv, .tsv, .ods",rOa:"AUTO",tab:"TAB",DPa:",",iQa:"CUSTOM"},null,c);c.appendChild(b,a);b=Cs(tJc,{Zda:"Learn more",bL:Ala,cHa:"Supported formats: .xls, .xlsx, .csv, .tsv, .ods"});Vr(this).appendChild(b);
b=this.B=new b0(!0);c0(b,"destination",a);for(var c={},d=b.J,e=0;e<d.length;e++){var f=d[e];c[b.La(f)]=f}this.M=c;this.K=$Vb("delimiter",a)};
r.$a=function(){H$.O.$a.call(this);var a=this.Z();this.il();Q(a.getElement("formatButterPane"),!1);this.J=a.getElement("divUploadMsgs");this.vb=a.getElement("spanImportSpinner");this.U=a.getElement("delimiterOptionsPane");xJc(this,0);T(this).L(this,"dialogselect",this.oub).L(this.K,"change",this.Gxa).L(this.B,"change",this.M0a).L(a.getElement("customDelimiter"),"keyup",this.Gxa)};
function yJc(a){var b=qJc(a.getFileName()),c=null!=(iJc(a.B)||null),d=!1;c&&(d=a.M[zJc(a)],d=a.B.isEnabled(d));cs(a.C,"import").disabled=!(b&&c&&d)}function AJc(a,b){var c=new Lg(["APPEND_SHEET","REPLACE_DATA","REPLACE_SHEET"]);"READ_ONLY"==a.Y?(d0(a.B,a.M.NEW_SPREADSHEET),BJc(a,"NEW_SPREADSHEET"),Yb(wJc,function(a){"NEW_SPREADSHEET"!=a&&this.dta(!1,a)},a)):("NON_GRID"==a.Y&&(b=!1),!b&&c.contains(zJc(a))&&(In(Pl("formatButterPane"))||CJc(a,"badOptionButterPane",!0)),Kg(c,v(a.dta,a,b)),yJc(a))}
r.dta=function(a,b){var c=this.M[b];this.B.Ta(c,a);Er(this.Z().Cq(this.B.getElement(c)),"dlgImportDisabled",!a)};function BJc(a,b){a.D.xb("dst",b);var c=new Lg(["APPEND_SHEET","REPLACE_DATA","REPLACE_SHEET"]);CJc(a,"replaceButterPane","REPLACE_SPREADSHEET"==String(b)&&!In(Pl("formatButterPane")));c.contains(b)||(CJc(a,"badOptionButterPane",!1),yJc(a))}function zJc(a){return String(Sk(a.D,"dst"))}
function DJc(a){xJc(a,1);zi(Ai(xi(Sj(a.sb.df(a.D.toString()).rf("idi",Oa(a.$.id),"esid",Qi(a.pe)),"POST").setTimeout(135E3),1),function(a){EJc(this,a)},a),function(){EJc(this,null)},a).ye()}r.setMode=ca("Y");function FJc(a){var b=aWb(a.K);return"CUSTOM"==b?a.Z().getElement("customDelimiter").value:"TAB"==b?"\t":b}
function EJc(a,b){var c=null,d=null,e=null==b,f="Sorry, can't import this file right now. Try again later.";if(b)try{var h=b.Af();0==h["0"]?(c=h["1"],gc(h,"s")&&(d=h.s)):(e=!0,f=GJc(h.c))}catch(k){e=!0}e&&(h=a.Z(),h=h.Ja("div","dlgImportError",h.Yi(f)),am(a.J),a.J.appendChild(h),Q(a.J,!0),Ym(f));xJc(a,2);a.dispatchEvent(new HJc("import-done",a,c,d,e))}
function GJc(a){switch(a){case 1:return"Too large to import. Remove rows or columns and try again.";case 2:return"Couldn't be opened for import. If the file is password protected, try removing the password.";case 3:return"This file couldn't be imported because it may be damaged. Save a copy and try importing again.";case 4:return"Couldn't be imported. Save as a .csv, .xlsx or .ods and try importing again.";case 5:return"Couldn't be imported. You are trying to edit a protected cell or object.  Please contact the spreadsheet owner to remove protection if you need to edit.";
default:return"Sorry, can't import this file right now. Try again later."}}r.Gxa=function(){this.dispatchEvent("option-change")};r.M0a=function(){this.dispatchEvent("option-change")};function xJc(a,b){var c=1==b;Q(a.J,2==b);Q(a.vb,c);var d=cs(a.C,"import"),e=cs(a.C,"cancel");d&&(c&&e&&e.focus(),d.disabled=c)}r.getFileName=function(){return Oa(this.$.name)};r.oub=function(a){"import"==a.key&&(a.preventDefault(),this.dispatchEvent("import"))};
function CJc(a,b,c){Q(Pl(b),c);Er(Vr(a),"dlgRitzImportButterPane",In(Pl("badOptionButterPane"))||In(Pl("formatButterPane"))||In(Pl("replaceButterPane")))}r.V=function(){H$.O.V.call(this);this.U=this.J=null;L(this.B);this.B=null;L(this.K);this.K=null};function HJc(a,b,c,d,e){M.call(this,a,b);this.Ic=c||null;this.$g=d||null;this.bd=!!e}z(HJc,M);function I$(a,b,c){J.call(this);this.B=a;this.D=pJc();this.C=b;this.Yb=c;c=this.C.B;if(this.C.Gd())a.setMode("READ_ONLY");else if(cJ(c)&&!dI(b)){a.setMode("NORMAL");var d=SB(c);b=Wx(d);c=b.y;d=d.Ob();a.D.xb("c",b.x);a.D.xb("r",c);a.D.xb("agi",d)}else a.setMode("NON_GRID");this.X=new P(this);this.X.L(a,"option-change",this.J).L(a,"import",this.H).L(a,"import-done",this.F);BJc(a,"NEW_SPREADSHEET");b=this.B.getFileName();b=this.D[rJc(b)];AJc(a,!b||!!b.SHEET);b=this.B.getFileName();b=(b=this.D[rJc(b)])&&
!!b.DELIMITED;a.D.xb("del","AUTO");Q(a.U,b);a.il()}z(I$,J);I$.prototype.F=function(a){if(!a.bd){var b=this.C.C.B;jk(b,hk(b.Ua,4,!0));jk(b,hk(b.Ua,4,!1));var b=this.B,c;c=a.$g;c=(Cl("userDashPrefix")||"")+"/spreadsheets/d/"+a.Ic+"/edit"+(c?"#gid="+c:"");"NEW_SPREADSHEET"==zJc(b)?(a=Cs(vJc,{link:c}),am(b.J),b.J.appendChild(a),Q(b.J,!0),b.Z().getElement("ritzimport-success-link").focus(),Ym("File imported successfully.")):(b.setVisible(!1),null!==a.$g&&(a=Number(a.$g))&&this.Yb.dispatchEvent(new lJc(a)))}};
I$.prototype.H=function(){DJc(this.B)};I$.prototype.J=function(){var a=this.B,b=String(Sk(a.D,"del"))!=FJc(a),a=zJc(a)!=(iJc(a.B)||null);if(b||a)b=this.B,a=FJc(b),b.D.xb("del",a),BJc(b,iJc(b.B)||null)};I$.prototype.V=function(){I$.O.V.call(this);this.X.dispose();this.D={}};function IJc(){J.call(this)}z(IJc,Lm);r=IJc.prototype;r.agb=function(a,b,c){return new F$(a,0,0,b,c)};r.ggb=function(a,b){return new sJc(a,b)};r.bgb=function(a){return new mJc(a,Cl("onePickSheetPickerUrl"))};r.hgb=function(a){return new mJc(a,Cl("onePickImportPickerUrl"))};r.cgb=function(a,b,c,d){return new G$(a,b,c,d,void 0)};r.jgb=function(a,b,c){new I$(a,b,c)};r.kgb=function(a,b,c,d){return new H$(a,b,c,d)};Tm("onepick",IJc);
