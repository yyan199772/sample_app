function JYb(a,b){if(a.yb!=b){a.yb=b;var c=new Mz("lock_mode_change");c.cd=b;a.dispatchEvent(c)}};function KYb(){this.j=void 0}z(KYb,Xb);KYb.prototype.o=function(a,b){var c=a.length;b.push("[");for(var d=0,e="",f=0;f<c;f++)null==a[f]?d++:(0<d&&(b.push($a(",",d)),d=0),b.push(e),Saa(this,a[f],b),e=",");b.push("]")};var LYb=null;function m0(a,b,c){this.attributeName=a;this.j=b||3;this.value=c}function n0(a){var b=[];b[1]=a.attributeName;oa(a.value)&&6==a.attributeName?(b[3]=Wb(a.value),b[9]=!0):b[a.j]=a.value;return b}function MYb(a){var b=new m0(a[1]),c;a:{switch(b.attributeName){case 1:case 2:case 3:case 4:case 5:case 21:case 20:c=2;break a;case 30:c=3;break a}c=null}if(b.j=c)b.value=a[c];else if(a[9])b.value=Ub(a[3]),b[9]=!0;else{a:{for(c=2;c<a.length;c++)if(null!=a[c]){a=a[c];break a}a=null}b.value=a}return b}
function NYb(a){for(var b=[],c=0;c<a.length;c++)b.push(MYb(a[c]));return b};function OYb(){this.value=this.D=this.C=this.o=this.endRow=this.B=this.startRow=this.F=this.gridId=this.j=null}var PYb={MRb:"setgadgetuserprefs",LRb:"setgadgetprefs",IDb:"getpref",HRb:"setactivecell",ORb:"setselection",ADb:"getactivecell",JDb:"getselection",BDb:"getactivesheet",MFb:"haspendingchanges",KCb:"flushpendingchanges",eMb:"locksheet",rTb:"unlocksheet"};function QYb(){this.j=this.o=this.value=this.B=null}function RYb(a){var b=[];b[1]=a.B;b[3]=a.o;var c=[];null!=a.value&&c.push(n0(new m0(6,null,a.value)));null!=a.j&&c.push(n0(new m0(26,2,a.j)));b[2]=c;LYb||(LYb=new KYb);return LYb.Yb(b)}function SYb(a,b,c,d,e,f){a.value=[];a.value.push(n0(new m0(1,2,b)));a.value.push(n0(new m0(2,2,c)));a.value.push(n0(new m0(4,2,d)));e&&a.value.push(n0(new m0(3,2,e)));f&&a.value.push(n0(new m0(5,2,f)))};function TYb(a,b,c){this.j=a;this.o=b;this.D=c}var UYb=null;
TYb.prototype.wj=function(a,b,c){var d;d=sa(b)?Ub(b):b;b=new OYb;b.j=d[2];d=NYb(d[4]);for(var e=0;e<d.length;e++){var f=d[e];switch(f.attributeName){case 1:b.gridId=Number(f.value);break;case 30:b.F=String(f.value);break;case 2:b.startRow=Number(f.value);break;case 4:b.B=Number(f.value);break;case 3:b.endRow=Number(f.value);break;case 5:b.o=Number(f.value);break;case 21:b.D=Number(f.value);break;case 20:b.C=Number(f.value);break;case 6:b.value=f.value}}d=this.j.j;e=b.gridId?Nw(d,b.gridId):d.getActiveGrid();
d=new QYb;switch(String(b.j)){case "setselection":b=new Rh(b.startRow-1,b.B-1,b.endRow,b.o);e=e.vc();Yx(e,b.ke());$x(e,b);break;case "getactivecell":b=Ux(e.vc());SYb(d,e.ub(),b.y+1,b.x+1);break;case "getselection":b=Px(e.vc());SYb(d,e.ub(),b.Ob()+1,b.Nb()+1,b.tc(),b.Cc());break;case "getactivesheet":b=e.ub();d.value=[];d.value.push(n0(new m0(1,2,b)));break;case "haspendingchanges":d.value=[n0(new m0(6,4,0<this.o.C.j.length))];break;case "locksheet":JYb(this.j,!0);d.value=[n0(new m0(6,4,!0))];break;
case "unlocksheet":JYb(this.j,!1);d.value=[n0(new m0(6,4,!0))];break;case "flushpendingchanges":a=v(this.C,this,a,c);(c=bu(this.D))&&cu(c,!0);this.B(0,a);return}d.B=0;d.j=a;c([[a,RYb(d)]])};TYb.prototype.B=function(a,b){0<this.o.C.j.length?5>a?Vj(v(this.B,this,a+1,b),200):b(!0):b(!1)};TYb.prototype.C=function(a,b,c){var d=new QYb;d.value=[n0(new m0(6,4,c))];d.B=0;d.j=a;b([[a,RYb(d)]])};function VYb(a,b,c,d){this.C=a;this.j=b;this.B=c;this.o=d}var WYb=0;VYb.prototype.wj=function(a,b){var c=Ub(a[0][1]),d;a:{d=c[2];for(var e in PYb)if(PYb[e]==d){d=!0;break a}d=!1}d?(UYb||(UYb=new TYb(this.C,this.j,this.o))).wj(a[0][0],c,b):(c=new Jk,c.set("id",this.B),d=[WYb++,a],c.set("js",Wb(d)),Nk(Tk(window.location.href),"authp")&&c.set("authp","true"),v(this.Ii,this,b),El()||VBa(this.j,"/mapi"))};VYb.prototype.Ii=function(a,b){var c;c=jv(b);c=c.j?Ub(c.j.responseText):void 0;a(c[1])};function XYb(){N.call(this)}z(XYb,N);XYb.prototype.render=ba();function YYb(a){M.call(this,"messagereceived");this.params=a||null}z(YYb,M);function o0(a,b,c){N.call(this);var d=null;if(0==a)a=Ub(Nk(new Bk(window.location.href),"xpc")),d=new Iu(a),d.Fh("handle_message",v(this.o,this,"em")),d.connect(c||ha);else if(1==a){if(!b)throw Error("Please specify xpc config when initializing outer frame");d=new Iu(b);d.Fh("handle_message",v(this.o,this,"tr"))}this.j=d}z(o0,XYb);o0.prototype.render=function(a,b){tAa(this.j,a,v(this.B,this));this.j.connect(b)};
o0.prototype.send=function(a){if(!this.j.Lm())throw Error("Channel must be connected in order to send");this.j.send("handle_message",a)};o0.prototype.o=function(a,b){this.dispatchEvent(new YYb({mid:a,msg:b}))};o0.prototype.B=function(a){a.style.border="0px";a.frameBorder="no";a.scrolling="no";a.marginheight="0";a.marginwidth="0";a.width="100%";a.height="100%"};function p0(a,b,c){N.call(this);this.o=a;this.D=b;this.Bb=c||"tr";this.C=[];this.j=[];this.U=new P(this);K(this,this.U);this.U.K(this.o,"messagereceived",this.F)}z(p0,N);p0.prototype.dispatchEvent=function(a,b){var c=p0.L.dispatchEvent.call(this,a);if(b){var d=Tk(window.location.href);if(Wa(d.B,"gmodules"))for(var d=this.j,e=0;e<d.length;e++)this.o.send(Wb([,,,,a]),this.j[e][0],this.j[e][1]);else this.o.send(Wb([,,,,a]))}return c};
p0.prototype.F=function(a){var b=a.params.mdm,c=Ub(a.params.msg),d=c[0],e=c[1],f=c[2];a=c[3];c=c[4];if(f)this.D.wj(f,v(this.B,this,b,d,e));else if(a)if("-1"==a[0])alert(a[1]);else for(b=this.C,d=0;d<a.length;d++){f=a[d];e=f[0];c=Ub(f[1]);f=new QYb;f.B=c[1];f.o=c[3];var h=c[2],c=[];if(u(h))for(var h=NYb(h),k=0;k<h.length;k++){var l=h[k];switch(l.attributeName){case 6:c.push(l.value);break;case 3:case 5:c.push(l);break;case 26:f.j=Number(l.value)}}f.value=1<c.length?c:c[0];if(c=b[e])c(f.value),b[e]=
null}else c&&this.dispatchEvent(new su(c.type,c.params))};p0.prototype.B=function(a,b,c,d){for(var e=0;e<this.j.length&&this.j[e][1]!=b;e++);e==this.j.length&&this.j.push([a,b]);c=[this.Bb,c,null,d];this.o&&this.o.send(Wb(c),a,b)};function ZYb(a,b,c,d,e){J.call(this);this.H=c;this.F=new VYb(a,b,d,e);this.o=new P(this);this.C=this.B=!1;this.j=null;this.o.K(b,["disconnect","edit"],this.V8);var f=this;(a=a.j)&&(a=a.getActiveGrid())&&this.o.K(hu(a.vc()),"Ra",function(a){a=new su("selectionChange");f.V8(a)});kla(Tk(window.location.href).j,"xpc")&&(a=new o0(0,null,v(this.r_a,this)),this.j=new p0(a,this.F),this.o.K(this.j,"ack_open",this.qXa),this.B&&this.O1())}z(ZYb,J);r=ZYb.prototype;r.r_a=function(){this.j?this.O1():this.B=!0};
r.qXa=function(){this.C=!0;this.O1()};r.O1=function(){Wj(this.D);this.j.dispatchEvent(new su("open",{key:this.H}),!0);this.C||(this.D=Vj(this.O1,500,this))};r.V8=function(a){a=new su(a.type,a.params);this.j&&this.j.dispatchEvent(a,!0)};r.R=function(){ZYb.L.R.call(this);this.o.dispose()};function $Yb(){J.call(this)}z($Yb,Cm);$Yb.prototype.j=function(){return ZYb};Sm("api",$Yb);
