function QYb(a,b){if(a.Ab!=b){a.Ab=b;var c=new Nz("lock_mode_change");c.ld=b;a.dispatchEvent(c)}};function RYb(){this.B=void 0}z(RYb,Xb);RYb.prototype.C=function(a,b){var c=a.length;b.push("[");for(var d=0,e="",f=0;f<c;f++)null==a[f]?d++:(0<d&&(b.push($a(",",d)),d=0),b.push(e),Saa(this,a[f],b),e=",");b.push("]")};var SYb=null;function e0(a,b,c){this.attributeName=a;this.B=b||3;this.value=c}function f0(a){var b=[];b[1]=a.attributeName;oa(a.value)&&6==a.attributeName?(b[3]=Wb(a.value),b[9]=!0):b[a.B]=a.value;return b}function TYb(a){var b=new e0(a[1]),c;a:{switch(b.attributeName){case 1:case 2:case 3:case 4:case 5:case 21:case 20:c=2;break a;case 30:c=3;break a}c=null}if(b.B=c)b.value=a[c];else if(a[9])b.value=Ub(a[3]),b[9]=!0;else{a:{for(c=2;c<a.length;c++)if(null!=a[c]){a=a[c];break a}a=null}b.value=a}return b}
function UYb(a){for(var b=[],c=0;c<a.length;c++)b.push(TYb(a[c]));return b};function VYb(){this.value=this.H=this.F=this.C=this.endRow=this.D=this.startRow=this.J=this.gridId=this.B=null}var WYb={hSb:"setgadgetuserprefs",gSb:"setgadgetprefs",kEb:"getpref",cSb:"setactivecell",jSb:"setselection",cEb:"getactivecell",lEb:"getselection",dEb:"getactivesheet",pGb:"haspendingchanges",oDb:"flushpendingchanges",HMb:"locksheet",MTb:"unlocksheet"};function XYb(){this.B=this.C=this.value=this.D=null}function YYb(a){var b=[];b[1]=a.D;b[3]=a.C;var c=[];null!=a.value&&c.push(f0(new e0(6,null,a.value)));null!=a.B&&c.push(f0(new e0(26,2,a.B)));b[2]=c;SYb||(SYb=new RYb);return SYb.$b(b)}function ZYb(a,b,c,d,e,f){a.value=[];a.value.push(f0(new e0(1,2,b)));a.value.push(f0(new e0(2,2,c)));a.value.push(f0(new e0(4,2,d)));e&&a.value.push(f0(new e0(3,2,e)));f&&a.value.push(f0(new e0(5,2,f)))};function $Yb(a,b,c){this.B=a;this.C=b;this.H=c}var aZb=null;
$Yb.prototype.Bj=function(a,b,c){var d;d=sa(b)?Ub(b):b;b=new VYb;b.B=d[2];d=UYb(d[4]);for(var e=0;e<d.length;e++){var f=d[e];switch(f.attributeName){case 1:b.gridId=Number(f.value);break;case 30:b.J=String(f.value);break;case 2:b.startRow=Number(f.value);break;case 4:b.D=Number(f.value);break;case 3:b.endRow=Number(f.value);break;case 5:b.C=Number(f.value);break;case 21:b.H=Number(f.value);break;case 20:b.F=Number(f.value);break;case 6:b.value=f.value}}d=this.B.B;e=b.gridId?Pw(d,b.gridId):d.getActiveGrid();
d=new XYb;switch(String(b.B)){case "setselection":b=new Rh(b.startRow-1,b.D-1,b.endRow,b.C);e=e.Bc();$x(e,b.ue());ay(e,b,!1,void 0,void 0);break;case "getactivecell":b=Wx(e.Bc());ZYb(d,e.wb(),b.y+1,b.x+1);break;case "getselection":b=e.Bc().Tc();ZYb(d,e.wb(),b.Rb()+1,b.Pb()+1,b.wc(),b.Fc());break;case "getactivesheet":b=e.wb();d.value=[];d.value.push(f0(new e0(1,2,b)));break;case "haspendingchanges":d.value=[f0(new e0(6,4,0<this.C.F.B.length))];break;case "locksheet":QYb(this.B,!0);d.value=[f0(new e0(6,
4,!0))];break;case "unlocksheet":QYb(this.B,!1);d.value=[f0(new e0(6,4,!0))];break;case "flushpendingchanges":a=v(this.F,this,a,c);(c=du(this.H))&&eu(c,!0);this.D(0,a);return}d.D=0;d.B=a;c([[a,YYb(d)]])};$Yb.prototype.D=function(a,b){0<this.C.F.B.length?5>a?Wj(v(this.D,this,a+1,b),200):b(!0):b(!1)};$Yb.prototype.F=function(a,b,c){var d=new XYb;d.value=[f0(new e0(6,4,c))];d.D=0;d.B=a;b([[a,YYb(d)]])};function bZb(a,b,c,d){this.F=a;this.B=b;this.D=c;this.C=d}var cZb=0;bZb.prototype.Bj=function(a,b){var c=Ub(a[0][1]),d;a:{d=c[2];for(var e in WYb)if(WYb[e]==d){d=!0;break a}d=!1}d?(aZb||(aZb=new $Yb(this.F,this.B,this.C))).Bj(a[0][0],c,b):(c=new Kk,c.set("id",this.D),d=[cZb++,a],c.set("js",Wb(d)),Sk(Uk(window.location.href),"authp")&&c.set("authp","true"),v(this.Ni,this,b),Fl()||$Ba(this.B,"/mapi"))};bZb.prototype.Ni=function(a,b){var c;c=lv(b);c=c.B?Ub(c.B.responseText):void 0;a(c[1])};function dZb(){N.call(this)}z(dZb,N);dZb.prototype.render=ba();function eZb(a){M.call(this,"messagereceived");this.params=a||null}z(eZb,M);function g0(a,b,c){N.call(this);var d=null;if(0==a)a=Ub(Sk(new Ck(window.location.href),"xpc")),d=new Ku(a),d.Kh("handle_message",v(this.C,this,"em")),d.connect(c||ha);else if(1==a){if(!b)throw Error("Please specify xpc config when initializing outer frame");d=new Ku(b);d.Kh("handle_message",v(this.C,this,"tr"))}this.B=d}z(g0,dZb);g0.prototype.render=function(a,b){yAa(this.B,a,v(this.D,this));this.B.connect(b)};
g0.prototype.send=function(a){if(!this.B.Wm())throw Error("Channel must be connected in order to send");this.B.send("handle_message",a)};g0.prototype.C=function(a,b){this.dispatchEvent(new eZb({mid:a,msg:b}))};g0.prototype.D=function(a){a.style.border="0px";a.frameBorder="no";a.scrolling="no";a.marginheight="0";a.marginwidth="0";a.width="100%";a.height="100%"};function h0(a,b,c){N.call(this);this.C=a;this.H=b;this.Db=c||"tr";this.F=[];this.B=[];this.X=new P(this);K(this,this.X);this.X.L(this.C,"messagereceived",this.J)}z(h0,N);h0.prototype.dispatchEvent=function(a,b){var c=h0.O.dispatchEvent.call(this,a);if(b){var d=Uk(window.location.href);if(Wa(d.D,"gmodules"))for(var d=this.B,e=0;e<d.length;e++)this.C.send(Wb([,,,,a]),this.B[e][0],this.B[e][1]);else this.C.send(Wb([,,,,a]))}return c};
h0.prototype.J=function(a){var b=a.params.mdm,c=Ub(a.params.msg),d=c[0],e=c[1],f=c[2];a=c[3];c=c[4];if(f)this.H.Bj(f,v(this.D,this,b,d,e));else if(a)if("-1"==a[0])alert(a[1]);else for(b=this.F,d=0;d<a.length;d++){f=a[d];e=f[0];c=Ub(f[1]);f=new XYb;f.D=c[1];f.C=c[3];var h=c[2],c=[];if(u(h))for(var h=UYb(h),k=0;k<h.length;k++){var l=h[k];switch(l.attributeName){case 6:c.push(l.value);break;case 3:case 5:c.push(l);break;case 26:f.B=Number(l.value)}}f.value=1<c.length?c:c[0];if(c=b[e])c(f.value),b[e]=
null}else c&&this.dispatchEvent(new uu(c.type,c.params))};h0.prototype.D=function(a,b,c,d){for(var e=0;e<this.B.length&&this.B[e][1]!=b;e++);e==this.B.length&&this.B.push([a,b]);c=[this.Db,c,null,d];this.C&&this.C.send(Wb(c),a,b)};function fZb(a,b,c,d,e){J.call(this);this.K=c;this.J=new bZb(a,b,d,e);this.C=new P(this);this.F=this.D=!1;this.B=null;this.C.L(b,["disconnect","edit"],this.x9);var f=this;(a=a.B)&&(a=a.getActiveGrid())&&this.C.L(ju(a.Bc()),"Ra",function(a){a=new uu("selectionChange");f.x9(a)});nla(Uk(window.location.href).B,"xpc")&&(a=new g0(0,null,v(this.V_a,this)),this.B=new h0(a,this.J),this.C.L(this.B,"ack_open",this.TXa),this.D&&this.o2())}z(fZb,J);r=fZb.prototype;r.V_a=function(){this.B?this.o2():this.D=!0};
r.TXa=function(){this.F=!0;this.o2()};r.o2=function(){Xj(this.H);this.B.dispatchEvent(new uu("open",{key:this.K}),!0);this.F||(this.H=Wj(this.o2,500,this))};r.x9=function(a){a=new uu(a.type,a.params);this.B&&this.B.dispatchEvent(a,!0)};r.V=function(){fZb.O.V.call(this);this.C.dispose()};function gZb(){J.call(this)}z(gZb,Lm);gZb.prototype.B=function(){return fZb};Tm("api",gZb);
