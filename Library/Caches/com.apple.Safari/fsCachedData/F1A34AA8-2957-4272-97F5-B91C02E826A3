function SYb(a,b){if(a.Ab!=b){a.Ab=b;var c=new Oz("lock_mode_change");c.fd=b;a.dispatchEvent(c)}};function TYb(){this.B=void 0}z(TYb,Xb);TYb.prototype.C=function(a,b){var c=a.length;b.push("[");for(var d=0,e="",f=0;f<c;f++)null==a[f]?d++:(0<d&&(b.push($a(",",d)),d=0),b.push(e),Saa(this,a[f],b),e=",");b.push("]")};var UYb=null;function r0(a,b,c){this.attributeName=a;this.B=b||3;this.value=c}function s0(a){var b=[];b[1]=a.attributeName;oa(a.value)&&6==a.attributeName?(b[3]=Wb(a.value),b[9]=!0):b[a.B]=a.value;return b}function VYb(a){var b=new r0(a[1]),c;a:{switch(b.attributeName){case 1:case 2:case 3:case 4:case 5:case 21:case 20:c=2;break a;case 30:c=3;break a}c=null}if(b.B=c)b.value=a[c];else if(a[9])b.value=Ub(a[3]),b[9]=!0;else{a:{for(c=2;c<a.length;c++)if(null!=a[c]){a=a[c];break a}a=null}b.value=a}return b}
function WYb(a){for(var b=[],c=0;c<a.length;c++)b.push(VYb(a[c]));return b};function XYb(){this.value=this.H=this.F=this.C=this.endRow=this.D=this.startRow=this.J=this.gridId=this.B=null}var YYb={RRb:"setgadgetuserprefs",QRb:"setgadgetprefs",TDb:"getpref",MRb:"setactivecell",TRb:"setselection",LDb:"getactivecell",UDb:"getselection",MDb:"getactivesheet",YFb:"haspendingchanges",XCb:"flushpendingchanges",pMb:"locksheet",vTb:"unlocksheet"};function ZYb(){this.B=this.C=this.value=this.D=null}function $Yb(a){var b=[];b[1]=a.D;b[3]=a.C;var c=[];null!=a.value&&c.push(s0(new r0(6,null,a.value)));null!=a.B&&c.push(s0(new r0(26,2,a.B)));b[2]=c;UYb||(UYb=new TYb);return UYb.$b(b)}function aZb(a,b,c,d,e,f){a.value=[];a.value.push(s0(new r0(1,2,b)));a.value.push(s0(new r0(2,2,c)));a.value.push(s0(new r0(4,2,d)));e&&a.value.push(s0(new r0(3,2,e)));f&&a.value.push(s0(new r0(5,2,f)))};function bZb(a,b,c){this.B=a;this.C=b;this.H=c}var cZb=null;
bZb.prototype.Cj=function(a,b,c){var d;d=sa(b)?Ub(b):b;b=new XYb;b.B=d[2];d=WYb(d[4]);for(var e=0;e<d.length;e++){var f=d[e];switch(f.attributeName){case 1:b.gridId=Number(f.value);break;case 30:b.J=String(f.value);break;case 2:b.startRow=Number(f.value);break;case 4:b.D=Number(f.value);break;case 3:b.endRow=Number(f.value);break;case 5:b.C=Number(f.value);break;case 21:b.H=Number(f.value);break;case 20:b.F=Number(f.value);break;case 6:b.value=f.value}}d=this.B.B;e=b.gridId?Pw(d,b.gridId):d.getActiveGrid();
d=new ZYb;switch(String(b.B)){case "setselection":b=new Rh(b.startRow-1,b.D-1,b.endRow,b.C);e=e.Ac();$x(e,b.re());by(e,b);break;case "getactivecell":b=Wx(e.Ac());aZb(d,e.wb(),b.y+1,b.x+1);break;case "getselection":b=Rx(e.Ac());aZb(d,e.wb(),b.Rb()+1,b.Pb()+1,b.wc(),b.Ec());break;case "getactivesheet":b=e.wb();d.value=[];d.value.push(s0(new r0(1,2,b)));break;case "haspendingchanges":d.value=[s0(new r0(6,4,0<this.C.F.B.length))];break;case "locksheet":SYb(this.B,!0);d.value=[s0(new r0(6,4,!0))];break;
case "unlocksheet":SYb(this.B,!1);d.value=[s0(new r0(6,4,!0))];break;case "flushpendingchanges":a=v(this.F,this,a,c);(c=du(this.H))&&eu(c,!0);this.D(0,a);return}d.D=0;d.B=a;c([[a,$Yb(d)]])};bZb.prototype.D=function(a,b){0<this.C.F.B.length?5>a?Wj(v(this.D,this,a+1,b),200):b(!0):b(!1)};bZb.prototype.F=function(a,b,c){var d=new ZYb;d.value=[s0(new r0(6,4,c))];d.D=0;d.B=a;b([[a,$Yb(d)]])};function dZb(a,b,c,d){this.F=a;this.B=b;this.D=c;this.C=d}var eZb=0;dZb.prototype.Cj=function(a,b){var c=Ub(a[0][1]),d;a:{d=c[2];for(var e in YYb)if(YYb[e]==d){d=!0;break a}d=!1}d?(cZb||(cZb=new bZb(this.F,this.B,this.C))).Cj(a[0][0],c,b):(c=new Kk,c.set("id",this.D),d=[eZb++,a],c.set("js",Wb(d)),Sk(Uk(window.location.href),"authp")&&c.set("authp","true"),v(this.Mi,this,b),Fl()||VBa(this.B,"/mapi"))};dZb.prototype.Mi=function(a,b){var c;c=lv(b);c=c.B?Ub(c.B.responseText):void 0;a(c[1])};function fZb(){N.call(this)}z(fZb,N);fZb.prototype.render=ba();function gZb(a){M.call(this,"messagereceived");this.params=a||null}z(gZb,M);function t0(a,b,c){N.call(this);var d=null;if(0==a)a=Ub(Sk(new Ck(window.location.href),"xpc")),d=new Ku(a),d.Jh("handle_message",v(this.C,this,"em")),d.connect(c||ha);else if(1==a){if(!b)throw Error("Please specify xpc config when initializing outer frame");d=new Ku(b);d.Jh("handle_message",v(this.C,this,"tr"))}this.B=d}z(t0,fZb);t0.prototype.render=function(a,b){tAa(this.B,a,v(this.D,this));this.B.connect(b)};
t0.prototype.send=function(a){if(!this.B.Vm())throw Error("Channel must be connected in order to send");this.B.send("handle_message",a)};t0.prototype.C=function(a,b){this.dispatchEvent(new gZb({mid:a,msg:b}))};t0.prototype.D=function(a){a.style.border="0px";a.frameBorder="no";a.scrolling="no";a.marginheight="0";a.marginwidth="0";a.width="100%";a.height="100%"};function u0(a,b,c){N.call(this);this.C=a;this.H=b;this.Db=c||"tr";this.F=[];this.B=[];this.X=new P(this);K(this,this.X);this.X.M(this.C,"messagereceived",this.J)}z(u0,N);u0.prototype.dispatchEvent=function(a,b){var c=u0.O.dispatchEvent.call(this,a);if(b){var d=Uk(window.location.href);if(Wa(d.D,"gmodules"))for(var d=this.B,e=0;e<d.length;e++)this.C.send(Wb([,,,,a]),this.B[e][0],this.B[e][1]);else this.C.send(Wb([,,,,a]))}return c};
u0.prototype.J=function(a){var b=a.params.mdm,c=Ub(a.params.msg),d=c[0],e=c[1],f=c[2];a=c[3];c=c[4];if(f)this.H.Cj(f,v(this.D,this,b,d,e));else if(a)if("-1"==a[0])alert(a[1]);else for(b=this.F,d=0;d<a.length;d++){f=a[d];e=f[0];c=Ub(f[1]);f=new ZYb;f.D=c[1];f.C=c[3];var h=c[2],c=[];if(u(h))for(var h=WYb(h),k=0;k<h.length;k++){var l=h[k];switch(l.attributeName){case 6:c.push(l.value);break;case 3:case 5:c.push(l);break;case 26:f.B=Number(l.value)}}f.value=1<c.length?c:c[0];if(c=b[e])c(f.value),b[e]=
null}else c&&this.dispatchEvent(new uu(c.type,c.params))};u0.prototype.D=function(a,b,c,d){for(var e=0;e<this.B.length&&this.B[e][1]!=b;e++);e==this.B.length&&this.B.push([a,b]);c=[this.Db,c,null,d];this.C&&this.C.send(Wb(c),a,b)};function hZb(a,b,c,d,e){J.call(this);this.K=c;this.J=new dZb(a,b,d,e);this.C=new P(this);this.F=this.D=!1;this.B=null;this.C.M(b,["disconnect","edit"],this.l9);var f=this;(a=a.B)&&(a=a.getActiveGrid())&&this.C.M(ju(a.Ac()),"Ra",function(a){a=new uu("selectionChange");f.l9(a)});kla(Uk(window.location.href).B,"xpc")&&(a=new t0(0,null,v(this.L_a,this)),this.B=new u0(a,this.J),this.C.M(this.B,"ack_open",this.KXa),this.D&&this.a2())}z(hZb,J);r=hZb.prototype;r.L_a=function(){this.B?this.a2():this.D=!0};
r.KXa=function(){this.F=!0;this.a2()};r.a2=function(){Xj(this.H);this.B.dispatchEvent(new uu("open",{key:this.K}),!0);this.F||(this.H=Wj(this.a2,500,this))};r.l9=function(a){a=new uu(a.type,a.params);this.B&&this.B.dispatchEvent(a,!0)};r.V=function(){hZb.O.V.call(this);this.C.dispose()};function iZb(){J.call(this)}z(iZb,Dm);iZb.prototype.B=function(){return hZb};Tm("api",iZb);
