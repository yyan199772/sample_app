var __DEBUG_BUILD=false;var Type=Function;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\core/type.js".toLowerCase()])(function(){Type.Const={};Type.Const.Boolean=typeof true;Type.Const.Function=typeof(new Function());Type.Const.Number=typeof 0;Type.Const.Object=typeof{};Type.Const.String=typeof"";Type.Const.Undefined=typeof undefined;var __Namespace=function $__Namespace$(name){this.__sTypeName=name};__Namespace.prototype={__fNamespace:true,getName:function(){return this.__sTypeName}};Type.__sTypeName='Type';Type.prototype.createClass=function Type$createClass(sTypeName,oBaseType,oInterfaces){this.prototype.constructor=this;this.__sTypeName=sTypeName;this.__fClass=true;this.__oBaseType=oBaseType||Object;if(oBaseType){this.__fBasePrototypePending=true}if(oInterfaces){this.__rgInterfaces=[];for(var i=2;i<arguments.length;i++){oInterfaces=arguments[i];this.__rgInterfaces[this.__rgInterfaces.length]=oInterfaces}}};Type.prototype.createInterface=function Type$createInterface(sInterfaceName){this.__sTypeName=sInterfaceName;this.__fInterface=true};Type.prototype.constructBase=function Type$constructBase(oInstance,rgArgs){if(this.__fBasePrototypePending){this._setupBase()}if(!rgArgs){this.__oBaseType.apply(oInstance)}else{this.__oBaseType.apply(oInstance,rgArgs)}};Type.prototype.callBase=function Type$callBase(oInstance,sName,rgArgs){var baseMethod=this.__oBaseType.prototype[sName];if(!rgArgs){return baseMethod.apply(oInstance)}else{return baseMethod.apply(oInstance,rgArgs)}};Type.prototype.get_Name=function Type$get_Name(){var fullName=this.__sTypeName;var nsIndex=fullName.lastIndexOf('.');if(nsIndex>0){return fullName.substr(nsIndex+1)}return fullName};Type.prototype.isInstance=function Type$isInstance(oInstance){if((oInstance===null)||(oInstance===undefined)){return false}if(!oInstance.hasOwnProperty){return false}if((this==Object)||((oInstance) instanceof(this))){return true}var type=Type.getInstanceType(oInstance);return this._isAssignableFrom(type)};Type.prototype._setupBase=function Type$_setupBase(){if(this.__fBasePrototypePending){var oBaseType=this.__oBaseType;if(oBaseType.__fBasePrototypePending){oBaseType._setupBase()}for(var memberName in oBaseType.prototype){var memberValue=oBaseType.prototype[memberName];if(typeof(this.prototype[memberName])==Type.Const.Undefined){this.prototype[memberName]=memberValue}}delete this.__fBasePrototypePending}};Type.prototype._isAssignableFrom=function Type$_isAssignableFrom(oType){if((this==Object)||(this==oType)||(this.__sTypeName&&this.__sTypeName==oType.__sTypeName)){return true}if(this.__fClass){var oBaseType=oType.__oBaseType;while(oBaseType){if(this==oBaseType||(this.__sTypeName&&this.__sTypeName==oBaseType.__sTypeName)){return true}oBaseType=oBaseType.__oBaseType}}else if(this.__fInterface){var interfaces=oType.__rgInterfaces;var index=0;for(index=0;interfaces&&index<interfaces.length;++index){if((this.__sTypeName&&interfaces[index].__sTypeName==this.__sTypeName)||interfaces[index]==this){return true}}var oBaseType=oType.__oBaseType;while(oBaseType){interfaces=oBaseType.__rgInterfaces;for(index=0;interfaces&&index<interfaces.length;++index){if((this.__sTypeName&&interfaces[index].__sTypeName==this.__sTypeName)||interfaces[index]==this){return true}}oBaseType=oBaseType.__oBaseType}}return false};Type.createNamespace=function Type$createNamespace(sName){if(!window.__namespaces){window.__namespaces={}}if(!window.__rootNamespaces){window.__rootNamespaces=[]}if(window.__namespaces[sName]){return}var oParentNamespace=window;var rgNameParts=sName.split('.');for(var i=0;i<rgNameParts.length;i++){var sPart=rgNameParts[i];var oNamespace=oParentNamespace[sPart];if(!oNamespace){oParentNamespace[sPart]=oNamespace=new __Namespace(rgNameParts.slice(0,i+1).join('.'));if(i==0){window.__rootNamespaces[window.__rootNamespaces.length]=oNamespace}}oParentNamespace=oNamespace}window.__namespaces[sName]=oParentNamespace};Type.getInstanceType=function Type$getInstanceType(oInstance){var ctor=null;try{ctor=oInstance.constructor}catch(e){}if(!ctor||!ctor.__sTypeName){ctor=Object}return ctor};Type.getType=function Type$getType(sTypeName){if(!sTypeName){return null}if(!Type.__typeCache){Type.__typeCache={}}var type=Type.__typeCache[sTypeName];if(!type){type=eval(sTypeName);Type.__typeCache[sTypeName]=type}return type};Object.__sTypeName='Object';Object.__oBaseType=null;Array.__sTypeName="Array";Array.__oBaseType=null;Array.__fClass=true;Boolean.__sTypeName="Boolean";Boolean.__oBaseType=null;Boolean.__fClass=true;String.__sTypeName="String";String.__oBaseType=null;String.__fClass=true;Number.__sTypeName="Number";Number.__oBaseType=null;Number.__fClass=true})();g_fModuleLoaded[".\\core/type.js".toLowerCase()]=1;var UniqueIdGenerator;var UniqueIdHashSet;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\core/UniqueId.js".toLowerCase()])(function(){var _iUpper=1000000000;var oInstance=null;var oHashSetInstance=null;UniqueIdGenerator=function(){this._sTick=(new Date()).getTime();this._sSeed=Math.round(Math.random()*_iUpper)};UniqueIdGenerator.get_Instance=function UniqueIdGenerator$get_Instance(){if(!oInstance){oInstance=new UniqueIdGenerator()}return oInstance};UniqueIdGenerator.prototype.get_Next=function UniqueIdGenerator$get_Next(){var sId="_"+this._sTick+"_"+this._sSeed;this._sSeed+=Math.round(Math.random()*10)+1;return sId};UniqueIdGenerator.createClass("UniqueIdGenerator");UniqueIdHashSet=function(){this._oObjectHashSet={}};UniqueIdHashSet.get_Instance=function UniqueIdHashSet$get_Instance(){if(!oHashSetInstance){oHashSetInstance=new UniqueIdHashSet()}return oHashSetInstance};UniqueIdHashSet.prototype.put=function UniqueIdHashSet$put(sUniqueId,oObject){return this._oObjectHashSet[sUniqueId]=oObject};UniqueIdHashSet.prototype.get=function UniqueIdHashSet$get(sUniqueId){return this._oObjectHashSet[sUniqueId]};UniqueIdHashSet.prototype.remove=function UniqueIdHashSet$remove(sUniqueId){delete this._oObjectHashSet[sUniqueId]};UniqueIdHashSet.prototype.clear=function UniqueIdHashSet$clear(){this._oObjectHashSet={}};UniqueIdHashSet.createClass("UniqueIdHashSet")})();g_fModuleLoaded[".\\core/UniqueId.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\core/StringBuilder.js".toLowerCase()])(function(){Type.createNamespace("Owa.Text");Owa.Text.StringBuilder=function Owa$Text$StringBuilder(){this.buffer=[]};Owa.Text.StringBuilder.prototype.append=function Owa$Text$StringBuilder$append(s){this.buffer.push(s);return this};Owa.Text.StringBuilder.prototype.toString=function Owa$Text$StringBuilder$toString(){return this.buffer.join("")}})();g_fModuleLoaded[".\\core/StringBuilder.js".toLowerCase()]=1;var urlEnc,urlDec,htmlEnc,htmlDec,jsEnc,toUTF8;(function(){Type.createNamespace("Owa.Encoder");urlEnc=Owa.Encoder.urlEncode=function Owa$Encoder$urlEncode(s){return toUTF8(s)};urlDec=Owa.Encoder.urlDec=function Owa$Encoder$urlDec(s){return decodeURIComponent(s)};htmlEnc=Owa.Encoder.htmlEnc=function Owa$Encoder$htmlEnc(s){var o=document.createElement("DIV");o.innerText=o.textContent=s;var sEnc=o.innerHTML;sEnc=sEnc.replace(new RegExp("\"","g"),"&quot;");return sEnc};htmlDec=Owa.Encoder.htmlDec=function Owa$Encoder$htmlDec(s){var o=Owa.Dom.Document.get_Current().createElement("DIV");o.set_InnerHtml(s);return o.get_TextContent()};jsEnc=Owa.Encoder.jsEnc=function Owa$Encoder$jsEnc(s){if(!isDf(typeof(s))||!s)return;var a=[];var c;for(var i=0;i<s.length;i++){c=s.charAt(i);switch(c){case'\"':case'\'':case'\\':case'/':a.push('\\');a.push(c);break;case'\r':a.push('\\');a.push('r');break;case'\n':a.push('\\');a.push('n');break;default:a.push(c);break}}return a.join("")};toUTF8=Owa.Encoder.toUTF8=function Owa$Encoder$toUTF8(szInput){if(szInput==null)return"";if(typeof(szInput)=="number")szInput=""+szInput;var sb=new Owa.Text.StringBuilder();var iRun=0;for(var x=0;x<szInput.length;x++){var wch=szInput.charCodeAt(x);if(isSfAscChr(wch)){continue}if(iRun!=x){sb.append(szInput.substring(iRun,x))}iRun=x+1;if(!(wch&0xFF80)){sb.append("%");sb.append(wch.toString(16))}else if(!(wch&0xF800)){sb.append("%");sb.append((wch>>6|0xC0).toString(16));sb.append("%");sb.append((wch&0x3F|0x80).toString(16))}else{sb.append("%");sb.append((wch>>12|0xE0).toString(16));sb.append("%");sb.append((((wch>>6)&0x3F)|0x80).toString(16));sb.append("%");sb.append((wch&0x3F|0x80).toString(16))}}if(iRun!=0&&iRun!=szInput.length){sb.append(szInput.substring(iRun,szInput.length))}return(iRun==0)?szInput:sb.toString()};function isSfAscChr(iCh){return((iCh>=0x30&&iCh<=0x39)||(iCh>=0x41&&iCh<=0x5A)||(iCh>=0x61&&iCh<=0x7A)||(iCh==0x21)||(iCh>=0x27&&iCh<=0x2A)||(iCh==0x2D)||(iCh==0x2E)||(iCh==0x5F)||(iCh==0x7E))}})();Type.createNamespace("Owa.Collection.Set");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\core/Set.js".toLowerCase()])(function(){Owa.Collection.Set=function Owa$Collection$Set(){this._rgObject=[]};var oPrototype=Owa.Collection.Set.prototype;oPrototype.add=function Owa$Collection$Set$add(oObject){if(!this.contains(oObject)){this._rgObject.push(oObject);return true}return false};oPrototype._indexOf=function Owa$Collection$Set$_indexOf(oObject){var iLength=this._rgObject.length;for(var iIndex=0;iIndex<iLength;iIndex++){if(oObject.equals){if(oObject.equals(this._rgObject[iIndex]))return iIndex}else if(oObject===this._rgObject[iIndex]){return iIndex}}return -1};oPrototype.contains=function Owa$Collection$Set$contains(oObject){return this._indexOf(oObject)!==-1};oPrototype.clear=function Owa$Collection$Set$clear(){this._rgObject=[]};oPrototype.toArray=function Owa$Collection$Set$toArray(){return this._rgObject.clone()};oPrototype.remove=function Owa$Collection$Set$remove(oObject){var iIndex=this._indexOf(oObject);if(iIndex>=0){this._rgObject.removeAt(iIndex);return true}return false}})();g_fModuleLoaded[".\\core/Set.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\core/strings.js".toLowerCase()])(function(){(function(){Type.createNamespace("Owa.Strings.Ids");var ns=Owa.Strings.Ids;ns.HelpButtonId="lnkHelp";ns.NewMailNotificationButtonId="lnkNwMl";ns.NewVoiceMailNotificationButtonId="lnkNwVMl";ns.NewFaxNotificationButtonId="lnkNwFx";ns.BuddyRequestNotificationButtonId="lnkBr";ns.ActiveChatsNotificationButtonId="lnkAc";ns.NewChatNotificationButtonId="lnkNwCht";ns.ReminderNotificationButtonId="lnkRm";ns.ErrorNotificationButtonId="lnkNE";ns.ComboDropDownList="divCmbList";ns.DatePickerDropDown="divDP";ns.ComboTextDisplaySpan="spanCmbSel";ns.TimeTextBox="txtTime";ns.InputTextBox="txtInput";ns.Accept="accept";ns.Decline="decline";ns.Tentative="tentative";ns.ShowCalendar="showcalendar";ns.SendResponse="sndrsp";ns.NoResponse="norsp";ns.EditResponse="edrsp";ns.Remove="remove";ns.AddThisCalendar="addThisCalendar";ns.FromSpan="spnFrom";ns.RecipientSpan="spnR";ns.AttachmentLink="lnkAtmt";ns.ItemPartExpansionHeader="divExpHdr";ns.ItemPartActionsButton="divActions";ns.ItemPartExpansion="divExp";ns.ItemPartDraftSpan="spnDraft"})();(function(){Type.createNamespace("Owa.Strings.Attributes");var ns=Owa.Strings.Attributes;ns.Id='id';ns.Type="name";ns.IsSticky="_stky";ns.IsToolbarButton="_tbb";ns.IsMenuItem="_mnuItm";ns.IsNotificationButton="_ntf";ns.IsOptionsSaveButton="_opt";ns.HasBigButtonWrapper="_fBig";ns.IsDisabled='fDsbl';ns.SubMenuId="_sbMnu";ns.ButtonPushed="_pushed";ns.ButtonAlwaysPushed="_alwaysPushed";ns.ToggleSiblingIds="_tgl";ns.SwapSiblingIds="_swp";ns.ComboMenuId="_twsy";ns.Radio="_radio";ns.ComboDropDownId="_ovr";ns.AllowContextMenu="_fAllwCM";ns.Value="oV";ns.TimeValue="sTm";ns.ShortTimeFormatString="sStf"})();(function(){Type.createNamespace("Owa.Strings.Controls");var ns=Owa.Strings.Controls;ns.Button="lnkB";ns.Menu="mnu";ns.Toolbar="tlb"})();(function(){Type.createNamespace("Owa.Strings.Names");var ns=Owa.Strings.Names;ns.LinkButton="lnkB";ns.LinkNotificationButton="lnkNB"})();(function(){Type.createNamespace("Owa.Strings.CssClass");var ns=Owa.Strings.CssClass;ns.ButtonDisabled="btnDa";ns.ButtonDown="btnDn";ns.ButtonDefault="btnDf";ns.ToolbarButtonDisabled="tbfD";ns.ToolbarButtonDown="tbfP";ns.ToolbarButtonHoverable="tbfHvr";ns.MenuButtonDisabled="miDa";ns.MenuButtonDown="miDn";ns.MenuButtonDefault="miDf";ns.NotificationButtonDown="alertBtnDn";ns.NotificationButtonDefault="alertBtnDf";ns.OptionsSaveButtonDisabled="optDa";ns.OptionsSaveButtonDown="optDn";ns.OptionsSaveButtonHoverable="optHvr";ns.ComboDropDownSelectedItem="cmbSel";ns.ComboBoxDisable="cmbDsbl";ns.RightPipe="rightPipe";ns.LeftPipe="leftPipe";ns.RightStopLarge="rightStopL";ns.RightStopSmall="rightStopS";ns.LeftStopLarge="leftStopL";ns.LeftStopSmall="leftStopS";ns.RightChildStopLarge="rightChildStopL";ns.RightChildStopSmall="rightChildStopS";ns.LeftChildStopLarge="leftChildStopL";ns.LeftChildStopSmall="leftChildStopS";ns.ChildPipe="childPipe";ns.ParentPipe="ppPar";ns.AncestorPipe="ppAnc";ns.ParentStopSmall="psParS";ns.ParentStopLarge="psParL";ns.AncestorStopSmall="psAncS";ns.AncestorStopLarge="psAncL";ns.PipeBackground="pipeBkg"})();(function(){Type.createNamespace("Owa.Strings.ObjectClass");var ns=Owa.Strings.ObjectClass;ns.MeetingRequest="IPM.Schedule.Meeting.Request";ns.MeetingCancellation="IPM.Schedule.Meeting.Canceled";ns.SharingMessage="IPM.Sharing"})();(function(){Type.createNamespace("Owa.Strings.Icons");var ns=Owa.Strings.Icons;ns.Collapsed="plus.png";ns.Expanded="minus.png";ns.CollapsedRtl="plusrtl.png";ns.ExpandedRtl="minusrtl.png"})()})();g_fModuleLoaded[".\\core/strings.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\core/browserDetection.js".toLowerCase()])(function(){Type.createNamespace("Owa.Utility");var _fIsMac=null;var _fIsWin=null;var _fIsIE=null;var _fIsFirefox=null;var _fIsSafari=null;var _iFirefoxVersion=null;Owa.Utility.isMac=function Owa$Utility$isMac(){if(_fIsMac==null){_fIsMac=(navigator.appVersion.indexOf('Mac')!=-1)}return _fIsMac};Owa.Utility.isWin=function Owa$Utility$isWin(){if(_fIsWin==null){_fIsWin=((navigator.appVersion.indexOf('Win')!=-1)||(navigator.appVersion.indexOf('NT')!=-1))}return _fIsWin};Owa.Utility.isIE=function Owa$Utility$isIE(){if(_fIsIE==null){_fIsIE=(navigator.userAgent.indexOf("MSIE ")!=-1)}return _fIsIE};Owa.Utility.isFirefox=function Owa$Utility$isFirefox(){if(_fIsFirefox==null){_fIsFirefox=(navigator.userAgent.indexOf("Firefox/")!=-1)&&(navigator.userAgent.indexOf("Gecko/")!=-1)}return _fIsFirefox};Owa.Utility.get_FirefoxVersion=function Owa$Utility$get_FirefoxVersion(){if(_iFirefoxVersion==null){if(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)){_iFirefoxVersion=new Number(RegExp.$1)}else{_iFirefoxVersion=-1}}return _iFirefoxVersion};Owa.Utility.isSafari=function Owa$Utility$isSafari(){if(_fIsSafari==null){_fIsSafari=(navigator.userAgent.indexOf("Safari")!=-1)&&(navigator.userAgent.indexOf("WebKit")!=-1)}return _fIsSafari};Owa.Utility.isActiveXControlSupported=function Owa$Utility$isActiveXControlSupported(){if(Owa.Utility.isIE()){try{new ActiveXObject("MSXML2.DomDocument");return true}catch(e){}}return false}})();g_fModuleLoaded[".\\core/browserDetection.js".toLowerCase()]=1;(function(){Type.createNamespace("Owa.Utility");Owa.Utility.IntFromSize=function Owa$Utility$IntFromSize(sValue){var result=parseInt(sValue.trim(),10);return isNaN(result)?0:result};function _delegateEquals(oObject){return !!oObject&&this._oThis==oObject._oThis&&this._fnFunction&&oObject._fnFunction}Owa.Utility.createDelegate=function Owa$Utility$createDelegate(oThis,fnFunction){var delegate=function(){return fnFunction.apply(oThis,arguments)};delegate._oThis=oThis;delegate._fnFunction=fnFunction;delegate.equals=_delegateEquals;return delegate};Owa.Utility.createContextDelegate=function Owa$Utility$createContextDelegate(oThis,fnFunction,oContext){var delegate=function(){return fnFunction.call(oThis,oContext)};delegate._oThis=oThis;delegate._fnFunction=fnFunction;delegate.equals=_delegateEquals;return delegate};Owa.Utility.createArgumentContextDelegate=function Owa$Utility$createArgumentContextDelegate(oThis,fnFunction,oContext){var delegate=function(oCallbackArguments){return fnFunction.call(oThis,oCallbackArguments,oContext)};delegate._oThis=oThis;delegate._fnFunction=fnFunction;delegate.equals=_delegateEquals;return delegate};Owa.Utility.inherit=function Owa$Utility$inherit(cls,baseCls){for(var sFn in baseCls.prototype)cls.prototype[sFn]=baseCls.prototype[sFn];cls.prototype.constructor=cls;cls.baseClass=baseCls};Owa.Utility.isArray=function Owa$Utility$isArray(o){if(o&&typeof(o)=="object")return typeof(o.length)!="undefined";return 0};Owa.Utility.appendPixelUnit=function Owa$Utility$appendPixelUnit(iValue){return iValue+"px"};Owa.Utility.isWebPartWindow=function Owa$Utility$isWebPartWindow(){return(Owa.Utility.isDefined(typeof a_fWP)&&a_fWP)};Owa.Utility.isDefined=function Owa$Utility$isDefined(sType){return(sType!==Type.Const.Undefined)};Owa.Utility.isEqual=function Owa$Utility$isEqual(oLeft,oRight){if(oLeft&&oLeft["equals"]!==undefined){return oLeft.equals(oRight)}else{return oLeft==oRight}};Owa.Utility.getIFrameParentOwaWindow=function Owa$Utility$getIFrameParentOwaWindow(){if(Owa.Utility.isWebPartWindow()){return Owa.Dom.Window.get_Current()}else{var oWindow=Owa.Dom.Window.get_Current();while(oWindow){var oParentWindow=oWindow.get_ParentWindow();if(!oParentWindow||oParentWindow._domWindow==oWindow._domWindow)break;var fOwaFlag=oParentWindow._domWindow["g_fOwa"];if(Owa.Utility.isDefined(typeof fOwaFlag)&&fOwaFlag)oWindow=oParentWindow;else break}return oWindow}};Owa.Utility.getRootOwaWindow=function Owa$Utility$getRootOwaWindow(){if(Owa.Utility.isWebPartWindow()){return Owa.Dom.Window.get_Current()}var oTopWindow=Owa.Dom.Window.get_Current();var oLastOwaWindow=oTopWindow;while(true){var oOwa=oTopWindow.getGlobalVariable("Owa");try{if(oOwa&&oOwa.Utility&&oOwa.Utility.getIFrameParentOwaWindow)oTopWindow=oOwa.Utility.getIFrameParentOwaWindow();else return oLastOwaWindow}catch(e){return oLastOwaWindow}if(oTopWindow.getGlobalVariable("a_fStPg"))return oTopWindow;var oOpenerWindow=oTopWindow.get_Opener();if(!oOpenerWindow)oOpenerWindow=oTopWindow.get_ParentWindow();if(oOpenerWindow&&oOpenerWindow.getGlobalVariable("g_fOwa")&&!oTopWindow.equals(oOpenerWindow)){oLastOwaWindow=oTopWindow;oTopWindow=oOpenerWindow}else{return oTopWindow}}};Owa.Utility.getVisiblePositionX=function Owa$Utility$getVisiblePositionX(oElement,iX,fRtl){var iWindowWidth=oElement.get_ParentElement().get_OffsetWidth();var iElementWidth=oElement.get_OffsetWidth();var iOffsetX=oElement.get_PositionalParent().get_RelativeLeft(oElement.get_ParentElement());var iBodyX=iOffsetX+iX;if(!fRtl){var iOverhang=(iBodyX+iElementWidth-iWindowWidth);if(iOverhang>0)iBodyX-=iOverhang;if(iBodyX<0)iBodyX=0}else{if(iBodyX<0)iBodyX=0;if(iBodyX+iElementWidth>iWindowWidth)iBodyX=iWindowWidth-iElementWidth}return(iBodyX-iOffsetX)};Owa.Utility.getVisiblePositionY=function Owa$Utility$getVisiblePositionY(oElement,iY){var oDocumentElement=oElement.get_ParentElement();var iElementHeight=oElement.get_OffsetHeight();var iOffsetY=oElement.get_PositionalParent().get_RelativeTop(oDocumentElement);var iBodyY=iOffsetY+iY;var iOverhang=iBodyY+iElementHeight-oDocumentElement.get_OffsetHeight()-oDocumentElement.get_ScrollTop();if(iOverhang>0)iBodyY-=iOverhang;if(iBodyY<0)iBodyY=0;return(iBodyY-iOffsetY)};Owa.Utility.createWindowResizeHandler=function Owa$Utility$createWindowResizeHandler(oWindow,fnHandler){var oBody=oWindow.get_Document().get_Body();var iHeight=oBody.get_ClientHeight();var iWidth=oBody.get_ClientWidth();var fnReturnValue=function(){var iNewHeight=oBody.get_ClientHeight();var iNewWidth=oBody.get_ClientWidth();if(iHeight!=iNewHeight||iWidth!=iNewWidth){iHeight=iNewHeight;iWidth=iNewWidth;fnHandler()}};return fnReturnValue}})();Type.createNamespace("Owa.Collections");Owa.Collections.IEnumerator=function Owa$Collections$IEnumerator(){};Owa.Collections.IEnumerator.prototype.get_Current=null;Owa.Collections.IEnumerator.prototype.moveNext=null;Owa.Collections.IEnumerator.prototype.reset=null;Owa.Collections.IEnumerator.createInterface('Owa.Collections.IEnumerator');Owa.Collections.IEnumerable=function Owa$Collections$IEnumerable(){};Owa.Collections.IEnumerable.prototype.get_Enumerator=null;Owa.Collections.IEnumerable.createInterface('Owa.Collections.IEnumerable');Owa.Collections.IList=function Owa$Collections$IList(){};Owa.Collections.IList.prototype.get_Length=null;Owa.Collections.IList.prototype.get_Item=null;Owa.Collections.IList.createInterface('Owa.Collections.IList');Owa.Collections.ListEnumerator=function Owa$Collections$ListEnumerator(oList){this._oList=oList;this._index=-1};Owa.Collections.ListEnumerator.prototype.get_Current=function Owa$Collections$ListEnumerator$get_Current(){return this._oList.get_Item(this._index)};Owa.Collections.ListEnumerator.prototype.moveNext=function Owa$Collections$ListEnumerator$moveNext(){this._index++;return(this._index<this._oList.get_Length())};Owa.Collections.ListEnumerator.prototype.reset=function Owa$Collections$ListEnumerator$reset(){this._index=-1};Owa.Collections.ListEnumerator.createClass('Owa.Collections.ListEnumerator',null,Owa.Collections.IEnumerator);var isNoE,isRg,isDf,getInt;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\core/nativetypeextension.js".toLowerCase()])(function(){(function(){String.prototype.trimStart=function String$trimStart(){return this.replace(/^\s*/,"")};String.prototype.trimEnd=function String$trimEnd(){return this.replace(/\s*$/,"")};String.prototype.startsWith=function String$startsWith(sStr){return this.indexOf(sStr)==0};String.prototype.trim=function String$trim(){return this.trimStart().trimEnd()};String.prototype.endsWith=function String$endsWith(sStr){var iLastIndex=this.lastIndexOf(sStr);if(iLastIndex>=0&&iLastIndex==this.length-sStr.length){return true}else{return false}};String.prototype.contains=function String$contains(sStr){return this.indexOf(sStr)>=0};String.prototype.format=function String$format(){var s=this;for(var i=0;i<arguments.length;i++){s=s.replace(RegExp("\\{"+i+"\\}","g"),arguments[i])}return s};String.prototype._localeCompare=String.prototype.localeCompare;if(!String.prototype._localeCompare){String.prototype._localeCompare=function(s){if(this<s)return -1;else if(this>s)return 1;else return 0}}String._equalityOffset="0"._localeCompare("0");String.prototype.localeCompare=function(s){return this._localeCompare(s)-String._equalityOffset};String.NormalizeDomString=function String$NormalizeDomString(s){if(Owa.Utility.isIE()){return s}else{return s?s.replace(/\xa0/g,' '):s}};isNoE=String.isNullOrEmpty=function String$isNullOrEmpty(s){if(s&&(s.trim()!=""))return 0;else return 1}})();(function(){Array.__rgInterfaces=[Owa.Collections.IList,Owa.Collections.IEnumerable];Array.prototype.get_Length=function Array$get_Length(){return this.length};Array.prototype.get_Item=function Array$get_Item(index){return this[index]};Array.prototype.get_Enumerator=function Array$get_Enumerator(){return new Owa.Collections.ListEnumerator(this)};Array.prototype.indexOf=function Array$indexOf(oItem){for(var i=0;i<this.length;i++){if(this[i]&&this[i]===oItem)return i}return -1};Array.prototype.remove=function Array$remove(oItem){var index=this.indexOf(oItem);if(index>-1){this.splice(index,1)}return(index>-1)};Array.prototype.removeAt=function Array$removeAt(iIndex){if(iIndex<this.length){this.splice(iIndex,1);return true}return false};Array.prototype.add=function Array$add(oItem){this.push(oItem)};Array.prototype.clone=function Array$clone(){return this.slice()};isRg=Array.isArray=function Array$isArray(o){if(o&&typeof(o)==Type.Const.Object)return isDf(typeof(o.length));return false}})();(function(){Date.prototype.equals=function Date$equals(oR){return Date.isInstance(oR)&&this.gyr()==oR.gyr()&&this.gmo()==oR.gmo()&&this.gdt()==oR.gdt()&&this.ghrs()==oR.ghrs()&&this.gmins()==oR.gmins()};Date.prototype.gsecs=function Date$gsecs(){return this.getUTCSeconds()};Date.prototype.gsecsl=function Date$gsecsl(){return this.getSeconds()};Date.prototype.gmins=function Date$gmins(){return this.getUTCMinutes()};Date.prototype.gminsl=function Date$gminsl(){return this.getMinutes()};Date.prototype.ghrs=function Date$ghrs(){return this.getUTCHours()};Date.prototype.ghrsl=function Date$ghrsl(){return this.getHours()};Date.prototype.gdt=function Date$gdt(){return this.getUTCDate()};Date.prototype.gdtl=function Date$gdtl(){return this.getDate()};Date.prototype.gmo=function Date$gmo(){return this.getUTCMonth()};Date.prototype.gmol=function Date$gmol(){return this.getMonth()};Date.prototype.gyr=function Date$gyr(){return this.getUTCFullYear()};Date.prototype.gyrl=function Date$gyrl(){return this.getFullYear()};Date.prototype.smsecs=function Date$smsecs(iMs){this.setUTCMilliseconds(iMs)};Date.prototype.ssecs=function Date$ssecs(iS,iMs){this.setUTCSeconds(iS,iMs?iMs:null)};Date.prototype.smins=function Date$smins(iM,iS){this.setUTCMinutes(iM,iS?iS:null)};Date.prototype.shrs=function Date$shrs(iH,iM,iS){this.setUTCHours(iH,iM?iM:null,iS?iS:null)};Date.prototype.sdt=function Date$sdt(iD){this.setUTCDate(iD)};Date.prototype.smo=function Date$smo(iM,iD){this.setUTCMonth(iM,iD?iD:null)};Date.prototype.syr=function Date$syr(iY,iM,iD){this.setUTCFullYear(iY,iM?iM:null,iD?iD:null)};Date.prototype.eThn=function Date$eThn(dt){var iTimeNum1=Date.UTC(this.getUTCFullYear(),this.getUTCMonth(),this.getUTCDay(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds(),this.getUTCMilliseconds());var iTimeNum2=Date.UTC(dt.getUTCFullYear(),dt.getUTCMonth(),dt.getUTCDay(),dt.getUTCHours(),dt.getUTCMinutes(),dt.getUTCSeconds(),dt.getUTCMilliseconds());return iTimeNum1<iTimeNum2};Date.prototype.toIsoString=function Date$toIsoString(){var sY=this.gyr();var sMo=this.gmo()+1;var sD=this.gdt();var sH=this.ghrs();var sMi=this.gmins();var sS=this.gsecs();return sY+"-"+((sMo<10)?"0"+sMo:sMo)+"-"+((sD<10)?"0"+sD:sD)+"T"+((sH<10)?"0"+sH:sH)+":"+((sMi<10)?"0"+sMi:sMi)+":"+((sS<10)?"0"+sS:sS)}})();(function(){Type.createNamespace("Owa.Type.Utility");isDf=Owa.Type.Utility.isDefined=function Owa$Type$Utility$isDefined(sT){return sT!=Type.Const.Undefined};getInt=Owa.Type.Utility.getInt=function Owa$Type$Utility$getInt(s){return parseInt(s,10)}})()})();g_fModuleLoaded[".\\core/nativetypeextension.js".toLowerCase()]=1;Type.createNamespace("Owa.Utility");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\core/eventhandlercollection.js".toLowerCase()])(function(){Owa.Utility.EventHandlerCollection=function Owa$Utility$EventHandlerCollection(){this._handlers=[];this._fLast=false};Owa.Utility.EventHandlerCollection.prototype.add=function Owa$Utility$EventHandlerCollection$add(fnDelegate,fLast){if(this._fLast&&fLast){throw new Error("There can be only one \"last\" handler.")}if(this._indexOf(fnDelegate)==-1){if(this._fLast){var fnLast=this._handlers.pop();this._handlers.push(fnDelegate);this._handlers.push(fnLast)}else{this._handlers.add(fnDelegate);if(fLast){this._fLast=true}}}};Owa.Utility.EventHandlerCollection.prototype.clear=function Owa$Utility$EventHandlerCollection$clear(){this._handlers=[]};Owa.Utility.EventHandlerCollection.prototype.remove=function Owa$Utility$EventHandlerCollection$remove(fnDelegate){var index=this._indexOf(fnDelegate);if(index>=0){this._handlers.removeAt(index);return true}return false};Owa.Utility.EventHandlerCollection.prototype.get_IsEmpty=function Owa$Utility$EventHandlerCollection$get_IsEmpty(){return this._handlers.length==0};Owa.Utility.EventHandlerCollection.prototype.dispatch=function Owa$Utility$EventHandlerCollection$dispatch(oEventArgs,oContext){return this.dispatchWithThisArg(null,oEventArgs,oContext)};Owa.Utility.EventHandlerCollection.prototype.dispatchWithThisArg=function Owa$Utility$EventHandlerCollection$dispatchWithThisArg(oThisArg,oEventArg,oContext){var oRet=undefined;var handlers=this._handlers.slice(0);for(var iHandler=0;iHandler<handlers.length;++iHandler){var oOneResult=handlers[iHandler].call(oThisArg,oEventArg,oContext);if(oOneResult===false||oOneResult===0){oRet=false}else if(oRet!==false){oRet=oOneResult}}return oRet};Owa.Utility.EventHandlerCollection.prototype._indexOf=function Owa$Utility$EventHandlerCollection$_indexOf(fnDelegate){for(var iHandler=0;iHandler<this._handlers.length;++iHandler){if(fnDelegate==this._handlers[iHandler]){return iHandler}else if(fnDelegate._fnFunction&&this._handlers[iHandler]._fnFunction){if(fnDelegate._fnFunction==this._handlers[iHandler]._fnFunction&&fnDelegate._oThis==this._handlers[iHandler]._oThis){return iHandler}}}return -1}})();g_fModuleLoaded[".\\core/eventhandlercollection.js".toLowerCase()]=1;var POST="POST";var GET="GET";if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\dom/ajaxrequest.js".toLowerCase()])(function(){Type.createNamespace("Owa.Dom");var fChecked=false;var fUseNative=true;var rgRequests=[];Owa.Dom.AjaxRequest=function Owa$Dom$AjaxRequest(sUrl,sCmd,oCtx,cb,fSync,fNeverDispose){var oXHR;if(fChecked){oXHR=fUseNative?new XMLHttpRequest():new ActiveXObject("MSXML2.xmlhttp")}else{try{oXHR=new XMLHttpRequest();fUseNative=true}catch(e){oXHR=new ActiveXObject("MSXML2.xmlhttp");fUseNative=false}fChecked=true}this.oXmlHttp=oXHR;this.oXmlHttp.open(sCmd,sUrl,!fSync);this.sUrl=sUrl;this.oCtx=oCtx;this.fSync=fSync;this.fLock=false;this._fNeverDispose=!!fNeverDispose;this.iIndex=rgRequests.length;rgRequests.push(this);if(cb){this.cb=cb;if(!fSync){this.oXmlHttp.onreadystatechange=new Function("Owa.Dom.AjaxRequest._cbOnReadyStateChange("+this.iIndex+");")}}Owa.Dom.AjaxRequest.get_OnRequestCreated().dispatch(this)};Owa.Dom.AjaxRequest.prototype.send=function Owa$Dom$AjaxRequest$send(sBody){if(isDf(typeof(sBody))){this.oXmlHttp.send(sBody)}else{this.oXmlHttp.send(null)}if(this.fSync){return this.onComplete()}else{return null}};Owa.Dom.AjaxRequest.prototype.setRequestHeader=function Owa$Dom$AjaxRequest$setRequestHeader(sHeaderName,sHeaderValue){this.oXmlHttp.setRequestHeader(sHeaderName,sHeaderValue)};Owa.Dom.AjaxRequest.prototype.cancelCallback=function Owa$Dom$AjaxRequest$cancelCallback(){if(this.fLock)throw"cannot cancel the callback when it is already finished or cancelled";this.fLock=true;rgRequests[this.iIndex].oXmlHttp.abort();delete rgRequests[this.iIndex]};Owa.Dom.AjaxRequest.prototype.onComplete=function Owa$Dom$AjaxRequest$onComplete(){if(!this.fLock){this.fLock=true;Owa.Dom.AjaxRequest.get_OnResponseReceived().dispatch(this);var oCallbackResult=null;if(this.cb!=null)oCallbackResult=this.cb(this);delete rgRequests[this.iIndex];Owa.Dom.AjaxRequest.get_OnCallbackCompleted().dispatch(this);return oCallbackResult}};Owa.Dom.AjaxRequest._cbOnReadyStateChange=function Owa$Dom$AjaxRequest$_cbOnReadyStateChange(i){var oRequest=rgRequests[i];if(oRequest&&4==oRequest.oXmlHttp.readyState){if(0==oRequest.oXmlHttp.status&&(Owa.Utility.isFirefox()||Owa.Utility.isSafari())){oRequest.cancelCallback()}else{oRequest.onComplete()}}};Owa.Dom.AjaxRequest.disposeAjaxRequests=function Owa$Dom$AjaxRequest$disposeAjaxRequests(){for(var i=0;i<rgRequests.length;i++){if(rgRequests[i]){var oR=rgRequests[i];if(oR._fNeverDispose)continue;Owa.Dom.AjaxRequest.abortAnXMLHttpRequest(oR.oXmlHttp);rgRequests[i]=null}}};Owa.Dom.AjaxRequest.abortAjaxRequests=function Owa$Dom$AjaxRequest$abortAjaxRequests(sNs,oCmd){var oR=null;for(var i=0;i<rgRequests.length;i++){oR=rgRequests[i];if(oR&&oR.oCtx&&isDf(typeof(oR.oCtx.sNs))&&(oR.oCtx.sNs==sNs)&&isDf(typeof(oR.oCtx.sEv))&&isDf(typeof(oCmd[oR.oCtx.sEv]))){if(oR.fLock){continue}oR.fLock=true;Owa.Dom.AjaxRequest.abortAnXMLHttpRequest(oR.oXmlHttp);rgRequests[i]=null}}};Owa.Dom.AjaxRequest.abortAnXMLHttpRequest=function Owa$Dom$AjaxRequest$abortAnXMLHttpRequest(oX){if(isDf(typeof(oX))&&oX&&isDf(typeof(oX.abort))){try{oX.onreadystatechange=function(){};oX.abort()}catch(e){}}};var ON_REQUEST_CREATED="onRequestCreated";var ON_RESPONSE_RECEIVED="onResponseReceived";var ON_CALLBACK_COMPLETED="onCallbackCompleted";var _oStaticEvents={};_oStaticEvents[ON_REQUEST_CREATED]=new Owa.Utility.EventHandlerCollection();_oStaticEvents[ON_RESPONSE_RECEIVED]=new Owa.Utility.EventHandlerCollection();_oStaticEvents[ON_CALLBACK_COMPLETED]=new Owa.Utility.EventHandlerCollection();Owa.Dom.AjaxRequest.get_OnRequestCreated=function Owa$Dom$AjaxRequest$get_OnRequestCreated(){return _oStaticEvents[ON_REQUEST_CREATED]};Owa.Dom.AjaxRequest.get_OnResponseReceived=function Owa$Dom$AjaxRequest$get_OnResponseReceived(){return _oStaticEvents[ON_RESPONSE_RECEIVED]};Owa.Dom.AjaxRequest.get_OnCallbackCompleted=function Owa$Dom$AjaxRequest$get_OnCallbackCompleted(){return _oStaticEvents[ON_CALLBACK_COMPLETED]}})();g_fModuleLoaded[".\\dom/ajaxrequest.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\dom/event.js".toLowerCase()])(function(){Type.createNamespace("Owa.Dom");Owa.Dom.Event=function Owa$Dom$Event(oEvent,oCurrentTarget){this._oEvent=oEvent;this._oCurrentTarget=oCurrentTarget};Owa.Dom.Event.prototype.isLeftButtonDown=function Owa$Dom$Event$isLeftButtonDown(){if(typeof(this._oEvent.which)!="undefined"){if(Owa.Utility.isMac()&&this._oEvent.ctrlKey){return false}else{return(this._oEvent.which==1)}}else{return((this._oEvent.button&0x1)!=0)}};Owa.Dom.Event.prototype.isRightButtonDown=function Owa$Dom$Event$isRightButtonDown(){if(typeof(this._oEvent.which)!="undefined"){if(this._oEvent.which==3||(Owa.Utility.isMac()&&this._oEvent.ctrlKey&&this._oEvent.which==1)){return true}}else{return((this._oEvent.button&0x2)!=0)}};Owa.Dom.Event.prototype.isAltKeyDown=function Owa$Dom$Event$isAltKeyDown(){return this._oEvent.altKey};Owa.Dom.Event.prototype.isCtrlKeyDown=function Owa$Dom$Event$isCtrlKeyDown(){if(Owa.Utility.isMac())return this._oEvent.metaKey;else return this._oEvent.ctrlKey};Owa.Dom.Event.prototype.isMacCtrlKeyDown=function Owa$Dom$Event$isMacCtrlKeyDown(){return Owa.Utility.isMac()&&this._oEvent.ctrlKey};Owa.Dom.Event.prototype.isShiftKeyDown=function Owa$Dom$Event$isShiftKeyDown(){return this._oEvent.shiftKey};Owa.Dom.Event.prototype.preventDefault=function Owa$Dom$Event$preventDefault(){this._oEvent.preventDefault?this._oEvent.preventDefault():this._oEvent.returnValue=false};Owa.Dom.Event.prototype.cancelBubble=function Owa$Dom$Event$cancelBubble(){this._oEvent.cancelBubble=true};Owa.Dom.Event.prototype.get_ClientX=function Owa$Dom$Event$get_ClientX(){return this._oEvent.clientX};Owa.Dom.Event.prototype.get_ClientY=function Owa$Dom$Event$get_ClientY(){return this._oEvent.clientY};Owa.Dom.Event.prototype.get_CurrentTarget=function Owa$Dom$Event$get_CurrentTarget(){if(!this._oWrapCurrentTarget&&this._oCurrentTarget){this._oWrapCurrentTarget=this._oCurrentTarget?Owa.Dom.EventTarget.wrapEventTarget(this._oCurrentTarget):null}return this._oWrapCurrentTarget};Owa.Dom.Event.prototype.get_Target=function Owa$Dom$Event$get_Target(){var o=this._oEvent.srcElement||this._oEvent.target;if(o&&typeof(o.nodeType)!="undefined"&&o.nodeType!=Owa.NodeType.Element)o=o.parentNode;return o?Owa.Dom.EventTarget.wrapEventTarget(o):null};Owa.Dom.Event.prototype.get_ToElementForMouseOut=function Owa$Dom$Event$get_ToElementForMouseOut(){if(this._oEvent.type!="mouseout")throw"Cannot call getToElementForMouseOut for a non mouseout event";var o=this._oEvent.toElement||this._oEvent.relatedTarget;return o?Owa.Dom.Node.wrapDomNode(o):null};Owa.Dom.Event.prototype.get_KeyCodeForKeyUpDown=function Owa$Dom$Event$get_KeyCodeForKeyUpDown(){if(this._oEvent.type!="keyup"&&this._oEvent.type!="keydown")throw"Cannot get keyCode for events other than keyup or keydown";return this._oEvent.keyCode};Owa.Dom.Event.prototype.get_CharCodeForKeyPress=function Owa$Dom$Event$get_CharCodeForKeyPress(){if(this._oEvent.type!="keypress")throw"Cannot get char code for events other than keypress";if(Owa.Utility.isIE()){return this._oEvent.keyCode}else{return this._oEvent.charCode}};Owa.Dom.Event.prototype.get_Type=function Owa$Dom$Event$get_Type(){if(window.Components){switch(this._oEvent.type){case"draggesture":return"dragstart";case"dragdrop":return"drop";case"dragexit":return"dragleave";case"DOMMouseScroll":return"mousewheel";default:return this._oEvent.type}}return this._oEvent.type};Owa.Dom.Event.prototype.get_WheelDirection=function Owa$Dom$Event$get_WheelDirection(){if(this._oEvent.wheelDelta)return(this._oEvent.wheelDelta<0)?1:-1;else return(this._oEvent.detail>0)?1:-1};Owa.Dom.Event.createClass("Owa.Dom.Event")})();g_fModuleLoaded[".\\dom/event.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\dom/eventtarget.js".toLowerCase()])(function(){Type.createNamespace("Owa.Dom");Owa.Dom.EventTarget=function Owa$Dom$EventTarget(oTarget){this._oTarget=oTarget};Owa.Dom.EventTarget.prototype.attachEvent=function Owa$Dom$EventTarget$attachEvent(sEventName,fn,fLast){sEventName=_mapEventName(sEventName);var oE=this._get_Target();var rgHandlers=oE.__eventHandlers;if(!rgHandlers){rgHandlers={};oE.__eventHandlers=rgHandlers}if(!rgHandlers[sEventName]){rgHandlers[sEventName]=new Owa.Utility.EventHandlerCollection();var oInlineHandler=oE["on"+sEventName];if(oInlineHandler){rgHandlers[sEventName].add(oInlineHandler)}if((typeof oE.addEventListener)!="undefined"){oE.addEventListener(sEventName,Owa.Dom.EventTarget._dispatchEvent,false)}else{oE["on"+sEventName]=Owa.Dom.EventTarget._dispatchEvent}}rgHandlers[sEventName].add(fn,fLast);Owa.Dom.DisposeManager.add(this)};function _isCollectionEmpty(oObj){var fIsNull=true;for(var sMember in oObj){if(oObj[sMember]!=null){fIsNull=false;break}}return fIsNull}Owa.Dom.EventTarget.prototype.detachEvent=function Owa$Dom$EventTarget$detachEvent(sEventName,fn){var oE=this._get_Target();sEventName=_mapEventName(sEventName);if(oE.__eventHandlers&&oE.__eventHandlers[sEventName]){oE.__eventHandlers[sEventName].remove(fn);if(oE.__eventHandlers[sEventName].get_IsEmpty()){if((typeof oE.removeEventListener)=="undefined"){oE["on"+sEventName]=null}else{oE.removeEventListener(sEventName,Owa.Dom.EventTarget._dispatchEvent,false)}oE.__eventHandlers[sEventName]=null}if(_isCollectionEmpty(oE.__eventHandlers)){oE.__eventHandlers=null}}};Owa.Dom.EventTarget.prototype.detachAllEvents=function Owa$Dom$EventTarget$detachAllEvents(sEventName){var oE=this._get_Target();sEventName=_mapEventName(sEventName);if(sEventName){if(oE.__eventHandlers&&oE.__eventHandlers[sEventName]){oE.__eventHandlers[sEventName]=null;oE["on"+sEventName]=null;if(_isCollectionEmpty(oE.__eventHandlers)){oE.__eventHandlers=null}}}else{for(var sEvent in oE.__eventHandlers){if((typeof oE.removeEventListener)=="undefined"){oE["on"+sEvent]=null}else{oE.removeEventListener(sEvent,Owa.Dom.EventTarget._dispatchEvent,false)}oE.__eventHandlers[sEvent]=null}oE.__eventHandlers=null}};Owa.Dom.EventTarget.prototype.dispose=function Owa$Dom$EventTarget$dispose(){Owa.Dom.DisposeManager.remove(this);this._internalDispose()};Owa.Dom.EventTarget.prototype._internalDispose=function Owa$Dom$EventTarget$_internalDispose(){this.detachAllEvents()};Owa.Dom.EventTarget._dispatchEvent=function Owa$Dom$EventTarget$_dispatchEvent(e){e=e||Owa.Dom.EventTarget._getEvent(this);if(this.__eventHandlers){var oEvent=new Owa.Dom.Event(e,this);if(this.__eventHandlers[e.type]){return this.__eventHandlers[e.type].dispatchWithThisArg(this,oEvent)}}};Owa.Dom.EventTarget.prototype._clearPropertiesForClone=function Owa$Dom$EventTarget$_clearPropertiesForClone(){var oE=this._get_Target();if(Owa.Utility.isIE())oE.removeAttribute("__eventHandlers");else delete oE.__eventHandlers};Owa.Dom.EventTarget._getEvent=function Owa$Dom$EventTarget$_getEvent(o){try{if(o.event){return o.event}if(o.ownerDocument){o=o.ownerDocument}return o.parentWindow.event}catch(e){Owa.BrowserErrorHandler.handleFrameAccessError(e)}};Owa.Dom.EventTarget.wrapEventTarget=function Owa$Dom$EventTarget$wrapEventTarget(o){if(typeof(o.navigator)!="undefined"){return new Owa.Dom.Window(o)}else{return Owa.Dom.Node.wrapDomNode(o)}};var _oFirefoxSpecialNamedEventsMap={"mousewheel":"DOMMouseScroll"};function _mapEventName(sOriginalEventName){var sNameMapped;if(Owa.Utility.isFirefox()){sNameMapped=_oFirefoxSpecialNamedEventsMap[sOriginalEventName]}if(sNameMapped)return sNameMapped;else return sOriginalEventName}Owa.Dom.EventTarget.prototype._get_Target=function Owa$Dom$EventTarget$_get_Target(){return this._oTarget};Owa.Dom.EventTarget.createClass("Owa.Dom.EventTarget")})();g_fModuleLoaded[".\\dom/eventtarget.js".toLowerCase()]=1;Type.createNamespace("Owa.Dom");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\dom/window.js".toLowerCase()])(function(){Owa.Dom.Window=function Owa$Dom$Window(domWindow){this._domWindow=domWindow;Owa.Dom.Window.constructBase(this,[domWindow])};var _oCurrentWindow;Owa.Dom.Window.get_Current=function Owa$Dom$Window$get_Current(){if(!_oCurrentWindow){_oCurrentWindow=new Owa.Dom.Window(window)}return _oCurrentWindow};Owa.Dom.Window.dispose=function Owa$Dom$Window$dispose(){if(_oCurrentWindow){_oCurrentWindow.dispose();_oCurrentWindow=null}};Owa.Dom.Window.prototype.get_Document=function Owa$Dom$Window$get_Document(){return new Owa.Dom.Document(this._domWindow.document)};Owa.Dom.Window.prototype.get_FrameElement=function Owa$Dom$Window$get_FrameElement(){if(this._domWindow.frameElement){return new Owa.Dom.Frame(this._domWindow.frameElement)}else{return null}};Owa.Dom.Window.prototype.get_Name=function Owa$Dom$Window$get_Name(){return this._domWindow.name};Owa.Dom.Window.prototype.set_Name=function Owa$Dom$Window$set_Name(sValue){this._domWindow.name=sValue};Owa.Dom.Window.prototype.get_ParentWindow=function Owa$Dom$Window$get_ParentWindow(){var oParent;try{oParent=this._domWindow.parent}catch(e){oParent=null}if(oParent)oParent=new Owa.Dom.Window(oParent);return oParent};Owa.Dom.Window.prototype.get_TopWindow=function Owa$Dom$Window$get_TopWindow(){return new Owa.Dom.Window(this._domWindow.top)};Owa.Dom.Window.prototype.get_Location=function Owa$Dom$Window$get_Location(){return this._domWindow.location};Owa.Dom.Window.prototype.get_Opener=function Owa$Dom$Window$get_Opener(){var oWindow;try{oWindow=this._domWindow.dialogArguments&&this._domWindow.dialogArguments.opener?this._domWindow.dialogArguments.opener:(this._domWindow.opener?this._domWindow.opener:null);if(oWindow&&oWindow.closed)oWindow=null}catch(e){oWindow=null}return oWindow?new Owa.Dom.Window(oWindow):null};Owa.Dom.Window.prototype.setTimeout=function Owa$Dom$Window$setTimeout(delegate,iTimeoutInterval){return this._domWindow.setTimeout(delegate,iTimeoutInterval)};Owa.Dom.Window.prototype.clearTimeout=function Owa$Dom$Window$clearTimeout(iTimerId){this._domWindow.clearTimeout(iTimerId)};Owa.Dom.Window.prototype.setInterval=function Owa$Dom$Window$setInterval(delegate,iInterval){return this._domWindow.setInterval(delegate,iInterval)};Owa.Dom.Window.prototype.clearInterval=function Owa$Dom$Window$clearInterval(iTimerId){this._domWindow.clearInterval(iTimerId)};Owa.Dom.Window.prototype.close=function Owa$Dom$Window$close(){this._domWindow.close()};Owa.Dom.Window.prototype.moveTo=function Owa$Dom$Window$moveTo(iX,iY){this._domWindow.moveTo(iX,iY)};Owa.Dom.Window.prototype.resizeTo=function Owa$Dom$Window$resizeTo(iWidth,iHeight){this._domWindow.resizeTo(iWidth,iHeight)};Owa.Dom.Window.prototype.resizeBy=function Owa$Dom$Window$resizeBy(iWidth,iHeight){this._domWindow.resizeBy(iWidth,iHeight)};Owa.Dom.Window.prototype.open=function Owa$Dom$Window$open(sUrl,sName,sFeatures){if(!sUrl)sUrl="";if(!sName)sName="";if(!sFeatures)sFeatures="";return new Owa.Dom.Window(this._domWindow.open(sUrl,sName,sFeatures))};Owa.Dom.Window.prototype.print=function Owa$Dom$Window$print(){this._domWindow.print()};Owa.Dom.Window.prototype.scrollTo=function Owa$Dom$Window$scrollTo(iX,iY){this._domWindow.scrollTo(iX,iY)};Owa.Dom.Window.prototype.scrollBy=function Owa$Dom$Window$scrollBy(iX,iY){this._domWindow.scrollBy(iX,iY)};Owa.Dom.Window.prototype.navigate=function Owa$Dom$Window$navigate(sUrl){if(this._domWindow.navigate){this._domWindow.navigate(sUrl)}else{this._domWindow.location=sUrl}};Owa.Dom.Window.prototype.equals=function Owa$Dom$Window$equals(oWindow){if(oWindow==null)return false;if(this._domWindow==null)return false;else return this._domWindow==oWindow._domWindow};function checkIfValidVariableName(sVariableName){switch(sVariableName){case"document":case"href":case"navigate":case"scrollBy":case"scrollTo":case"print":case"frameElement":case"length":case"name":case"parent":case"top":case"location":case"navigator":case"opener":case"screenX":case"screenY":case"setTimeout":case"clearTimeout":case"setInterval":case"clearInterval":case"open":case"close":case"moveTo":case"resizeTo":throw new Error("can't access dom functionlity")}if(sVariableName.contains(".")){throw new Error("can't access nested variable")}}Owa.Dom.Window.prototype.getGlobalVariable=function Owa$Dom$Window$getGlobalVariable(sVariableName){checkIfValidVariableName(sVariableName);try{return this._domWindow[sVariableName]}catch(e){return null}};Owa.Dom.Window.prototype.setGlobalVariable=function Owa$Dom$Window$setGlobalVariable(sVariableName,oValue){checkIfValidVariableName(sVariableName);try{this._domWindow[sVariableName]=oValue}catch(e){}};Owa.Dom.Window.prototype.invokeFunction=function Owa$Dom$Window$invokeFunction(sFunctionName,rgArgs,oThis){if(this._domWindow.invoke){var oResult=this._domWindow.invoke(sFunctionName,rgArgs,oThis);if(oResult.error)throw oResult.error;return oResult.result}else{}};Owa.Dom.Window.createClass("Owa.Dom.Window",Owa.Dom.EventTarget);Owa.Dom.Window.prototype.is_Closed=function Owa$Dom$Window$is_Closed(){try{return this._domWindow.closed}catch(e){return true}}})();g_fModuleLoaded[".\\dom/window.js".toLowerCase()]=1;function invoke(sFunctionName,rgArgs,oThis){oThis=oThis?oThis:window;var rg=[];if(rgArgs){for(var i=0;i<rgArgs.length;i++){rg[i]=rgArgs[i]}}var oFunction=oThis[sFunctionName];var oResult={};if(!oFunction){oResult.error=new Error(sFunctionName+" is undefined");return oResult}try{oResult.result=oFunction.apply(oThis,rg)}catch(e){oResult.error=e;return oResult}return oResult}if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\dom/disposemanager.js".toLowerCase()])(function(){Type.createNamespace("Owa.Dom.DisposeManager");var rgDisposeQueue;Owa.Dom.DisposeManager.add=function Owa$Dom$DisposeManager$add(oEventTarget){if(!isInCurrentWindow(oEventTarget)){return}if(!rgDisposeQueue){initializeDisposeManager()}if(indexOf(oEventTarget)==-1){rgDisposeQueue.push(oEventTarget)}};Owa.Dom.DisposeManager.remove=function Owa$Dom$DisposeManager$remove(oEventTarget){var i=indexOf(oEventTarget);if(i>-1){rgDisposeQueue.splice(i,1)}};function initializeDisposeManager(){rgDisposeQueue=[];Owa.Dom.Window.get_Current().attachEvent("unload",onWindowUnload,true)}function onWindowUnload(){for(var i=0;i<rgDisposeQueue.length;i++){rgDisposeQueue[i]._internalDispose();rgDisposeQueue[i]=null}rgDisposeQueue=null}function indexOf(oEventTarget){for(var i=rgDisposeQueue.length-1;i>=0;i--){if(rgDisposeQueue[i]._oTarget===oEventTarget._oTarget){return i}}return -1}function isInCurrentWindow(oEventTarget){return(Owa.Dom.Window.get_Current().equals(oEventTarget)||Owa.Dom.Document.get_Current().equals(oEventTarget)||(Owa.Dom.NonSingletonNode.isInstance(oEventTarget)&&Owa.Dom.Document.get_Current().equals(oEventTarget.get_OwnerDocument())))}})();g_fModuleLoaded[".\\dom/disposemanager.js".toLowerCase()]=1;Type.createNamespace("Owa.Dom");Owa.NodeType={Element:1,Text:3,Comment:8,Document:9};function $(sId){return Owa.Dom.Document.get_Current().getElementById(sId)}if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\dom/node.js".toLowerCase()])(function(){Owa.Dom.Node=function Owa$Dom$Node(oDomNode){Owa.Dom.Node._setupBase();this._oDomNode=oDomNode;this._oTarget=oDomNode};Owa.Dom.Node.wrapDomNode=function Owa$Dom$Node$wrapDomNode(oNode){var oReturn=null;switch(oNode.nodeType){case Owa.NodeType.Element:var sTagName=oNode.tagName;if(sTagName=="IFRAME"){oReturn=new Owa.Dom.Frame(oNode)}else if(sTagName=="INPUT"||sTagName=="TEXTAREA"||sTagName=="BUTTON"||sTagName=="SELECT"){oReturn=new Owa.Dom.Input(oNode)}else{oReturn=new Owa.Dom.Element(oNode)}break;case Owa.NodeType.Document:oReturn=new Owa.Dom.Document(oNode);break;default:oReturn=new Owa.Dom.NonSingletonNode(oNode);break}return oReturn};Owa.Dom.Node.wrapXmlDomNode=function Owa$Dom$Node$wrapXmlDomNode(oNode){switch(oNode.nodeType){case Owa.NodeType.Element:return new Owa.Dom.XmlElement(oNode);case Owa.NodeType.Document:return new Owa.Dom.XmlDocument(oNode);default:return new Owa.Dom.NonSingletonNode(oNode)}};Owa.Dom.Node.prototype.get_NodeType=function Owa$Dom$Node$get_NodeType(){return this._get_DomNode().nodeType};Owa.Dom.Node.prototype.contains=function Owa$Dom$Node$contains(oNode){if(this.get_NodeType()==Owa.NodeType.Element&&oNode.get_NodeType()==Owa.NodeType.Element&&typeof(this._get_DomNode().contains)!="undefined"){return this._get_DomNode().contains(oNode._get_DomNode())}else{var oTemp=oNode._get_DomNode();do{if(oTemp==this._get_DomNode())return true;oTemp=oTemp.parentNode}while(oTemp);return false}};Owa.Dom.Node.OwaExpandosName="__OwaExpandos";Owa.Dom.Node.prototype.setExpando=function Owa$Dom$Node$setExpando(sName,oExpando){var oDomNode=this._get_DomNode();if(typeof(oDomNode[Owa.Dom.Node.OwaExpandosName])=="undefined"||oDomNode[Owa.Dom.Node.OwaExpandosName]==null){oDomNode[Owa.Dom.Node.OwaExpandosName]={}}oDomNode[Owa.Dom.Node.OwaExpandosName][sName]=oExpando;Owa.Dom.DisposeManager.add(this)};Owa.Dom.Node.prototype.getExpando=function Owa$Dom$Node$getExpando(sName){var oOwaExpandos=this._get_DomNode()[Owa.Dom.Node.OwaExpandosName];return(!!oOwaExpandos)?oOwaExpandos[sName]:null};Owa.Dom.Node.prototype.clearAllExpandos=function Owa$Dom$Node$clearAllExpandos(){this._get_DomNode()[Owa.Dom.Node.OwaExpandosName]=null};Owa.Dom.Node.prototype.equals=function Owa$Dom$Node$equals(oNode){if(oNode==null)return false;if(this._oDomNode==null){return false}else{return this._oDomNode==oNode._oDomNode}};Owa.Dom.Node.prototype._wrapNode=function Owa$Dom$Node$_wrapNode(oDomNode){return Owa.Dom.Node.wrapDomNode(oDomNode)};Owa.Dom.Node.prototype._get_DomNode=function Owa$Dom$Node$_get_DomNode(){return this._oDomNode};Owa.Dom.Node.prototype._internalDispose=function Owa$Dom$Node$_internalDispose(){var oDomNode=this._get_DomNode();if("__OwaExpandos" in oDomNode){for(var sName in oDomNode[Owa.Dom.Node.OwaExpandosName]){oDomNode[Owa.Dom.Node.OwaExpandosName][sName]=null}oDomNode[Owa.Dom.Node.OwaExpandosName]=null}Owa.Dom.Node.callBase(this,"_internalDispose")};Owa.Dom.Node.prototype._clearPropertiesForClone=function Owa$Dom$Node$_clearPropertiesForClone(){var oDomNode=this._get_DomNode();if(Owa.Utility.isIE())oDomNode.removeAttribute(Owa.Dom.Node.OwaExpandosName);else delete oDomNode[Owa.Dom.Node.OwaExpandosName];Owa.Dom.Node.callBase(this,"_clearPropertiesForClone")};Owa.Dom.Node.createClass("Owa.Dom.Node",Owa.Dom.EventTarget)})();g_fModuleLoaded[".\\dom/node.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\dom/documentbase.js".toLowerCase()])(function(){Owa.Dom.DocumentBase=function Owa$Dom$DocumentBase(oDocument){Owa.Dom.DocumentBase.constructBase(this,[oDocument])};Owa.Dom.DocumentBase.prototype.get_DocumentElement=function Owa$Dom$DocumentBase$get_DocumentElement(){var oDocumentElement=this._get_DomDocument().documentElement;return oDocumentElement?this._wrapNode(oDocumentElement):null};Owa.Dom.DocumentBase.prototype.appendChild=function Owa$Dom$DocumentBase$appendChild(oElement){throw"Cannot call an abstract method"};Owa.Dom.DocumentBase.prototype.createElement=function Owa$Dom$DocumentBase$createElement(sTagName){return this._wrapNode(this._get_DomDocument().createElement(sTagName))};Owa.Dom.DocumentBase.prototype._get_DomDocument=function Owa$Dom$DocumentBase$_get_DomDocument(){return this._get_DomNode()};Owa.Dom.DocumentBase.createClass("Owa.Dom.DocumentBase",Owa.Dom.Node)})();g_fModuleLoaded[".\\dom/documentbase.js".toLowerCase()]=1;Type.createNamespace("Owa.Dom");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\dom/cssstylerule.js".toLowerCase()])(function(){Owa.Dom.cssStyleRule=function Owa$Dom$cssStyleRule(oDomRule){this._oDomRule=oDomRule};Owa.Dom.cssStyleRule.prototype.get_SelectorText=function Owa$Dom$cssStyleRule$get_SelectorText(){return this._oDomRule.selectorText};Owa.Dom.cssStyleRule.prototype.get_CssText=function Owa$Dom$cssStyleRule$get_CssText(){return this._oDomRule.style.cssText}})();g_fModuleLoaded[".\\dom/cssstylerule.js".toLowerCase()]=1;Type.createNamespace("Owa.Dom");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\dom/stylesheet.js".toLowerCase()])(function(){Owa.Dom.StyleSheet=function Owa$Dom$StyleSheet(oDomStyleSheet){this._oDomStyleSheet=oDomStyleSheet};Owa.Dom.StyleSheet.prototype.get_OwnerNode=function Owa$Dom$StyleSheet$get_OwnerNode(){return Owa.Utility.isDefined(typeof(this._oDomStyleSheet.ownerNode))?Owa.Dom.Node.wrapDomNode(this._oDomStyleSheet.ownerNode):Owa.Dom.Node.wrapDomNode(this._oDomStyleSheet.owningElement)};Owa.Dom.StyleSheet.prototype.get_Id=function Owa$Dom$StyleSheet$get_Id(){return this.get_OwnerNode().get_Id()};Owa.Dom.StyleSheet.prototype.remove=function Owa$Dom$StyleSheet$remove(){this.get_OwnerNode().remove(1)};Owa.Dom.StyleSheet.prototype.addRule=function Owa$Dom$StyleSheet$addRule(sSelector,sStyle){if(typeof(this._oDomStyleSheet.addRule)!="undefined"){this._oDomStyleSheet.addRule(sSelector,sStyle)}else{sStyleRule=sSelector+" {"+sStyle+"}";this._oDomStyleSheet.insertRule(sStyleRule,this._oDomStyleSheet.cssRules.length);this._oDomStyleSheet.ownerNode.innerHTML=this._oDomStyleSheet.ownerNode.innerHTML+sStyleRule}};Owa.Dom.StyleSheet.prototype.removeRule=function Owa$Dom$StyleSheet$removeRule(iIndex){if(typeof(this._oDomStyleSheet.removeRule)!="undefined"){this._oDomStyleSheet.removeRule(iIndex)}else{this._oDomStyleSheet.deleteRule(iIndex)}};Owa.Dom.StyleSheet.prototype.get_RulesCount=function Owa$Dom$StyleSheet$get_RulesCount(){var oSheet=this._oDomStyleSheet;return oSheet.cssRules?oSheet.cssRules.length:oSheet.rules.length};Owa.Dom.StyleSheet.prototype.getRuleAt=function Owa$Dom$StyleSheet$getRuleAt(iIndex){var oSheet=this._oDomStyleSheet;var oRule=oSheet.cssRules?oSheet.cssRules[iIndex]:oSheet.rules[iIndex];return oRule?new Owa.Dom.cssStyleRule(oRule):null}})();g_fModuleLoaded[".\\dom/stylesheet.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\dom/document.js".toLowerCase()])(function(){Owa.Dom.Document=function Owa$Dom$Document(oDomDocument){this._oContainerWindow=null;Owa.Dom.Document.constructBase(this,[oDomDocument])};var _oCurrentDocument;Owa.Dom.Document.get_Current=function Owa$Dom$Document$get_Current(){if(!_oCurrentDocument)_oCurrentDocument=new Owa.Dom.Document(document);return _oCurrentDocument};Owa.Dom.Document.dispose=function Owa$Dom$Document$dispose(){if(_oCurrentDocument){_oCurrentDocument.dispose();_oCurrentDocument=null}};Owa.Dom.Document.prototype.get_Title=function Owa$Dom$Document$get_Title(){var s=this._get_DomDocument().title;if(!s)s="";return s};Owa.Dom.Document.prototype.set_Title=function Owa$Dom$Document$set_Title(sTitle){this._get_DomDocument().title=sTitle};Owa.Dom.Document.prototype.get_ContainerWindow=function Owa$Dom$Document$get_ContainerWindow(){if(!this._oContainerWindow){var oDocument=this._get_DomDocument();var oDomWindow=(typeof(oDocument.defaultView)!="undefined")?oDocument.defaultView:oDocument.parentWindow;if(oDomWindow==window){this._oContainerWindow=Owa.Dom.Window.get_Current()}else{this._oContainerWindow=new Owa.Dom.Window(oDomWindow)}}return this._oContainerWindow};Owa.Dom.Document.prototype.getElementById=function Owa$Dom$Document$getElementById(sId){var oElement=null;if(this._get_DomDocument().all){var rgElements=this._get_DomDocument().all[sId];if(rgElements){if(!Owa.Utility.isArray(rgElements)){rgElements=[rgElements]}for(var i=0;i<rgElements.length;i++){if(rgElements[i].id==sId){oElement=rgElements[i];break}}}}else{oElement=this._get_DomDocument().getElementById(sId)}return oElement?Owa.Dom.Node.wrapDomNode(oElement):null};Owa.Dom.Document.prototype.getElementsByName=function Owa$Dom$Document$getElementsByName(sName){var rgElements=this._get_DomDocument().getElementsByName(sName);var returnValue=[];for(var i=0;i<rgElements.length;++i){returnValue.add(Owa.Dom.Node.wrapDomNode(rgElements[i]))}return returnValue};Owa.Dom.Document.prototype.appendChild=function Owa$Dom$Document$appendChild(oElement){return Owa.Dom.Node.wrapDomNode(this._get_DomDocument().body.appendChild(oElement._get_DomNode()))};Owa.Dom.Document.prototype.get_StyleSheetCount=function Owa$Dom$Document$get_StyleSheetCount(){return this._get_DomDocument().styleSheets.length};Owa.Dom.Document.prototype.getStyleSheetAt=function Owa$Dom$Document$getStyleSheetAt(index){var oSS=this._get_DomDocument().styleSheets[index];return oSS?new Owa.Dom.StyleSheet(oSS):null};Owa.Dom.Document.prototype.getStyleSheetByAttribute=function Owa$Dom$Document$getStyleSheetByAttribute(sName,sValue){var rg=this._get_DomDocument().styleSheets;for(var i=0;i<rg.length;i++){var oSS=new Owa.Dom.StyleSheet(rg[i]);if(oSS.get_OwnerNode().getAttribute(sName)==sValue){return oSS}}return 0};Owa.Dom.Document.prototype.importStyleSheet=function Owa$Dom$Document$importStyleSheet(sUrl){var oDoc=this._get_DomDocument();if(!oDoc.getElementsByTagName("head")||oDoc.getElementsByTagName("head").length==0){oDoc.body.parentNode.insertBefore(oDoc.createElement("head"),oDoc.body)}if(typeof(oDoc.createStyleSheet)!="undefined"){return new Owa.Dom.StyleSheet(oDoc.createStyleSheet(sUrl))}else{var o=oDoc.createElement('link');o.rel='stylesheet';o.type='text/css';o.href=sUrl;oDoc.getElementsByTagName("head")[0].appendChild(o);return new Owa.Dom.StyleSheet(o)}};Owa.Dom.Document.prototype.insertBlankStyleSheet=function Owa$Dom$Document$insertBlankStyleSheet(sId,media){var oDoc=this._get_DomDocument();var oNewSS;if(!oDoc.getElementsByTagName("head")||oDoc.getElementsByTagName("head").length==0){oDoc.body.parentNode.insertBefore(oDoc.createElement("head"),oDoc.body)}if(typeof(oDoc.createStyleSheet)!="undefined"){oNewSS=oDoc.createStyleSheet();if(sId!=null){oNewSS.owningElement.setAttribute("id",sId)}if(media){oNewSS.media=media}}else{var o=oDoc.createElement('style');o.type='text/css';if(sId!=null){o.id=sId}if(media){o.media=media}oDoc.getElementsByTagName("head")[0].appendChild(o);oNewSS=oDoc.styleSheets[oDoc.styleSheets.length-1]}return new Owa.Dom.StyleSheet(oNewSS)};Owa.Dom.Document.prototype.open=function Owa$Dom$Document$open(){this._get_DomDocument().open()};Owa.Dom.Document.prototype.write=function Owa$Dom$Document$write(s){this._get_DomDocument().write(s)};Owa.Dom.Document.prototype.close=function Owa$Dom$Document$close(){this._get_DomDocument().close()};Owa.Dom.Document.prototype.get_IsDesignMode=function Owa$Dom$Document$get_IsDesignMode(){return this._get_DomDocument().designMode.toLowerCase()=="on"};Owa.Dom.Document.prototype.set_DesignMode=function Owa$Dom$Document$set_DesignMode(fOn){this._get_DomDocument().designMode=fOn?"on":"off"};Owa.Dom.Document.prototype.set_IsRtl=function Owa$Dom$Document$set_IsRtl(fRtl){var oDoc=this._get_DomDocument();var oHtml=oDoc.getElementsByTagName("html")[0];oHtml.dir=fRtl?"rtl":"ltr"};Owa.Dom.Document.prototype.get_IsRtl=function Owa$Dom$Document$get_IsRtl(){var oDoc=this._get_DomDocument();var oHtml=oDoc.getElementsByTagName("html")[0];return oHtml.dir.toLowerCase()=="rtl"};Owa.Dom.Document.prototype.get_Body=function Owa$Dom$Document$get_Body(){return Owa.Dom.Node.wrapDomNode(this._get_DomDocument().body)};Owa.Dom.Document.createClass("Owa.Dom.Document",Owa.Dom.DocumentBase)})();g_fModuleLoaded[".\\dom/document.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\dom/nonsingletonnode.js".toLowerCase()])(function(){Owa.Dom.NonSingletonNode=function Owa$Dom$NonSingletonNode(oDomNode){Owa.Dom.NonSingletonNode._setupBase();this._oDomNode=oDomNode;this._oTarget=oDomNode};Owa.Dom.NonSingletonNode.prototype.get_OwnerDocument=function Owa$Dom$NonSingletonNode$get_OwnerDocument(){var oOwnerDocument=this._get_DomNode().ownerDocument;if(oOwnerDocument==document){return Owa.Dom.Document.get_Current()}else{return this._wrapNode(oOwnerDocument)}};Owa.Dom.NonSingletonNode.prototype.clone=function Owa$Dom$NonSingletonNode$clone(f){return this._wrapNode(this._get_DomNode().cloneNode(f))};Owa.Dom.NonSingletonNode.prototype.get_FirstChild=function Owa$Dom$NonSingletonNode$get_FirstChild(){var oDomFirstChild=Owa$Dom$NonSingletonNode$__returnFirstValidNode(this._oDomNode.firstChild,"nextSibling");return(oDomFirstChild==null)?null:this._wrapNode(oDomFirstChild)};Owa.Dom.NonSingletonNode.prototype.get_LastChild=function Owa$Dom$NonSingletonNode$get_LastChild(){var oDomLastChild=Owa$Dom$NonSingletonNode$__returnFirstValidNode(this._oDomNode.lastChild,"previousSibling");return(oDomLastChild==null)?null:this._wrapNode(oDomLastChild)};Owa.Dom.NonSingletonNode.prototype.get_NextSibling=function Owa$Dom$NonSingletonNode$get_NextSibling(){var oDomNextSibling=Owa$Dom$NonSingletonNode$__returnFirstValidNode(this._oDomNode.nextSibling,"nextSibling");return(oDomNextSibling==null)?null:this._wrapNode(oDomNextSibling)};Owa.Dom.NonSingletonNode.prototype.get_PreviousSibling=function Owa$Dom$NonSingletonNode$get_PreviousSibling(){var oDomPreviousSibling=Owa$Dom$NonSingletonNode$__returnFirstValidNode(this._oDomNode.previousSibling,"previousSibling");return(oDomPreviousSibling==null)?null:this._wrapNode(oDomPreviousSibling)};Owa.Dom.Node.prototype.get_ParentElement=function Owa$Dom$Node$get_ParentElement(){var oParentNode=this._get_DomNode().parentNode;var oParentElement=null;if(oParentNode&&oParentNode.nodeType==Owa.NodeType.Element){oParentElement=oParentNode}return oParentElement?this._wrapNode(oParentElement):null};Owa.Dom.NonSingletonNode.prototype.getAncestorByTag=function Owa$Dom$NonSingletonNode$getAncestorByTag(sTag){var sTagUpper=sTag.toUpperCase();var oE=this._get_DomNode();do{oE=(oE.parentNode.nodeType==Owa.NodeType.Element?oE.parentNode:null)}while(oE&&oE.tagName.toUpperCase()!=sTagUpper);return oE?this._wrapNode(oE):null};Owa.Dom.NonSingletonNode.prototype.getAncestorById=function Owa$Dom$NonSingletonNode$getAncestorById(sId,sStopId){var oE=this;while(oE&&oE.get_Id()!=sId){if(sStopId&&oE.get_Id()==sStopId){return null}oE=oE.get_ParentElement()}return oE};Owa.Dom.NonSingletonNode.prototype.getAncestorByClass=function Owa$Dom$NonSingletonNode$getAncestorByClass(sClass,sStopClass){var oE=this;do{if(sStopClass&&oE.hasCssClass(sStopClass)){return null}oE=oE.get_ParentElement()}while(oE&&!oE.hasCssClass(sClass));return oE};Owa.Dom.NonSingletonNode.prototype.get_TextContent=function Owa$Dom$NonSingletonNode$get_TextContent(){return String.NormalizeDomString(this._get_DomNode().nodeValue)};Owa.Dom.NonSingletonNode.prototype.set_TextContent=function Owa$Dom$NonSingletonNode$set_TextContent(sText){return this._get_DomNode().nodeValue=sText};Owa.Dom.NonSingletonNode.prototype.remove=function Owa$Dom$NonSingletonNode$remove(fRemoveChildren){Owa.Dom.NonSingletonNode._removeDomNode(this._get_DomNode(),fRemoveChildren);return this};Owa.Dom.NonSingletonNode.prototype.replace=function Owa$Dom$NonSingletonNode$replace(oNewElement){var oThisDomNode=this._get_DomNode();var oNewDomNode=oNewElement._get_DomNode();if((typeof oThisDomNode.replaceNode)!="undefined"){oThisDomNode.replaceNode(oNewDomNode)}else{return oThisDomNode.parentNode.replaceChild(oNewDomNode,oThisDomNode)}return this};Owa.Dom.NonSingletonNode._isIgnorableNode=function Owa$Dom$NonSingletonNode$_isIgnorableNode(oDomNode){return oDomNode.nodeType==Owa.NodeType.Comment||Owa$Dom$NonSingletonNode$__isWhiteSpaceOnlyTextNode(oDomNode)};Owa.Dom.NonSingletonNode._removeDomNode=function Owa$Dom$NonSingletonNode$_removeDomNode(oDomNode,fRemoveChildren){if((typeof oDomNode.removeNode)!="undefined"){oDomNode.removeNode(fRemoveChildren)}else{if(fRemoveChildren||!oDomNode.hasChildNodes()){if(oDomNode.parentNode)oDomNode.parentNode.removeChild(oDomNode)}else{var oRange=oDomNode.ownerDocument.createRange();oRange.selectNodeContents(oDomNode);if(oDomNode.parentNode)oDomNode.parentNode.replaceChild(oRange.extractContents(),oDomNode)}}};function Owa$Dom$NonSingletonNode$__returnFirstValidNode(oDomStartNode,sNextPosition){while(true){if(oDomStartNode==null){return null}else{if(Owa.Dom.NonSingletonNode._isIgnorableNode(oDomStartNode)){oDomStartNode=oDomStartNode[sNextPosition]}else{return oDomStartNode}}}}function Owa$Dom$NonSingletonNode$__isWhiteSpaceOnlyTextNode(oDomNode){return oDomNode.nodeType==Owa.NodeType.Text&&!(/[^\t\n\r ]/.test(oDomNode.data))}Owa.Dom.NonSingletonNode.createClass("Owa.Dom.NonSingletonNode",Owa.Dom.Node)})();g_fModuleLoaded[".\\dom/nonsingletonnode.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\dom/elementbase.js".toLowerCase()])(function(){Owa.Dom.ElementBase=function Owa$Dom$ElementBase(oDomElement){Owa.Dom.ElementBase._setupBase();this._oDomNode=oDomElement;this._oTarget=oDomElement};Owa.Utility.inherit(Owa.Dom.ElementBase,Owa.Dom.NonSingletonNode);Owa.Dom.ElementBase.prototype.get_TagName=function Owa$Dom$ElementBase$get_TagName(){return this._get_DomNode().tagName};Owa.Dom.ElementBase.prototype.setAttribute=function Owa$Dom$ElementBase$setAttribute(sName,sValue){if(typeof sValue=="undefined"||sValue==null){this._get_DomNode().removeAttribute(sName)}else{this._get_DomNode().setAttribute(sName,sValue)}};Owa.Dom.ElementBase.prototype.getAttribute=function Owa$Dom$ElementBase$getAttribute(sName){var sAttributeValue=this._get_DomNode().getAttribute(sName);if((typeof sAttributeValue)=="undefined"||sAttributeValue==null){return null}else if(typeof sAttributeValue!="string"){throw"Cannot get the attribute of none string type on IE"}else{return String.NormalizeDomString(sAttributeValue)}};Owa.Dom.ElementBase.prototype.setIntAttribute=function Owa$Dom$ElementBase$setIntAttribute(sName,iValue){this.setAttribute(sName,iValue.toString(10))};Owa.Dom.ElementBase.prototype.getIntAttribute=function Owa$Dom$ElementBase$getIntAttribute(sName){var sValue=this.getAttribute(sName);if(sValue==null)sValue='';return parseInt(sValue,10)};Owa.Dom.ElementBase.prototype.setBoolAttribute=function Owa$Dom$ElementBase$setBoolAttribute(sName,fValue){var validBool=Boolean.isInstance(fValue)||((typeof fValue=="string")&&(fValue.toLowerCase()=="true"||fValue.toLowerCase()=="false"))||(parseInt(fValue,10)==1||parseInt(fValue,10)==0);if(!validBool){throw"fValue "+fValue+" is not a valid boolean value."}this.setAttribute(sName,fValue.toString(10))};Owa.Dom.ElementBase.prototype.getBoolAttribute=function Owa$Dom$ElementBase$getBoolAttribute(sName){var sValue=this._get_DomNode().getAttribute(sName);if((typeof sValue=="string"&&sValue.toLowerCase()=="true")||(parseInt(sValue,10)==1)){return true}return false};Owa.Dom.ElementBase.prototype.forEachChild=function Owa$Dom$ElementBase$forEachChild(fnCallback,oState){var rgChildNodes=this._get_DomNode().childNodes;for(var i=0;i<rgChildNodes.length;i++){var oCurrentChild=rgChildNodes[i];if(!Owa.Dom.NonSingletonNode._isIgnorableNode(oCurrentChild)){var oCurrentNode=this._wrapNode(oCurrentChild);if(fnCallback(oCurrentNode,oState)){return oCurrentNode}}}return 0};Owa.Dom.ElementBase.prototype.hasChildNodes=function Owa$Dom$ElementBase$hasChildNodes(){var oDomElement=this._get_DomNode();var fHasChildNode=false;if(oDomElement.hasChildNodes()){for(var i=0;i<oDomElement.childNodes.length;i++){var oCurrentChild=oDomElement.childNodes[i];if(!Owa.Dom.NonSingletonNode._isIgnorableNode(oCurrentChild)){fHasChildNode=true;break}}}return fHasChildNode};Owa.Dom.ElementBase.prototype.appendChild=function Owa$Dom$ElementBase$appendChild(oNewChild){this._get_DomNode().appendChild(oNewChild._get_DomNode());return oNewChild};Owa.Dom.ElementBase.prototype.removeChild=function Owa$Dom$ElementBase$removeChild(oChildToRemove){this._get_DomNode().removeChild(oChildToRemove._get_DomNode());return oChildToRemove};Owa.Dom.ElementBase.prototype.removeAllChildNodes=function Owa$Dom$ElementBase$removeAllChildNodes(){var oCurrentElement=this._get_DomNode();while(oCurrentElement.hasChildNodes()){oCurrentElement.removeChild(oCurrentElement.lastChild)}};Owa.Dom.ElementBase.prototype.replaceChild=function Owa$Dom$ElementBase$replaceChild(oNewChild,oOldChild){this._get_DomNode().replaceChild(oNewChild._get_DomNode(),oOldChild._get_DomNode());return oOldChild};Owa.Dom.ElementBase.prototype.swap=function Owa$Dom$ElementBase$swap(oNew){if(this._get_DomNode().swapNode){this._get_DomNode().swapNode(oNew._get_DomNode())}else{var oTemp=this.get_OwnerDocument().createElement("div");oNew.get_ParentElement().replaceChild(oTemp,oNew);this.get_ParentElement().replaceChild(oNew,this);oTemp.get_ParentElement().replaceChild(this,oTemp)}};Owa.Dom.ElementBase.createClass("Owa.Dom.ElementBase",Owa.Dom.NonSingletonNode)})();g_fModuleLoaded[".\\dom/elementbase.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\dom/element.js".toLowerCase()])(function(){Type.createNamespace("Owa.Style");Owa.Style.Side={Top:"top",Right:"right",Bottom:"bottom",Left:"left"};Owa.Style.Unit={Pixels:"px",Percent:"%",Points:"pt",Em:"em"};Owa.Style.Positioning={Fixed:"fixed",Absolute:"absolute",Relative:"relative",Static:"static",Inherit:"inherit",Default:""};Owa.Style.Overflow={Auto:"auto",Hidden:"hidden",Scroll:"scroll",Visible:"visible",Inherit:"inherit",Default:""};var _Display={None:"none",Inherit:"inherit",Default:""};Owa.Style.Visibility={Visible:"visible",Hidden:"hidden",Collapse:"collapse",Inherit:"inherit",Default:""};Owa.Style.FontWeight={Normal:"normal",Bold:"bold",Bolder:"bolder",Lighter:"lighter",i100:"100",i200:"200",i300:"300",i400:"400",i500:"500",i600:"600",i700:"700",i800:"800",i900:"900"};Owa.ElementInsertionPoint={BeforeBegin:"beforeBegin",AfterBegin:"afterBegin",BeforeEnd:"beforeEnd",AfterEnd:"afterEnd"};Owa.Dom.Element=function Owa$Dom$Element(oDomElement){if(!oDomElement)throw"the DOM object is null";Owa.Dom.Element._setupBase();this._oDomNode=oDomElement;this._oTarget=oDomElement};Owa.Dom.Element.prototype._internalDispose=function Owa$Dom$Element$_internalDispose(){if(this._get_DomNode().oOriginalParent){this._get_DomNode().oOriginalParent=null}Owa.Dom.Element.callBase(this,"_internalDispose")};var toUnitEnum=function $toUnitEnum$(sValue){switch(sValue){case Owa.Style.Unit.Pixels:case Owa.Style.Unit.Percent:case Owa.Style.Unit.Points:case Owa.Style.Unit.Em:return sValue;break;default:throw sValue+" unknown unit type"}};var toOverflowEnum=function $toOverflowEnum$(sValue){switch(sValue){case Owa.Style.Overflow.Auto:case Owa.Style.Overflow.Hidden:case Owa.Style.Overflow.Scroll:case Owa.Style.Overflow.Visible:case Owa.Style.Overflow.Inherit:case Owa.Style.Overflow.Default:return sValue;break;default:throw sValue+" unknown overflow type"}};var toVisibilityEnum=function $toVisibilityEnum$(sValue){switch(sValue){case Owa.Style.Visibility.Visible:case Owa.Style.Visibility.Hidden:case Owa.Style.Visibility.Collapse:case Owa.Style.Visibility.Inherit:case Owa.Style.Visibility.Default:return sValue;break;default:throw sValue+" unknown visibility type"}};var toFontWeightEnum=function $toFontWeightEnum$(sValue){switch(sValue){case Owa.Style.FontWeight.Normal:case Owa.Style.FontWeight.Bold:case Owa.Style.FontWeight.Bolder:case Owa.Style.FontWeight.Lighter:case Owa.Style.FontWeight.i100:case Owa.Style.FontWeight.i200:case Owa.Style.FontWeight.i300:case Owa.Style.FontWeight.i500:case Owa.Style.FontWeight.i600:case Owa.Style.FontWeight.i800:case Owa.Style.FontWeight.i900:return sValue;break;case Owa.Style.FontWeight.i400:return Owa.Style.FontWeight.Normal;case Owa.Style.FontWeight.i700:return Owa.Style.FontWeight.Bold;default:throw sValue+" unknown fontweight type"}};Owa.Dom.Element.prototype.get_Id=function Owa$Dom$Element$get_Id(){return this._get_DomNode().id};Owa.Dom.Element.prototype.set_Id=function Owa$Dom$Element$set_Id(s){this._get_DomNode().id=s};Owa.Dom.Element.prototype.get_Title=function Owa$Dom$Element$get_Title(){return this._get_DomNode().title};Owa.Dom.Element.prototype.set_Title=function Owa$Dom$Element$set_Title(sValue){this._get_DomNode().title=sValue};Owa.Dom.Element.prototype.get_Name=function Owa$Dom$Element$get_Name(){return this._oDomNode.name};Owa.Dom.Element.prototype.set_Name=function Owa$Dom$Element$set_Name(sValue){return this._oDomNode.name=sValue};Owa.Dom.Element.prototype._get_OffsetParent=function Owa$Dom$Element$_get_OffsetParent(){var offsetParent=this._get_DomNode().offsetParent;return offsetParent!=null?Owa.Dom.Node.wrapDomNode(offsetParent):null};Owa.Dom.Element.prototype.get_TextContent=function Owa$Dom$Element$get_TextContent(){if(typeof(this._get_DomNode().textContent)!="undefined"){return String.NormalizeDomString(this._get_DomNode().textContent)}else{return this._get_DomNode().innerText}};Owa.Dom.Element.prototype.set_TextContent=function Owa$Dom$Element$set_TextContent(sText){if(typeof(this._get_DomNode().textContent)!="undefined"){this._get_DomNode().textContent=sText}else{this._get_DomNode().innerText=sText}};Owa.Dom.Element.prototype.get_InnerHtml=function Owa$Dom$Element$get_InnerHtml(){return this._get_DomNode().innerHTML};Owa.Dom.Element.prototype.set_InnerHtml=function Owa$Dom$Element$set_InnerHtml(sHTML){this._get_DomNode().innerHTML=sHTML};Owa.Dom.Element.prototype.set_InnerHtmlIEWorkaround=function Owa$Dom$Element$set_InnerHtmlIEWorkaround(sHTML){if(!Owa.Utility.isIE()){throw"set_innerHtmlIEWorkaround is only supported for IE"}var oElementClone=this.clone(1);oElementClone._get_DomNode().innerHTML=sHTML;this.get_ParentElement().replaceChild(oElementClone,this)};Owa.Dom.Element.prototype.get_OuterHtml=function Owa$Dom$Element$get_OuterHtml(){if((typeof this._get_DomNode().outerHTML)!="undefined"){return this._get_DomNode().outerHTML}else{var oDocument=this._get_DomNode().ownerDocument;var oClone=this._get_DomNode().cloneNode(true);var oT=oDocument.createElement("div");oDocument.documentElement.appendChild(oT);oT.appendChild(oClone);var s=oT.innerHTML;Owa.Dom.NonSingletonNode._removeDomNode(oT,1);return s}};Owa.Dom.Element.prototype.getDescendantById=function Owa$Dom$Element$getDescendantById(sId){var rgAll=this._get_DomNode().getElementsByTagName("*");var oElement=rgAll[sId];if(Owa.Utility.isArray(oElement)&&!(oElement.tagName&&oElement.tagName=="SELECT")){oElement=oElement[0]}else if((oElement==null)&&(!Owa.Utility.isIE())){for(var i=0;i<rgAll.length;i++){if(rgAll[i].id==sId){oElement=rgAll[i];break}}}return(!!oElement)?Owa.Dom.Node.wrapDomNode(oElement):null};Owa.Dom.Element.prototype.getAllDescendantsById=function Owa$Dom$Element$getAllDescendantsById(sId){var rgReturn=[];var oDomElement=this._get_DomNode();if(oDomElement.all){var oResult=oDomElement.all[sId];if(oResult){if(Owa.Utility.isArray(oResult)){var rgResult=oResult;for(var i=0;i<rgResult.length;i++){rgReturn.push(Owa.Dom.Node.wrapDomNode(rgResult[i]))}}else{rgReturn.push(Owa.Dom.Node.wrapDomNode(oResult))}}}else{var rgAll=oDomElement.getElementsByTagName("*");for(var i=0;i<rgAll.length;i++){if(rgAll[i].id==sId){rgReturn.push(Owa.Dom.Node.wrapDomNode(rgAll[i]))}}}return rgReturn};Owa.Dom.Element.prototype.get_AllDecendantsEnumerator=function Owa$Dom$Element$get_AllDecendantsEnumerator(){var rgAll=this._get_DomNode().getElementsByTagName("*");return new Owa.Dom.NodeEnumerator(rgAll,Owa.Dom.NonSingletonNode._isIgnorableNode)};Owa.Dom.Element.prototype.getDescendantsByTagName=function Owa$Dom$Element$getDescendantsByTagName(sTagName){var rgReturn=[];var rgAll=this._get_DomNode().getElementsByTagName(sTagName);for(var i=0;i<rgAll.length;i++){rgReturn.push(Owa.Dom.Node.wrapDomNode(rgAll[i]))}return rgReturn};Owa.Dom.Element.prototype.get_Enumerator=function Owa$Dom$Element$get_Enumerator(){return new Owa.Dom.NodeEnumerator(this._get_DomNode().childNodes,Owa.Dom.NonSingletonNode._isIgnorableNode)};Owa.Dom.Element.prototype.forEachDescendant=function Owa$Dom$Element$forEachDescendant(fnCallback){var rgAll=this._get_DomNode().getElementsByTagName("*");for(var i=0;i<rgAll.length;i++){var oCurrentDomNode=rgAll[i];if(!Owa.Dom.NonSingletonNode._isIgnorableNode(oCurrentDomNode)){if(fnCallback(Owa.Dom.Node.wrapDomNode(oCurrentDomNode))){return}}}};Owa.Dom.Element.prototype.clone=function Owa$Dom$Element$clone(f){var oClone=this._wrapNode(this._get_DomNode().cloneNode(f));oClone._clearPropertiesForClone();if(f){oClone.forEachDescendant(function(oChild){if(Owa.Dom.Element.isInstance(oChild)){oChild._clearPropertiesForClone()}})}return oClone};Owa.Dom.Element.prototype.getChildrenSnapshot=function Owa$Dom$Element$getChildrenSnapshot(){var rgChildren=[];this.forEachChild(function(oElement){rgChildren.push(oElement)});return rgChildren};Owa.Dom.Element.prototype.getChildById=function Owa$Dom$Element$getChildById(sId){var oDomElement=this._get_DomNode();var oChild;if((typeof oDomElement.children)!="undefined"){oChild=oDomElement.children[sId];if(Owa.Utility.isArray(oChild)&&!(oChild.tagName&&oChild.tagName=="SELECT")){oChild=oChild[0]}}else{for(var i=0;i<oDomElement.childNodes.length;i++){var oCurrentChild=oDomElement.childNodes[i];if(oCurrentChild.id==sId){oChild=oCurrentChild;break}}}return !!oChild?Owa.Dom.Node.wrapDomNode(oChild):null};Owa.Dom.Element.prototype.insertAdjacentElement=function Owa$Dom$Element$insertAdjacentElement(sWhere,oElement){var oDomContainer=this._get_DomNode();var oNewDomChild=oElement._get_DomNode();if(oElement.get_NodeType()==Owa.NodeType.Element&&typeof oDomContainer.insertAdjacentElement!="undefined"){oDomContainer.insertAdjacentElement(sWhere,oNewDomChild)}else{switch(sWhere){case Owa.ElementInsertionPoint.BeforeBegin:oDomContainer.parentNode.insertBefore(oNewDomChild,oDomContainer);break;case Owa.ElementInsertionPoint.AfterBegin:oDomContainer.insertBefore(oNewDomChild,oDomContainer.firstChild);break;case Owa.ElementInsertionPoint.BeforeEnd:oDomContainer.appendChild(oNewDomChild);break;case Owa.ElementInsertionPoint.AfterEnd:oDomContainer.parentNode.insertBefore(oNewDomChild,oDomContainer.nextSibling);break;default:throw sWhere+" insertion point not supported"}}return oElement};Owa.Dom.Element.prototype.insertAdjacentHtml=function Owa$Dom$Element$insertAdjacentHtml(sWhere,sHTML){var oThisDomElement=this._get_DomNode();if(typeof oThisDomElement.insertAdjacentHTML!="undefined"){oThisDomElement.insertAdjacentHTML(sWhere,sHTML)}else{var oRange=oThisDomElement.ownerDocument.createRange();oRange.setStartBefore(oThisDomElement);var oDomDocumentFragment=oRange.createContextualFragment(sHTML);var oDocumentFragment=Owa.Dom.Node.wrapDomNode(oDomDocumentFragment);this.insertAdjacentElement(sWhere,oDocumentFragment)}};Owa.Dom.Element.prototype.insertAdjacentText=function Owa$Dom$Element$insertAdjacentText(sWhere,sText){var oThisDomElement=this._get_DomNode();var oNewTextNode=new Owa.Dom.Element(oThisDomElement.ownerDocument.createTextNode(sText));this.insertAdjacentElement(sWhere,oNewTextNode)};function isCssClassInString(sCssClass,sCssClassName){sCssClass=sCssClass.replace("\t"," ");if(sCssClassName.length==0||sCssClass.length<sCssClassName.length){return false}else if(sCssClass==sCssClassName){return true}else if(sCssClass.startsWith(sCssClassName+" ")){return true}else if(sCssClass.endsWith(" "+sCssClassName)){return true}else if(sCssClass.contains(" "+sCssClassName+" ")){return true}return false}function removeCssClassFromString(sCssClass,sRemoveCssClassName){var fCssClassRemoved=false;sCssClass=sCssClass.replace("\t"," ");if(sCssClass==sRemoveCssClassName){sCssClass=""}else if(sRemoveCssClassName.length==0||sCssClass.length<=sRemoveCssClassName.length){}else if(sCssClass.startsWith(sRemoveCssClassName+" ")){sCssClass=sCssClass.substr(sRemoveCssClassName.length+1);fCssClassRemoved=true}else if(sCssClass.endsWith(" "+sRemoveCssClassName)){sCssClass=sCssClass.substr(0,sCssClass.length-(sRemoveCssClassName.length+1));fCssClassRemoved=true}else if(sCssClass.contains(" "+sRemoveCssClassName+" ")){sCssClass=sCssClass.replace(" "+sRemoveCssClassName+" "," ");fCssClassRemoved=true}if(fCssClassRemoved){sCssClass=removeCssClassFromString(sCssClass,sRemoveCssClassName)}return sCssClass}Owa.Dom.Element.prototype.get_CssClasses=function Owa$Dom$Element$get_CssClasses(){var sClassName=this._get_DomNode().className;sClassName=sClassName.replace("\t"," ");var rgTempClasses=sClassName.split(" ");var rgClasses=[];for(var i=0;i<rgTempClasses.length;i++){if(rgTempClasses[i]){rgClasses.push(rgTempClasses[i])}}return rgClasses};Owa.Dom.Element.prototype.set_CssClasses=function Owa$Dom$Element$set_CssClasses(rgClasses){var sClassName="";if(rgClasses&&rgClasses.length){sClassName=rgClasses.join(" ")}this._get_DomNode().className=sClassName};Owa.Dom.Element.prototype.removeCssClass=function Owa$Dom$Element$removeCssClass(sCssClassName){var cleanedCssClass=removeCssClassFromString(this._get_DomNode().className,sCssClassName);if(cleanedCssClass!=this._get_DomNode().className){this._get_DomNode().className=cleanedCssClass}};Owa.Dom.Element.prototype.addCssClass=function Owa$Dom$Element$addCssClass(sCssClassName){if(!this.hasCssClass(sCssClassName)){this._oDomNode.className=this._oDomNode.className.concat(" "+sCssClassName)}};Owa.Dom.Element.prototype.replaceCssClass=function Owa$Dom$Element$replaceCssClass(sCssClassName,sCssClassToReplace){var sClassName=this._get_DomNode().className;var tmpClassName=removeCssClassFromString(sClassName,sCssClassToReplace);if(tmpClassName==sClassName){throw"The CSS class to be replaced doesn't exist."}if(!isCssClassInString(tmpClassName,sCssClassName)){tmpClassName=tmpClassName.concat((tmpClassName.length==0?"":" ")+sCssClassName)}if(tmpClassName!=sClassName){this._get_DomNode().className=tmpClassName.trim()}};Owa.Dom.Element.prototype.hasCssClass=function Owa$Dom$Element$hasCssClass(sCssClassName){return isCssClassInString(this._get_DomNode().className,sCssClassName)};Owa.Dom.Element.prototype.focus=function Owa$Dom$Element$focus(iTimeout){var o=this._get_DomNode();function focusElement(){try{o.focus()}catch(e){}}if(!iTimeout){focusElement()}else{try{this.get_OwnerDocument().get_ContainerWindow().setTimeout(focusElement,iTimeout)}catch(e){}}};Owa.Dom.Element.prototype.set_IsDisabled=function Owa$Dom$Element$set_IsDisabled(fDisabled){if(this.get_TagName().toLowerCase()!="div"){throw"Can only set disabled to DIV element."}this._get_DomNode().disabled=fDisabled};Owa.Dom.Element.prototype.getEffectivePadding=function Owa$Dom$Element$getEffectivePadding(iSide){return this._getEffectivePadding(iSide,true)};Owa.Dom.Element.prototype._getEffectivePadding=function Owa$Dom$Element$_getEffectivePadding(iSide,fCheckError){var sValue;switch(iSide){case Owa.Style.Side.Top:sValue=this._getEffectiveStyle("padding-top","paddingTop");break;case Owa.Style.Side.Right:sValue=this._getEffectiveStyle("padding-right","paddingRight");break;case Owa.Style.Side.Bottom:sValue=this._getEffectiveStyle("padding-bottom","paddingBottom");break;case Owa.Style.Side.Left:sValue=this._getEffectiveStyle("padding-left","paddingLeft");break;default:throw"INVALID_PROPERTY"}if(sValue.length==0){return 0}if(fCheckError&&!sValue.contains(Owa.Style.Unit.Pixels)){throw"Padding unit must be specified in pixels for getEffectivePadding()"}return Owa.Utility.IntFromSize(sValue,10)};Owa.Dom.Element.prototype.set_Padding=function Owa$Dom$Element$set_Padding(iSide,sValue){var paddingSide;switch(iSide){case Owa.Style.Side.Top:paddingSide="paddingTop";break;case Owa.Style.Side.Right:paddingSide="paddingRight";break;case Owa.Style.Side.Bottom:paddingSide="paddingBottom";break;case Owa.Style.Side.Left:paddingSide="paddingLeft";break;default:throw"INVALID_PROPERTY"}this._setStyleValue(paddingSide,sValue,Owa.Style.Unit.Pixels)};Owa.Dom.Element.prototype.getEffectiveBorderWidth=function Owa$Dom$Element$getEffectiveBorderWidth(iSide){return this._getEffectiveBorderWidth(iSide,true)};Owa.Dom.Element.prototype._getEffectiveBorderWidth=function Owa$Dom$Element$_getEffectiveBorderWidth(iSide,fCheckError){var sValue;switch(iSide){case Owa.Style.Side.Top:sValue=this._getEffectiveStyle("border-top-width","borderTopWidth");break;case Owa.Style.Side.Right:sValue=this._getEffectiveStyle("border-right-width","borderRightWidth");break;case Owa.Style.Side.Bottom:sValue=this._getEffectiveStyle("border-bottom-width","borderBottomWidth");break;case Owa.Style.Side.Left:sValue=this._getEffectiveStyle("border-left-width","borderLeftWidth");break;default:throw"INVALID_PROPERTY"}if(sValue.length==0){return 0}if(fCheckError&&!sValue.contains(Owa.Style.Unit.Pixels)){throw"Padding unit must be specified in pixels for getEffectiveBorderWidth()"}return Owa.Utility.IntFromSize(sValue)};Owa.Dom.Element.prototype.set_BorderWidth=function Owa$Dom$Element$set_BorderWidth(iSide,sValue){var borderWidthSide;switch(iSide){case Owa.Style.Side.Top:borderWidthSide="borderTopWidth";break;case Owa.Style.Side.Right:borderWidthSide="borderRightWidth";break;case Owa.Style.Side.Bottom:borderWidthSide="borderBottomWidth";break;case Owa.Style.Side.Left:borderWidthSide="borderLeftWidth";break;default:throw"INVALID_PROPERTY"}this._setStyleValue(borderWidthSide,sValue,Owa.Style.Unit.Pixels)};Owa.Dom.Element.prototype.getEffectiveMargin=function Owa$Dom$Element$getEffectiveMargin(iSide){return this._getEffectiveMargin(iSide,true)};Owa.Dom.Element.prototype._getEffectiveMargin=function Owa$Dom$Element$_getEffectiveMargin(iSide,fCheckError){var sValue;switch(iSide){case Owa.Style.Side.Top:sValue=this._getEffectiveStyle("margin-top","marginTop");break;case Owa.Style.Side.Right:sValue=this._getEffectiveStyle("margin-right","marginRight");break;case Owa.Style.Side.Bottom:sValue=this._getEffectiveStyle("margin-bottom","marginBottom");break;case Owa.Style.Side.Left:sValue=this._getEffectiveStyle("margin-left","marginLeft");break;default:throw"INVALID_PROPERTY"}if(sValue.length==0){return 0}if(fCheckError&&!sValue.contains(Owa.Style.Unit.Pixels)){throw"Padding unit must be specified in pixels for getEffectiveMargin()"}return Owa.Utility.IntFromSize(sValue)};Owa.Dom.Element.prototype.set_Margin=function Owa$Dom$Element$set_Margin(iSide,sValue){var marginSide;switch(iSide){case Owa.Style.Side.Top:marginSide="marginTop";break;case Owa.Style.Side.Right:marginSide="marginRight";break;case Owa.Style.Side.Bottom:marginSide="marginBottom";break;case Owa.Style.Side.Left:marginSide="marginLeft";break;default:throw"INVALID_PROPERTY"}this._setStyleValue(marginSide,sValue,Owa.Style.Unit.Pixels)};Owa.Dom.Element.prototype.set_textIndent=function Owa$Dom$Element$set_textIndent(iValue){this._setStyleValue("textIndent",iValue)};Owa.Dom.Element.prototype._get_EffectivePaddingBorderHeight=function Owa$Dom$Element$_get_EffectivePaddingBorderHeight(){var iTH=0;iTH+=this._getEffectivePadding(Owa.Style.Side.Top);iTH+=this._getEffectivePadding(Owa.Style.Side.Bottom);iTH+=this._getEffectiveBorderWidth(Owa.Style.Side.Top);iTH+=this._getEffectiveBorderWidth(Owa.Style.Side.Bottom);return iTH};Owa.Dom.Element.prototype._get_EffectivePaddingBorderWidth=function Owa$Dom$Element$_get_EffectivePaddingBorderWidth(){var iTH=0;iTH+=this._getEffectivePadding(Owa.Style.Side.Left);iTH+=this._getEffectivePadding(Owa.Style.Side.Right);iTH+=this._getEffectiveBorderWidth(Owa.Style.Side.Left);iTH+=this._getEffectiveBorderWidth(Owa.Style.Side.Right);return iTH};Owa.Dom.Element.prototype._get_EffectiveMarginHeight=function Owa$Dom$Element$_get_EffectiveMarginHeight(){var iTH=0;iTH+=this._getEffectiveMargin(Owa.Style.Side.Top);iTH+=this._getEffectiveMargin(Owa.Style.Side.Bottom);return iTH};Owa.Dom.Element.prototype._get_EffectiveMarginWidth=function Owa$Dom$Element$_get_EffectiveMarginWidth(){var iTH=0;iTH+=this._getEffectiveMargin(Owa.Style.Side.Left);iTH+=this._getEffectiveMargin(Owa.Style.Side.Right);return iTH};Owa.Dom.Element.prototype.get_OffsetHeight=function Owa$Dom$Element$get_OffsetHeight(){return this._oDomNode.offsetHeight};Owa.Dom.Element.prototype.get_OffsetWidth=function Owa$Dom$Element$get_OffsetWidth(){return this._oDomNode.offsetWidth};Owa.Dom.Element.prototype._get_OffsetLeft=function Owa$Dom$Element$_get_OffsetLeft(){if(this.get_OwnerDocument().get_IsRtl()){var oParent=this._get_OffsetParent();if(oParent){var iOffset=oParent.get_ScrollWidth()-oParent.get_ClientWidth();if(iOffset>0){return this._get_DomNode().offsetLeft+iOffset}}}return this._get_DomNode().offsetLeft};Owa.Dom.Element.prototype._get_OffsetTop=function Owa$Dom$Element$_get_OffsetTop(){return this._get_DomNode().offsetTop};Owa.Dom.Element.prototype.get_ClientWidth=function Owa$Dom$Element$get_ClientWidth(){var iW=this._oDomNode.clientWidth;iW=this._oDomNode.clientWidth;if(iW==0&&Owa.Utility.isIE()){if(!this._oDomNode.hasLayout){this._oDomNode.style.zoom="1.0";iW=this._oDomNode.clientWidth}}return iW};Owa.Dom.Element.prototype.get_ClientHeight=function Owa$Dom$Element$get_ClientHeight(){var iH=this._oDomNode.clientHeight;if(iH==0&&Owa.Utility.isIE()){if(!this._oDomNode.hasLayout){this._oDomNode.style.zoom="1.0";iH=this._oDomNode.clientHeight}}return iH};Owa.Dom.Element.prototype.get_ScrollWidth=function Owa$Dom$Element$get_ScrollWidth(){var iW=this._oDomNode.scrollWidth;iW=this._oDomNode.scrollWidth;if(Owa.Utility.isFirefox()||Owa.Utility.isSafari()){var iBorderWidth=this._getEffectiveBorderWidth(Owa.Style.Side.Left,false)+this._getEffectiveBorderWidth(Owa.Style.Side.Right,false);if(this._oDomNode.clientWidth+iBorderWidth==this._oDomNode.offsetWidth&&this._oDomNode.scrollWidth==this._oDomNode.offsetWidth){iW=this._oDomNode.clientWidth}}return iW};Owa.Dom.Element.prototype.get_ScrollHeight=function Owa$Dom$Element$get_ScrollHeight(){var iH=this._oDomNode.scrollHeight;return iH};Owa.Dom.Element.prototype.get_ClientLeft=function Owa$Dom$Element$get_ClientLeft(){return this._get_DomNode().clientLeft};Owa.Dom.Element.prototype.get_Width=function Owa$Dom$Element$get_Width(){var sValue=this._getEffectiveStyle("width","width");return Owa.Utility.IntFromSize(sValue)};Owa.Dom.Element.prototype.get_Height=function Owa$Dom$Element$get_Height(){var sValue=this._getEffectiveStyle("height","height");return Owa.Utility.IntFromSize(sValue)};Owa.Dom.Element.prototype.set_Width=function Owa$Dom$Element$set_Width(iSize,sUnit){this._setStyleValue("width",iSize,sUnit)};Owa.Dom.Element.prototype.set_Height=function Owa$Dom$Element$set_Height(iSize,sUnit){this._setStyleValue("height",iSize,sUnit)};Owa.Dom.Element.prototype.set_MaxHeight=function Owa$Dom$Element$set_MaxHeight(iSize,sUnit){this._setStyleValue("maxHeight",iSize,sUnit)};Owa.Dom.Element.prototype.get_Top=function Owa$Dom$Element$get_Top(){var sValue=this._getEffectiveStyle("top","top");return Owa.Utility.IntFromSize(sValue)};Owa.Dom.Element.prototype.get_Left=function Owa$Dom$Element$get_Left(){var sValue=this._getEffectiveStyle("left","left");return Owa.Utility.IntFromSize(sValue)};Owa.Dom.Element.prototype.get_Right=function Owa$Dom$Element$get_Right(){var sValue=this._getEffectiveStyle("right","right");return Owa.Utility.IntFromSize(sValue)};Owa.Dom.Element.prototype.set_Top=function Owa$Dom$Element$set_Top(iSize,sUnit){this._setStyleValue("top",iSize,sUnit)};Owa.Dom.Element.prototype.set_Bottom=function Owa$Dom$Element$set_Bottom(iSize,sUnit){this._setStyleValue("bottom",iSize,sUnit)};Owa.Dom.Element.prototype.set_Left=function Owa$Dom$Element$set_Left(iSize,sUnit){this._setStyleValue("left",iSize,sUnit)};Owa.Dom.Element.prototype.set_Right=function Owa$Dom$Element$set_Right(iSize,sUnit){this._setStyleValue("right",iSize,sUnit)};Owa.Dom.Element.prototype.get_FontSize=function Owa$Dom$Element$get_FontSize(){var sValue=this._oDomNode.style.fontSize;var sFontSize=sValue.length>2?sValue:null;return sFontSize};Owa.Dom.Element.prototype._setStyleValue=function Owa$Dom$Element$_setStyleValue(sStyle,iValue,sUnit){if(iValue===null){this._oDomNode.style[sStyle]=""}else{if(!sUnit){sUnit=Owa.Style.Unit.Pixels}this._oDomNode.style[sStyle]=iValue+toUnitEnum(sUnit)}};Owa.Dom.Element.prototype.get_ScrollLeft=function Owa$Dom$Element$get_ScrollLeft(){if(Owa.Utility.isFirefox()&&this.get_OwnerDocument().get_IsRtl()){return this.get_ScrollWidth()-this.get_ClientWidth()+this._get_DomNode().scrollLeft}else{return this._get_DomNode().scrollLeft}};Owa.Dom.Element.prototype.get_ScrollTop=function Owa$Dom$Element$get_ScrollTop(){return this._get_DomNode().scrollTop};Owa.Dom.Element.prototype.set_ScrollLeft=function Owa$Dom$Element$set_ScrollLeft(iValue){var iAdjustedValue;if(Owa.Utility.isFirefox()&&this.get_OwnerDocument().get_IsRtl()){iAdjustedValue=-(this.get_ScrollWidth()-this.get_ClientWidth()-iValue)}else{iAdjustedValue=iValue}this._get_DomNode().scrollLeft=iAdjustedValue};Owa.Dom.Element.prototype.set_ScrollTop=function Owa$Dom$Element$set_ScrollTop(iValue){this._get_DomNode().scrollTop=iValue};Owa.Dom.Element.prototype.get_OverflowX=function Owa$Dom$Element$get_OverflowX(){var sValue=this._getEffectiveStyle("overflow-x","overflowX");if(sValue==Owa.Style.Overflow.Default){sValue=this._getEffectiveStyle("overflow","overflow")}return toOverflowEnum(sValue)};Owa.Dom.Element.prototype.set_OverflowX=function Owa$Dom$Element$set_OverflowX(sValue){this._oDomNode.style.overflowX=toOverflowEnum(sValue)};Owa.Dom.Element.prototype.get_OverflowY=function Owa$Dom$Element$get_OverflowY(){var sValue=this._getEffectiveStyle("overflow-y","overflowY");if(sValue==Owa.Style.Overflow.Default){sValue=this._getEffectiveStyle("overflow","overflow")}return toOverflowEnum(sValue)};Owa.Dom.Element.prototype.set_OverflowY=function Owa$Dom$Element$set_OverflowY(sValue){this._oDomNode.style.overflowY=toOverflowEnum(sValue)};Owa.Dom.Element.prototype.get_IsShown=function Owa$Dom$Element$get_IsShown(){var sValue=this._getEffectiveStyle("display","display");return _Display.None!=sValue};Owa.Dom.Element.prototype.set_IsShown=function Owa$Dom$Element$set_IsShown(fShow){this._oDomNode.style.display=fShow?_Display.Default:_Display.None};Owa.Dom.Element.prototype.get_IsDisplayed=function Owa$Dom$Element$get_IsDisplayed(){return this.get_OffsetWidth()!=0};Owa.Dom.Element.prototype.set_IsShownAroundIEBug=function Owa$Dom$Element$set_IsShownAroundIEBug(fShow){var oParent=this.get_ParentElement();var oNext=this.get_NextSibling();if(oParent&&Owa.Utility.isIE())oParent.removeChild(this);this.set_IsShown(fShow);if(oParent&&Owa.Utility.isIE()){if(oNext){oNext.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeBegin,this)}else{oParent.appendChild(this)}}};Owa.Dom.Element.prototype.set_Visibility=function Owa$Dom$Element$set_Visibility(sValue){this._oDomNode.style.visibility=toVisibilityEnum(sValue)};Owa.Dom.Element.prototype.set_FontWeight=function Owa$Dom$Element$set_FontWeight(sValue){this._oDomNode.style.fontWeight=toFontWeightEnum(sValue)};Owa.Dom.Element.prototype.isPositionalElement=function Owa$Dom$Element$isPositionalElement(){var sValue=this._getEffectiveStyle("position","position").toLowerCase();if((sValue=="")||(sValue=="static")){return false}return true};Owa.Dom.Element.prototype.get_PositionalParent=function Owa$Dom$Element$get_PositionalParent(){var oPositionalParent=this._get_OffsetParent();while(oPositionalParent&&!oPositionalParent.isPositionalElement()){oPositionalParent=oPositionalParent._get_OffsetParent()}if(oPositionalParent==null){oPositionalParent=this.get_OwnerDocument()._get_DomNode().body.parentNode?new Owa.Dom.Element(this.get_OwnerDocument()._get_DomNode().body.parentNode):null}return oPositionalParent};Owa.Dom.Element.prototype.get_PositionalTop=function Owa$Dom$Element$get_PositionalTop(){var oPositionalTop=this._get_OffsetTop();var oPositionalParent=this._get_OffsetParent();while(oPositionalParent&&!oPositionalParent.isPositionalElement()){if(oPositionalParent._get_OffsetParent()!=null){oPositionalTop+=oPositionalParent._get_OffsetTop()}oPositionalParent=oPositionalParent._get_OffsetParent()}if(oPositionalParent==null){var oDocument=this.get_OwnerDocument();var oBody=oDocument.get_Body();var oHtml=oDocument.get_DocumentElement();oPositionalTop+=oBody._getEffectiveMargin(Owa.Style.Side.Top);oPositionalTop+=oHtml._getEffectivePadding(Owa.Style.Side.Top);oPositionalTop+=oHtml._getEffectiveBorderWidth(Owa.Style.Side.Top)}return oPositionalTop};Owa.Dom.Element.prototype.get_PositionalLeft=function Owa$Dom$Element$get_PositionalLeft(){var oPositionalLeft=this._get_OffsetLeft();var oPositionalParent=this._get_OffsetParent();while(oPositionalParent&&!oPositionalParent.isPositionalElement()){if(oPositionalParent.offsetParent!=null){oPositionalLeft+=oPositionalParent._get_OffsetLeft()}oPositionalParent=oPositionalParent._get_OffsetParent()}if(oPositionalParent==null){var oDocument=this.get_OwnerDocument();var oBody=oDocument.get_Body();var oHtml=oDocument.get_DocumentElement();oPositionalLeft+=oBody._getEffectiveMargin(Owa.Style.Side.Left);oPositionalLeft+=oHtml._getEffectivePadding(Owa.Style.Side.Left);oPositionalLeft+=oHtml._getEffectiveBorderWidth(Owa.Style.Side.Left)}return oPositionalLeft};Owa.Dom.Element.prototype.get_DocumentTop=function Owa$Dom$Element$get_DocumentTop(){var oDocumentTop=this._get_OffsetTop();var oParent=this._get_OffsetParent();while(oParent){var sTagName=oParent.get_TagName().toLowerCase();if(sTagName=="body"||sTagName=="html")break;oDocumentTop+=oParent._get_OffsetTop()+oParent._get_DomNode().clientTop;oDocumentTop-=oParent.get_ScrollTop();oParent=oParent._get_OffsetParent()}var oDocument=this.get_OwnerDocument();var oBody=oDocument.get_Body();var oHtml=oDocument.get_DocumentElement();oDocumentTop+=oBody._getEffectiveMargin(Owa.Style.Side.Top);oDocumentTop+=oHtml._getEffectivePadding(Owa.Style.Side.Top);oDocumentTop+=oHtml._getEffectiveBorderWidth(Owa.Style.Side.Top);return oDocumentTop};Owa.Dom.Element.prototype.get_DocumentLeft=function Owa$Dom$Element$get_DocumentLeft(){var oDocumentLeft=this._get_OffsetLeft();var oParent=this._get_OffsetParent();while(oParent){oDocumentLeft+=oParent._get_OffsetLeft()+oParent._get_DomNode().clientLeft;oDocumentLeft-=oParent.get_ScrollLeft();oParent=oParent._get_OffsetParent()}var oDocument=this.get_OwnerDocument();var oBody=oDocument.get_Body();var oHtml=oDocument.get_DocumentElement();oDocumentLeft+=oBody._getEffectiveMargin(Owa.Style.Side.Left);oDocumentLeft+=oHtml._getEffectivePadding(Owa.Style.Side.Left);oDocumentLeft+=oHtml._getEffectiveBorderWidth(Owa.Style.Side.Left);return oDocumentLeft};Owa.Dom.Element.prototype.scrollIntoView=function Owa$Dom$Element$scrollIntoView(fAlignToTop){this._get_DomNode().scrollIntoView(fAlignToTop)};Owa.Dom.Element.prototype.get_RelativeTop=function Owa$Dom$Element$get_RelativeTop(oRelativeElement){return this.get_DocumentTop()-oRelativeElement.get_DocumentTop()};Owa.Dom.Element.prototype.get_RelativeLeft=function Owa$Dom$Element$get_RelativeLeft(oRelativeElement){return this.get_DocumentLeft()-oRelativeElement.get_DocumentLeft()};Owa.Dom.Element.prototype.set_PositionalLeft=function Owa$Dom$Element$set_PositionalLeft(iLeft){var oPositionalParent=this.get_PositionalParent();var oOffsetParent=this._get_OffsetParent();var iDeltaX=oOffsetParent.get_RelativeLeft(oPositionalParent);this.set_Left((iLeft-iDeltaX),Owa.Style.Unit.Pixels)};Owa.Dom.Element.prototype.set_PositionalTop=function Owa$Dom$Element$set_PositionalTop(iTop){var oPositionalParent=this.get_PositionalParent();var oOffsetParent=this._get_OffsetParent();var iDeltaY=oOffsetParent.get_RelativeTop(oPositionalParent);this.set_Top((iTop-iDeltaY),Owa.Style.Unit.Pixels)};Owa.Dom.Element.prototype.set_PositionalParent=function Owa$Dom$Element$set_PositionalParent(oNewParent){if(this._get_DomNode().oOriginalParent){throw"This element has already been reparented."}this.setExpando("_originalParent",this.get_ParentElement());this.setExpando("_originalOffsetX",this._get_OffsetLeft());this.setExpando("_originalOffsetY",this._get_OffsetTop());this._get_DomNode().oOriginalParent=this._get_DomNode().parentNode;this._get_DomNode().iOriginalY=this._get_OffsetTop();this._get_DomNode().iOriginalX=this._get_OffsetLeft();oNewParent.insertAdjacentElement(Owa.ElementInsertionPoint.AfterBegin,this)};Owa.Dom.Element.prototype.moveToTop=function Owa$Dom$Element$moveToTop(){var oDomElement=this._get_DomNode();var oDomPositionalParent=this._get_DomNode().parentNode;var iMaxZIndex=0;for(var i=0;i<oDomPositionalParent.childNodes.length;i++){var oCurrentChild=oDomPositionalParent.childNodes[i];if(oCurrentChild.nodeType==Owa.NodeType.Element){var iZIndex=getInt(Owa.Dom.Node.wrapDomNode(oCurrentChild)._getEffectiveStyle("z-index","zIndex"));iZIndex=isNaN(iZIndex)?0:iZIndex;if(iZIndex>iMaxZIndex){iMaxZIndex=iZIndex}}}oDomElement.style.zIndex=iMaxZIndex+1};Owa.Dom.Element.prototype.fillHeight=function Owa$Dom$Element$fillHeight(oVisualParent,oSiblingBefore,oSiblingAfter){var oParent;if(oVisualParent!=null){oParent=oVisualParent}else{oParent=this.get_ParentElement()}var iH=oParent.get_OffsetHeight();iH-=oParent._get_EffectivePaddingBorderHeight();if(oSiblingBefore!=null){iH-=oSiblingBefore.get_OffsetHeight();iH-=oSiblingBefore._get_EffectiveMarginHeight()}if(oSiblingAfter!=null){iH-=oSiblingAfter.get_OffsetHeight();iH-=oSiblingAfter._get_EffectiveMarginHeight()}iH-=this._get_EffectiveMarginHeight();iH-=this._get_EffectivePaddingBorderHeight();if(iH<0){iH=0}this._oDomNode.style.height=iH+Owa.Style.Unit.Pixels};Owa.Dom.Element.prototype.fillWidth=function Owa$Dom$Element$fillWidth(oVisualParent,oSiblingBefore,oSiblingAfter){var oParent;if(oVisualParent!=null){oParent=oVisualParent}else{oParent=this.get_ParentElement()}var iW=oParent.get_OffsetWidth();iW-=oParent._get_EffectivePaddingBorderWidth();if(oSiblingBefore!=null){iW=iW-oSiblingBefore.get_OffsetWidth();iW-=oSiblingBefore._get_EffectiveMarginWidth()}if(oSiblingAfter!=null){iW=iW-oSiblingAfter.get_OffsetWidth();iW-=oSiblingAfter._get_EffectiveMarginWidth()}iW-=this._get_EffectiveMarginWidth();iW-=this._get_EffectivePaddingBorderWidth();if(iW<0){iW=0}this._oDomNode.style.width=iW+Owa.Style.Unit.Pixels};Owa.Dom.Element.prototype.click=function Owa$Dom$Element$click(){if(this._get_DomNode().click){this._get_DomNode().click()}else{var oDocument=this.get_OwnerDocument();var oEvent=oDocument._get_DomDocument().createEvent("MouseEvents");oEvent.initEvent("click",true,true);this._get_DomNode().dispatchEvent(oEvent)}};var isGetComputedStyleDefined=!!window.getComputedStyle;Owa.Dom.Element.prototype._getEffectiveStyle=function Owa$Dom$Element$_getEffectiveStyle(sPropertyW3C,sPropertyIE){var sValue;if(isGetComputedStyleDefined){var parentWindow=(typeof(this._oDomNode.ownerDocument.defaultView)!="undefined")?this._oDomNode.ownerDocument.defaultView:this._oDomNode.ownerDocument.parentWindow;if(Owa.Utility.isFirefox()&&parentWindow.getComputedStyle(this._oDomNode,"")==null){if(sPropertyW3C.toLowerCase()=="display"){sValue=this._oDomNode.style.display;if((sValue==null)||(sValue=="")){sValue=_Display.None}}else{throw"Trying to compute "+sPropertyW3C+", but the style object is null. Is the element \"'display: none\"?"}}else{sValue=parentWindow.getComputedStyle(this._oDomNode,"").getPropertyValue(sPropertyW3C)}}else if(this._oDomNode.currentStyle){sValue=this._oDomNode.currentStyle[sPropertyIE]}return sValue===undefined?'':sValue};Owa.Dom.Element.createClass("Owa.Dom.Element",Owa.Dom.ElementBase,Owa.Collections.IEnumerable)})();g_fModuleLoaded[".\\dom/element.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\dom/input.js".toLowerCase()])(function(){Type.createNamespace("Owa.Dom");Owa.Dom.Input=function Owa$Dom$Input(oDomElement){if(!oDomElement)throw"the DOM element is null";Owa.Dom.Input.constructBase(this,[oDomElement])};Owa.Dom.Input.Type={Button:"button",Checkbox:"checkbox",File:"file",Hidden:"hidden",Radio:"radio",SelectOne:"select-one",Text:"text",Textarea:"textarea",ButtonTag:"buttonTag",Password:"password"};Owa.Dom.Input.prototype.get_Type=function Owa$Dom$Input$get_Type(){if(this.get_TagName().toLowerCase()=="button"){return Owa.Dom.Input.Type.ButtonTag}else if(this.get_TagName().toLowerCase()=="textarea"){return Owa.Dom.Input.Type.Textarea}else{return this._get_DomNode().type}};Owa.Dom.Input.prototype.set_Type=function Owa$Dom$Input$set_Type(sInputType){this._get_DomNode().type=sInputType};Owa.Dom.Input.prototype.get_IsChecked=function Owa$Dom$Input$get_IsChecked(){throwIfCheckedNotValid(this);return this._get_DomNode().checked};Owa.Dom.Input.prototype.set_IsChecked=function Owa$Dom$Input$set_IsChecked(fChecked){throwIfCheckedNotValid(this);this._get_DomNode().checked=fChecked};Owa.Dom.Input.prototype.get_IsDisabled=function Owa$Dom$Input$get_IsDisabled(){return this._get_DomNode().disabled};Owa.Dom.Input.prototype.set_IsDisabled=function Owa$Dom$Input$set_IsDisabled(fDisabled){this._get_DomNode().disabled=fDisabled};Owa.Dom.Input.prototype.get_Value=function Owa$Dom$Input$get_Value(){throwIfValueNotValid(this);return this._get_DomNode().value};Owa.Dom.Input.prototype.set_Value=function Owa$Dom$Input$set_Value(sValue){throwIfValueNotValid(this);this._get_DomNode().value=sValue};function throwIfCheckedNotValid(oElement){var sType=oElement.get_Type();if(sType!=Owa.Dom.Input.Type.Checkbox&&sType!=Owa.Dom.Input.Type.Radio){throw new Error("Property \"checked\" is not supported for inputs of type: "+sType)}}function throwIfValueNotValid(oElement){var sType=oElement.get_Type();if(sType!=Owa.Dom.Input.Type.Text&&sType!=Owa.Dom.Input.Type.Textarea&&sType!=Owa.Dom.Input.Type.SelectOne&&sType!=Owa.Dom.Input.Type.Password&&sType!=Owa.Dom.Input.Type.Radio){throw new Error("Property \"value\" is not supported for inputs of type: "+sType)}}Owa.Dom.Input.createClass("Owa.Dom.Input",Owa.Dom.Element)})();g_fModuleLoaded[".\\dom/input.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\dom/frame.js".toLowerCase()])(function(){Owa.Dom.Frame=function Owa$Dom$Frame(domFrame){Owa.Dom.Frame.constructBase(this,[domFrame])};Owa.Dom.Frame.prototype.get_ContentWindow=function Owa$Dom$Frame$get_ContentWindow(){var oContentWindow=null;try{oContentWindow=this._oDomNode.contentWindow}catch(e){}if(oContentWindow){return new Owa.Dom.Window(oContentWindow)}else{return null}};Owa.Dom.Frame.prototype.set_Source=function Owa$Dom$Frame$set_Source(sValue){this._oDomNode.src=sValue};Owa.Dom.Frame.prototype.initFrameBorder=function Owa$Dom$Frame$initFrameBorder(fHasBorder){if(this.get_ParentElement()){throw new Error("Can't set frame border after inserting into DOM")}this._oDomNode.frameBorder=fHasBorder?1:0};Owa.Dom.Frame.prototype.initAllowTransparency=function Owa$Dom$Frame$initAllowTransparency(fTransparent){if(this.get_ParentElement()){throw new Error("Can't set frame transparency after inserting into DOM")}this._oDomNode.allowTransparency=fTransparent?true:false};Owa.Dom.Frame.prototype.get_ContentDocument=function Owa$Dom$Frame$get_ContentDocument(){return this.get_ContentWindow().get_Document()};Owa.Dom.Frame.createClass("Owa.Dom.Frame",Owa.Dom.Element)})();g_fModuleLoaded[".\\dom/frame.js".toLowerCase()]=1;if(Owa==null){var Owa={}}(function(){Owa.DomUtility={};Owa.DomUtility.getAncestorById=function Owa$DomUtility$getAncestorById(oElement,sId,sParentId){oElement=Owa.Dom.Node.wrapDomNode(oElement);var oAncestor=oElement.getAncestorById(sId,sParentId);return(oAncestor?oAncestor._get_DomNode():null)};Owa.DomUtility.getAncestorByClass=function Owa$DomUtility$getAncestorByClass(oElement,sClass,sParentClass){oElement=Owa.Dom.Node.wrapDomNode(oElement);var oAncestor=oElement.getAncestorByClass(sClass,sParentClass);return(oAncestor?oAncestor._get_DomNode():null)};Owa.DomUtility.calculateVerticalScrollBar=function Owa$DomUtility$calculateVerticalScrollBar(oElement){var iTotalHeight=0;var iSelfHeight=oElement.get_OffsetHeight();oElement.forEachChild(function(oChild){iTotalHeight+=oChild.get_IsShown()?oChild.get_OffsetHeight():0});oElement.set_OverflowY(iTotalHeight>iSelfHeight?Owa.Style.Overflow.Scroll:Owa.Style.Overflow.Hidden);if(Owa.Utility.isSafari()&&oElement.get_IsShown()){var iScrollTop=oElement.get_ScrollTop();oElement.set_IsShown(false);oElement.get_OffsetWidth();oElement.set_IsShown(true);oElement.set_ScrollTop(iScrollTop)}};Owa.DomUtility.isOwaWindow=function Owa$DomUtility$isOwaWindow(oWindow){return !!oWindow.getGlobalVariable("g_fOwa")};Owa.DomUtility.getTextFromHtml=function Owa$DomUtility$getTextFromHtml(sHtml,sElementId){var oDiv;try{var oDocument=Owa.Dom.Document.get_Current();var oElement;oDiv=oDocument.createElement("DIV");oDocument.appendChild(oDiv);oDiv.set_IsShown(false);oDiv.set_InnerHtml(sHtml);oElement=oDiv.getDescendantById(sElementId);if(!oElement)return"";return oElement.get_TextContent()}finally{if(oDiv)oDiv.remove(true)}}})();function Point(x,y){this.iX=x;this.iY=y}function Bounds(x,y,width,height){this.iX=x;this.iY=y;this.iHeight=height;this.iWidth=width}function SelectionRange(range,doc){this.w3c=(window.getSelection)?true:false;this.range=range;this.document=doc}function createSelectionRange(oDoc){if(!oDoc){oDoc=document}if(window.getSelection){var oDomWindow=oDoc.defaultView;var selection=oDomWindow.getSelection();if(Owa.Utility.isFirefox()){return new SelectionRange(selection.getRangeAt(0),oDoc)}else{var range=oDoc.createRange();range.setStart(selection.anchorNode,selection.anchorOffset);range.setEnd(selection.focusNode,selection.focusOffset);if(range.collapsed!=selection.isCollapsed){range.setStart(selection.extentNode,selection.extentOffset);range.setEnd(selection.baseNode,selection.baseOffset)}return new SelectionRange(range,oDoc)}}else{return new SelectionRange(oDoc.selection.createRange(),oDoc)}}function createTextRange(oDoc){if(!oDoc){oDoc=document}if(document.createRange){return new SelectionRange(oDoc.createRange(),oDoc)}else{return new SelectionRange(oDoc.body.createTextRange(),oDoc)}}function createRecipientRange(oDoc,oSel){var osr;if(!oSel){osr=createSelectionRange(oDoc)}else{osr=oSel}var sr=osr.duplicate();sr.collapse(true);var rr=sr.range;if(sr.w3c){var strValue=rr.startContainer.nodeValue;if(!strValue){return sr}var strLeft=strValue.substring(0,rr.startOffset);var strRight=strValue.substring(rr.startOffset);var iLen=strValue.length;var iLeftpos=strLeft.lastIndexOf(";");var iRightpos=strRight.indexOf(";");if(iLeftpos==-1){iLeftpos=0}else{iLeftpos++}if(iRightpos==-1){iRightpos=iLen}else{iRightpos+=strLeft.length}rr.setStart(rr.startContainer,iLeftpos);rr.setEnd(rr.endContainer,iRightpos)}else{var oDivRw=rr.parentElement();if(!oDivRw){return null}while(oDivRw.tagName!="DIV"){oDivRw=oDivRw.parentElement;if(!oDivRw){return null}}var fIsAnchor=false;var fDone=false;var iCnt=0;while(!fDone){rr.moveStart("character",-1);if(rr.text.charAt(0)==";"){fDone=true}iCnt++;var oSelTmp=rr.duplicate();oSelTmp.setEndPoint("EndToStart",oSelTmp);var oSlPrt=oSelTmp.parentElement();if(oSlPrt.nodeType!=3){var sT=oSlPrt.tagName;if(sT=="A"){if(iCnt==1){rr.moveToElementText(oSlPrt);fIsAnchor=true}else{rr.moveStart("character",1)}fDone=true}else if(sT=="SPAN"||!oDivRw.contains(oSlPrt)){fDone=true}}}fDone=fIsAnchor;while(!fDone){rr.moveEnd("character",1);var lastchar=rr.text.slice(-1);if(lastchar.charAt(0)==";"){fDone=true}var oSelTmp=rr.duplicate();oSelTmp.setEndPoint("StartToEnd",oSelTmp);var oSlPrt=oSelTmp.parentElement();if(oSlPrt.nodeType!=3){var sT=oSlPrt.tagName;if(sT=="A"){fDone=true}else if(sT=="SPAN"||!oDivRw.contains(oSlPrt)){fDone=true}}}if(!fIsAnchor){rr.moveEnd("character",-1)}}return sr}function RemoveSemicolon(oTxt){var sTxt=oTxt.nodeValue;if((oTxt.nodeType==3)&&(sTxt.charAt(0)==";")){if(sTxt.charAt(1)==" "){oTxt.deleteData(0,2)}else{oTxt.deleteData(0,1)}}}function isEmptyChar(ch){return((ch<=32)||(ch==160)||(ch==8206)||(ch==8207))}function isSemicolon(ch){return(ch==59)}function isValidRecipientTextNode(str){if(!str||!str.length){return false}var ch=str.charCodeAt(0);if(!isEmptyChar(ch)&&!isSemicolon(ch)){return true}for(var i=1;i<str.length;i++){if(!isEmptyChar(str.charCodeAt(i))){return true}}return false}function isValidPendingRecipient(str){if(!str||!str.length){return false}for(var i=0;i<str.length;i++){var ch=str.charCodeAt(i);if(!isEmptyChar(ch)&&!isSemicolon(ch)){return true}}return false}SelectionRange.prototype.recipientDeleteKey=function SelectionRange$recipientDeleteKey(e){if(this.w3c){var fEdgeOfNode=false;var fResetCaret=false;var oRW=null;var oStartContainer=this.range.startContainer;var strValue=oStartContainer.nodeValue;var nodeType=oStartContainer.nodeType;var outerSpan=oStartContainer.nextSibling;if(nodeType==3){if(strValue==null){fEdgeOfNode=true}else if(this.range.startOffset==strValue.length){fEdgeOfNode=true}else{strValue=strValue.slice(this.range.startOffset,strValue.length);fEdgeOfNode=!isValidRecipientTextNode(strValue)}}else if(nodeType==1){outerSpan=oStartContainer;if(outerSpan.tagName!="SPAN"){if(outerSpan.tagName=="DIV"){fEdgeOfNode=true;fResetCaret=true;oRW=outerSpan;var newNode=document.createElement("a");this.range.insertNode(newNode);outerSpan=newNode.nextSibling;newNode.parentNode.removeChild(newNode);if(outerSpan!=null&&outerSpan.nodeType==3){var oTxtNode=outerSpan;outerSpan=outerSpan.nextSibling;oTxtNode.parentNode.removeChild(oTxtNode)}}}else{fEdgeOfNode=true}}if(fEdgeOfNode){if(isRecipientSpan(outerSpan)){var innerSpan=outerSpan.firstChild;var cssClasses=innerSpan.className;if(cssClasses.contains("rwUR")||cssClasses.contains("rwRR")){if(fResetCaret){browserWorkAround(oRW);this.setCaretAfter(outerSpan)}var oNxt=outerSpan.nextSibling;var oPrev=outerSpan.previousSibling;outerSpan.parentNode.removeChild(outerSpan);if(oNxt){RemoveSemicolon(oNxt);if(oPrev){combineTextNodes(oPrev,oNxt)}}canEvt(e)}}}}};SelectionRange.prototype.recipientBackspaceKey=function SelectionRange$recipientBackspaceKey(e){if(this.w3c){var fEdgeOfNode=false;var oRW=null;var oStartContainer=this.range.startContainer;var strValue=oStartContainer.nodeValue;var nodeType=oStartContainer.nodeType;var outerSpan=oStartContainer.previousSibling;if(nodeType==3){if(strValue==null){fEdgeOfNode=true}else if(this.range.startOffset==0){fEdgeOfNode=true}else{strValue=strValue.substring(0,this.range.startOffset);fEdgeOfNode=!isValidRecipientTextNode(strValue)}}else if(nodeType==1){outerSpan=oStartContainer;if(outerSpan.tagName!="SPAN"){if(outerSpan.tagName=="DIV"){fEdgeOfNode=true;oRW=outerSpan;var newNode=document.createElement("a");this.range.insertNode(newNode);outerSpan=newNode.previousSibling;newNode.parentNode.removeChild(newNode);if(outerSpan!=null&&outerSpan.nodeType==3){var oTxtNode=outerSpan;outerSpan=outerSpan.previousSibling;oTxtNode.parentNode.removeChild(oTxtNode)}}}else{fEdgeOfNode=true}}if(fEdgeOfNode){if(isRecipientSpan(outerSpan)){var oDiv=outerSpan.parentNode;var innerSpan=outerSpan.firstChild;var cssClasses=innerSpan.className;if(cssClasses.contains("rwUR")){var strText=Owa.Dom.Node.wrapDomNode(innerSpan).get_TextContent();innerSpan.fDel=1;var oTextNode=this.document.createTextNode(strText);outerSpan.parentNode.replaceChild(oTextNode,outerSpan);var oNxt=oTextNode.nextSibling;this.setCaretAfter(oTextNode);if(oNxt){RemoveSemicolon(oNxt)}canEvt(e)}else if(cssClasses.contains("rwRR")){var oNxt=outerSpan.nextSibling;this.setCaretBefore(outerSpan);outerSpan.parentNode.removeChild(outerSpan);if(oNxt){RemoveSemicolon(oNxt)}canEvt(e)}browserWorkAround(oDiv)}}}else{this.moveStart(-1);this.moveEnd(-1);var innerSpan=this.parentElement();var outerSpan=innerSpan.parentNode;if(innerSpan&&innerSpan.className=="rwUR"){var strText=innerSpan.innerText;innerSpan.fDel=1;var oTextNode=this.document.createTextNode(strText);outerSpan.parentNode.replaceChild(oTextNode,outerSpan);this.setEndPoint("StartToEnd",this);this.select();canEvt(e)}}};SelectionRange.prototype.getText=function SelectionRange$getText(){if(this.w3c){return this.range.toString()}else{return this.range.text}};SelectionRange.prototype.htmlText=function SelectionRange$htmlText(){if(this.w3c){if(window.XMLSerializer){return new XMLSerializer().serializeToString(this.range.cloneContents())}}else{return this.range.htmlText}};SelectionRange.prototype.getStartRecipientTextNode=function SelectionRange$getStartRecipientTextNode(oRW){if(this.w3c){return this.range.endContainer}else{var oSelRng=this.duplicate();oSelRng.collapse(true);var rr=oSelRng.range;var fDn=0;var oSrcNd;while(!fDn){rr.moveStart("character",-1);rr.setEndPoint("EndToStart",rr);var oSelTmp=rr.duplicate();oSelTmp.setEndPoint("EndToStart",oSelTmp);var oPrntNd=oSelTmp.parentElement();if(oPrntNd.nodeType==1){var sT=oPrntNd.tagName;if(sT=="SPAN"){fDn=1;if(oPrntNd.firstChild!=null&&oPrntNd.firstChild.tagName!="SPAN"){oPrntNd=oPrntNd.parentElement}oSrcNd=oPrntNd.nextSibling}else if(sT=="A"){fDn=1;oSrcNd=oPrntNd.nextSibling;while(oSrcNd&&(oSrcNd.nodeType==3)&&!isValidPendingRecipient(oSrcNd.data)){oSrcNd=oSrcNd.nextSibling}}else if(!oRW.contains(oPrntNd)){fDn=1;oSrcNd=oRW.firstChild}}}if(!oSrcNd||oSrcNd.nodeType!=3||oSrcNd.parentNode!=oRW){return null}return oSrcNd}};SelectionRange.prototype.selectionExists=function SelectionRange$selectionExists(){if(this.w3c){return !this.range.collapsed}else{return this.document.selection.type!="None"}};SelectionRange.prototype.IsTypeControl=function SelectionRange$IsTypeControl(){if(this.w3c){return false}else{return this.document.selection.type=="Control"}};SelectionRange.prototype.inRange=function SelectionRange$inRange(or){if(this.w3c){var fStart=this.range.compareBoundaryPoints(Range.START_TO_START,or.range);var fEnd=this.range.compareBoundaryPoints(Range.END_TO_END,or.range);return(fStart<0)&&(fEnd>0)}else{return this.range.inRange(or.range)}};SelectionRange.prototype.isEqual=function SelectionRange$isEqual(or){if(this.w3c){var fStart=this.range.compareBoundaryPoints(Range.START_TO_START,or.range);var fEnd=this.range.compareBoundaryPoints(Range.END_TO_END,or.range);return(fStart==0)&&(fEnd==0)}else{return this.range.isEqual(or.range)}};SelectionRange.prototype.bounding=function SelectionRange$bounding(){if(this.w3c){var rangeCopy=this.range.cloneRange();var span=document.createElement("SPAN");rangeCopy.insertNode(span);rangeCopy.selectNode(span);rangeCopy.deleteContents();return new Bounds(span.offsetLeft,span.offsetTop,span.offsetLeft,span.offsetTop)}else{return new Bounds(this.range.boundingLeft,this.range.boundingTop,this.range.boundingWidth,this.range.boundingHeight)}};SelectionRange.prototype.offset=function SelectionRange$offset(){if(this.w3c){var rangeCopy=this.range.cloneRange();var span=document.createElement("SPAN");rangeCopy.insertNode(span);var oDiv=span.parentNode;var offsetTop=getCY(span)-oDiv.scrollTop;var iSpanHeight=Owa.Dom.Node.wrapDomNode(span).get_ClientHeight();if(iSpanHeight>0)offsetTop+=iSpanHeight;else offsetTop+=13;var offsetLeft=getCX(span);rangeCopy.selectNode(span);rangeCopy.deleteContents();return new Point(offsetLeft,offsetTop)}else{return new Point(this.range.offsetLeft,this.range.offsetTop)}};SelectionRange.prototype.moveEnd=function SelectionRange$moveEnd(x){if(this.w3c){var y;if(x>0){for(y=0;y<x;y++){if(this.range.endOffset!=this.range.endContainer.nodeValue.length){this.range.setEnd(this.range.endContainer,this.range.endOffset+1)}}}else if(x<0){for(y=0;y>x;y--){if(this.range.endOffset!=0){this.range.setEnd(this.range.endContainer,this.range.endOffset-1)}}}}else if(document.selection){this.range.moveEnd("character",x)}};SelectionRange.prototype.moveStart=function SelectionRange$moveStart(x){if(this.w3c){var y;if(x>0){for(y=0;y<x;y++){if(this.range.startOffset!=0){this.range.setStart(this.range.startContainer,this.range.startOffset+1)}}}else if(x<0){for(y=0;y>x;y--){if(this.range.startOffset!=0){this.range.setStart(this.range.startContainer,this.range.startOffset-1)}}}}else{this.range.moveStart("character",x)}};SelectionRange.prototype.setCaretAfter=function SelectionRange$setCaretAfter(oE){if(this.w3c){var oNext=oE.nextSibling;var selection=window.getSelection();if(Owa.Utility.isFirefox()){selection.removeAllRanges();if(oNext){this.range.setStart(oNext,0);this.range.setEnd(oNext,0)}else if(oE.nodeType==3){var offset=oE.nodeValue.length;this.range.setStart(oE,offset);this.range.setEnd(oE,offset)}selection.addRange(this.range)}else{if(oNext){selection.setBaseAndExtent(oNext,0,oNext,0)}}}else{this.range.select(oE);this.range.collapse(false);this.range.moveStart("character",1)}};SelectionRange.prototype.setCaretBefore=function SelectionRange$setCaretBefore(oE){if(this.w3c){var oPrev=oE.previousSibling;var selection=window.getSelection();if(Owa.Utility.isFirefox()){selection.removeAllRanges();if(oPrev){var offset=oPrev.nodeValue.length;this.range.setStart(oPrev,offset);this.range.setEnd(oPrev,offset)}else if(oE.nodeType==3){this.range.setStart(oE,0);this.range.setEnd(oE,0)}selection.addRange(this.range)}else{if(oPrev){var offset=oPrev.nodeValue.length;selection.setBaseAndExtent(oPrev,offset,oPrev,offset)}}}else{this.range.select(oE);this.range.collapse(true);this.range.moveStart("character",-1)}};SelectionRange.prototype.moveToElementText=function SelectionRange$moveToElementText(e){if(this.w3c){return this.range.selectNodeContents(e)}else{return this.range.moveToElementText(e)}};SelectionRange.prototype.selectRecipient=function SelectionRange$selectRecipient(oE){if(this.w3c){var selection=window.getSelection();if(Owa.Utility.isFirefox()){selection.removeAllRanges();this.range.selectNode(oE);oE=oE.parentNode;if(oE&&(oE.tagName=="SPAN")){var oNext=oE.nextSibling;var oPrev=oE.previousSibling;if(oNext&&oPrev){var offset=oPrev.nodeValue.length;this.range.setStart(oPrev,offset);this.range.setEnd(oNext,0)}else{this.range.selectNode(oE)}}selection.addRange(this.range)}else{this.range.selectNode(oE);this.select();oE=oE.parentNode;if(oE&&(oE.tagName=="SPAN")){var oNext=oE.nextSibling;var oPrev=oE.previousSibling;if(oNext&&oPrev){var offset=oPrev.nodeValue.length;selection.setBaseAndExtent(oPrev,offset,oNext,0)}else{this.range.selectNode(oE)}}}return this.range}else{this.range.moveToElementText(oE);oE=oE.parentNode;if(oE&&(oE.tagName=="SPAN")){this.range.moveToElementText(oE);this.range.moveStart("character",-1);this.range.moveEnd("character",1)}return this.range.select()}};SelectionRange.prototype.collapse=function SelectionRange$collapse(f){return this.range.collapse(f)};SelectionRange.prototype.select=function SelectionRange$select(){if(this.w3c){var selection=window.getSelection();if(selection.removeAllRanges){selection.removeAllRanges();selection.addRange(this.range)}else{selection.setBaseAndExtent(this.range.startContainer,this.range.startOffset,this.range.endContainer,this.range.endOffset)}return this.range}else{return this.range.select()}};SelectionRange.prototype.parentElement=function SelectionRange$parentElement(){if(this.w3c){return this.range.commonAncestorContainer}else{return this.range.parentElement()}};SelectionRange.prototype.duplicate=function SelectionRange$duplicate(){if(this.w3c){return new SelectionRange(this.range.cloneRange(),this.document)}else{return new SelectionRange(this.range.duplicate(),this.document)}};SelectionRange.prototype.setEndPoint=function SelectionRange$setEndPoint(type,or){if(this.w3c){switch(type){case"StartToEnd":return this.range.setEnd(or.range.StartContainer,or.range.StartOffset);break;case"StartToStart":return this.range.setStart(or.range.StartContainer,or.range.StartOffset);break;case"EndToStart":return this.range.setStart(or.range.EndContainer,or.range.EndOffset);break;case"EndToEnd":return this.range.setEnd(or.range.EndContainer,or.range.EndOffset);break}}else if(document.selection){return this.range.setEndPoint(type,or.range)}};SelectionRange.prototype.insertNode=function SelectionRange$insertNode(oNode){if(this.w3c){this.range.deleteContents();this.range.insertNode(oNode)}};SelectionRange.prototype.pasteHtml=function SelectionRange$pasteHtml(html){if(this.w3c){Owa.ExecCommand.execute(this.document,"inserthtml",false,html)}else{this.range.pasteHTML(html)}};SelectionRange.prototype.moveTextAreaCursorToStartOrEnd=function SelectionRange$moveTextAreaCursorToStartOrEnd(oTxtArea,f){if(oTxtArea._oDomNode.childNodes&&oTxtArea._oDomNode.firstChild&&oTxtArea._oDomNode.firstChild.nodeType==3){this.moveToElementText(oTxtArea._oDomNode);if(this.w3c){var iStartOrEnd=f?0:oTxtArea._oDomNode.value.length;oTxtArea._oDomNode.setSelectionRange(iStartOrEnd,iStartOrEnd);oTxtArea.focus(1)}else{this.collapse(f);this.select()}}};function mvIP(o,f,oD){if(!oD)oD=document;var oR=createTextRange(oD);oR.moveToElementText(o);oR.collapse(f);oR.select()}function combineTextNodes(oPrev,oNxt){if((oPrev.nodeType==3)&&(oNxt.nodeType==3)){oPrev.appendData(oNxt.nodeValue);oNxt.parentNode.removeChild(oNxt)}}if(Owa==null){var Owa={}}(function(){Owa.Layout={};Owa.Layout.MaximumWidth=function Owa$Layout$MaximumWidth(rgsElemIds){if(!rgsElemIds){return 0}var iMax=0;for(var i=0;i<rgsElemIds.length;i++){var oElement=document.getElementById(rgsElemIds[i]);if(oElement){var iW=oElement.offsetWidth+1;iMax=(iMax<iW)?iW:iMax}}return iMax};Owa.Layout.SetWidths=function Owa$Layout$SetWidths(rgsElemIds,width){if(!rgsElemIds){return}for(var i=0;i<rgsElemIds.length;i++){var oElement=document.getElementById(rgsElemIds[i]);if(oElement&&oElement.offsetWidth){oElement.style.width=width+"px"}}};Owa.Layout.setElementWidthsToLargest=function Owa$Layout$setElementWidthsToLargest(rgsElementIds){var iW=Owa.Layout.MaximumWidth(rgsElementIds);Owa.Layout.SetWidths(rgsElementIds,iW)}})();if(Owa==null){var Owa={}}(function(){Owa.ExecCommand={};Owa.ExecCommand.execute=function Owa$ExecCommand$execute(oEdtr,sCmd,fUI,oV){sCmd=sCmd.toLowerCase();switch(sCmd){case"createlink":if(!Owa.Utility.isIE()){var sUrl=prompt("URL: ","http://");if(sUrl&&sUrl!="http://"){oEdtr.execCommand(sCmd,false,sUrl)}}else{oEdtr.execCommand(sCmd,true,oV)}break;case"backcolor":if(Owa.Utility.isFirefox()){oEdtr.execCommand("hiliteColor",fUI,oV)}else if(Owa.Utility.isSafari()){oV="#"+oV;oEdtr.execCommand(sCmd,fUI,oV)}else{oEdtr.execCommand(sCmd,fUI,oV)}break;case"forecolor":if(Owa.Utility.isSafari()){oV="#"+oV;oEdtr.execCommand(sCmd,fUI,oV)}else{oEdtr.execCommand(sCmd,fUI,oV)}break;default:oEdtr.execCommand(sCmd,fUI,oV);break}}})();Type.createNamespace("Owa.Components");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/control.js".toLowerCase()])(function(){Owa.Components.Control=function Owa$Components$Control(){this._oResourceSet={};this.__fDisposed=false;this.__fInitialized=false;if(this._fSupportUniqueId){this._sUniqueId=UniqueIdGenerator.get_Instance().get_Next();UniqueIdHashSet.get_Instance().put(this._sUniqueId,this)}if(this._fClearTimeoutCallbackInDisposing){this._oTimeoutCallbackHashtable={};this._oIntervalCallbackHashtable={}}this._oEvents=null};var _oPrototype=Owa.Components.Control.prototype;_oPrototype._fSupportUniqueId=false;_oPrototype._fClearTimeoutCallbackInDisposing=false;_oPrototype.initialize=function Owa$Components$Control$initialize(){this.__fInitialized=true};_oPrototype.get_IsInitialized=function Owa$Components$Control$get_IsInitialized(){return this.__fInitialized};_oPrototype.dispose=function Owa$Components$Control$dispose(){if(Owa.Components.Application.get_ShouldExplicitDisposeResource()){this._disposeAllResources();this._clearEventCollections()}if(this._fSupportUniqueId){UniqueIdHashSet.get_Instance().remove(this._sUniqueId)}if(this.__oResourceManager){this.__oResourceManager.removeResource(this)}if(this._fClearTimeoutCallbackInDisposing){var oWindow=Owa.Dom.Window.get_Current();for(var iId in this._oTimeoutCallbackHashtable){oWindow.clearTimeout(parseInt(iId))}for(var iId in this._oIntervalCallbackHashtable){oWindow.clearInterval(parseInt(iId))}this._fClearTimeoutCallbackInDisposing=null}this.__fDisposed=true};_oPrototype.get_IsDisposed=function Owa$Components$Control$get_IsDisposed(){return this.__fDisposed};_oPrototype.get_UniqueId=function Owa$Components$Control$get_UniqueId(){return this._sUniqueId};_oPrototype.getResourceManager=function Owa$Components$Control$getResourceManager(){return this.__oResourceManager};_oPrototype.addResource=function Owa$Components$Control$addResource(oResource){if(!oResource)return;if(oResource.__oResourceManager){oResource.__oResourceManager.removeResource(oResource)};this._oResourceSet[oResource.get_UniqueId()]=oResource;oResource.__oResourceManager=this;return oResource};_oPrototype.removeResource=function Owa$Components$Control$removeResource(oResource){delete this._oResourceSet[oResource.get_UniqueId()];oResource.__oResourceManager=null;return oResource};_oPrototype._clearEventCollections=function Owa$Components$Control$_clearEventCollections(){if(this._oEvents){for(var sName in this._oEvents){this._oEvents[sName].clear()}this._oEvents=null}};_oPrototype._disposeAllResources=function Owa$Components$Control$_disposeAllResources(){for(var sId in this._oResourceSet){if(!this._oResourceSet[sId].__fDisposed)this._oResourceSet[sId].dispose()}this._oResourceSet={}};_oPrototype._createCallback=function Owa$Components$Control$_createCallback(fnFunction,oContext){return Owa.Utility.createArgumentContextDelegate(this,fnFunction,oContext)};_oPrototype._setTimeout=function Owa$Components$Control$_setTimeout(fnFunction,iTimeoutInterval,oContext){if(this._fClearTimeoutCallbackInDisposing){var oCallbackContext={};var fnCallback=Owa.Utility.createContextDelegate(this,fnFunction,oContext);var iId=Owa.Dom.Window.get_Current().setTimeout(Owa.Utility.createContextDelegate(this,this._timeoutCallback,oCallbackContext),iTimeoutInterval);oCallbackContext.fnCallback=fnCallback;oCallbackContext.iId=iId;this._oTimeoutCallbackHashtable[iId]=true;return iId}else{return Owa.Dom.Window.get_Current().setTimeout(Owa.Utility.createContextDelegate(this,fnFunction,oContext),iTimeoutInterval)}};_oPrototype._timeoutCallback=function Owa$Components$Control$_timeoutCallback(oContext){var iId=oContext.iId;var fnCallback=oContext.fnCallback;delete this._oTimeoutCallbackHashtable[iId];fnCallback()};_oPrototype.stTmout=function Owa$Components$Control$stTmout(sFn,iT){var rgArgs=[];for(var i=2;i<arguments.length;i++)rgArgs.push(arguments[i]);var oC=this;var fn=function(){oC[sFn].apply(oC,rgArgs)};return Owa.Dom.Window.get_Current().setTimeout(fn,iT)};_oPrototype._clearTimeout=function Owa$Components$Control$_clearTimeout(iTimeoutHandle){if(this._fClearTimeoutCallbackInDisposing){delete this._oTimeoutCallbackHashtable[iTimeoutHandle]}Owa.Dom.Window.get_Current().clearTimeout(iTimeoutHandle)};_oPrototype._setInterval=function Owa$Components$Control$_setInterval(fnFunction,iInterval,oContext){if(this._fClearTimeoutCallbackInDisposing){var iId=Owa.Dom.Window.get_Current().setInterval(Owa.Utility.createContextDelegate(this,fnFunction,oContext),iInterval);this._oIntervalCallbackHashtable[iId]=true;return iId}else{return Owa.Dom.Window.get_Current().setInterval(Owa.Utility.createContextDelegate(this,fnFunction,oContext),iInterval)}};_oPrototype._clearInterval=function Owa$Components$Control$_clearInterval(iIntervalHandle){if(this._fClearTimeoutCallbackInDisposing){delete this._oIntervalCallbackHashtable[iIntervalHandle]}Owa.Dom.Window.get_Current().clearInterval(iIntervalHandle)};_oPrototype._getEventHandlerCollection=function Owa$Components$Control$_getEventHandlerCollection(sEventName){if(!this._oEvents){this._oEvents=new Object()}if(!this._oEvents[sEventName]){this._oEvents[sEventName]=new Owa.Utility.EventHandlerCollection()}return this._oEvents[sEventName]};_oPrototype._dispatchEvent=function Owa$Components$Control$_dispatchEvent(sEventName,oEventArgs,oContext){if(!this._oEvents||!this._oEvents[sEventName]){return}return this._oEvents[sEventName].dispatch(oEventArgs,oContext)};Owa.Components.Control.createClass("Owa.Components.Control")})();g_fModuleLoaded[".\\components/control.js".toLowerCase()]=1;if(!Owa){var Owa={}}if(!Owa.Controls){Owa.Controls={}}(function(){Owa.Controls.Control=function Owa$Controls$Control(o){this._el=o;if(o&&o.id)this.sId=o.id};Owa.Controls.Control.prototype.getEl=function Owa$Controls$Control$getEl(){if(!this._el)this._el=window.document.getElementById(this.sId);return this._el};Owa.Controls.Control.prototype.addEvent=function Owa$Controls$Control$addEvent(oE,sE,sFn){if(this[sFn]){var f=this.crtEvtCB(sFn);attchEvt(oE,sE,f);return f}};Owa.Controls.Control.prototype.crtEvtCB=function Owa$Controls$Control$crtEvtCB(sFn){var oC=this;var f=function(e){oC[sFn](e?e:event)};return f};Owa.Controls.Control.prototype.removeEvent=function Owa$Controls$Control$removeEvent(oE,sE,sFn){if(this[sFn])dtchEvt(oE,sE,this[sFn])};Owa.Controls.Control.prototype.crtOehCb=function Owa$Controls$Control$crtOehCb(sFn){var oC=this;return(function(oR){return oC[sFn](oR)})};Owa.Controls.Control.prototype.crtCb=function Owa$Controls$Control$crtCb(sFn){var oC=this;var args=[];for(var i=1;i<arguments.length;i++)args.push(arguments[i]);return(function(){return oC[sFn].apply(oC,args)})};Owa.Controls.Control.prototype.crtCbWA=function Owa$Controls$Control$crtCbWA(sFn){var oC=this;var args=[];for(var i=1;i<arguments.length;i++)args.push(arguments[i]);return(function(){var tmpArgs=[];for(var i=0;i<args.length;i++)tmpArgs.push(args[i]);for(var i=0;i<arguments.length;i++)tmpArgs.push(arguments[i]);return oC[sFn].apply(oC,tmpArgs)})};Owa.Controls.Control.prototype.stTmout=function Owa$Controls$Control$stTmout(sFn,iT){var rgArgs=[];for(var i=2;i<arguments.length;i++)rgArgs.push(arguments[i]);var oC=this;var fn=function(){oC[sFn].apply(oC,rgArgs)};return window.setTimeout(fn,iT)}})();var g_oCS;if(!g_oCS){g_oCS=new Object()}var CSV_MRU_UPD_DT="dtMRUUpd";var CSV_MRU_CACHE="sMRUHtmlCache";var CSV_MM_PAR_STR="sMMPar";var CSV_CALENDAR_FOLDERS_DT="dtCalendarFolders";function getCSVAsStr(sN){try{return getCSW().g_oCS[sN]}catch(e){return 0}}function setCSVAsStr(sN,oV){try{getCSW().g_oCS[sN]=oV.toString()}catch(e){}}if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\dom/xmlelement.js".toLowerCase()])(function(){Owa.Dom.XmlElement=function Owa$Dom$XmlElement(oDomElement){Owa.Dom.XmlElement.constructBase(this,[oDomElement])};Owa.Dom.XmlElement.prototype.get_Xml=function Owa$Dom$XmlElement$get_Xml(){return Owa.Dom.XmlElement.getXmlFromXmlNode(this._get_DomNode())};Owa.Dom.XmlElement.prototype.get_TextContent=function Owa$Dom$XmlElement$get_TextContent(){var oElement=this._get_DomNode();return oElement.text||oElement.textContent};Owa.Dom.XmlElement.prototype.set_TextContent=function Owa$Dom$XmlElement$set_TextContent(sText){var oElement=this._get_DomNode();if(typeof(oElement.text)!="undefined")oElement.text=sText;else oElement.textContent=sText};Owa.Dom.XmlElement.prototype.selectNodes=function Owa$Dom$XmlElement$selectNodes(sXPath){var oElement=this._get_DomNode();var rgResults=[];if(typeof(oElement.selectNodes)!="undefined"){var rgNodes=oElement.selectNodes(sXPath);for(var i=0;i<rgNodes.length;i++){rgResults.push(Owa.Dom.Node.wrapXmlDomNode(rgNodes[i]))}}else{var rgNodes=(new XPathEvaluator()).evaluate(sXPath,oElement,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);if(rgNodes!=null){var oNode=rgNodes.iterateNext();while(oNode){rgResults.push(Owa.Dom.Node.wrapXmlDomNode(oNode));oNode=rgNodes.iterateNext()}}}return rgResults};Owa.Dom.XmlElement.prototype.selectSingleNode=function Owa$Dom$XmlElement$selectSingleNode(sXPath){var oElement=this._get_DomNode();var oNode=null;if(typeof(oElement.selectSingleNode)!="undefined"){oNode=oElement.selectSingleNode(sXPath)}else{var oResult=(new XPathEvaluator()).evaluate(sXPath,oElement,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null);oNode=oResult?oResult.singleNodeValue:null}return oNode?Owa.Dom.Node.wrapXmlDomNode(oNode):null};Owa.Dom.XmlElement.prototype._wrapNode=function Owa$Dom$XmlElement$_wrapNode(oDomNode){return Owa.Dom.Node.wrapXmlDomNode(oDomNode)};Owa.Dom.XmlElement.getXmlFromXmlNode=function Owa$Dom$XmlElement$getXmlFromXmlNode(oNode){var sXml=null;if(typeof(oNode.xml)!="undefined"){sXml=oNode.xml;sXml=sXml?sXml.trim():null}else{sXml=(new XMLSerializer()).serializeToString(oNode)}return sXml};Owa.Dom.XmlElement.createClass("Owa.Dom.XmlElement",Owa.Dom.ElementBase)})();g_fModuleLoaded[".\\dom/xmlelement.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\dom/xmldocument.js".toLowerCase()])(function(){Owa.Dom.XmlDocument=function Owa$Dom$XmlDocument(){var oXmlDoc;if(document.implementation&&document.implementation.createDocument){oXmlDoc=document.implementation.createDocument("","",null)}else if(window.ActiveXObject){oXmlDoc=new ActiveXObject("MSXML2.DomDocument")}else{throw"The browser doesn't support create a XML DOC object"}oXmlDoc.preserveWhiteSpace=1;Owa.Dom.XmlDocument.constructBase(this,[oXmlDoc])};Owa.Dom.XmlDocument.prototype.loadXML=function Owa$Dom$XmlDocument$loadXML(sXmlstring){var oXmlDoc=this._get_XmlDocument();if(typeof(oXmlDoc.loadXML)!="undefined"){return oXmlDoc.loadXML(sXmlstring)}else{var oDOMParser=new DOMParser();var oNewXMLDoc=oDOMParser.parseFromString(sXmlstring,"text/xml");var sNewXml=(new XMLSerializer()).serializeToString(oNewXMLDoc);if(sNewXml!=sXmlstring&&/<\/parsererror>/.test(sNewXml))return false;while(oXmlDoc.hasChildNodes()){oXmlDoc.removeChild(oXmlDoc.lastChild)}for(var i=0;i<oNewXMLDoc.childNodes.length;i++){var oNewNode=oXmlDoc.importNode(oNewXMLDoc.childNodes[i],true);oXmlDoc.appendChild(oNewNode)}return true}};Owa.Dom.XmlDocument.prototype.get_Xml=function Owa$Dom$XmlDocument$get_Xml(){return Owa.Dom.XmlElement.getXmlFromXmlNode(this._get_XmlDocument())};Owa.Dom.XmlDocument.prototype.appendChild=function Owa$Dom$XmlDocument$appendChild(oElement){this._get_XmlDocument().appendChild(oElement._get_DomNode())};Owa.Dom.XmlDocument.prototype.selectNodes=function Owa$Dom$XmlDocument$selectNodes(sXPath){var oDoc=this._get_XmlDocument();var rgResults=[];if(typeof(oDoc.selectNodes)!="undefined"){var rgNodes=oDoc.selectNodes(sXPath);for(var i=0;i<rgNodes.length;i++){rgResults.push(this._wrapNode(rgNodes[i]))}}else{var rgNodes=(new XPathEvaluator()).evaluate(sXPath,oDoc,null,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);if(rgNodes!=null){var oNode=rgNodes.iterateNext();while(oNode){rgResults.push(this._wrapNode(oNode));oNode=rgNodes.iterateNext()}}}return rgResults};Owa.Dom.XmlDocument.prototype.selectSingleNode=function Owa$Dom$XmlDocument$selectSingleNode(sXPath){var oDoc=this._get_XmlDocument();var oNode=null;if(typeof(oDoc.selectSingleNode)!="undefined"){oNode=oDoc.selectSingleNode(sXPath)}else{var oResult=(new XPathEvaluator()).evaluate(sXPath,oDoc,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null);oNode=oResult?oResult.singleNodeValue:null}return oNode?Owa.Dom.Node.wrapXmlDomNode(oNode):null};Owa.Dom.XmlDocument.prototype._wrapNode=function Owa$Dom$XmlDocument$_wrapNode(oDomNode){return Owa.Dom.Node.wrapXmlDomNode(oDomNode)};Owa.Dom.XmlDocument.prototype._get_XmlDocument=function Owa$Dom$XmlDocument$_get_XmlDocument(){return this._get_DomDocument()};Owa.Dom.XmlDocument.createClass("Owa.Dom.XmlDocument",Owa.Dom.DocumentBase)})();g_fModuleLoaded[".\\dom/xmldocument.js".toLowerCase()]=1;function rtrvUCCk(){if(!isDf(typeof(a_sUCCkStr)))return"";var sCky=document.cookie;var sC="";if(!isExpLgn()){var uCCk=sCky.match(a_sUCCkStr+'=(.*?)(;|$)');if(!uCCk)return"";sC=uCCk[1]}else{var sMatch=a_sUCCkStr+'_(.*?)'+'=(.*?)&(.*?)(;|$)';var oRegExp=new RegExp(sMatch,"g");var uCCk;while((uCCk=oRegExp.exec(sCky))!=null){if(bsf(a_sMailboxUniqueId).indexOf(uCCk[3])==0){sC=uCCk[2];break}}}return unescape(sC)}function Cky(sNm){this.sNm=sNm;this.Add=function Cky$Add(oExpirationTime){var cookieString=this.sNm+"=1";if(oExpirationTime){cookieString+=";expires="+oExpirationTime.toGMTString()}document.cookie=cookieString};this.Expire=function Cky$Expire(){var oD=new Date();oD.setTime(oD.getTime()-2*7*24*60*60*1000);document.cookie=this.sNm+"=1; expires="+oD.toUTCString()};this.IsLdd=function Cky$IsLdd(){return(document.cookie.indexOf(this.sNm)>=0)}}function updCmp(oW,oR,fPndGt,fSingleDoc){try{if(window.t_onUpdCmp)window.t_onUpdCmp(oW,oR,fPndGt,fSingleDoc)}catch(e){}}var MMRdy_Bdy=0x1;var MMRdy_Frm=0x2;var g_MMRdy_Stat=0;function readFmUpdCmp(oW){if(isFlgSt(g_MMRdy_Stat,MMRdy_Bdy|MMRdy_Frm)){g_MMRdy_Stat=0;updCmp(oW)}}function addPerfMarker(sItemName){try{if(window.msWriteProfilerMark){window.msWriteProfilerMark(sItemName)}if(a_fPerformanceConsoleEnabled){var oTopWindow=Owa.Utility.getRootOwaWindow();if(!Owa.Dom.Window.get_Current().equals(oTopWindow)){oTopWindow.invokeFunction("addPerfMarker",[sItemName])}else{var dtNow=new Date();var dtTimestamp=dtNow.getTime();var iMaxRecordCount=100;var sVariableName="rgPerfMarkerRecords";var rgPerfMarkerRecords=window[sVariableName];if(rgPerfMarkerRecords==null){rgPerfMarkerRecords=new Array();window[sVariableName]=rgPerfMarkerRecords}var oPerfMarkerRecord={"sItemName":sItemName,"dtTimestamp":dtTimestamp};if(rgPerfMarkerRecords.length>=iMaxRecordCount){rgPerfMarkerRecords.shift()}rgPerfMarkerRecords.push(oPerfMarkerRecord)}}}catch(e){}}function popLgn(){opnWin("?ae=Dialog&t=CloseWindow&exsvurl=1",800,600,1)}function rplLgn(){self.location.reload(true)}var CT_HTML=1;var CT_JS=2;var CT_UNK=3;var oeReq,oeSt,oeResp,cbOehST,cbOeh;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/oeh.js".toLowerCase()])(function(){(function(){Type.createNamespace("Owa.Components");var OWA_HEADER_USER_ACTION="X-UserActivity";var OWA_HEADER_SUBPAGE_EVENTHANDLER="X-OWA-SubPage-EventHandler";var iPendingRequestsCount=0;oeReq=Owa.Components.OehRequest=function Owa$Components$OehRequest(sNs,sEv,oCtx,cb,sVerb,sPath,fSync,fNotUserAction,fNeverDispose,sRId,fNoCanary,fSubPageContent){this.sUrl=fNotUserAction?"ev.owa?UA=0&oeh=1":"ev.owa?oeh=1";this.sUrl+="&ns="+sNs+"&ev="+sEv;if(sRId){this.sUrl+="&rid="+sRId}if(sPath){this.sUrl=sPath+"/"+this.sUrl}else if(Owa.Components.OehRequest.sHardCodeOwaPathForTest){this.sUrl="/"+Owa.Components.OehRequest.sHardCodeOwaPathForTest+"/"+this.sUrl}if(!sVerb)sVerb=POST;this.sVerb=sVerb.toUpperCase();this.sNs=sNs;this.sEv=sEv;this.sQS="";this.fSync=fSync;this.oCtx=oCtx;this.oDoc=new Owa.Dom.XmlDocument();this.oRoot=this.oDoc.createElement("params");this.oDoc.appendChild(this.oRoot);this.cb=cb;this._fNotUserAction=!!fNotUserAction;this._fNeverDispose=!!fNeverDispose;this._fSubPageContent=!!fSubPageContent;if(!fNoCanary&&isDf(typeof(a_sCnNm)))this.add(a_sCnNm,rtrvUCCk())};Owa.Components.OehRequest.prototype.add=function Owa$Components$OehRequest$add(sN,sV){sV=Owa.Components.OehRequest.parseValueToString(sV);if(this.sVerb==POST){var oE=this.oDoc.createElement(sN);oE.set_TextContent(sV);this.oRoot.appendChild(oE)}else{var s=this.sQS;s+="&"+sN+"="+urlEnc(sV);this.sQS=s}};Owa.Components.OehRequest.prototype.addRg=function Owa$Components$OehRequest$addRg(sN,rgV){var oE=this.oDoc.createElement(sN);for(var i=0;i<rgV.length;i++){var oI=this.oDoc.createElement("item");var sV=Owa.Components.OehRequest.parseValueToString(rgV[i]);oI.set_TextContent(sV);oE.appendChild(oI)}this.oRoot.appendChild(oE)};Owa.Components.OehRequest.prototype.addSt=function Owa$Components$OehRequest$addSt(sN,oSt){var oE=this.oDoc.createElement(sN);oE.appendChild(oSt.oE);this.oRoot.appendChild(oE)};Owa.Components.OehRequest.prototype.addRgSt=function Owa$Components$OehRequest$addRgSt(sN,rgV){var oE=this.oDoc.createElement(sN);for(var i=0;i<rgV.length;i++){var oI=this.oDoc.createElement("item");oI.appendChild(rgV[i].oE);oE.appendChild(oI)}this.oRoot.appendChild(oE)};Owa.Components.OehRequest.prototype.send=function Owa$Components$OehRequest$send(){if(this._fSubPageContent){this.sQS+="&SP=1"}this.oAjaxRequest=new Owa.Dom.AjaxRequest(this.sUrl+this.sQS,this.sVerb,this,cbOeReq,this.fSync,this._fNeverDispose);++iPendingRequestsCount;if(this._fNotUserAction){this.oAjaxRequest.setRequestHeader(OWA_HEADER_USER_ACTION,"0")}if(this._fSubPageContent){this.oAjaxRequest.setRequestHeader(OWA_HEADER_SUBPAGE_EVENTHANDLER,1)}var oResult;if(this.sVerb==POST){var sBody=this.oDoc.get_Xml();oResult=this.oAjaxRequest.send((isDf(typeof(sBody))&&sBody)?sBody.replace(/([\x00-\x08\x0b-\x0c\x0e-\x1f])/g,"?"):"")}else{oResult=this.oAjaxRequest.send("")}return this.fSync?oResult:null};Owa.Components.OehRequest.prototype.cancelCallback=function Owa$Components$OehRequest$cancelCallback(){if(!this.oAjaxRequest)throw"Cannot call 'cancelCallback' before the request is sent";this.oAjaxRequest.cancelCallback();iPendingRequestsCount--};Owa.Components.OehRequest.hasPendingRequests=function Owa$Components$OehRequest$hasPendingRequests(){return iPendingRequestsCount>0};Owa.Components.OehRequest.get_CurrentPendingRequestsCount=function Owa$Components$OehRequest$get_CurrentPendingRequestsCount(){return iPendingRequestsCount};Owa.Components.OehRequest.abortOehRequests=function Owa$Components$OehRequest$abortOehRequests(sNs,oEvHash){Owa.Dom.AjaxRequest.abortAjaxRequests(sNs,oEvHash)};function cbOeReq(oAjaxRequest){var oResponse=new oeResp(oAjaxRequest);var oXH=oResponse.oXmlHttp;if(oXH.status==200){var sEventResult=oXH.getResponseHeader("X-OWA-EventResult");if(sEventResult=="0"){}else if(sEventResult=="1"){var oDiv=Owa.Dom.Document.get_Current().createElement("div");oDiv.set_InnerHtml(oResponse.sBody);var oErr=oDiv.getDescendantById("err");oResponse.sErr=oErr.getAttribute("_msg");oResponse.sErrorDetails=oErr.getAttribute("_details");var oErrAttr=oErr.getAttribute("_cd");oResponse.iErr=oErrAttr?parseInt(oErrAttr,10):0;var divDbg=oDiv.getDescendantById("debugInfo");if(divDbg)oResponse.sErrDbg=divDbg.get_OuterHtml();var divCustom=oDiv.getDescendantById("divCstInfo");if(divCustom)oResponse.divCustom=divCustom}else{oResponse.sErr=L_IntErr}}else{oResponse.sErr=getHttpErr(oXH.status)}Owa.Components.OehRequest.get_onResponseReceived().dispatch(oResponse);--iPendingRequestsCount;var oRequest=oAjaxRequest.oCtx;if(oRequest.cb){if(!oRequest.cb(oResponse)){updCmp(window,oResponse)}oResponse.cleanUpAfterCallback()}return oResponse}function getHttpErr(iErr){var s=null;switch(iErr){case 403:s=L_AcsDnd;break;case 12002:case 408:s=L_Tmout;break;case 400:case 500:s=L_IntErr;break;case 12029:case 12007:s=L_NmNtRslv;break;case 503:s=L_SvcUnv;break;default:if(isDf(typeof(L_HttpErr)))s=L_HttpErr.format(iErr.toString());else s=iErr.toString()}return s}Owa.Components.OehRequest.parseValueToString=function Owa$Components$OehRequest$parseValueToString(oV){var sV;if(oV==null){sV=""}else if(oV.getDate!=null){sV=oV.toIsoString()}else{sV=oV.toString()}return sV};var ON_RESPONSE_RECEIVED="OnResponseReceived";Owa.Components.OehRequest._oEvents={};Owa.Components.OehRequest._oEvents[ON_RESPONSE_RECEIVED]=new Owa.Utility.EventHandlerCollection();Owa.Components.OehRequest.get_onResponseReceived=function Owa$Components$OehRequest$get_onResponseReceived(){return Owa.Components.OehRequest._oEvents[ON_RESPONSE_RECEIVED]}})();(function(){oeSt=Owa.Components.OehStructure=function Owa$Components$OehStructure(oReq,sN){this.oDoc=oReq.oDoc;this.oE=this.oDoc.createElement(sN);this.oE.set_TextContent("")};Owa.Components.OehStructure.prototype.add=function Owa$Components$OehStructure$add(sN,sV){sV=Owa.Components.OehRequest.parseValueToString(sV);this.oE.setAttribute(sN,sV)}})();(function(){oeResp=Owa.Components.OehResponse=function Owa$Components$OehResponse(oAjaxRequest){var oXH=oAjaxRequest.oXmlHttp;this.sBody=oXH.responseText;this.oReq=oAjaxRequest.oCtx;this.oCtx=this.oReq.oCtx;this.oXmlHttp=oXH;this.iStatus=oXH.status;this.fST=(oXH.status==440);var sCT=oXH.getResponseHeader("Content-Type");if(!sCT)sCT="";if(sCT.toUpperCase().indexOf("HTML")>=0)this.iCT=CT_HTML;else if(sCT.toUpperCase().indexOf("JAVASCRIPT")>=0)this.iCT=CT_JS;else this.iCT=CT_UNK};Owa.Components.OehResponse.prototype.isErr=function Owa$Components$OehResponse$isErr(){return this.fST||this.sErr};Owa.Components.OehResponse.prototype.getResponseAsDomElement=function Owa$Components$OehResponse$getResponseAsDomElement(fTentative,oDocument){oDocument=oDocument||Owa.Dom.Document.get_Current();var oBody=oDocument.get_Body();oBody.insertAdjacentHtml(Owa.ElementInsertionPoint.BeforeEnd,this.sBody);var oElement=oBody.get_LastChild();this._sResponseElement=oElement;this._fResponseElementTentative=fTentative;return oElement};Owa.Components.OehResponse.prototype.cleanUpAfterCallback=function Owa$Components$OehResponse$cleanUpAfterCallback(){if(this._fResponseElementTentative){this._sResponseElement.remove();delete this._sResponseElement}};cbOehST=function Owa$Components$OehResponse$sessionTimeoutCallback(oR){if(oR.fST){if(g_iLgn==1)popLgn();else if(g_iLgn==2)rplLgn();return 0}return 1};cbOeh=function Owa$Components$OehResponse$GenericCallback(oR,fnCb,oCbCtx){if(!cbOehST(oR))return 0;if(oR.sErr)shwErrDlg(oR,0,0,0,0,0,0,fnCb,oCbCtx);else return 1;return 0}})()})();g_fModuleLoaded[".\\components/oeh.js".toLowerCase()]=1;function rndm(){return Math.round(Math.random()*1000000)}var CC_ACC=0;var CC_FBST=1;var CC_MRUFNTS=2;var CC_FNTLST=3;var CC_PR=4;var CC_SC=5;var CC_MRUC=6;var CC_MTR=7;var CC_MTC=8;var CC_MTCFG=9;var ADD=0;var REF=1;var DEL=2;var g_CC=null;function hasClientCacheAutoCompleteCache(){return(g_CC&&isDf(typeof(g_CC.sAcc))&&g_CC.sAcc)}function hasClientCachePrimaryRecipient(){return(g_CC&&isDf(typeof(g_CC.sPr)))}function hasClientCacheSubscriptionCache(){return(g_CC&&isDf(typeof(g_CC.sSc)))}function hasClientCacheMruCache(){return(g_CC&&isDf(typeof(g_CC.sMruc)))}function initCC(fSync){if(chkCC()){return}var oCC=null;var oTopWindow=Owa.Utility.getRootOwaWindow();try{oCC=oTopWindow._domWindow.g_CC}catch(e){}if(!isDf(typeof(oCC))||!oCC){var oR=new oeReq("ClientCache","Get",0,cbCC,POST,0,fSync);oR.send()}else{g_CC=oCC}}function initACC(){initCC(true);if(hasClientCacheAutoCompleteCache()){try{g_rgoRcp=eval("new Array("+g_CC.sAcc+")")}catch(e){}}}function isExpLgn(){return isDf(typeof(a_fIsExpLgn))&&a_fIsExpLgn}function updSc(sVal){tryUpdCC(CC_SC,sVal,REF)}function fnChkCC(){return 1}function chkCC(){if(!g_CC)return false;try{g_CC.chkCC()}catch(e){return false}return true}function tryUpdCC(iT,oV,iA){if(!g_CC)return false;try{g_CC.updCC(iT,oV,iA)}catch(e){}}function fnUpdCC(iT,oV,iA){if(!oV)return;switch(iT){case CC_ACC:switch(iA){case ADD:var oRecip=eval(oV);if(!oRecip._em){return}g_rgoRcp=eval("new Array("+this.sAcc+")");for(var i=0;i<g_rgoRcp.length;i++){if(g_rgoRcp[i]&&g_rgoRcp[i]._em.toLowerCase()==oRecip._em.toLowerCase()){return}}if(this.sAcc!=""){this.sAcc+=","}this.sAcc+=oV;g_rgoRcp.push(oRecip);break;case REF:this.sAcc=oV;break;case DEL:var rgA=this.sAcc.split(oV);var s;if(rgA[0].trim()!=""){if(rgA[1].trim()==""){s=rgA[0].slice(0,rgA[0].length-1)}else{s=rgA[0]+rgA[1].slice(1,rgA[1].length)}}else{if(rgA[1].trim()==""){s=""}else{s=rgA[1].slice(1,rgA[1].length)}}this.sAcc=s;break;default:break}break;case CC_FBST:this.iFmtBrSt=oV;break;case CC_MRUFNTS:this.sMruFnts=oV;break;case CC_FNTLST:this.sFntLst=oV;break;case CC_PR:this.sPr=oV;break;case CC_SC:this.sSc=oV;break;case CC_MRUC:this.sMruc=oV;break;case CC_MTR:switch(iA){case REF:if(!this.oMailTipsRequesters){this.oMailTipsRequesters={}}var iHash;do{iHash=rndm()}while(this.oMailTipsRequesters[iHash]);this.oMailTipsRequesters[iHash]=oV;oV.setHash(iHash);break;case DEL:if(this.oMailTipsRequesters){var iHash=oV.getHash();if(iHash&&this.oMailTipsRequesters[iHash]){delete this.oMailTipsRequesters[iHash]}}break}break;case CC_MTC:if(!this.oMailTipsCache){this.oMailTipsCache={}}Owa.Components.MailTipsResponder.updateClientCache(oV,this.oMailTipsCache);break;case CC_MTCFG:if(oV){if(!this.oMailTipsConfig){this.oMailTipsConfig={}}for(var sConfigName in oV){this.oMailTipsConfig[sConfigName]=oV[sConfigName]}}break;default:break}}function cbCC(oR){if(oR.sErr||oR.iStatus==440){return}if(oR.sBody){var sCC='('+oR.sBody+')';setCC(sCC);var oTopWindow=Owa.Utility.getRootOwaWindow();if(!Owa.Dom.Window.get_Current().equals(oTopWindow)){try{oTopWindow._domWindow.setCC(sCC)}catch(e){}}}}function setCC(sCC){g_CC=eval(sCC);g_CC.updCC=fnUpdCC;g_CC.chkCC=fnChkCC}function gtCCUrl(){initCC(true);var sEncodedString="";if(!chkCC()){sEncodedString=g_ver}else{sEncodedString=g_ver+","+g_CC.sLng+","+g_CC.iThmId+","+(g_CC.fTxt?"Text":"HTML")+","+g_CC.fShwBcc+","+g_CC.fShwFrm}return"&cc="+bsf(sEncodedString,true)}function bsf(s,fUrl){var b1,b2,b3;var i1,i2,i3,i4;var sOutAlpha;var sOut="";if(isDf(typeof(fUrl))&&fUrl)sOutAlpha="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";else sOutAlpha="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var i;for(i=0;i<s.length;){b1=s.charCodeAt(i);b2=s.charCodeAt(i+1);b3=s.charCodeAt(i+2);i1=(b1>>2);i2=((b1&0x03)<<4)|(b2>>4);i3=((b2&0x0f)<<2)|(b3>>6);i4=(b3&0x3f);if(isNaN(b2)){i3=i4=64}else if(isNaN(b3)){i4=64}sOut+=sOutAlpha.charAt(i1)+sOutAlpha.charAt(i2)+sOutAlpha.charAt(i3)+sOutAlpha.charAt(i4);i+=3}return sOut}function getStr(oV,fEnc){if(!oV){return""}else{var s=oV.toString();if(fEnc){return jsEnc(s)}else{return s}}}Type.createNamespace("Owa.Components.Storage");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/istorage.js".toLowerCase()])(function(){Owa.Components.Storage.IStorage=function Owa$Components$Storage$IStorage(){throw new Error("Can't create an instance of interface")};Owa.Components.Storage.IStorage.prototype.get_Data=function Owa$Components$Storage$IStorage$get_Data(){throw new Error("Not implemented")};Owa.Components.Storage.IStorage.prototype.set_Data=function Owa$Components$Storage$IStorage$set_Data(sContent){throw new Error("Not implemented")};Owa.Components.Storage.IStorage.createInterface("Owa.Components.Storage.IStorage")})();g_fModuleLoaded[".\\components/istorage.js".toLowerCase()]=1;Type.createNamespace("Owa.Components.Storage");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/clipboard.js".toLowerCase()])(function(){Owa.Components.Storage.Clipboard=function Owa$Components$Storage$Clipboard(){Owa.Components.Storage.Clipboard.constructBase(this)};var _CLIPBOARD_CONTEXT="__clipboardContext";Owa.Components.Storage.Clipboard.saveContolContentsToClipboard=function Owa$Components$Storage$Clipboard$saveContolContentsToClipboard(sId){var oControl=$(sId);var oCB=new Owa.Components.Storage.Clipboard();oCB.set_Data(oControl.get_TextContent())};Owa.Components.Storage.Clipboard.get_MimeType=function Owa$Components$Storage$Clipboard$get_MimeType(){if(Owa.Utility.isSafari())return"text/plain";else if(Owa.Utility.isFirefox())return"text/unicode";else return"text"};Owa.Components.Storage.Clipboard.prototype.get_Data=function Owa$Components$Storage$Clipboard$get_Data(){var sMimeType=Owa.Components.Storage.Clipboard.get_MimeType();var sContent;if(window.clipboardData){sContent=window.clipboardData.getData(sMimeType)}else if(!Owa.Utility.isFirefox()){var oContext=Owa.Utility.getRootOwaWindow().getGlobalVariable(_CLIPBOARD_CONTEXT);if(oContext){sContent=oContext[sMimeType]}else{var oContext=Owa.Utility.getIFrameParentOwaWindow().getGlobalVariable(_CLIPBOARD_CONTEXT);if(oContext)sContent=oContext[sMimeType]}}return sContent};Owa.Components.Storage.Clipboard.prototype.set_Data=function Owa$Components$Storage$Clipboard$set_Data(sContent){var sMimeType=Owa.Components.Storage.Clipboard.get_MimeType();if(window.clipboardData){window.clipboardData.setData(sMimeType,sContent)}else if(!Owa.Utility.isFirefox()){var oContext={};oContext[sMimeType]=sContent;Owa.Utility.getIFrameParentOwaWindow().setGlobalVariable(_CLIPBOARD_CONTEXT,oContext);Owa.Utility.getRootOwaWindow().getGlobalVariable(_CLIPBOARD_CONTEXT,oContext)}};Owa.Components.Storage.Clipboard.createClass("Owa.Components.Storage.Clipboard",Owa.Components.Control,Owa.Components.Storage.IStorage)})();g_fModuleLoaded[".\\components/clipboard.js".toLowerCase()]=1;var IT_MSG="IPM.Note";var IT_CNT="IPM.Contact";var IT_PDL="IPM.DistList";var IT_TSK="IPM.Task";var IT_PST="IPM.Post";var IT_MTG="IPM.Schedule.Meeting";var IT_MTR="IPM.Schedule.Meeting.Request";var IT_MTC="IPM.Schedule.Meeting.Canceled";var IT_APP="IPM.Appointment";var IT_SHR="IPM.Sharing";var IT_APP_EXC="IPM.OLE.CLASS.{00061055-0000-0000-C000-000000000046}";var IT_APV_RQ="IPM.Note.Microsoft.Approval.Request";var IT_SMS="IPM.Note.Mobile.SMS";var IT_AD="AD";var IT_SUFFIX_SMIME="SMIME";var IT_SUFFIX_SMIME_SIGNED="SMIME.Signed";var IT_SUFFIX_SMIME_MULTIPART_SIGNED="SMIME.MultipartSigned";var IT_SUFFIX_SMIME_SIGNED_ENCRYPTED="SMIME.SignedEncrypted";var IT_SUFFIX_SMIME_ENCRYPTED="SMIME.Encrypted";function isOfClss(sItmClss,sBsClss){return sItmClss.lc().startsW(sBsClss.lc())&&(sItmClss.length==sBsClss.length||(sItmClss.length>sBsClss.length&&sItmClss.charAt(sBsClss.length)=='.'))}function hasClassSuffix(sItemClass,sSuffix){if(sItemClass==null){return false}sItemClass=sItemClass.toLowerCase();sSuffix="."+sSuffix.toLowerCase();return sItemClass.endsWith(sSuffix)}function isSMime(sItemClass){return hasClassSuffix(sItemClass,IT_SUFFIX_SMIME)||hasClassSuffix(sItemClass,IT_SUFFIX_SMIME_MULTIPART_SIGNED)||hasClassSuffix(sItemClass,IT_SUFFIX_SMIME_ENCRYPTED)||hasClassSuffix(sItemClass,IT_SUFFIX_SMIME_SIGNED_ENCRYPTED)||hasClassSuffix(sItemClass,IT_SUFFIX_SMIME_SIGNED)}function isCal(t){return(isOfClss(t,IT_APP)||isOfClss(t,IT_APP_EXC))}function isApprovalRequest(sType){return sType&&isOfClss(sType,IT_APV_RQ)}function getApplicationElementForItem(sDefaultAe,sAction,sItemType,fJunk,fPhishing){if((isOfClss(sItemType,IT_SHR)&&(sAction=="Open"||sAction=="Preview"||sAction==""))&&!(fJunk||fPhishing)){return"PreFormAction"}else{return sDefaultAe}}function isMvAllw(sFT,sIT){if(sFT==""||isOfClss(sFT,T_MSG))return 1;else if(isOfClss(sFT,T_CAL))return isOfClss(sIT,IT_APP);else if(isOfClss(sFT,T_CON))return isOfClss(sIT,IT_CNT)||isOfClss(sIT,IT_PDL);else if(isOfClss(sFT,T_TSK))return isOfClss(sIT,IT_TSK);else return 0}function updCMM(){setCSVAsStr(CSV_MRU_UPD_DT,new Date());setCSVAsStr(CSV_MRU_CACHE,"")}function cbCpMvItms(oR,oSndr,oCallerSubPage,sSourceFolderId,rgIds,sDstFId,fC,fCal){var fRL;var oSrcLV,oDstLV;var sCFId=0;var oTW=wt();var fSFV=0;var fSndr=oTW==oSndr;if(fSndr){if(!cbOeh(oR))return}else{if(oR.isErr())return}if(shwRspWrn(oR,"errCpyMv",!fSndr))return;updCMM();if(!fC&&sSourceFolderId==sDstFId)return;if(fCal){if(isStPg()){try{oTW.rfrshCal()}catch(e){}}else if(isDf(typeof(a_fCal))&&a_fCal){refresh()}return}oCallerSubPage=oCallerSubPage||Owa.UIControls.SubPage.get_Instance();var fFltrdSrc=0;if(isReadConversationPageObject(oCallerSubPage)){var oTempSubPage=oCallerSubPage.get_ParentSubPage();if(oTempSubPage!=null&&isFolderViewSubPageObject(oTempSubPage)){oCallerSubPage=oTempSubPage}}if(isNavigationPageObject(oCallerSubPage)){oSrcLV=oCallerSubPage.getLstVw(sSourceFolderId);oDstLV=oCallerSubPage.getLstVw(sDstFId);sCFId=oCallerSubPage.getSubPageVariable("a_sLstFID");if(!oSrcLV){oSrcLV=oCallerSubPage.getLstVw(sCFId)}if(oSrcLV&&oSrcLV.isFltrd()){fFltrdSrc=1}}else if(isFolderViewSubPageObject(oCallerSubPage)){oSrcLV=oCallerSubPage.get_VirtualListView();sCFId=oCallerSubPage.get_FolderId();fFltrdSrc=oSrcLV.isFltrd();fSFV=1;if(sDstFId==sSourceFolderId)oDstLV=oSrcLV}else if(!fC&&fSndr){window.close();return}if(oDstLV){if(sCFId==sDstFId)fRL=1;else if(!fSFV)stDrty(sDstFId)}if(sDstFId&&isPFId(sDstFId)){stDrty(sDstFId)}var fSrcCnv;if(oSrcLV&&oSrcLV.isCnvVw&&oSrcLV.isCnvVw()){fSrcCnv=1}if(oSrcLV&&(!fC||fSrcCnv)){if((sCFId==sSourceFolderId)||(fFltrdSrc)){if(fSrcCnv){fRL=1}else if(isFolderViewSubPageObject(oCallerSubPage)&&oCallerSubPage.isPF()&&!fC){fRL=1}else{oSrcLV.rmvRws(rgIds);if(oSrcLV.isDumpsterVw()){oSrcLV.updCnts()}fRL=fFltrdSrc}}else if(!fSFV)stDrty(sSourceFolderId)}var oLV;if((sCFId==sSourceFolderId)||(fFltrdSrc))oLV=oSrcLV;else if(sCFId==sDstFId)oLV=oDstLV;if(oLV){if(fRL){if((!fFltrdSrc)&&(oLV.isCnvVw&&oLV.isCnvVw()))oLV.cbCnvCpMv(oR);else{if(oLV.get_SearchControl()){oLV.get_SearchControl().fReExecuteSearch=true}oLV.rfrsh()}}var oRP=oLV.get_SubPage().gtCnvRP();if(oRP)oRP.rfrsh(0,1)}}function shwRspWrn(oR,sId,fNSndr){var divR=Owa.Dom.Document.get_Current().createElement("div");divR.set_InnerHtml(oR.sBody);var oErr=divR.getDescendantById(sId);if((oErr!=null)&&(oErr.getAttribute("_msg")!=null)){if(!fNSndr){OKDlg(oErr.getAttribute("_msg"),null,null,Owa.BUTTON_DIALOG_ICON.WARNING,L_Wrng).show()}return 1}}function mvItm(oC){if(g_fJnkRq)return;var rgIds=new Array(oC.sId);var sSrcFId=null;var sDstFId=null;var oCallerSubPage=oC.oCallerSubPage;if(oC.iActn==ACTN_NTJNK){sSrcFId=oCallerSubPage.getSubPageVariable("a_sJnkId");sDstFId=a_sInbxId}else if(oC.iActn==ACTN_ADDBSL){sSrcFId=oCallerSubPage.getSubPageVariable("a_sFId");sDstFId=a_sJnkId}var oCtx=new Object();oCtx.iActn=oC.iActn;oCtx.rgIds=rgIds;oCtx.sDstFId=sDstFId;oCtx.fCls=oC.fCls;oCtx.oCallerSubPage=oC.oCallerSubPage;var oR=new oeReq("MsgVLV2","Move",oCtx,cbMvItm);oR.addRg("id",rgIds);oR.add("destId",sDstFId);oR.add("fId",sSrcFId);oR.add("fAddToMRU",0);oR.send();g_fJnkRq=1}function cbCopyMoveItem(iButtonIndex){var oSelectedTreeNode=this._get_TreeControl().gtSelNd();var sFolderId=oSelectedTreeNode.gtFId();var sFolderContainerClass=oSelectedTreeNode.gtFCC();var fIsCopy=this.get_ButtonCaptions(iButtonIndex)==L_Cp;cbCopyMoveItem.fnCallback(sFolderId,null,sFolderContainerClass,fIsCopy);cbCopyMoveItem.fnCallback=null}function updateFolderPickerCopyMoveItemButton(){var oSelectedTreeNode=this._get_TreeControl().gtSelNd();var iER=(oSelectedTreeNode?oSelectedTreeNode.gtER():0);this.enableButton(this.get_ButtonCaptions()[0],oSelectedTreeNode?!(iER&&!hasER(iER,ER_CC))&&!oSelectedTreeNode.isS(DFT_SFR)&&!oSelectedTreeNode.isS(DFT_ERT):false)}function updateFolderPickerCopyMoveFolderButton(){var oSelectedTreeNode=this._get_TreeControl().gtSelNd();this.enableButton(this.get_ButtonCaptions()[0],oSelectedTreeNode?oSelectedTreeNode.canAcceptSubFolderType(this.get_SourceTreeNode().gtFCC()):false)}Type.createNamespace("Owa.Components.CssSprites");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/csssprites.js".toLowerCase()])(function(){function mapFilenameToClassName(sThemeFileName){var oDivThm=Owa.Dom.Document.get_Current().getElementById("divThm");var sFn="";if(oDivThm&&oDivThm.getAttribute("_cur")&&oDivThm.getDescendantById("csssprites.css")&&oDivThm.getDescendantById(sThemeFileName))sFn="-"+oDivThm.getAttribute("_fn");return sFn+" sprites-"+sThemeFileName.replace(".","-")+sFn}function getImageClass(sThemeFileName){return"csimg csimgbg"+mapFilenameToClassName(sThemeFileName)}Owa.Components.CssSprites.getImageClass=function Owa$Components$CssSprites$getImageClass(sThemeFileName){return getImageClass(sThemeFileName)};Owa.Components.CssSprites.getImageMarkup=function Owa$Components$CssSprites$getImageMarkup(sFileName,sAttributes,sClasses,fnGetThemeFile){var fnGetThm=fnGetThemeFile?fnGetThemeFile:getThmF;var sImgHtml;sImgHtml="<img src=\"";sImgHtml+=fnGetThm("clear1x1.gif");sImgHtml+="\" class=\"";sImgHtml+=getImageClass(sFileName);if(sClasses){sImgHtml+=" ";sImgHtml+=sClasses}sImgHtml+="\" ";if(sAttributes){sImgHtml+=sAttributes}sImgHtml+=">";return sImgHtml};Owa.Components.CssSprites.getImageElement=function Owa$Components$CssSprites$getImageElement(sFileName,oDocument){if(!oDocument)oDocument=Owa.Dom.Document.get_Current();var oImage=oDocument.createElement("img");oImage.setAttribute("src",getThmF("clear1x1.gif"));oImage.addCssClass(getImageClass(sFileName));return oImage};Owa.Components.CssSprites.updateImage=function Owa$Components$CssSprites$updateImage(oImage,sThemeFileName){var rgClasses=oImage.get_CssClasses();var sOldSpritesClass=null;for(var i=0;i<rgClasses.length;i++){if(rgClasses[i].startsWith("sprites-")){sOldSpritesClass=rgClasses[i];break}}if(sOldSpritesClass){oImage.replaceCssClass(mapFilenameToClassName(sThemeFileName),sOldSpritesClass)}else{oImage.addCssClass(getImageClass(sThemeFileName))}}})();g_fModuleLoaded[".\\components/csssprites.js".toLowerCase()]=1;function parseTm(sT,dtST,dtET){var rxTm=new RegExp("([012]?[0-9]|2[0-4])([^\\d]+([0-5]?[0-9])?)?","gi");parseTm.rxAmPm.lastIndex=0;var rgHM=rxTm.exec(sT);if(null==rgHM)return -1;var rgAP=parseTm.rxAmPm.exec(sT);var fIsPM=(null!=rgAP&&!!rgAP[2]);var fIsAM=(null!=rgAP&&!!rgAP[1]);var iM=Number(rgHM[3]);var iH=Number(rgHM[1]);if(null==rgAP&&dtST!=null&&dtET!=null&&cmpDy(dtST,dtET)&&iH<12){var iSH=dtST.ghrs();if(iSH<12&&iH<iSH)fIsPM=1;else if(12<=iSH&&iSH<=(iH+12)&&(iH+12)<=23)fIsPM=1}if(rgHM[1]<12&&fIsPM)iH+=12;if(iH==12&&fIsAM)iH=0;if(23<iH)return -1;return((iH*60)+iM)}parseTm.rxAmPm;function fmtDt(dt,sF,fL){var i=0;var iTL=0;var sD="";if(!isDf(typeof(fL)))fL=0;while(i<sF.length){var sC=sF.charAt(i);switch(sC){case'd':iTL=prsRpt(sF,i,sC);var iD=(!fL?dt.gdt():dt.gdtl());if(iTL==4)sD+=getDtf(DTF_FULDN)[(!fL?dt.getUTCDay():dt.getDay())];else if(iTL==3)sD+=getDtf(DTF_ABRDN)[(!fL?dt.getUTCDay():dt.getDay())];else if(iTL==2)sD+=iD>9?iD:"0"+iD;else sD+=iD;break;case'M':iTL=prsRpt(sF,i,sC);var iM=(!fL?dt.gmo():dt.gmol())+1;if(iTL==4)sD+=getDtf(DTF_FULMN)[(!fL?dt.gmo():dt.gmol())];else if(iTL==3)sD+=getDtf(DTF_ABRMN)[(!fL?dt.gmo():dt.gmol())];else if(iTL==2)sD+=iM>9?iM:"0"+iM;else sD+=iM;break;case'y':iTL=prsRpt(sF,i,sC);var iY=(!fL?dt.gyr():dt.gyrl());var iY2=iY%100;if(iTL==4)sD+=iY;else sD+=9<iY2?iY2:"0"+iY2;break;case'h':iTL=prsRpt(sF,i,sC);var iH=(!fL?dt.ghrs():dt.ghrsl());if(iH>12)iH-=12;if(iH==0)iH=12;if(iTL==2)sD+=9<iH?iH:"0"+iH;else sD+=iH;break;case'H':iTL=prsRpt(sF,i,sC);var iH=(!fL?dt.ghrs():dt.ghrsl());if(iTL==2)sD+=9<iH?iH:"0"+iH;else sD+=iH;break;case'm':iTL=prsRpt(sF,i,sC);var iM=(!fL?dt.gmins():dt.gminsl());if(iTL==2)sD+=9<iM?iM:"0"+iM;else sD+=iM;break;case's':iTL=prsRpt(sF,i,sC);var iS=(!fL?dt.gsecs():dt.gsecsl());if(iTL==2)sD+=9<iS?iS:"0"+iS;else sD+=iS;break;case't':iTL=prsRpt(sF,i,sC);var iH=(!fL?dt.ghrs():dt.ghrsl());sD+=(11<iH)?getDtf(DTF_PM):getDtf(DTF_AM);break;case'\'':case'"':var sQC=sC;var iP=i+1;while(iP<sF.length){var sNC=sF.charAt(iP++);if(sNC==sQC){break}else if(sNC=='\\'){iP++;if(iP>=sF.length)break;sD+=sF.charAt(iP)}else{sD+=sNC}}iTL=iP-i;break;default:sD+=sC;iTL=1;break}i+=iTL}return sD}var g_fDtfInit=0;function initDtf(){if(g_fDtfInit)return;if(!fmtDt.sAM)fmtDt.sAM=isDf(typeof(L_AM))?L_AM:0;if(!fmtDt.sPM)fmtDt.sPM=isDf(typeof(L_PM))?L_PM:0;if(!fmtDt.rgFulDN)fmtDt.rgFulDN=isDf(typeof(a_rgFulDN))?a_rgFulDN:0;if(!fmtDt.rgAbrDN)fmtDt.rgAbrDN=isDf(typeof(a_rgAbrDN))?a_rgAbrDN:0;if(!fmtDt.rgFulMN)fmtDt.rgFulMN=isDf(typeof(a_rgFulMN))?a_rgFulMN:0;if(!fmtDt.rgAbrMN)fmtDt.rgAbrMN=isDf(typeof(a_rgAbrMN))?a_rgAbrMN:0;g_fDtfInit=1}var DTF_AM=1;var DTF_PM=2;var DTF_FULDN=3;var DTF_ABRDN=4;var DTF_FULMN=5;var DTF_ABRMN=6;function getDtf(iDtf){initDtf();switch(iDtf){case DTF_AM:return fmtDt.sAM;break;case DTF_PM:return fmtDt.sPM;break;case DTF_FULDN:return fmtDt.rgFulDN;break;case DTF_ABRDN:return fmtDt.rgAbrDN;break;case DTF_FULMN:return fmtDt.rgFulMN;break;case DTF_ABRMN:return fmtDt.rgAbrMN;break;default:return null}}function prsRpt(sS,iP,sC){var i=iP+1;while((i<sS.length)&&(sS.charAt(i)==sC)){i++}return(i-iP)}function rndrATLst(oLst,dt){oLst.clr();for(var i=0;i<48;++i){var iM=i*30;var dt=new Date(dt);dt.shrs(0,iM);oLst.add(dt,fmtDt(dt,g_sShtTmFmt))}}function toDate(y,m,d){return new Date(Date.UTC(y,m-1,d,0,0,0))}function cmpDy(dtA,dtB){return((dtA.gyr()==dtB.gyr())&&(dtA.gmo()==dtB.gmo())&&(dtA.gdt()==dtB.gdt()))}function cmpDt(dtA,dtB){return(cmpDy(dtA,dtB)&&cmpTm(dtA,dtB))}function cmpTm(dtA,dtB){return((dtA.ghrs()==dtB.ghrs())&&(dtA.gmins()==dtB.gmins()))}function cpyDt(dtS,dtD){dtD.syr(dtS.gyr(),dtS.gmo(),dtS.gdt());return dtD}function cpyTm(dtS,dtD){dtD.shrs(dtS.ghrs(),dtS.gmins());return dtD}function dtST(dt,iH,iM,iS){dt.smsecs(0);dt.ssecs(iS);dt.smins(iM);dt.shrs(iH);return dt}var DLG_MOD=0x001;var DLG_RSZ=0x002;var DLG_STA=0x004;var DLG_CTR=0x008;var DLG_SCR=0x010;function shwDlg(sN,iW,iH,iF,oPar,sQS){var oDlgArg=new Object();oDlgArg.opener=window;oDlgArg.oPar=oPar;if(!iF)iF=DLG_RSZ|DLG_CTR;function _chkF(f){return(iF&f)?"yes;":"no;"}var sF="help:no;";sF+="dialogwidth:"+scaleX(iW)+"px;dialogheight:"+scaleY(iH)+"px;";sF+="resizable:"+_chkF(DLG_RSZ);sF+="status:"+_chkF(DLG_STA);sF+="scroll:"+_chkF(DLG_SCR);sF+="center:"+_chkF(DLG_CTR);var sUrl="?ae=Dialog&t="+sN;if(isDf(typeof(sOwaVDir)))sUrl=sOwaVDir+sUrl;if(sQS)sUrl+=sQS;try{if(iF&DLG_MOD)return window.showModalDialog(sUrl,oDlgArg,sF);else return window.showModelessDialog(sUrl,oDlgArg,sF)}catch(e){}}function scaleX(iVal){if(screen.deviceXDPI&&screen.logicalXDPI)return iVal*(screen.deviceXDPI/screen.logicalXDPI);else return iVal}function scaleY(iVal){if(screen.deviceYDPI&&screen.logicalYDPI)return iVal*(screen.deviceYDPI/screen.logicalYDPI);else return iVal}function shwAB(sTgt,sA){var oP=new Object();var oDivTo=$(TO);var oDivCc=$(CC);var oDivBcc=$(BCC);var oDivFrom=$(FROM);if(oDivTo){oP.sTo=oDivTo.get_InnerHtml()}if(oDivCc){oP.sCc=oDivCc.get_InnerHtml()}if(oDivBcc){oP.sBcc=oDivBcc.get_InnerHtml()}if(oDivFrom){oP.sFrom=oDivFrom.get_InnerHtml()}oP.sTgt=sTgt;shwDlg("AddressBook",a_iABW,a_iABH,DLG_MOD|DLG_CTR|DLG_RSZ,oP,"&a="+sA);if(oDivTo){setRwHtml(oDivTo,oP.sTo)}if(oDivCc){setRwHtml(oDivCc,oP.sCc)}if(oDivBcc&&(0<oP.sBcc.length)){shwBcc(1)}if(oDivBcc){setRwHtml(oDivBcc,oP.sBcc)}if(oDivFrom){setRwHtml(oDivFrom,oP.sFrom)}revtRSpn()}var g_fDrty=0;function drty(){g_fDrty=1}function clrDrty(){g_fDrty=0}function isDrty(){return g_fDrty==1}Type.createNamespace("Owa.Components.Storage");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/dragdrop.js".toLowerCase()])(function(){Owa.Components.Storage.DragDrop=function Owa$Components$Storage$DragDrop(oEvent){Owa.Components.Storage.DragDrop.constructBase(this);this._oEvent=oEvent};Owa.Components.Storage.DragDrop.Effect={All:"all",Copy:"copy",Link:"link",Move:"move",None:"none"};var _DRAGDROP_CONTEXT="__dragdropContext";function get_MimeType(){if(Owa.Utility.isSafari())return"text/plain";else if(Owa.Utility.isFirefox())return"owadragcontext";else return"text"}Owa.Components.Storage.DragDrop.prototype.get_Data=function Owa$Components$Storage$DragDrop$get_Data(){var sMimeType=get_MimeType();if(this._oEvent._oEvent.dataTransfer){var sContent=this._oEvent._oEvent.dataTransfer.getData(sMimeType);if(!sContent&&Owa.Utility.isSafari()&&(this._oEvent.get_Type()=="dragenter"||this._oEvent.get_Type()=="dragover")){sContent=getDragDropData(sMimeType)}}else{sContent=getDragDropData(sMimeType)}return sContent};function getDragDropData(sMimeType){var oContext=Owa.Utility.getRootOwaWindow().getGlobalVariable(_DRAGDROP_CONTEXT);if(oContext){return oContext[sMimeType]}else{oContext=Owa.Utility.getIFrameParentOwaWindow().getGlobalVariable(_DRAGDROP_CONTEXT);if(oContext)return oContext[sMimeType]}}function setDragDropData(sMimeType,sContent){var oContext={};oContext[sMimeType]=sContent;Owa.Utility.getIFrameParentOwaWindow().setGlobalVariable(_DRAGDROP_CONTEXT,oContext);Owa.Utility.getRootOwaWindow().setGlobalVariable(_DRAGDROP_CONTEXT,oContext)}Owa.Components.Storage.DragDrop.prototype.clear=function Owa$Components$Storage$DragDrop$clear(){setDragDropData(get_MimeType(),null)};Owa.Components.Storage.DragDrop.prototype.set_Data=function Owa$Components$Storage$DragDrop$set_Data(sContent){var sMimeType=get_MimeType();if(this._oEvent._oEvent.dataTransfer){this._oEvent._oEvent.dataTransfer.effectAllowed=Owa.Components.Storage.DragDrop.Effect.All;this._oEvent._oEvent.dataTransfer.setData(sMimeType,sContent);if(Owa.Utility.isSafari())setDragDropData(sMimeType,sContent);if(Owa.Utility.isFirefox()){var oCanvas=document.createElement("canvas");oCanvas.width=oCanvas.height=0;this._oEvent._oEvent.dataTransfer.setDragImage(oCanvas,0,0)}}else{var oContext={};oContext[sMimeType]=sContent;Owa.Utility.getIFrameParentOwaWindow().setGlobalVariable(_DRAGDROP_CONTEXT,oContext);Owa.Utility.getRootOwaWindow().setGlobalVariable(_DRAGDROP_CONTEXT,oContext)}};Owa.Components.Storage.DragDrop.prototype.setEffect=function Owa$Components$Storage$DragDrop$setEffect(sEffect){if(this._oEvent._oEvent.dataTransfer){if(sEffect==Owa.Components.Storage.DragDrop.Effect.None){this._oEvent._oEvent.dataTransfer.dropEffect=sEffect}else{var sEffectAllowed="";try{sEffectAllowed=this._oEvent._oEvent.dataTransfer.effectAllowed}catch(e){}sEffectAllowed=sEffectAllowed.toLowerCase();if(sEffectAllowed==""||sEffectAllowed==Owa.Components.Storage.DragDrop.Effect.All||sEffectAllowed.contains(sEffect))this._oEvent._oEvent.dataTransfer.dropEffect=sEffect;else this._oEvent._oEvent.dataTransfer.dropEffect=Owa.Components.Storage.DragDrop.Effect.All}}var oRawEvent=this._oEvent._oEvent;oRawEvent._effect=sEffect;if(Owa.Utility.isSafari()){var oImage=new Image();oImage.src=getThmF("clear1x1.gif");this._oEvent._oEvent.dataTransfer.setDragImage(oImage,1,1)}};Owa.Components.Storage.DragDrop.prototype.deny=function Owa$Components$Storage$DragDrop$deny(){this.setEffect(Owa.Components.Storage.DragDrop.Effect.None);this._oEvent.preventDefault();this._oEvent.cancelBubble()};var _fSimulate=null;Owa.Components.Storage.DragDrop.isSimulateInFireFox=function Owa$Components$Storage$DragDrop$isSimulateInFireFox(){if(Boolean.isInstance(_fSimulate)){return _fSimulate}_fSimulate=Owa.Utility.isFirefox()&&Owa.Utility.get_FirefoxVersion()<3.5;return _fSimulate};Owa.Components.Storage.DragDrop.createClass("Owa.Components.Storage.DragDrop",Owa.Components.Control,Owa.Components.Storage.IStorage)})();g_fModuleLoaded[".\\components/dragdrop.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/FireFoxDNDSimulator.js".toLowerCase()])(function(){if(Owa.Components.Storage.DragDrop.isSimulateInFireFox()){Owa.Components.Storage.DragDrop.__dragDropContext={};var _oLastTarget="oLastTarget";var _sLastEffect="sLastEffect";var _fMouseButtonDown="fMouseButtonDown";var _fDragging="fDragging";var _fDragStartFired="fDragStartFired";function getDragDropContext(){var oOwa=Owa.Utility.getIFrameParentOwaWindow().getGlobalVariable("Owa");return oOwa.Components.Storage.DragDrop.__dragDropContext}function getDragDropVariable(sName){return getDragDropContext()[sName]}function setDragDropVarible(sName,oValue){getDragDropContext()[sName]=oValue}function fireEvent(oEvent,sEventName,oTarget){var oTarget=oTarget?oTarget:oEvent.get_Target();if(!oTarget)return;var oOldRawEvent=oEvent._oEvent;var oRawEvent=document.createEvent("MouseEvent");oRawEvent.initMouseEvent(sEventName,1,1,oOldRawEvent.view,oOldRawEvent.detail,oOldRawEvent.screenX,oOldRawEvent.screenY,oOldRawEvent.clientX,oOldRawEvent.clientY,oOldRawEvent.ctrlKey,oOldRawEvent.altKey,oOldRawEvent.shiftKey,oOldRawEvent.metaKey,oOldRawEvent.button,oOldRawEvent.relatedTarget);oTarget._get_DomNode().dispatchEvent(oRawEvent);return oRawEvent}function fireDragEvent(oEvent){var oLastTarget=getDragDropVariable(_oLastTarget);var oTarget=oEvent.get_Target();var sEffect;if((oLastTarget&&(oLastTarget.equals(oTarget))||oEvent.get_Type()=="keydown")){if(oEvent.get_Type()=="keydown"){oTarget=oLastTarget}var oRawEvent=fireEvent(oEvent,"dragover",oTarget);if(oRawEvent){var sEffect=oRawEvent._effect;if(sEffect)setDragDropVarible(_sLastEffect,sEffect);setCursor(oTarget)}}else{if(oLastTarget){fireEvent(oEvent,"dragleave",oLastTarget);resetCursor(oLastTarget)}var oRawEvent=fireEvent(oEvent,"dragenter");if(oRawEvent){var sEffect=oRawEvent._effect;if(sEffect)setDragDropVarible(_sLastEffect,sEffect);setCursor(oTarget)}}setDragDropVarible(_oLastTarget,oTarget)}function setCursor(oTarget){if(!oTarget)return;var sEffect=getDragDropVariable(_sLastEffect);var sCursor="no-drop";if(!oTarget._get_DomNode().__cursorSaved){oTarget._get_DomNode().__oldCursor=oTarget._get_DomNode().style.cursor;oTarget._get_DomNode().__cursorSaved=true}if(sEffect){switch(sEffect){case Owa.Components.Storage.DragDrop.Effect.All:sCursor="alias";break;case Owa.Components.Storage.DragDrop.Effect.Move:sCursor="alias";break;case Owa.Components.Storage.DragDrop.Effect.Copy:sCursor="copy";break;case Owa.Components.Storage.DragDrop.Effect.Link:sCursor="default";break;default:sCursor="no-drop"}}oTarget._get_DomNode().style.cursor=sCursor}function resetCursor(oTarget){if(!oTarget)return;if(oTarget._get_DomNode().__cursorSaved){oTarget._get_DomNode().style.cursor=oTarget._get_DomNode().__oldCursor;oTarget._get_DomNode().__cursorSaved=null;oTarget._get_DomNode().__oldCursor=null}}function dragNDropSimulator(e){var oEvent=new Owa.Dom.Event(e,this);if(oEvent.isLeftButtonDown()){setDragDropVarible(_fMouseButtonDown,1);setDragDropVarible(_fDragStartFired,0)}}function dragNDropOnMouseDown(e){var oEvent=new Owa.Dom.Event(e,this);if(oEvent.isRightButtonDown()){stopDragNDrop(oEvent,true)}}function dragNDropOnMouseMove(e){if(getDragDropVariable(_fMouseButtonDown)&&!getDragDropVariable(_fDragStartFired)){var oEvent=new Owa.Dom.Event(e,this);setDragDropVarible(_fDragStartFired,1);setDragDropVarible(_sLastEffect,Owa.Components.Storage.DragDrop.Effect.None);fireEvent(oEvent,"dragstart");var oDragDrop=new Owa.Components.Storage.DragDrop(oEvent);if(oDragDrop.get_Data()){setDragDropVarible(_fDragging,1)}else{return}}if(getDragDropVariable(_fMouseButtonDown)&&getDragDropVariable(_fDragging)){var oEvent=new Owa.Dom.Event(e,this);fireDragEvent(oEvent)}}function dragNDropOnMouseOver(e){if(getDragDropVariable(_fDragging)){var oEvent=new Owa.Dom.Event(e,this);fireDragEvent(oEvent)}}function dragNDropOnKeyDown(e){if(getDragDropVariable(_fDragging)){var oEvent=new Owa.Dom.Event(e,this);if(27==oEvent.get_KeyCodeForKeyUpDown()){stopDragNDrop(oEvent,true)}}}function dragNDropOnMouseUp(e){var oEvent=new Owa.Dom.Event(e,this);if(oEvent.isLeftButtonDown()){setDragDropVarible(_fMouseButtonDown,0)}if(getDragDropVariable(_fDragging)){if(oEvent.isLeftButtonDown()){var sLastEffect=getDragDropVariable(_sLastEffect);if(sLastEffect&&sLastEffect!=Owa.Components.Storage.DragDrop.Effect.None){fireEvent(oEvent,"drop")}stopDragNDrop(oEvent,false)}}}function dragNDropOnMouseOut(e){var oEvent=new Owa.Dom.Event(e,this);if(getDragDropVariable(_oLastTarget)){fireEvent(oEvent,"dragleave",getDragDropVariable(_oLastTarget));resetCursor(getDragDropVariable(_oLastTarget))}setDragDropVarible(_oLastTarget,null)}function stopDragNDrop(oEvent,fFireCancelEvent){if(getDragDropVariable(_fDragging)){var oLastTarget=getDragDropVariable(_oLastTarget);var oDragDrop=new Owa.Components.Storage.DragDrop(oEvent);if(fFireCancelEvent&&oLastTarget){fireEvent(oEvent,"dragleave",oLastTarget)}resetCursor(getDragDropVariable(_oLastTarget));setDragDropVarible(_fMouseButtonDown,0);setDragDropVarible(_fDragging,0);setDragDropVarible(_fDragStartFired,0);setDragDropVarible(_oLastTarget,null);setDragDropVarible(_sLastEffect,null);oDragDrop.set_Data(null)}}function dragNDropOnDragStart(e){var oEvent=new Owa.Dom.Event(e);oEvent.cancelBubble();oEvent.preventDefault()}document.addEventListener("mousedown",dragNDropOnMouseDown,true);document.addEventListener("mousemove",dragNDropOnMouseMove,true);document.addEventListener("mouseover",dragNDropOnMouseOver,true);document.addEventListener("keydown",dragNDropOnKeyDown,true);document.addEventListener("mouseup",dragNDropOnMouseUp,true);document.addEventListener("mouseout",dragNDropOnMouseOut,true)}Owa.Components.Storage.DragDrop.enableDNDInFireFox=function Owa$Components$DragDrop$Storage$enableDNDInFireFox(oElement){if(Owa.Components.Storage.DragDrop.isSimulateInFireFox()){var oDomElement=oElement._get_DomNode();oDomElement.addEventListener("mousedown",dragNDropSimulator,true);oDomElement.addEventListener("draggesture",dragNDropOnDragStart,true)}}})();g_fModuleLoaded[".\\components/FireFoxDNDSimulator.js".toLowerCase()]=1;var MAX_REQ_ITMS=500;var IT_AD_PFX="AD.";function isValidDropFolder(oDraggableObject,sFolderContainerClass){if(oDraggableObject.get_TypeName()!==Owa.Components.DraggableObjects.Type.Items&&oDraggableObject.get_TypeName()!==Owa.Components.DraggableObjects.Type.Conversations){return false}var oRootElement=oDraggableObject.get_RootElement();var fValid=true;oRootElement.foreach_Item(function(oItem){if(!isMoveAllow(sFolderContainerClass,oItem.get_ItemType())){fValid=false;return true}});return fValid}function isMoveAllow(sFolderContainerClass,sItemType){if(!sFolderContainerClass||isOfClss(sFolderContainerClass,T_MSG)){return !isOfClss(sItemType,IT_AD)}else if(isOfClss(sFolderContainerClass,T_CAL)){return isOfClss(sItemType,IT_APP)}else if(isOfClss(sFolderContainerClass,T_CON)){return isOfClss(sItemType,IT_CNT)||isOfClss(sItemType,IT_PDL)}else if(isOfClss(sFolderContainerClass,T_TSK)){return isOfClss(sItemType,IT_TSK)}else{return false}}function checkLimit(oDraggableObject,oListView){var fLimit=false;if(oDraggableObject.get_TypeName()===Owa.Components.DraggableObjects.Type.Items&&oDraggableObject.get_RootElement().getLength_Item()>MAX_REQ_ITMS){fLimit=true}if(fLimit){alrt(L_ErrMaxItms,0,Owa.BUTTON_DIALOG_ICON.WARNING,L_Wrng);return true}return false}function canAttach(oDraggableObject){if((oDraggableObject.get_TypeName()!==Owa.Components.DraggableObjects.Type.Items)&&(oDraggableObject.get_TypeName()!==Owa.Components.DraggableObjects.Type.Conversations)){return false}var fCanAttach=true;var oRootElement=oDraggableObject.get_RootElement();oRootElement.foreach_Item(function(oItem){if(oItem.get_ItemType().startsWith(IT_AD_PFX)){fCanAttach=false;return true}});return fCanAttach}Type.createNamespace("Owa.Components.Storage");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/storableobject.js".toLowerCase()])(function(){Owa.Components.Storage.StorableObject=function Owa$Components$Storage$StorableObject(sTypeName,iVersion,sRootElementType,sRootElementName){Owa.Components.Storage.StorableObject.constructBase(this);this._sTypeName=sTypeName;this._iVersion=iVersion;this._sRootElementType=sRootElementType;this._sRootElementName=sRootElementName};Owa.Components.Storage.StorableObject.prototype.save=function Owa$Components$Storage$StorableObject$save(oStorage){var oXmlDocument=this.saveToXml();oStorage.set_Data(oXmlDocument.get_Xml())};Owa.Components.Storage.StorableObject.DocumentElementName="OwaStorableObject";Owa.Components.Storage.StorableObject.prototype.load=function Owa$Components$Storage$StorableObject$load(oStorage){var sXml=oStorage.get_Data();var oXmlDocument=new Owa.Dom.XmlDocument();oXmlDocument.loadXML(sXml);return this.loadFromXml(oXmlDocument)};Owa.Components.Storage.StorableObject.prototype.loadFromXml=function Owa$Components$Storage$StorableObject$loadFromXml(oXmlDocument){var oXmlElement=oXmlDocument.selectSingleNode("/"+Owa.Components.Storage.StorableObject.DocumentElementName);this._rootElement=null;if(oXmlElement.getAttribute("type")===this.get_TypeName()){var iVersion=parseInt(oXmlElement.getAttribute("version"),10);if(iVersion!=this.get_Version())return false}else{return false}var oXmlRootElement=oXmlDocument.selectSingleNode("/"+Owa.Components.Storage.StorableObject.DocumentElementName+"/"+this._sRootElementName);if(!oXmlRootElement)return false;this.get_RootElement().load(oXmlRootElement);return true};Owa.Components.Storage.StorableObject.prototype.saveToXml=function Owa$Components$Storage$StorableObject$saveToXml(){var oXmlDocument=new Owa.Dom.XmlDocument();var oXmlElement;oXmlDocument.loadXML("<"+Owa.Components.Storage.StorableObject.DocumentElementName+"><"+this._sRootElementName+"></"+this._sRootElementName+"></"+Owa.Components.Storage.StorableObject.DocumentElementName+">");this.get_RootElement().save(oXmlDocument.selectSingleNode("/"+Owa.Components.Storage.StorableObject.DocumentElementName+"/"+this._sRootElementName));oXmlElement=oXmlDocument.selectSingleNode("/"+Owa.Components.Storage.StorableObject.DocumentElementName);oXmlElement.setAttribute("type",this.get_TypeName());oXmlElement.setAttribute("version",this.get_Version().toString());return oXmlDocument};Owa.Components.Storage.StorableObject.prototype.get_RootElement=function Owa$Components$Storage$StorableObject$get_RootElement(){if(!this._rootElement)this._rootElement=this._createRootElement();return this._rootElement};Owa.Components.Storage.StorableObject.prototype.get_TypeName=function Owa$Components$Storage$StorableObject$get_TypeName(){return this._sTypeName};Owa.Components.Storage.StorableObject.prototype.get_Version=function Owa$Components$Storage$StorableObject$get_Version(){return this._iVersion};Owa.Components.Storage.StorableObject.prototype._createRootElement=function Owa$Components$Storage$StorableObject$_createRootElement(){return new(Type.getType(this._sRootElementType))()};Owa.Components.Storage.StorableObject._registeredType={};Owa.Components.Storage.StorableObject.register=function Owa$Components$Storage$StorableObject$register(sTypeName,iVersion,sRootElementType,sRootElementName,sObjectType){var oType=Owa.Components.Storage.StorableObject._registeredType[sTypeName];if(oType)throw new Error("Type already registered");oType={};oType.sTypeName=sTypeName;oType.iVersion=iVersion;oType.sRootElementType=sRootElementType;oType.sRootElementName=sRootElementName;oType.sObjectType=sObjectType?sObjectType:"Owa.Components.Storage.StorableObject";Owa.Components.Storage.StorableObject._registeredType[sTypeName]=oType};Owa.Components.Storage.StorableObject.create=function Owa$Components$Storage$StorableObject$create(sTypeName){var oType=Owa.Components.Storage.StorableObject._registeredType[sTypeName];if(oType)return new(Type.getType(oType.sObjectType))(oType.sTypeName,oType.iVersion,oType.sRootElementType,oType.sRootElementName);else throw new Error("Type isn't registered")};Owa.Components.Storage.StorableObject.createFromStorage=function Owa$Components$Storage$StorableObject$createFromStorage(oStorage){var sXml=oStorage.get_Data();var sTypeName;var oType;var oXmlDocument;var oXmlElement;var oStorableObject;if(!sXml)return null;oXmlDocument=new Owa.Dom.XmlDocument();oXmlDocument.loadXML(sXml);oXmlElement=oXmlDocument.selectSingleNode("/"+Owa.Components.Storage.StorableObject.DocumentElementName);if(!oXmlElement)return null;sTypeName=oXmlElement.getAttribute("type");oType=Owa.Components.Storage.StorableObject._registeredType[sTypeName];if(!oType)return null;oStorableObject=new(Type.getType(oType.sObjectType))(oType.sTypeName,oType.iVersion,oType.sRootElementType,oType.sRootElementName);return oStorableObject.loadFromXml(oXmlDocument)?oStorableObject:null};Owa.Components.Storage.StorableObject.createClass("Owa.Components.Storage.StorableObject",Owa.Components.Control);Owa.Components.Storage.StorableElement=function Owa$Components$Storage$StorableElement(){Owa.Components.Storage.StorableElement.constructBase(this);this._propertyValues={};if(!this._simpleProperties){var rgSimpleProperties=[];var rgArrayProperties=[];for(var sMemberName in this){if(sMemberName.startsWith("_property.")){rgSimpleProperties.push(this[sMemberName]);delete this[sMemberName]}else if(sMemberName.startsWith("_array_property.")){rgArrayProperties.push(this[sMemberName]);delete this[sMemberName]}}this.constructor.prototype._simpleProperties=rgSimpleProperties;this.constructor.prototype._arrayProperties=rgArrayProperties}};Owa.Components.Storage.StorableElement.PropertyType={String:"String",Number:"Number",Boolean:"Boolean"};Owa.Components.Storage.StorableElement.prototype.save=function Owa$Components$Storage$StorableElement$save(oXmlElement){for(var i=0;i<this._simpleProperties.length;i++){var oPropertyDefinition=this._simpleProperties[i];var oValue=this._propertyValues[oPropertyDefinition.sName];switch(oPropertyDefinition.sType){case Owa.Components.Storage.StorableElement.PropertyType.String:oXmlElement.setAttribute(oPropertyDefinition.sName,oValue);break;case Owa.Components.Storage.StorableElement.PropertyType.Number:if(oValue||oValue===0)oXmlElement.setAttribute(oPropertyDefinition.sName,oValue.toString());break;case Owa.Components.Storage.StorableElement.PropertyType.Boolean:oXmlElement.setAttribute(oPropertyDefinition.sName,oValue?"true":"false");break}}for(var i=0;i<this._arrayProperties.length;i++){var oPropertyDefinition=this._arrayProperties[i];var oArrayValue=this._propertyValues[oPropertyDefinition.sName];if(oArrayValue&&oArrayValue.length>0){var oXmlDocument=oXmlElement.get_OwnerDocument();for(var iIndex=0;iIndex<oArrayValue.length;iIndex++){var oChildElement=oXmlDocument.createElement(oPropertyDefinition.sName);oXmlElement.appendChild(oChildElement);oArrayValue[iIndex].save(oChildElement)}}}};Owa.Components.Storage.StorableElement.prototype.load=function Owa$Components$Storage$StorableElement$load(oXmlElement){for(var i=0;i<this._simpleProperties.length;i++){var oPropertyDefinition=this._simpleProperties[i];var sValue=oXmlElement.getAttribute(oPropertyDefinition.sName);switch(oPropertyDefinition.sType){case Owa.Components.Storage.StorableElement.PropertyType.String:this._propertyValues[oPropertyDefinition.sName]=sValue;break;case Owa.Components.Storage.StorableElement.PropertyType.Number:this._propertyValues[oPropertyDefinition.sName]=parseInt(sValue,10);break;case Owa.Components.Storage.StorableElement.PropertyType.Boolean:this._propertyValues[oPropertyDefinition.sName]=sValue==="true"?true:false;break}}for(var i=0;i<this._arrayProperties.length;i++){var oPropertyDefinition=this._arrayProperties[i];var oNodeList=oXmlElement.selectNodes("./"+oPropertyDefinition.sName);if(oNodeList&&oNodeList.length>0){var oArrayValue=[];for(var iIndex=0;iIndex<oNodeList.length;iIndex++){var oChildElement=new(Type.getType(oPropertyDefinition.sType))();oChildElement.load(oNodeList[iIndex]);oArrayValue.push(oChildElement)}this._propertyValues[oPropertyDefinition.sName]=oArrayValue}}};Owa.Components.Storage.StorableElement.prototype._getProperty=function Owa$Components$Storage$StorableElement$_getProperty(sName){return this._propertyValues[sName]};Owa.Components.Storage.StorableElement.prototype._setProperty=function Owa$Components$Storage$StorableElement$_setProperty(sName,oValue){this._propertyValues[sName]=oValue};Owa.Components.Storage.StorableElement.defineProperty=function Owa$Components$Storage$StorableElement$defineProperty(oClass,sName,sType,fReadonly){var oPropertyDefinition={};oPropertyDefinition.sName=sName;oPropertyDefinition.sType=sType;oClass.prototype["_property."+sName]=oPropertyDefinition;oClass.prototype["get_"+sName]=function Owa$Components$Storage$StorabelElement$_getPropertyAnonymous(){return this._getProperty(sName)};if(!fReadonly){oClass.prototype["set_"+sName]=function Owa$Components$Storage$StorabelElement$_setPropertyAnonymous(oValue){this._setProperty(sName,oValue)}}delete oClass;delete sType;delete fReadonly;delete oPropertyDefinition};Owa.Components.Storage.StorableElement.prototype._getArrayPropertyDefinition=function Owa$Components$Storage$StorableElement$_getArrayPropertyDefinition(sName){var oPropertyDefinition=this["_array_property."+sName];return oPropertyDefinition};Owa.Components.Storage.StorableElement.prototype._getArrayPropertyByIndex=function Owa$Components$Storage$StorableElement$_getArrayPropertyByIndex(sName,iIndex){var oArrayValue=this._propertyValues[sName];return oArrayValue?oArrayValue[iIndex]:null};Owa.Components.Storage.StorableElement.prototype._getArrayPropertyAll=function Owa$Components$Storage$StorableElement$_getArrayPropertyAll(sName){var oArrayValue=this._propertyValues[sName];return oArrayValue?oArrayValue:[]};Owa.Components.Storage.StorableElement.prototype._clearArrayProperty=function Owa$Components$Storage$StorableElement$_clearArrayProperty(sName){this._propertyValues[sName]=null};Owa.Components.Storage.StorableElement.prototype._appendArrayProperty=function Owa$Components$Storage$StorableElement$_appendArrayProperty(sName,oValue){var oArrayValue=this._propertyValues[sName];if(oArrayValue)oArrayValue.push(oValue);else this._propertyValues[sName]=[oValue]};Owa.Components.Storage.StorableElement.prototype._createOneOfArrayProperty=function Owa$Components$Storage$StorableElement$_createOneOfArrayProperty(sName){var oPropertyDefinition=this._getArrayPropertyDefinition(sName);if(!oPropertyDefinition)return null;else return new(Type.getType(oPropertyDefinition.sType))()};Owa.Components.Storage.StorableElement.prototype._getLengthOfArrayProperty=function Owa$Components$Storage$StorableElement$_getLengthOfArrayProperty(sName){var oArrayValue=this._propertyValues[sName];if(oArrayValue)return oArrayValue.length;else return 0};Owa.Components.Storage.StorableElement.prototype._removeArrayPropertyByIndex=function Owa$Components$Storage$StorableElement$_removeArrayPropertyByIndex(sName,iIndex){var oArrayValue=this._propertyValues[sName];if(oArrayValue)oArrayValue.removeAt(iIndex)};Owa.Components.Storage.StorableElement.prototype._foreachArrayProperty=function Owa$Components$Storage$StorableElement$_foreachArrayProperty(sName,oCallback){var oArrayValue=this._propertyValues[sName];for(var iIndex=0;oArrayValue&&iIndex<oArrayValue.length;iIndex++)if(oCallback(oArrayValue[iIndex]))break};Owa.Components.Storage.StorableElement.defineArrayProperty=function Owa$Components$Storage$StorableElement$defineArrayProperty(oClass,sName,sType){var oPropertyDefinition={};oPropertyDefinition.sName=sName;oPropertyDefinition.sType=sType;oClass.prototype["_array_property."+sName]=oPropertyDefinition;oClass.prototype["get_"+sName]=function Owa$Components$Storage$StorableElement$_getArrayPropertyByIndexAnonymous(sName,iIndex){return this._getArrayPropertyByIndex(iIndex)};oClass.prototype["getAll_"+sName]=function Owa$Components$Storage$StorableElement$_getArrayPropertyAllAnonymous(){return this._getArrayPropertyAll(sName)};oClass.prototype["clear_"+sName]=function Owa$Components$Storage$StorableElement$_clearArrayPropertyAnonymous(){return this._clearArrayProperty(sName)};oClass.prototype["append_"+sName]=function Owa$Components$Storage$StorableElement$_appendArrayPropertyAnonymous(oValue){return this._appendArrayProperty(sName,oValue)};oClass.prototype["createOne_"+sName]=function Owa$Components$Storage$StorableElement$_createOneOfArrayPropertyAnonymous(){return this._createOneOfArrayProperty(sName)};oClass.prototype["getLength_"+sName]=function Owa$Components$Storage$StorableElement$_getLengthOfArrayPropertyAnonymous(){return this._getLengthOfArrayProperty(sName)};oClass.prototype["remove_"+sName]=function Owa$Components$Storage$StorableElement$_removeArrayPropertyByIndexAnonymous(iIndex){return this._removeArrayPropertyByIndex(sName,iIndex)};oClass.prototype["foreach_"+sName]=function Owa$Components$Storage$StorableElement$_foreachArrayPropertyAnonymous(oCallback){return this._foreachArrayProperty(sName,oCallback)};delete oClass;delete sType;delete oPropertyDefinition};Owa.Components.Storage.StorableElement.createClass("Owa.Components.Storage.StorableElement",Owa.Components.Control)})();g_fModuleLoaded[".\\components/storableobject.js".toLowerCase()]=1;Type.createNamespace("Owa.Components.DraggableObjects");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/draggableobjects.js".toLowerCase()])(function(){Owa.Components.DraggableObject=function Owa$Components$DraggableObject(sTypeName,iVersion,sRootElementType,sRootElementName){Owa.Components.DraggableObject.constructBase(this,arguments)};Owa.Components.DraggableObject.prototype.set_DenyCopy=function Owa$Components$DraggableObject$set_DenyCopy(fValue){this._denyCopy=fValue};Owa.Components.DraggableObject.prototype.get_DenyCopy=function Owa$Components$DraggableObject$get_DenyCopy(){return this._denyCopy};Owa.Components.DraggableObject.prototype.set_DenyMove=function Owa$Components$DraggableObject$set_DenyMove(fValue){this._denyMove=fValue};Owa.Components.DraggableObject.prototype.get_DenyMove=function Owa$Components$DraggableObject$get_DenyMove(){return this._denyMove};Owa.Components.DraggableObject.prototype.set_LegacyDN=function Owa$Components$DraggableObject$set_LegacyDN(sLegacyDN){this._legacyDN=sLegacyDN};Owa.Components.DraggableObject.prototype.get_LegacyDN=function Owa$Components$DraggableObject$get_LegacyDN(){return this._legacyDN};Owa.Components.DraggableObject.prototype.loadFromXml=function Owa$Components$DraggableObject$loadFromXml(oXmlDocument){var fSuccess=Owa.Components.DraggableObject.callBase(this,"loadFromXml",[oXmlDocument]);if(!fSuccess)return false;var oXmlElement=oXmlDocument.selectSingleNode("/"+Owa.Components.Storage.StorableObject.DocumentElementName);if(oXmlElement){this.set_DenyCopy(oXmlElement.getAttribute("denyCopy")==="true");this.set_DenyMove(oXmlElement.getAttribute("denyMove")==="true");this.set_LegacyDN(oXmlElement.getAttribute("legacyDN"))}return true};Owa.Components.DraggableObject.prototype.saveToXml=function Owa$Components$DraggableObject$saveToXml(){var oXmlDocument=Owa.Components.DraggableObject.callBase(this,"saveToXml");var oXmlElement=oXmlDocument.selectSingleNode("/OwaStorableObject");if(oXmlElement){oXmlElement.setAttribute("denyCopy",this.get_DenyCopy()?"true":"false");oXmlElement.setAttribute("denyMove",this.get_DenyMove()?"true":"false");oXmlElement.setAttribute("legacyDN",this.get_LegacyDN()?this.get_LegacyDN():null)}return oXmlDocument};Owa.Components.DraggableObject.register=function Owa$Components$DraggableObject$register(sTypeName,iVersion,sRootElementType,sRootElementName){Owa.Components.Storage.StorableObject.register(sTypeName,iVersion,sRootElementType,sRootElementName,"Owa.Components.DraggableObject")};Owa.Components.DraggableObject.createClass("Owa.Components.DraggableObject",Owa.Components.Storage.StorableObject);Owa.Components.DraggableObjects.Type={Folder:"Folder",Items:"Items",Conversations:"Conversations",NavigationHeader:"NavigationHeader",NavigationNode:"NavigationNode",Buddy:"Buddy"};Owa.Components.DraggableObjects.FolderElement=function Owa$Components$DraggableObjects$FolderElement(){Owa.Components.DraggableObjects.FolderElement.constructBase(this)};Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.FolderElement,"FolderId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.FolderElement,"IsInDeletedItems",Owa.Components.Storage.StorableElement.PropertyType.Boolean,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.FolderElement,"IsInJunkItems",Owa.Components.Storage.StorableElement.PropertyType.Boolean,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.FolderElement,"FolderType",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.FolderElement,"FolderContainerClass",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.FolderElement,"IsOutlookSearchFolder",Owa.Components.Storage.StorableElement.PropertyType.Boolean,false);Owa.Components.DraggableObjects.FolderElement.createClass("Owa.Components.DraggableObjects.FolderElement",Owa.Components.Storage.StorableElement);Owa.Components.DraggableObject.register(Owa.Components.DraggableObjects.Type.Folder,1,"Owa.Components.DraggableObjects.FolderElement","Folder");Owa.Components.DraggableObjects.NavigationNodeElement=function Owa$Components$DraggableObjects$NavigationNodeElement(){Owa.Components.DraggableObjects.NavigationNodeElement.constructBase(this)};Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.NavigationNodeElement,"FolderId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.NavigationNodeElement,"NavigationNodeId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.NavigationNodeElement,"GroupSection",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.DraggableObjects.NavigationNodeElement.createClass("Owa.Components.DraggableObjects.NavigationNodeElement",Owa.Components.Storage.StorableElement);Owa.Components.DraggableObject.register(Owa.Components.DraggableObjects.Type.NavigationNode,1,"Owa.Components.DraggableObjects.NavigationNodeElement","NavigationNode");Owa.Components.DraggableObjects.NavigationHeaderElement=function Owa$Components$DraggableObjects$NavigationHeaderElement(){Owa.Components.DraggableObjects.NavigationHeaderElement.constructBase(this)};Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.NavigationHeaderElement,"NavigationNodeId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.NavigationHeaderElement,"GroupSection",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.DraggableObjects.NavigationHeaderElement.createClass("Owa.Components.DraggableObjects.NavigationHeaderElement",Owa.Components.Storage.StorableElement);Owa.Components.DraggableObject.register(Owa.Components.DraggableObjects.Type.NavigationHeader,1,"Owa.Components.DraggableObjects.NavigationHeaderElement","NavigationHeader");Owa.Components.DraggableObjects.ItemElement=function Owa$Components$DraggableObjects$ItemElement(){Owa.Components.DraggableObjects.ItemElement.constructBase(this)};Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.ItemElement,"ItemId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.ItemElement,"UrlEncItemId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.ItemElement,"ItemType",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.DraggableObjects.ItemElement.createClass("Owa.Components.DraggableObjects.ItemElement",Owa.Components.Storage.StorableElement);Owa.Components.DraggableObjects.ConversationElement=function Owa$Components$DraggableObjects$ConversationElement(){Owa.Components.DraggableObjects.ConversationElement.constructBase(this)};Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.ConversationElement,"Topic",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.ConversationElement,"TimeStamp",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.DraggableObjects.ConversationElement.createClass("Owa.Components.DraggableObjects.ConversationElement",Owa.Components.Storage.StorableElement);Owa.Components.DraggableObjects.ItemsElement=function Owa$Components$DraggableObjects$ItemsElement(){Owa.Components.DraggableObjects.ItemsElement.constructBase(this)};Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.ItemsElement,"FolderId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.ItemsElement,"IsCrossFolder",Owa.Components.Storage.StorableElement.PropertyType.Boolean,false);Owa.Components.Storage.StorableElement.defineArrayProperty(Owa.Components.DraggableObjects.ItemsElement,"Item",Owa.Components.DraggableObjects.ItemElement);Owa.Components.Storage.StorableElement.defineArrayProperty(Owa.Components.DraggableObjects.ItemsElement,"Conversation",Owa.Components.DraggableObjects.ConversationElement);Owa.Components.DraggableObjects.ItemsElement.createClass("Owa.Components.DraggableObjects.ItemsElement",Owa.Components.Storage.StorableElement);Owa.Components.DraggableObject.register(Owa.Components.DraggableObjects.Type.Items,1,"Owa.Components.DraggableObjects.ItemsElement","Items");Owa.Components.DraggableObjects.ConversationsElement=function Owa$Components$DraggableObjects$ConversationsElement(){Owa.Components.DraggableObjects.ConversationsElement.constructBase(this)};Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.ConversationsElement,"FolderId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.ConversationsElement,"IsCrossFolder",Owa.Components.Storage.StorableElement.PropertyType.Boolean,false);Owa.Components.Storage.StorableElement.defineArrayProperty(Owa.Components.DraggableObjects.ConversationsElement,"Item",Owa.Components.DraggableObjects.ItemElement);Owa.Components.Storage.StorableElement.defineArrayProperty(Owa.Components.DraggableObjects.ConversationsElement,"Conversation",Owa.Components.DraggableObjects.ConversationElement);Owa.Components.DraggableObjects.ConversationsElement.createClass("Owa.Components.DraggableObjects.ConversationsElement",Owa.Components.Storage.StorableElement);Owa.Components.DraggableObject.register(Owa.Components.DraggableObjects.Type.Conversations,1,"Owa.Components.DraggableObjects.ConversationsElement","Conversations");Owa.Components.DraggableObjects.BuddyElement=function Owa$Components$DraggableObjects$BuddyElement(){Owa.Components.DraggableObjects.BuddyElement.constructBase(this)};Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.BuddyElement,"GroupId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.Storage.StorableElement.defineProperty(Owa.Components.DraggableObjects.BuddyElement,"BuddyId",Owa.Components.Storage.StorableElement.PropertyType.String,false);Owa.Components.DraggableObjects.BuddyElement.createClass("Owa.Components.DraggableObjects.BuddyElement",Owa.Components.Storage.StorableElement);Owa.Components.DraggableObject.register(Owa.Components.DraggableObjects.Type.Buddy,1,"Owa.Components.DraggableObjects.BuddyElement","Buddy")})();g_fModuleLoaded[".\\components/draggableobjects.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\core/browsererrorhandler.js".toLowerCase()])(function(){var E_NOINTF=-(~(0x80004002)+1);var E_FAIL=-(~(0x80004005)+1);var E_NEM=-(~(0x80070008)+1);var E_ACCDND=-(~(0x80070005)+1);var E_OOM=-(~(0x8007000E)+1);var ACC_DND="df5284f9d6134a689c4e494b74df12bd";var NO_MEM_ERR="143abf4577894d22ae34a054a6dce7fe";Type.createNamespace("Owa.BrowserErrorHandler");Owa.BrowserErrorHandler.isAccessDeny=function Owa$BrowserErrorHandler$isAccessDeny(s){return(s==ACC_DND)};Owa.BrowserErrorHandler.isNoMemoryError=function Owa$BrowserErrorHandler$isNoMemoryError(s){return(s==NO_MEM_ERR)};Owa.BrowserErrorHandler.handleFrameAccessError=function Owa$BrowserErrorHandler$handleFrameAccessError(e){if(e.number==E_ACCDND)throw new Error(ACC_DND);else throw e};Owa.BrowserErrorHandler.handleNewWindowError=function Owa$BrowserErrorHandler$handleNewWindowError(e){switch(e.number){case E_NOINTF:case E_FAIL:case E_OOM:case E_NEM:throw new Error(NO_MEM_ERR);default:throw e}}})();g_fModuleLoaded[".\\core/browsererrorhandler.js".toLowerCase()]=1;function getEvt(o){try{if(!o)return null;if(o.event)return o.event;if(o.ownerDocument)o=o.ownerDocument;var oDocument=Owa.Dom.Node.wrapDomNode(o);return oDocument.get_ContainerWindow()._domWindow.event}catch(e){Owa.BrowserErrorHandler.handleFrameAccessError(e)}}function attchEvt(oE,sEvt,fn){var sEvtRef='__'+sEvt;if(oE[sEvtRef]){if(schRg(fn,oE[sEvtRef])>-1)return}else{oE[sEvtRef]=[];if(oE['on'+sEvt])oE[sEvtRef][0]=oE['on'+sEvt];oE['on'+sEvt]=dspchEvt}oE[sEvtRef][oE[sEvtRef].length]=fn}function dtchEvt(oE,sEvt,fn){var sEvtRef='__'+sEvt;if(oE[sEvtRef]){var i=schRg(fn,oE[sEvtRef]);if(i>-1){oE[sEvtRef].splice(i,1)}if(oE[sEvtRef].length==0){oE['on'+sEvt]=null;oE[sEvtRef]=null}}}function dspchEvt(e){if(Owa.Dom.Event.isInstance(e))e=e._oEvent;e=e||getEvt(this);var sEvtRef='__'+e.type;var fRet=true;for(var i=0;i<this[sEvtRef].length;i++){if(this[sEvtRef][i]){this.__fn=this[sEvtRef][i];fRet=this.__fn(e)&&fRet}}if(this.__fn)try{delete this.__fn}catch(e){this.__fn=null}return fRet}function schRg(o,rg){var i=rg.length;while(i--)if(rg[i]&&rg[i]===o)break;return i}function isLBDwn(oE){if(!isDf(typeof(oE.which))){return((oE.button&0x1)!=0)}else{return(oE.which==1)}}function isRBDwn(oE){if(!isDf(typeof(oE.which))){return((oE.button&0x2)!=0)}else{return(oE.which==3)}}function isAltKD(oE){return oE.altKey}function isCtrlKD(oE){if(Owa.Utility.isMac())return oE.metaKey;else return oE.ctrlKey}function isShftKD(oE){return oE.shiftKey}function prvntDft(oE){oE.preventDefault?oE.preventDefault():oE.returnValue=false}function cnclBbl(oE){oE.cancelBubble=true}function getEvtCX(oE){return oE.clientX}function getEvtCY(oE){return oE.clientY}function getEvtTgt(oE){var o=oE.srcElement||oE.target;if(o&&isDf(typeof o.nodeType)&&o.nodeType!=1)o=o.parentNode;return o}function getKeyCode(oE){return oE.keyCode}function getCharCode(oE){return oE.charCode||oE.keyCode}function getEvtType(oE){return oE.type}function edDoc(f){var oIframeBody=$("ifBdy");if(!oIframeBody)return null;if(f){return oIframeBody.get_ContentDocument()}else{return oIframeBody.get_ContentDocument()._get_DomNode()}}function edEvt(){return getEvt(edDoc())}function shwErrDlg(oRsp,sMsg,sTtl,sActMsg,sErrorDetailHtml,oES,sOptMsg,fnCb,oCbCtx){var oTopWindow=Owa.PageHierarchy.getOwaTopWindow();var oErrorContext={};if(!oTopWindow.equals(Owa.Dom.Window.get_Current())){return oTopWindow.invokeFunction("shwErrDlg",arguments)}if(oRsp){sMsg=oRsp.sErr;sOptMsg=oRsp.sErrorDetails;sErrorDetailHtml=oRsp.sErrDbg}var sId="divErrDlg"+rndm();var sH="<div style=\"padding:0 5\">"+htmlEnc(sMsg)+"</div>";if(sOptMsg)sH+="<div style=\"padding:10 5\">"+htmlEnc(sOptMsg)+"</div>";if(sActMsg)sH+="<div style=\"padding:10 5\">"+htmlEnc(sActMsg)+"</div>";if(sErrorDetailHtml){sH+="<div style=\"padding:10 5\">";var sSH="<span class=lnk id=spnShw onclick=\""+"hideEm(getOneDescendant(wda('"+sId+"'),'spnShw'));"+"showEm(getOneDescendant(wda('"+sId+"'), 'spnHd'));"+"showEm(getOneDescendant(wda('"+sId+"'),'divEDtls'));\">&nbsp;"+htmlEnc(L_ShwRpt)+"<img src=\""+getThmF("expnd.gif")+"\"></span>"+"<span class=lnk id=spnHd onclick=\""+"showEm(getOneDescendant(wda('"+sId+"'),'spnShw'));"+"hideEm(getOneDescendant(wda('"+sId+"'), 'spnHd'));"+"hideEm(getOneDescendant(wda('"+sId+"'), 'divEDtls'));\" "+"style=display:none>&nbsp;"+htmlEnc(L_HdRpt)+"<img src=\""+getThmF("cllps.gif")+"\"></span>";sH+=htmlEnc(L_RptDtlsMsg).format(sSH);if(oES){sH+="<br><br><a href=\"http://watson.microsoft.com/dw/dcp.asp?LCID="+a_LCID+"\" target=_blank>"+htmlEnc(L_VwPrvcy)+"</a>"}sH+="</div>"}if(sErrorDetailHtml){sH+="<div id=divEDtls style=display:none>";if(Owa.Utility.isIE()){sH+="<span class=\"lnk cpy\" onclick=\"setData(getOneDescendant(wda('"+sId+"'), 'divErrBdy').innerText)\">"+"<img src=\""+getThmF("copy.gif")+"\">"+htmlEnc(L_CpyDtls)+"</span>"}sH+="<div id=divErrBdy>"+sErrorDetailHtml+"</div>";sH+="</div>"}var rgBtns=new Array();if(oES){rgBtns.push(L_SndRpt);oErrorContext.oES=oES}if(fnCb)oErrorContext.fnCb=fnCb;if(oCbCtx)oErrorContext.oCbCtx=oCbCtx;if(oRsp)oErrorContext.oCbRsp=oRsp;oErrorContext.oES=oES;rgBtns.push(L_Cls);var oDlg=new BtnDlg(sId,sH,sTtl?sTtl:L_ErrTtl,rgBtns,430,Owa.BUTTON_DIALOG_ICON.ERROR,onClsErrDlg,0,0,0,0,0,oErrorContext);wtda(sId).className+=" errDlg";oDlg.show();return oDlg}function onClsErrDlg(i,oErrCtx){if(oErrCtx.oES&&i==0)sndER(oErrCtx.oES);else if(oErrCtx.fnCb)oErrCtx.fnCb(oErrCtx.oCbRsp,oErrCtx.oCbCtx);return false}function sndER(oES){try{var oR=new oeReq("Error","ClientError",null,cbSndER);oR.add("ln",oES.sLn);oR.add("msg",oES.sMsg);oR.add("cs",oES.sCS);oR.add("fn",oES.sFn);oR.add("b",oES.sBdy);oR.send()}catch(e){}}function cbSndER(oR){if(oR.sErr)shwErrDlg(oR)}if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\dom/nodeenumerator.js".toLowerCase()])(function(){Owa.Dom.NodeEnumerator=function Owa$Dom$NodeEnumerator(oDomList,fnIsIgnorable){Owa.Dom.NodeEnumerator.constructBase(this);this._oDomList=oDomList;this._currentIndex=-1;this._fnIsIgnorable=fnIsIgnorable};Owa.Dom.NodeEnumerator.prototype.moveNext=function Owa$Dom$NodeEnumerator$moveNext(){for(this._currentIndex++;this._currentIndex<this._oDomList.length;this._currentIndex++){if(!this._fnIsIgnorable||!this._fnIsIgnorable(this._oDomList[this._currentIndex])){return true}}};Owa.Dom.NodeEnumerator.prototype.get_Current=function Owa$Dom$NodeEnumerator$get_Current(){if(this._currentIndex<0||this._currentIndex>=this._oDomList.length){throw"invalid operation, current position in enumerator is invalid"}return Owa.Dom.Node.wrapDomNode(this._oDomList[this._currentIndex])};Owa.Dom.NodeEnumerator.prototype.reset=function Owa$Dom$NodeEnumerator$reset(){this._currentIndex=-1};Owa.Dom.NodeEnumerator.createClass("Owa.Dom.NodeEnumerator",Owa.Collections.IEnumerator)})();g_fModuleLoaded[".\\dom/nodeenumerator.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/uicontrolbase.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");var _AttachedEventHandler=function _AttachedEventHandler$(oElement,sEventName,oDelegate){this._oElement=oElement;this._sEventName=sEventName;this._oDelegate=oDelegate};_AttachedEventHandler.prototype.equals=function _AttachedEventHandler$equals(oObject){return !!oObject&&this._oElement===oObject._oElement&&this._sEventName===oObject._sEventName&&(this._oDelegate===oObject._oDelegate||(this._oDelegate.equals&&this._oDelegate.equals(oObject._oDelegate)))};Owa.UIControls.UIControlBase=function Owa$UIControls$UIControlBase(oElement,oParent){if(oElement){this._initializeDomElement(oElement,oParent)}this._oAttachedEventHandler=new Owa.Collection.Set();Owa.UIControls.UIControlBase.constructBase(this)};var _oPrototype=Owa.UIControls.UIControlBase.prototype;_oPrototype._fRemoveElementInDisposing=false;_oPrototype._fDetachEventHandlersInDisposing=true;_oPrototype._fSupportUniqueId=true;_oPrototype._fClearTimeoutCallbackInDisposing=true;_oPrototype.set_RemoveElementInDisposing=function Owa$UIControls$UIControlBase$set_RemoveElementInDisposing(oValue){this._fRemoveElementInDisposing=oValue};_oPrototype.initialize=function Owa$UIControls$UIControlBase$initialize(oClientActionTable){Owa.UIControls.UIControlBase.callBase(this,"initialize")};_oPrototype.dispose=function Owa$UIControls$UIControlBase$dispose(){if(this._fDetachEventHandlersInDisposing){this._detachAllEventHanders()}if(this._oElement){this._oElement.dispose()}if(this.get_IsDomElementLoaded()){this._get_Element().detachAllEvents();if(this._fRemoveElementInDisposing){this._get_Element().remove(true)}}this._oElement=null;this._oParent=null;Owa.UIControls.UIControlBase.callBase(this,"dispose")};_oPrototype._detachAllEventHanders=function Owa$UIControls$UIControlBase$_detachAllEventHanders(){var rgAttachedEventHandlers=this._oAttachedEventHandler.toArray();for(var iIndex=0;iIndex<rgAttachedEventHandlers.length;iIndex++){var oAttachedEventHander=rgAttachedEventHandlers[iIndex];var oElement=oAttachedEventHander._oElement;var sEventName=oAttachedEventHander._sEventName;var oDelegate=oAttachedEventHander._oDelegate;oElement.detachEvent(sEventName,oDelegate)}this._oAttachedEventHandler.clear()};_oPrototype.get_Id=function Owa$UIControls$UIControlBase$get_Id(){return this._sId};_oPrototype.get_IsShown=function Owa$UIControls$UIControlBase$get_IsShown(){if(!this.get_IsDomElementLoaded())return false;return this._get_Element().get_IsShown()};_oPrototype.get_IsDomElementLoaded=function Owa$UIControls$UIControlBase$get_IsDomElementLoaded(){return this._get_Element()!=null};_oPrototype._initializeDomElement=function Owa$UIControls$UIControlBase$_initializeDomElement(oElement,oParent){this._oElement=oElement;this._oParent=oParent;if(oElement.get_Id())this._sId=oElement.get_Id()};_oPrototype._get_Parent=function Owa$UIControls$UIControlBase$_get_Parent(){return this._oParent};_oPrototype._get_Element=function Owa$UIControls$UIControlBase$_get_Element(){return this._oElement};_oPrototype._getDescendant=function Owa$UIControls$UIControlBase$_getDescendant(sId){if(!this.get_IsDomElementLoaded())throw"The DOM element hasn't been loaded yet.";return this._get_Element().getDescendantById(sId)};_oPrototype._getAttribute=function Owa$UIControls$UIControlBase$_getAttribute(sName){if(!this.get_IsDomElementLoaded())throw"The DOM element hasn't been loaded yet.";return this._get_Element().getAttribute(sName)};_oPrototype._getIntAttribute=function Owa$UIControls$UIControlBase$_getIntAttribute(sName){if(!this.get_IsDomElementLoaded())throw"The DOM element hasn't been loaded yet.";return this._get_Element().getIntAttribute(sName)};_oPrototype._setIntAttribute=function Owa$UIControls$UIControlBase$_setIntAttribute(sName,iValue){if(!this.get_IsDomElementLoaded())throw"The DOM element hasn't been loaded yet.";this._get_Element().setIntAttribute(sName,iValue)};_oPrototype._attachEvent=function Owa$UIControls$UIControlBase$_attachEvent(oElement,sEventName,fnFunction,oContext){var fn=Owa.Utility.createArgumentContextDelegate(this,fnFunction,oContext);oElement.attachEvent(sEventName,fn);this._oAttachedEventHandler.add(new _AttachedEventHandler(oElement,sEventName,fn));return fnFunction};_oPrototype._detachEvent=function Owa$UIControls$UIControlBase$_detachEvent(oElement,sEventName,fnFunction){var fn=Owa.Utility.createArgumentContextDelegate(this,fnFunction);oElement.detachEvent(sEventName,fn);this._oAttachedEventHandler.remove(new _AttachedEventHandler(oElement,sEventName,fn))};_oPrototype._cancelEvent=function Owa$UIControls$UIControlBase$_cancelEvent(oElement,sEventName){this._attachEvent(oElement,sEventName,cancelEvent)};function cancelEvent(oEvent){oEvent.preventDefault();oEvent.cancelBubble()}Owa.UIControls.UIControlBase.createClass("Owa.UIControls.UIControlBase",Owa.Components.Control)})();g_fModuleLoaded[".\\uicontrols/uicontrolbase.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/uicontrol.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");Owa.UIControls.UIControl=function Owa$UIControls$UIControl(oElement,oParent){Owa.UIControls.UIControl.constructBase(this,[oElement,oParent]);if(this._oSubPage){this._oSubPage.addResource(this)}else if(!!Owa.Components.Application){Owa.Components.Application.get_GlobalResourceManager().addResource(this)}};var _oPrototype=Owa.UIControls.UIControl.prototype;Owa.UIControls.UIControl.prototype.set_SubPage=function Owa$UIControls$UIControl$set_SubPage(oSubPage){this._oSubPage=oSubPage;if(this._oSubPage&&this.getResourceManager()==Owa.Components.Application.get_GlobalResourceManager()){this._oSubPage.addResource(this)}};Owa.UIControls.UIControl.prototype.get_SubPage=function Owa$UIControls$UIControl$get_SubPage(){if(!this._oSubPage){var oSubPage=Owa.UIControls.SubPage&&Owa.UIControls.SubPage.get_Instance();;this._oSubPage=oSubPage}return this._oSubPage};Owa.UIControls.UIControl.prototype.dispose=function Owa$UIControls$UIControl$dispose(){this._oSubPage=null;Owa.UIControls.UIControl.callBase(this,"dispose")};_oPrototype.setSubPageVariable=function Owa$UIControls$UIControl$setSubPageVariable(sName,oValue){return this.get_SubPage().setSubPageVariable(sName,oValue)};_oPrototype.getSubPageVariable=function Owa$UIControls$UIControl$getSubPageVariable(sName){return this.get_SubPage().getSubPageVariable(sName)};Owa.UIControls.UIControl.createClass("Owa.UIControls.UIControl",Owa.UIControls.UIControlBase)})();g_fModuleLoaded[".\\uicontrols/uicontrol.js".toLowerCase()]=1;Type.createNamespace("Owa.Components");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/clientaction.js".toLowerCase()])(function(){Owa.Components.ClientAction=function Owa$Components$ClientAction(sActionName,rgOnActionHandlers,rgOnStateChangeHandlers){this._sActionName=sActionName;this._fEnabled=true;this._oActionEventHandlers=new Owa.Utility.EventHandlerCollection();this._oStateChangeEventHandlers=new Owa.Utility.EventHandlerCollection();if(rgOnActionHandlers){for(var i=0;i<rgOnActionHandlers.length;i++){this._oActionEventHandlers.add(rgOnActionHandlers[i])}}if(rgOnStateChangeHandlers){for(var i=0;i<rgOnStateChangeHandlers.length;i++){this._oStateChangeEventHandlers.add(rgOnStateChangeHandlers[i])}}};Owa.Components.ClientAction.prototype.get_Name=function Owa$Components$ClientAction$get_Name(){return this._sActionName};Owa.Components.ClientAction.prototype.get_ActionEventHandlers=function Owa$Components$ClientAction$get_ActionEventHandlers(){return this._oActionEventHandlers};Owa.Components.ClientAction.prototype.get_StateChangeEventHandlers=function Owa$Components$ClientAction$get_StateChangeEventHandlers(){return this._oStateChangeEventHandlers};Owa.Components.ClientAction.prototype.set_Enabled=function Owa$Components$ClientAction$prototype$set_Enabled(fEnable){fEnable?this.enable():this.disable()};Owa.Components.ClientAction.prototype.disable=function Owa$Components$ClientAction$prototype$disable(){this._fEnabled=false;this._oStateChangeEventHandlers.dispatch({fEnabled:false})};Owa.Components.ClientAction.prototype.enable=function Owa$Components$ClientAction$prototype$enable(){this._fEnabled=true;this._oStateChangeEventHandlers.dispatch({fEnabled:true})};Owa.Components.ClientAction.prototype.triggerAction=function Owa$Components$ClientAction$prototype$triggerAction(oSender,oEvent,fIsHotkey){if(this._fEnabled){return this._oActionEventHandlers.dispatch(oSender,{sActionName:this._sActionName,oEvent:oEvent,fIsHotkey:fIsHotkey})}}})();g_fModuleLoaded[".\\components/clientaction.js".toLowerCase()]=1;Type.createNamespace("Owa.Components");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/clientactiontable.js".toLowerCase()])(function(){Owa.Components.ClientActionTable=function Owa$Components$ClientActionTable(fnDefaultHandler){this._fnDefaultHandler=fnDefaultHandler;this._oActionTables={}};Owa.Components.ClientActionTable.prototype.getAction=function Owa$Components$ClientActionTable$getAction(sActionName){if(!this._oActionTables[sActionName]){var fnDefaultHandler=this._fnDefaultHandler;this._oActionTables[sActionName]=new Owa.Components.ClientAction(sActionName);this._oActionTables[sActionName].get_ActionEventHandlers().add(function(oSender,eventArg){return fnDefaultHandler(sActionName,oSender)})}return this._oActionTables[sActionName]};Owa.Components.ClientActionTable.prototype.addAction=function Owa$Components$ClientActionTable$addAction(oAction){if(this._oActionTables[oAction.get_Name()]){throw new Error("action already registered")}else{this._oActionTables[oAction.get_Name()]=oAction}};Owa.Components.ClientActionTable.prototype.addAsAction=function Owa$Components$ClientActionTable$addAsAction(sActionName,rgOnActionHandlers,rgOnStateChangeHandlers){this.addAction(new Owa.Components.ClientAction(sActionName,rgOnActionHandlers,rgOnStateChangeHandlers));return this};Owa.Components.ClientActionTable.prototype.hasAction=function Owa$Components$ClientActionTable$hasAction(sActionName){return !!this._oActionTables[sActionName]}})();g_fModuleLoaded[".\\components/clientactiontable.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/button.js".toLowerCase()])(function(){var ButtonDivStyles=[[Owa.Strings.CssClass.ButtonDefault,Owa.Strings.CssClass.ButtonDisabled,Owa.Strings.CssClass.ButtonDown],[Owa.Strings.CssClass.ToolbarButtonHoverable,Owa.Strings.CssClass.ToolbarButtonDisabled,Owa.Strings.CssClass.ToolbarButtonDown],[Owa.Strings.CssClass.MenuButtonDefault,Owa.Strings.CssClass.MenuButtonDisabled,Owa.Strings.CssClass.MenuButtonDown],[Owa.Strings.CssClass.NotificationButtonDefault,'',Owa.Strings.CssClass.NotificationButtonDown],[Owa.Strings.CssClass.OptionsSaveButtonHoverable,Owa.Strings.CssClass.OptionsSaveButtonDisabled,Owa.Strings.CssClass.OptionsSaveButtonDown]];var States={Default:0,Raised:0,Disable:1,Pressed:2};var StyleGroup={Button:0,ToolbarButton:1,MenuItemButton:2,NotificationButton:3,OptionsSaveButton:4};var TOOLBAR_ICON_ID="imgToolbarButtonIcon";Owa.UIControls.Button=function Owa$UIControls$Button(oElement,oParent){Owa.UIControls.Button.constructBase(this,[oElement,oParent]);this._clientAction=null;if(this._getIntAttribute(Owa.Strings.Attributes.IsToolbarButton)==1){this._styleGroup=StyleGroup.ToolbarButton}else if(this._getIntAttribute(Owa.Strings.Attributes.IsMenuItem)==1){this._styleGroup=StyleGroup.MenuItemButton}else if(this._getIntAttribute(Owa.Strings.Attributes.IsNotificationButton)==1){this._styleGroup=StyleGroup.NotificationButton}else if(this._getIntAttribute(Owa.Strings.Attributes.IsOptionsSaveButton)==1){this._styleGroup=StyleGroup.OptionsSaveButton}else{this._styleGroup=StyleGroup.Button}};Owa.UIControls.Button.create=function Owa$UIControls$Button$create(oSubPage,oElement,oParent){var oButton;if(oElement.getAttribute(Owa.Strings.Attributes.SubMenuId)){oButton=new Owa.UIControls.MenuButton(oElement,oParent)}else if(oElement.getAttribute(Owa.Strings.Attributes.ToggleSiblingIds)){oButton=new Owa.UIControls.ToggleButton(oElement,oParent)}else if(oElement.getAttribute(Owa.Strings.Attributes.IsSticky)){oButton=new Owa.UIControls.StickyButton(oElement,oParent)}else if(oElement.getAttribute(Owa.Strings.Attributes.SwapSiblingIds)){oButton=new Owa.UIControls.SwapButton(oElement,oParent)}else if(oElement.getAttribute(Owa.Strings.Attributes.ComboMenuId)){oButton=new Owa.UIControls.ComboButton(oElement,oParent)}else{oButton=new Owa.UIControls.Button(oElement,oParent)}oButton.set_SubPage(oSubPage);return oButton};Owa.UIControls.Button.prototype.initialize=function Owa$UIControls$Button$initialize(oClientActionTable){if(oClientActionTable.getAction(this._get_ClientActionId())){this._clientAction=oClientActionTable.getAction(this._get_ClientActionId());this._clientAction.get_StateChangeEventHandlers().add(Owa.Utility.createDelegate(this,this._onClientActionStateChanged))}this._attachEvent(this._get_Element(),"click",this._onClick);this._attachEvent(this._get_Element(),"keydown",this._onKeyDown);this._attachEvent(this._get_Element(),"keypress",this._onKeyPress);var buttonFrame=this._get_ButtonElement();this._attachEvent(buttonFrame,"click",this._onClick);this._attachEvent(buttonFrame,"mousedown",this._onMouseDown);this._attachEvent(buttonFrame,"mouseup",this._onMouseUp);this._attachEvent(this._get_Element(),"mouseout",this._onMouseUp);if(this._get_ButtonElement().hasCssClass(ButtonDivStyles[this._styleGroup][States.Disable])||this._get_Element().hasCssClass(ButtonDivStyles[this._styleGroup][States.Disable])){this._setIntAttribute(Owa.Strings.Attributes.IsDisabled,1)}};Owa.UIControls.Button.prototype.dispose=function Owa$UIControls$Button$dispose(){this._get_Element().detachAllEvents();var buttonFrame=this._get_ButtonElement();if(buttonFrame){buttonFrame.detachAllEvents()}Owa.UIControls.Button.callBase(this,'dispose')};Owa.UIControls.Button.prototype.click=function Owa$UIControls$Button$click(){if(!this.get_IsDisabled()){this._get_Element().click()}};Owa.UIControls.Button.prototype.getToolbarIcon=function Owa$UIControls$Button$getToolbarIcon(){if(StyleGroup.ToolbarButton==this._styleGroup){var oButtonElement=this._get_ButtonElement();if(oButtonElement){return oButtonElement.getDescendantById(TOOLBAR_ICON_ID)}}return 0};Owa.UIControls.Button.prototype._get_ClientActionId=function Owa$UIControls$Button$_get_ClientActionId(){return this.get_Id()};Owa.UIControls.Button.prototype.get_IsDisabled=function Owa$UIControls$Button$get_IsDisabled(){return this._getIntAttribute(Owa.Strings.Attributes.IsDisabled)==1};Owa.UIControls.Button.prototype.set_IsDisabled=function Owa$UIControls$Button$set_IsDisabled(fValue){if(fValue){addAndRemoveClasses(this._get_ButtonElement(),ButtonDivStyles[this._styleGroup][States.Disable],ButtonDivStyles[this._styleGroup]);if(this.get_IsPushed())this._get_ButtonElement().addCssClass(ButtonDivStyles[this._styleGroup][States.Pressed])}else{addAndRemoveClasses(this._get_ButtonElement(),ButtonDivStyles[this._styleGroup][this.get_IsPushed()?States.Pressed:States.Raised],ButtonDivStyles[this._styleGroup])}this._setIntAttribute(Owa.Strings.Attributes.IsDisabled,fValue?1:0)};Owa.UIControls.Button.prototype.get_IsPushed=function Owa$UIControls$Button$get_IsPushed(){return this._getIntAttribute(Owa.Strings.Attributes.ButtonPushed)==1};Owa.UIControls.Button.prototype.set_IsPushed=function Owa$UIControls$Button$set_IsPushed(fValue){if(this.get_IsDisabled()){return}if(this._getIntAttribute(Owa.Strings.Attributes.ButtonAlwaysPushed)==1){return}if(fValue){this._press()}else{this._release()}this._setIntAttribute(Owa.Strings.Attributes.ButtonPushed,fValue?1:0)};Owa.UIControls.Button.prototype.get_IsShown=function Owa$UIControls$Button$get_IsShown(){return this._get_ButtonFrame().get_IsShown()};Owa.UIControls.Button.prototype.set_IsShown=function Owa$UIControls$Button$set_IsShown(fValue){this._get_ButtonFrame().set_IsShown(fValue)};Owa.UIControls.Button.prototype.get_MenuReferencePosition=function Owa$UIControls$Button$get_MenuReferencePosition(fRtl){var oDiv=this._get_ButtonFrame();var iX=fRtl?(oDiv.get_DocumentLeft()+oDiv.get_OffsetWidth()):oDiv.get_DocumentLeft();var iY=oDiv.get_DocumentTop()+oDiv.get_OffsetHeight();return{"iX":iX,"iY":iY}};Owa.UIControls.Button.prototype._onMouseDown=function Owa$UIControls$Button$_onMouseDown(oEvent){if(!this.get_IsDisabled()&&!this.get_IsPushed()){this._press()}};Owa.UIControls.Button.prototype._onMouseUp=function Owa$UIControls$Button$_onMouseUp(oEvent){if(!this.get_IsDisabled()&&!this.get_IsPushed()){this._release()}};Owa.UIControls.Button.prototype._onClick=function Owa$UIControls$Button$_onClick(oEvent){oEvent.cancelBubble();oEvent.preventDefault();if(!this.get_IsDisabled()){if(!this.get_IsPushed()){this._release()}this._clientAction.triggerAction(oEvent.get_CurrentTarget(),oEvent)}};Owa.UIControls.Button.prototype._onKeyDown=function Owa$UIControls$Button$_onKeyDown(oEvent){if(oEvent.get_KeyCodeForKeyUpDown()==Owa.KeyCodes.ENTER){oEvent.preventDefault()}};Owa.UIControls.Button.prototype._onKeyPress=function Owa$UIControls$Button$_onKeyPress(oEvent){oEvent.preventDefault()};Owa.UIControls.Button.prototype._onClientActionStateChanged=function Owa$UIControls$Button$_onClientActionStateChanged(oState){this.set_IsDisabled(!oState.fEnabled)};Owa.UIControls.Button.prototype._press=function Owa$UIControls$Button$_press(){if(!this.get_IsDisabled()){addAndRemoveClasses(this._get_ButtonElement(),ButtonDivStyles[this._styleGroup][States.Pressed],ButtonDivStyles[this._styleGroup])}};Owa.UIControls.Button.prototype._release=function Owa$UIControls$Button$_release(){if(!this.get_IsDisabled()){addAndRemoveClasses(this._get_ButtonElement(),ButtonDivStyles[this._styleGroup][States.Raised],ButtonDivStyles[this._styleGroup])}};Owa.UIControls.Button.prototype._get_ButtonElement=function Owa$UIControls$Button$_get_ButtonElement(){if(this._getIntAttribute(Owa.Strings.Attributes.IsNotificationButton)==1){return this._get_Element()}else{return this._get_Element().get_ParentElement()}};Owa.UIControls.Button.prototype._get_ButtonFrame=function Owa$UIControls$Button$_get_ButtonFrame(){if(this._getIntAttribute(Owa.Strings.Attributes.HasBigButtonWrapper)==1){return this._get_ButtonElement().get_ParentElement()}else{return this._get_ButtonElement()}};function addAndRemoveClasses(oElement,sClassToAdd,rgClassesToRemove){var rgClasses=oElement.get_CssClasses();for(var i=0;i<rgClassesToRemove.length;i++){rgClasses.remove(rgClassesToRemove[i])}rgClasses.add(sClassToAdd);oElement.set_CssClasses(rgClasses)}Owa.UIControls.Button.createClass("Owa.UIControls.Button",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/button.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/stickybutton.js".toLowerCase()])(function(){Owa.UIControls.StickyButton=function Owa$UIControls$StickyButton(oDomElement,oParentControl){Owa.UIControls.StickyButton.constructBase(this,[oDomElement,oParentControl])};Owa.UIControls.StickyButton.prototype._onClick=function Owa$UIControls$StickyButton$_onClick(oEvent){oEvent.cancelBubble();if(this.get_IsDisabled()){return}if(!this.get_IsPushed()){this.set_IsPushed(true)}else{this.set_IsPushed(false)}this._clientAction.triggerAction(oEvent.get_Target(),oEvent)};Owa.UIControls.StickyButton.createClass("Owa.UIControls.StickyButton",Owa.UIControls.Button)})();g_fModuleLoaded[".\\uicontrols/stickybutton.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/swapbutton.js".toLowerCase()])(function(){Owa.UIControls.SwapButton=function Owa$UIControls$SwapButton(oDomElement,oParentControl){Owa.UIControls.SwapButton.constructBase(this,[oDomElement,oParentControl]);this._rgSwapButtons=[]};Owa.UIControls.SwapButton.prototype.initialize=function Owa$UIControls$SwapButton$initialize(oClientActionTable){Owa.UIControls.SwapButton.callBase(this,'initialize',[oClientActionTable]);if(this._get_Parent()){var rgSwapSiblingIds=this._getAttribute(Owa.Strings.Attributes.SwapSiblingIds).split(';');for(var iSwapSibling=0;iSwapSibling<rgSwapSiblingIds.length;++iSwapSibling){var oControl=this._get_Parent().getChildButton(rgSwapSiblingIds[iSwapSibling]);if(oControl){this._rgSwapButtons.add(oControl)}}}};Owa.UIControls.SwapButton.prototype._onClick=function Owa$UIControls$SwapButton$_onClick(oEvent){if(this.get_IsDisabled()){return}this.set_IsShown(false);for(var iSwapButton=0;iSwapButton<this._rgSwapButtons.length;++iSwapButton){this._rgSwapButtons[iSwapButton].set_IsShown(!this._rgSwapButtons[iSwapButton].get_IsShown())}Owa.UIControls.SwapButton.callBase(this,'_onClick',[oEvent])};Owa.UIControls.SwapButton.createClass("Owa.UIControls.SwapButton",Owa.UIControls.Button)})();g_fModuleLoaded[".\\uicontrols/swapbutton.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/togglebutton.js".toLowerCase()])(function(){Owa.UIControls.ToggleButton=function Owa$UIControls$ToggleButton(oDomElement,oParentControl){Owa.UIControls.ToggleButton.constructBase(this,[oDomElement,oParentControl]);this._rgToggleSiblingIds=[]};Owa.UIControls.ToggleButton.prototype.initialize=function Owa$UIControls$ToggleButton$initialize(oClientActionTable){Owa.UIControls.ToggleButton.callBase(this,'initialize',[oClientActionTable]);var sToggleIds=this._getAttribute(Owa.Strings.Attributes.ToggleSiblingIds);if(sToggleIds){this._rgToggleSiblingIds=sToggleIds.split(';')}};Owa.UIControls.ToggleButton.prototype._onClick=function Owa$UIControls$ToggleButton$_onClick(oEvent){oEvent.cancelBubble();if(this.get_IsDisabled()){return}if(!this.get_IsPushed()){this.set_IsPushed(true);var oParent=this._get_Parent();if(oParent&&oParent.getChildButton){for(var iToggleSibling=0;iToggleSibling<this._rgToggleSiblingIds.length;++iToggleSibling){var oControl=this._get_Parent().getChildButton(this._rgToggleSiblingIds[iToggleSibling]);if(oControl){if(oControl.get_IsPushed()){oControl.set_IsPushed(false)}}}}}else{this.set_IsPushed(false)}this._clientAction.triggerAction(oEvent.get_Target(),oEvent)};Owa.UIControls.ToggleButton.createClass("Owa.UIControls.ToggleButton",Owa.UIControls.StickyButton)})();g_fModuleLoaded[".\\uicontrols/togglebutton.js".toLowerCase()]=1;var UITest_Popup_Flag=2;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/popup.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");var ON_DATABIND="onDataBind";var ON_PRESHOW="onPreShow";var ON_CLOSE="onClose";var oTextBox=null;var iShownPopupCount=0;Owa.UIControls.Popup=function Owa$UIControls$Popup(oElement,oParent,fDisableOffscreenBox){Owa.UIControls.Popup.constructBase(this,[oElement,oParent]);this.fIsOpen=0;this._fIsInitialized=0;this._fSuppressClose=0;this._fAutomaticEnableClose=1;this._fDisableOffscreenBox=fDisableOffscreenBox;if(oParent&&Owa.UIControls.Popup.isInstance(oParent)){this._oParentPopup=oParent}};Owa.UIControls.Popup.prototype.initialize=function Owa$UIControls$Popup$initialize(){this._attachEvent(Owa.Dom.Window.get_Current(),"resize",this.close);if(!oTextBox){initializeTextBox()}this._attachEvent(this._get_Element(),"mousedown",this._onMouseDown);this._attachEvent(this._get_Element(),"selectstart",this._onSelectStart);this._attachEvent(this._get_Element(),"click",this._forwardEvent);var oDomParent=this._get_Element().get_ParentElement();while(oDomParent){if(Owa.Dom.Element.isInstance(oDomParent)&&(oDomParent.get_OverflowX()==Owa.Style.Overflow.Scroll||oDomParent.get_OverflowX()==Owa.Style.Overflow.Auto||oDomParent.get_OverflowY()==Owa.Style.Overflow.Scroll||oDomParent.get_OverflowY()==Owa.Style.Overflow.Auto||oDomParent.get_TagName().toLowerCase()=="body")){break}else{oDomParent=oDomParent.get_ParentElement()}}if(oDomParent){this._get_Element().set_PositionalParent(oDomParent)}else{var oDocument=this._get_Element().get_OwnerDocument();this._get_Element().set_PositionalParent(oDocument.get_Body())}this._fIsInitialized=1};Owa.UIControls.Popup.prototype.get_IsInitialized=function Owa$UIControls$Popup$get_IsInitialized(){return this._fIsInitialized};Owa.UIControls.Popup.prototype.dispose=function Owa$UIControls$Popup$dispose(){this.close();if(this.get_IsDomElementLoaded()){this._get_Element()._get_DomNode().oOriginalParent=null;this._get_Element().dispose()}Owa.UIControls.Popup.callBase(this,"dispose")};Owa.UIControls.Popup.prototype.get_OnDataBind=function Owa$UIControls$Popup$get_OnDataBind(){return this._getEventHandlerCollection(ON_DATABIND)};Owa.UIControls.Popup.prototype.get_OnPreShow=function Owa$UIControls$Popup$get_OnPreShow(){return this._getEventHandlerCollection(ON_PRESHOW)};Owa.UIControls.Popup.prototype.get_OnClose=function Owa$UIControls$Popup$get_OnClose(){return this._getEventHandlerCollection(ON_CLOSE)};Owa.UIControls.Popup.prototype.showRelative=function Owa$UIControls$Popup$showRelative(iX,iY){var oOriginalParent=this._get_Element().getExpando("_originalParent");iX+=oOriginalParent.get_DocumentLeft()+(g_fRtl?oOriginalParent.get_OffsetWidth():0);iY+=oOriginalParent.get_DocumentTop();this.show(iX,iY)};Owa.UIControls.Popup.prototype.get_Width=function Owa$UIControls$Popup$get_Width(){var oElement=this._get_Element();var iElementWidth;if(!oElement.get_IsShown()){oElement.set_IsShown(true);iElementWidth=oElement.get_OffsetWidth();oElement.set_IsShown(false)}else{iElementWidth=oElement.get_OffsetWidth()}return iElementWidth};Owa.UIControls.Popup.prototype.showUnder=function Owa$UIControls$Popup$showUnder(oElement,iOffsetY,fFarCorner){var fAlignRightCorner=(!g_fRtl&&fFarCorner)||(g_fRtl&&!fFarCorner);var iX=oElement.get_DocumentLeft()+(fAlignRightCorner?oElement.get_OffsetWidth():0);var iY=oElement.get_DocumentTop()+oElement.get_OffsetHeight()+(iOffsetY||0);this.show(iX,iY,fFarCorner)};Owa.UIControls.Popup.prototype.show=function Owa$UIControls$Popup$show(iX,iY,fFarCorner){this._dispatchEvent(ON_DATABIND,this);var oContext=new Object();oContext.iX=iX;oContext.iY=iY;oContext.fFarCorner=!!fFarCorner;var oParent=this._get_Element().get_ParentElement();if(oParent){oContext.iY=oContext.iY-oParent.get_DocumentTop()+oParent.get_ScrollTop()}UITest_Popup_Flag=1;this._iTShowTimer=this._setTimeout(this._tShow,1,oContext)};Owa.UIControls.Popup.prototype._tShow=function Owa$UIControls$Popup$_tShow(oContext){this._iTShowTimer=0;var oElement=this._get_Element();oElement.set_IsShown(1);iShownPopupCount++;this.fIsOpen=1;this._dispatchEvent(ON_PRESHOW,this);oElement.moveToTop();var iX=(oContext.fFarCorner^g_fRtl)?oContext.iX-oElement.get_OffsetWidth():oContext.iX;var iY=oContext.iY;oElement.set_PositionalLeft(Owa.Utility.getVisiblePositionX(oElement,iX,g_fRtl));oElement.set_PositionalTop(Owa.Utility.getVisiblePositionY(oElement,iY));this._addTextBoxEventHandlers();this._enableClose();UITest_Popup_Flag=2};Owa.UIControls.Popup.prototype.close=function Owa$UIControls$Popup$close(){if(this._iTShowTimer){this._clearTimeout(this._iTShowTimer);this._iTShowTimer=0;UITest_Popup_Flag=2}if(this.fIsOpen){this._get_Element().set_IsShown(0);iShownPopupCount--;this.fIsOpen=0;this._removeTextBoxEventHandlers();this._dispatchEvent(ON_CLOSE,this)}};Owa.UIControls.Popup.prototype._suppressClose=function Owa$UIControls$Popup$_suppressClose(fAutomaticEnableClose){this._fSuppressClose=1;this._fAutomaticEnableClose=this._fAutomaticEnableClose&&fAutomaticEnableClose;if(this._oParentPopup){this._oParentPopup._suppressClose(fAutomaticEnableClose)}};Owa.UIControls.Popup.prototype._enableClose=function Owa$UIControls$Popup$_enableClose(){this._fSuppressClose=0;this._fAutomaticEnableClose=1;if(!this._fDisableOffscreenBox){setFocusToTextBox()}};Owa.UIControls.Popup.prototype._onBlurTextBox=function Owa$UIControls$Popup$_onBlurTextBox(){this._closeOnBlur();clearFocusFlag()};Owa.UIControls.Popup.prototype._closeOnBlur=function Owa$UIControls$Popup$_closeOnBlur(){if(this.fIsOpen&&!this._fSuppressClose)this.close();if(this.fIsOpen&&this._fAutomaticEnableClose)this._setTimeout(this._enableClose,1)};Owa.UIControls.Popup.prototype._onMouseDown=function Owa$UIControls$Popup$_onMouseDown(e){this._suppressClose(true);this._forwardEvent(e)};Owa.UIControls.Popup.prototype._onKeyDown=function Owa$UIControls$Popup$_onKeyDown(e){this._suppressClose(true);this._forwardEvent(e);e.cancelBubble()};Owa.UIControls.Popup.prototype._onSelectStart=function Owa$UIControls$Popup$_onSelectStart(e){e.preventDefault();e.cancelBubble()};Owa.UIControls.Popup.prototype._forwardEvent=function Owa$UIControls$Popup$_forwardEvent(e){var sEventType="on"+e.get_Type();if(this[sEventType])this[sEventType](e)};Owa.UIControls.Popup.prototype._addTextBoxEventHandlers=function Owa$UIControls$Popup$_addTextBoxEventHandlers(){this._fnOnBlur=this._attachEvent(oTextBox,"blur",this._onBlurTextBox);this._fnOnKeyDown=this._attachEvent(oTextBox,"keydown",this._onKeyDown)};Owa.UIControls.Popup.prototype._removeTextBoxEventHandlers=function Owa$UIControls$Popup$_removeTextBoxEventHandlers(){if(this._fnOnBlur){this._detachEvent(oTextBox,"blur",this._fnOnBlur);this._fnOnBlur=null}if(this._fnOnKeyDown){this._detachEvent(oTextBox,"keydown",this._fnOnKeyDown);this._fnOnKeyDown=null}if(!this._oParentPopup){clearFocusFlag()}};Owa.UIControls.Popup.get_HasAnyPopupShown=function Owa$UIControls$Popup$get_HasAnyShown(){return iShownPopupCount!=0};function initializeTextBox(){var oDocument=Owa.Dom.Document.get_Current();oTextBox=oDocument.createElement("input");oTextBox.set_Type(Owa.Dom.Input.Type.Text);oTextBox.addCssClass("offscreen");oDocument.appendChild(oTextBox)}var HAS_FOCUS_ATTRIBUTE="_hasFocus";function setFocusToTextBox(){if(oTextBox.getBoolAttribute(HAS_FOCUS_ATTRIBUTE)){return}var oBody=oTextBox.get_OwnerDocument().get_Body();oTextBox.set_Top(oBody.get_ScrollTop());oTextBox.set_Left(oBody.get_ScrollLeft());oTextBox.focus();oTextBox.focus();oTextBox.setBoolAttribute(HAS_FOCUS_ATTRIBUTE,true);oTextBox.set_Top(null);oTextBox.set_Left(null)}function clearFocusFlag(){oTextBox.setBoolAttribute(HAS_FOCUS_ATTRIBUTE,false)}Owa.UIControls.Popup.createClass("Owa.UIControls.Popup",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/popup.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/menubutton.js".toLowerCase()])(function(){var _oCurrentPopupButton=null;var ON_BEFORE_POPUP="onBeforePopup";Owa.UIControls.MenuButton=function Owa$UIControls$MenuButton(oElement,oParent){Owa.UIControls.MenuButton.constructBase(this,[oElement,oParent]);this._oSubMenuPopup=null;this._oComboDropDownButton=null};Owa.UIControls.MenuButton.prototype.initialize=function Owa$UIControls$MenuButton$initialize(oClientActionTable){Owa.UIControls.MenuButton.callBase(this,'initialize',[oClientActionTable]);this._oSubMenuPopup=new Owa.UIControls.Popup(this._get_Element().get_ParentElement().getDescendantById(this._getAttribute(Owa.Strings.Attributes.SubMenuId)));this._oSubMenuPopup.set_SubPage(this.get_SubPage());var sComboDropDownId=this._getAttribute(Owa.Strings.Attributes.ComboDropDownId);if(sComboDropDownId){this._oComboDropDownButton=this._get_Parent().getChildButton(sComboDropDownId)}};Owa.UIControls.MenuButton.prototype.dispose=function Owa$UIControls$MenuButton$dispose(){this._oSubMenuPopup.dispose();if(this==_oCurrentPopupButton)_oCurrentPopupButton=null;Owa.UIControls.MenuButton.callBase(this,'dispose')};Owa.UIControls.MenuButton.prototype.get_OnBeforePopup=function Owa$UIControls$MenuButton$get_OnBeforePopup(){return this._getEventHandlerCollection(ON_BEFORE_POPUP)};Owa.UIControls.MenuButton.prototype._showPopup=function Owa$UIControls$MenuButton$_showPopup(){this._dispatchEvent(ON_BEFORE_POPUP,this);var oPosition=(this._oComboDropDownButton?this._oComboDropDownButton:this).get_MenuReferencePosition(g_fRtl);this._get_SubMenuPopup().show(oPosition.iX,oPosition.iY)};Owa.UIControls.MenuButton.prototype._get_SubMenuPopup=function Owa$UIControls$MenuButton$_get_SubMenuPopup(){if(!this._oSubMenuPopup.get_IsInitialized()){this._oSubMenuPopup.initialize();this._oSubMenuPopup.get_OnClose().add(this._createCallback(this._onDropDownClose))}return this._oSubMenuPopup};Owa.UIControls.MenuButton.prototype._onClick=function Owa$UIControls$MenuButton$_onClick(oEvent){oEvent.cancelBubble();oEvent.preventDefault();if(!this.get_IsDisabled()){this.show()}};Owa.UIControls.MenuButton.prototype._onDropDownClose=function Owa$UIControls$MenuButton$_onDropDownClose(oEvent){this.set_IsPushed(false);if(this._oComboDropDownButton){this._oComboDropDownButton.set_IsPushed(false)}};Owa.UIControls.MenuButton.prototype.show=function Owa$UIControls$MenuButton$show(){if(_oCurrentPopupButton){_oCurrentPopupButton.hide()}var oDoc=this._get_Element().get_OwnerDocument();if(this._get_SubMenuPopup().get_Id()=="tblspellcheckMnu"){if(g_SplLng==SP_RESET)g_SplLng=a_iSp;var oDivSplExpndo=$("divSpl").getExpando("oSpellCheckerComboBox");oDivSplExpndo.set_SelectedValue(g_SplLng);oDivSplExpndo.oSpSel=crtSelTxR()}else{this._attachEvent(oDoc,"mouseout",this._onDocumentMouseOut)}this._attachEvent(oDoc,"mouseup",this._onDocumentMouseUp);_oCurrentPopupButton=this;this.set_IsPushed(true);if(this._oComboDropDownButton){this._oComboDropDownButton.set_IsPushed(true)}this._showPopup()};Owa.UIControls.MenuButton.prototype.hide=function Owa$UIControls$MenuButton$hide(){if(_oCurrentPopupButton==this)_oCurrentPopupButton=null;this._get_SubMenuPopup().close();var oDoc=this._get_Element().get_OwnerDocument();this._detachEvent(oDoc,"mouseout",this._onDocumentMouseOut);this._detachEvent(oDoc,"mouseup",this._onDocumentMouseUp)};Owa.UIControls.MenuButton.prototype._onDocumentMouseUp=function Owa$UIControls$MenuButton$_onDocumentMouseUp(oEvent){if(this._get_SubMenuPopup().fIsOpen&&!this._get_SubMenuPopup()._fSuppressClose){this.hide()}};Owa.UIControls.MenuButton.prototype._onDocumentMouseOut=function Owa$UIControls$MenuButton$_onDocumentMouseOut(oEvent){if(oEvent.get_Target()==null){this.hide()}};Owa.UIControls.MenuButton.get_CurrentPopupButton=function Owa$UIControls$MenuButton$get_CurrentPopupButton(){return _oCurrentPopupButton};Owa.UIControls.MenuButton.hideAnyPopupMenu=function Owa$UIControls$MenuButton$hideAnyPopupMenu(){if(_oCurrentPopupButton)_oCurrentPopupButton.hide()};Owa.UIControls.MenuButton.createClass("Owa.UIControls.MenuButton",Owa.UIControls.StickyButton)})();g_fModuleLoaded[".\\uicontrols/menubutton.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/combobutton.js".toLowerCase()])(function(){Owa.UIControls.ComboButton=function Owa$UIControls$ComboButton(oElement,oParent){Owa.UIControls.ComboButton.constructBase(this,[oElement,oParent]);this._oComboDropDownTwisty=null};Owa.UIControls.ComboButton.prototype.initialize=function Owa$UIControls$ComboButton$initialize(oClientActionTable){Owa.UIControls.ComboButton.callBase(this,'initialize',[oClientActionTable]);this._oComboDropDownTwisty=this._get_Parent().getChildButton(this._getAttribute(Owa.Strings.Attributes.ComboMenuId))};Owa.UIControls.ComboButton.prototype.dispose=function Owa$UIControls$ComboButton$dispose(){Owa.UIControls.ComboButton.callBase(this,'dispose');this._oComboDropDownTwisty=null};Owa.UIControls.ComboButton.prototype.set_IsDisabled=function Owa$UIControls$ComboButton$set_IsDisabled(fValue){Owa.UIControls.ComboButton.callBase(this,'set_IsDisabled',[fValue]);this._oComboDropDownTwisty.set_IsDisabled(fValue)};Owa.UIControls.ComboButton.prototype.set_IsShown=function Owa$UIControls$ComboButton$set_IsShown(fValue){Owa.UIControls.ComboButton.callBase(this,'set_IsShown',[fValue]);this._oComboDropDownTwisty.set_IsShown(fValue)};Owa.UIControls.ComboButton.prototype.set_IsPushed=function Owa$UIControls$ComboButton$set_IsPushed(fValue,fIgnoreTwisty){Owa.UIControls.ComboButton.callBase(this,'set_IsPushed',[fValue]);if(!fIgnoreTwisty){this._oComboDropDownTwisty.set_IsPushed(fValue)}};Owa.UIControls.ComboButton.prototype.set_ComboEnabled=function Owa$UIControls$ComboButton$set_ComboEnabled(fEnabled){this._oComboDropDownTwisty.set_IsDisabled(!fEnabled)};Owa.UIControls.ComboButton.createClass("Owa.UIControls.ComboButton",Owa.UIControls.Button)})();g_fModuleLoaded[".\\uicontrols/combobutton.js".toLowerCase()]=1;Type.createNamespace("Owa.UIControls");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/toolbar.js".toLowerCase()])(function(){Owa.UIControls.Toolbar=function Owa$UIControls$Toolbar(oDomElement,oParentControl){Owa.UIControls.Toolbar.constructBase(this,[oDomElement,oParentControl]);this._oBtns={}};Owa.UIControls.Toolbar.prototype.initialize=function Owa$UIControls$Toolbar$initialize(oClientActionTable){var oControls=this._oBtns;var rgBtns=[];var rgQueue=[];rgQueue.add(this._get_Element());while(rgQueue.length>0){var oDomElement=rgQueue[0];rgQueue.removeAt(0);var enumerator=oDomElement.get_Enumerator();while(enumerator.moveNext()){var oChild=enumerator.get_Current();if(oChild.get_NodeType()!=Owa.NodeType.Element){continue}var sType=oChild.getAttribute(Owa.Strings.Attributes.Type);if(sType==Owa.Strings.Names.LinkButton||sType==Owa.Strings.Names.LinkNotificationButton){var control=Owa.UIControls.Button.create(this.get_SubPage(),oChild,this);if(control){oControls[control.get_Id()]=control;rgBtns.add(control)}else{rgQueue.add(oChild)}}else{rgQueue.add(oChild)}}}for(var iControl=0;iControl<rgBtns.length;++iControl){rgBtns[iControl].initialize(oClientActionTable)}};Owa.UIControls.Toolbar.prototype.dispose=function Owa$UIControls$Toolbar$dispose(){this._get_Element().detachAllEvents();for(var sId in this._oBtns){this._oBtns[sId].dispose()}Owa.UIControls.Toolbar.callBase(this,"dispose")};Owa.UIControls.Toolbar.prototype.getChildButton=function Owa$UIControls$Toolbar$getChildButton(sId){return this._oBtns[sId]};Owa.UIControls.Toolbar.createClass("Owa.UIControls.Toolbar",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/toolbar.js".toLowerCase()]=1;Type.createNamespace("Owa.Components");var enblB;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/ToolbarCollection.js".toLowerCase()])(function(){Owa.Components.ToolbarCollection=function Owa$Components$ToolbarCollection(oSubPage){Owa.Components.ToolbarCollection.constructBase(this);this._rgToolbars=null;this._oSubPage=oSubPage};Owa.Components.ToolbarCollection.get=function Owa$Components$ToolbarCollection$get(oSubPage){var oToolbarCollection=oSubPage._oToolbarCollection;if(!oToolbarCollection)oToolbarCollection=Owa.Components.ToolbarCollection.create(oSubPage);return oToolbarCollection};Owa.Components.ToolbarCollection.create=function Owa$Components$ToolbarCollection$create(oSubPage){var oToolbarCollection=new Owa.Components.ToolbarCollection(oSubPage);oSubPage._oToolbarCollection=oSubPage.addResource(oToolbarCollection);return oToolbarCollection};Owa.Components.ToolbarCollection.get_Current=function Owa$Components$ToolbarCollection$get_Current(){return this.get(Owa.UIControls.SubPage.get_Instance())};var _oPrototype=Owa.Components.ToolbarCollection.prototype;_oPrototype._fSupportUniqueId=true;Owa.Components.ToolbarCollection.prototype.addToolbars=function Owa$Components$ToolbarCollection$addToolbars(rgToolbarId,oClientActionTable){if(this._rgToolbars==null){this._rgToolbars=[]}for(var i=0;i<rgToolbarId.length;i++){var oElement=this._oSubPage._getDescendant(rgToolbarId[i]);if(oElement){var oToolbar=new Owa.UIControls.Toolbar(oElement);oToolbar.set_SubPage(this._oSubPage);oToolbar.initialize(oClientActionTable);this._rgToolbars.push(oToolbar)}}};Owa.Components.ToolbarCollection.prototype.getButton=function Owa$Components$ToolbarCollection$getButton(sId){if(this._rgToolbars==null){return null}for(var i=0;i<this._rgToolbars.length;i++){var oButton=this._rgToolbars[i].getChildButton(sId);if(oButton){return oButton}}return null};Owa.Components.ToolbarCollection.prototype.set_IsButtonShown=function Owa$Components$ToolbarCollection$set_IsButtonShown(sId,fShow){var oButton=this.getButton(sId);if(!oButton)return;oButton.set_IsShown(fShow?1:0)};Owa.Components.ToolbarCollection.prototype.set_IsButtonDisabled=function Owa$Components$ToolbarCollection$set_IsButtonDisabled(sId,fDisabled){var oButton=this.getButton(sId);if(!oButton)return;oButton.set_IsDisabled(fDisabled?1:0)};enblB=function enableButton(sId,f,oSubPage){if(!oSubPage)oSubPage=Owa.UIControls.SubPage.get_Instance();Owa.Components.ToolbarCollection.get(oSubPage).set_IsButtonDisabled(sId,!!f)};Owa.Components.ToolbarCollection.prototype.set_IsButtonPushed=function Owa$Components$ToolbarCollection$set_IsButtonPushed(sId,fPushed){var oButton=this.getButton(sId);if(!oButton)return;oButton.set_IsPushed(fPushed?1:0)};Owa.Components.ToolbarCollection.prototype.dispose=function Owa$Components$ToolbarCollection$dispose(){if(this._rgToolbars==null){return}for(var i=0;i<this._rgToolbars.length;i++){this._rgToolbars[i].dispose()}this._rgToolbars=null;this._oSubPage=null;Owa.Components.ToolbarCollection.callBase(this,"dispose")};Owa.Components.ToolbarCollection.createClass("Owa.Components.ToolbarCollection",Owa.Components.Control)})();g_fModuleLoaded[".\\components/ToolbarCollection.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/BackgroundFader.js".toLowerCase()])(function(){Type.createNamespace("Owa.Components");Owa.Components.BackgroundFader=function Owa$Components$BackgroundFader(oElement,iPulses,iFadeTime,iPauseTime){Owa.Components.BackgroundFader.constructBase(this);this._oElement=oElement;this.iPulses=iPulses;this._iFadeTime=iFadeTime;this._iPauseTime=iPauseTime;this._rgActiveFadeTimers=new Array();this._fFading=0};var _oPrototype=Owa.Components.BackgroundFader.prototype;var rgParsers=[new RegExp("rgb\\((\\d+),\\s+(\\d+),\\s+(\\d+)\\)","i"),new RegExp("#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})","i")];var rgParserBase=[10,16];_oPrototype.fadeInFadeOut=function Owa$Components$BackgroundFader$fadeInFadeOut(sOriginalColor,sFadedColor,fEndWithTransparent){if(this._fFading){return}this._fFading=1;for(var i=0;i<this._rgActiveFadeTimers.length;i++){clearTimeout(this._rgActiveFadeTimers[i])}this._setBackgroundColor(sOriginalColor);this._fade(sOriginalColor,sFadedColor,this._iFadeTime);for(var i=0;i<((this.iPulses*2)-1);i++){var inClr;var outClr;if(i%2==0){inClr=sFadedColor;outClr=sOriginalColor}else{inClr=sOriginalColor;outClr=sFadedColor}var oTimer=this.stTmout("_fade",(this._iFadeTime+this._iPauseTime)*(i+1),inClr,outClr,this._iFadeTime);this._rgActiveFadeTimers.push(oTimer)}var oEndTimer=this.stTmout("_setBackgroundColor",(this._iFadeTime+this._iPauseTime)*(this.iPulses*2),(fEndWithTransparent)?"transparent":"",1);this._rgActiveFadeTimers.push(oEndTimer)};_oPrototype._fade=function Owa$Components$BackgroundFader$_fade(sClrStrt,sClrEnd,iDur){var iFps=40;var iFrms=Math.round(iFps*(iDur/1000));var iIntvl=iDur/iFrms;var iDly=iIntvl;var iFrm=0;if(sClrStrt.length<7)sClrStrt+=sClrStrt.substr(1,3);if(sClrEnd.length<7)sClrEnd+=sClrEnd.substr(1,3);var rgRgbStartValues=this._parseColorComponents(sClrStrt);if(!rgRgbStartValues){return}var rgRgbEndValues=this._parseColorComponents(sClrEnd);if(!rgRgbEndValues){return}var iR,iG,iB,sH;while(iFrm<iFrms){iR=Math.floor(rgRgbStartValues[0]*((iFrms-iFrm)/iFrms)+rgRgbEndValues[0]*(iFrm/iFrms));iG=Math.floor(rgRgbStartValues[1]*((iFrms-iFrm)/iFrms)+rgRgbEndValues[1]*(iFrm/iFrms));iB=Math.floor(rgRgbStartValues[2]*((iFrms-iFrm)/iFrms)+rgRgbEndValues[2]*(iFrm/iFrms));sH=this._makeHex(iR,iG,iB);this.stTmout("_setBackgroundColor",iDly,sH);iFrm++;iDly=iIntvl*iFrm}this.stTmout("_setBackgroundColor",iDly,sClrEnd)};_oPrototype._parseColorComponents=function Owa$Components$BackgroundFader$_parseColorComponents(sColor){var rgRgbValues=null;for(var i=0;i<rgParsers.length;i++){var rgRgbStringValues=sColor.match(rgParsers[i]);if(rgRgbStringValues&&(4==rgRgbStringValues.length)){rgRgbValues=new Array(3);rgRgbValues[0]=parseInt(rgRgbStringValues[1],rgParserBase[i]);rgRgbValues[1]=parseInt(rgRgbStringValues[2],rgParserBase[i]);rgRgbValues[2]=parseInt(rgRgbStringValues[3],rgParserBase[i]);break}}return rgRgbValues};_oPrototype._makeHex=function Owa$Components$BackgroundFader$_makeHex(iR,iG,iB){iR=iR.toString(16);iG=iG.toString(16);iB=iB.toString(16);if(iR.length==1)iR='0'+iR;if(iG.length==1)iG='0'+iG;if(iB.length==1)iB='0'+iB;return"#"+iR+iG+iB};_oPrototype._setBackgroundColor=function Owa$Components$BackgroundFader$_setBackgroundColor(sColor,fEnd){this._oElement._get_DomNode().style.backgroundColor=sColor;if(fEnd){this._fFading=0}};Owa.Components.BackgroundFader.createClass("Owa.Components.BackgroundFader",Owa.Components.Control)})();g_fModuleLoaded[".\\components/BackgroundFader.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/MailTipsButtonHandler.js".toLowerCase()])(function(){var TOOLBAR_BUTTON_NAME="mailTips";var ERROR_ICON="warn.png";var INFO_ICON="info.gif";var PROGRESS_ICON="pgrs-sm.gif";var EXTEND_CLASS="extend";var DROPDOWN_IMAGE_ID="imgToolbarButtonDropdownIcon";var PROGRESS_IMAGE_ID="imgTipButtonProgress";var DROPDOWN_UP_ICON="up-arrw.gif";var DROPDOWN_DOWN_ICON="alertdropdown.gif";var HIGH_SEVERITY_COLOR=1;var LOW_SEVERITY_COLOR=0;var PULSES=2;var FADE_TIME=1000;var PULSE_TIME=100;var _oInstance=null;Owa.Components.MailTipsButtonHandler=function Owa$Components$MailTipsButtonHandler(){try{this.oButton=Owa.Components.ToolbarCollection.get_Current().getButton(TOOLBAR_BUTTON_NAME)}catch(e){this.oButton=null}if(this.oButton){var oButtonElement=this.oButton._get_ButtonElement();if(g_fRtl){oButtonElement.addCssClass("rtl")}var sImageProgress="<img id=\""+PROGRESS_IMAGE_ID+"\" src=\""+getThmF(PROGRESS_ICON)+"\" style=\"display:none\" class=\"tbLh tbBefore\">";var oIcon=this.oButton.getToolbarIcon();if(oIcon){oIcon.insertAdjacentHtml(Owa.ElementInsertionPoint.AfterEnd,sImageProgress)}else{oButtonElement.insertAdjacentHtml(Owa.ElementInsertionPoint.AfterBegin,sImageProgress)}this._oBackgroundFader=new Owa.Components.BackgroundFader(oButtonElement,PULSES,FADE_TIME,PULSE_TIME);this.sFadedColor=getStyle("mailTipsButtonFaded").backgroundColor}else{this._oBackgroundFader=0}};Owa.Components.MailTipsButtonHandler.get_Instance=function Owa$Components$MailTipsButtonHandler$get_Instance(){if(!_oInstance){_oInstance=new Owa.Components.MailTipsButtonHandler()}return _oInstance};var _oPrototype=Owa.Components.MailTipsButtonHandler.prototype;_oPrototype.dispose=function Owa$Components$MailTipsButtonHandler$dispose(){if(this.oButton){this.oButton.dispose()}};_oPrototype.doesButtonExist=function Owa$Components$MailTipsButtonHandler$doesButtonExist(){if(this.oButton){return 1}return 0};_oPrototype.updateDropDownIcon=function Owa$Components$MailTipsButtonHandler$updateDropDownIcon(fShown){if(this.oButton){var oButtonElement=this.oButton._get_ButtonElement();if(oButtonElement){var oImgDropDown=oButtonElement.getDescendantById(DROPDOWN_IMAGE_ID);if(oImgDropDown){Owa.Components.CssSprites.updateImage(oImgDropDown,fShown?DROPDOWN_UP_ICON:DROPDOWN_DOWN_ICON)}this._updateExtendClass(oButtonElement,fShown)}}};_oPrototype.updateIconAndColor=function Owa$Components$MailTipsButtonHandler$updateIconAndColor(iColor,sExistingClass,sTargetClass){if(this.oButton){var oIcon=this.oButton.getToolbarIcon();if(oIcon){var sIcon=INFO_ICON;switch(iColor){case HIGH_SEVERITY_COLOR:sIcon=ERROR_ICON;break;case LOW_SEVERITY_COLOR:sIcon=INFO_ICON;break}Owa.Components.CssSprites.updateImage(oIcon,sIcon)}var oButtonElement=this.oButton._get_ButtonElement();if(oButtonElement&&(!oButtonElement.hasCssClass(sTargetClass))){if(oButtonElement.hasCssClass(sExistingClass)){oButtonElement.removeCssClass(sExistingClass)}oButtonElement.addCssClass(sTargetClass)}}};_oPrototype.toggleProgressIcon=function Owa$Components$MailTipsButtonHandler$toggleProgressIcon(fShowProgress){if(this.oButton){var oIcon=this.oButton.getToolbarIcon();var oImgProgress=this.oButton._get_ButtonElement().getDescendantById(PROGRESS_IMAGE_ID);if(oIcon&&oImgProgress){oIcon.set_IsShown(!fShowProgress);oImgProgress.set_IsShown(fShowProgress)}if(fShowProgress){this.set_IsShown(1)}}};_oPrototype.get_IsShown=function Owa$Components$MailTipsButtonHandler$get_IsShown(){if(this.oButton){return this.oButton.get_IsShown()}return 0};_oPrototype.set_IsShown=function Owa$Components$MailTipsButtonHandler$set_IsShown(fShown){if(this.oButton){var oButtonElement=this.oButton._get_ButtonElement();var oDivTs=oButtonElement.get_ParentElement().get_ParentElement();this._updateExtendClass(oDivTs,fShown);this.oButton.set_IsShown(fShown)}};_oPrototype.fadeInFadeOut=function Owa$Components$MailTipsButtonHandler$fadeInFadeOut(sOriginalColor){if(this._oBackgroundFader){this._oBackgroundFader.fadeInFadeOut(sOriginalColor,this.sFadedColor)}};_oPrototype.setEndColor=function Owa$Components$MailTipsButtonHandler$setEndColor(sEndColor){if(this._oBackgroundFader){this._oBackgroundFader.setEndColor(sEndColor)}};_oPrototype.focusToolbar=function Owa$Components$MailTipsButtonHandler$focusToolbar(){if(this.oButton){this.oButton._get_ButtonElement().get_ParentElement().focus()}};_oPrototype._updateExtendClass=function Owa$Components$MailTipsButtonHandler$_updateExtendClass(oElement,fShown){if(fShown&&(!oElement.hasCssClass(EXTEND_CLASS))){oElement.addCssClass(EXTEND_CLASS)}else if(!fShown&&oElement.hasCssClass(EXTEND_CLASS)){oElement.removeCssClass(EXTEND_CLASS)}};Owa.Components.MailTipsButtonHandler.createClass("Owa.Components.MailTipsButtonHandler",Owa.Components.Control)})();g_fModuleLoaded[".\\components/MailTipsButtonHandler.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/Infobar.js".toLowerCase()])(function(){Type.createNamespace("Owa.Components");var COLOR_DIV_ID="divInfobarColor";var DIV_IB_ID="divIB";var DEFAULT_MESSAGE_ID="divInfobarMessage";var MESSAGE_ITEM_CLASS="infobarMessageItem";var DIV_ERR_ID="divErr";var HIGH_SEVERITY_CLASS="highSeverity";var LOW_SEVERITY_CLASS="lowSeverity";var HIGH_SEVERITY_COLOR=1;var LOW_SEVERITY_COLOR=0;var LOADING_DIV_ID="divInfobarLoading";Owa.UIControls.Infobar=function Owa$UIControls$Infobar(oInfobarElement){this.oMailTipsButtonHandler=Owa.Components.MailTipsButtonHandler.get_Instance();Owa.UIControls.Infobar.constructBase(this,[oInfobarElement])};var _oPrototype=Owa.UIControls.Infobar.prototype;var _fHideByDefault=0;_oPrototype.exists=function Owa$UIControls$Infobar$exists(){if(this._get_Element()){return 1}return 0};_oPrototype.get_IsShown=function Owa$UIControls$Infobar$get_IsShown(){var oElement=this._get_Element();if(oElement){return oElement.get_IsShown()}return 0};_oPrototype.set_IsShown=function Owa$UIControls$Infobar$set_IsShown(fShow,fSkipRefresh){var oDivInfobar=this._get_Element();if(fShow){var iColor=-1;if(this._hasHighSeverityMessages()){this.setColor(HIGH_SEVERITY_COLOR);iColor=HIGH_SEVERITY_COLOR}else if(0<this.getMessages().length){this.setColor(LOW_SEVERITY_COLOR);iColor=LOW_SEVERITY_COLOR}var oErrorMessage=this.getErrorMessage();var fWasShown=0;if(!_fHideByDefault||oErrorMessage&&oErrorMessage.get_IsShown()||!this.oMailTipsButtonHandler.doesButtonExist()){oDivInfobar.set_IsShown(fShow);this.oMailTipsButtonHandler.updateDropDownIcon(fShow);fWasShown=1}else if(_fHideByDefault){oDivInfobar.set_IsShown(0);this.oMailTipsButtonHandler.updateDropDownIcon(0)}this.oMailTipsButtonHandler.set_IsShown(1);if(!fWasShown&&(-1<iColor)){var sTopColor=gtStl(oDivInfobar.getChildById(COLOR_DIV_ID)._get_DomNode()).color;this.oMailTipsButtonHandler.fadeInFadeOut(sTopColor)}}else{oDivInfobar.set_IsShown(fShow);this.oMailTipsButtonHandler.updateDropDownIcon(fShow)}if(!fSkipRefresh){safeResizeBodies()}};_oPrototype.getOffsetHeight=function Owa$UIControls$Infobar$getOffsetHeight(){var oDivInfobar=this._get_Element();if(oDivInfobar.get_IsShown()){return oDivInfobar.get_OffsetHeight()}return 0};_oPrototype.expandHeight=function Owa$UIControls$Infobar$expandHeight(iHeightPixels){if(this.get_IsShown()){var oDivIB=this.getDivIB();if(oDivIB){var height=oDivIB.get_OffsetHeight();oDivIB.set_MaxHeight(height+iHeightPixels,Owa.Style.Unit.Pixels)}}};_oPrototype.getDivIB=function Owa$UIControls$Infobar$getDivIB(){return this._get_Element().getChildById(DIV_IB_ID)};_oPrototype.getMessages=function Owa$UIControls$Infobar$getMessages(){var rgMessages=[];var oDivIB=this.getDivIB();if(oDivIB){oDivIB.forEachChild(function(oMessage){if(oMessage.get_IsShown()){rgMessages.push(oMessage)}})}return rgMessages};_oPrototype.getMessageById=function Owa$UIControls$Infobar$getMessageById(sDivId){var oDivIB=this.getDivIB();if(oDivIB){return oDivIB.getChildById(sDivId)}return 0};_oPrototype.getErrorMessage=function Owa$UIControls$Infobar$getErrorMessage(){return this.getMessageById(DIV_ERR_ID)};_oPrototype.buildMessage=function Owa$UIControls$Infobar$buildMessage(sHtml,sDivId,iType){var oDivIB=this.getDivIB();if(oDivIB){if(!sDivId){sDivId=DEFAULT_MESSAGE_ID}if(!iType&&0!=iType){iType=1}var oDivMessage=Owa.Dom.Document.get_Current().createElement("div");oDivMessage.set_Id(sDivId);oDivMessage.setIntAttribute("iType",iType);oDivMessage.addCssClass(MESSAGE_ITEM_CLASS);oDivMessage.set_InnerHtml(sHtml);return oDivMessage}return 0};_oPrototype.replaceOrInsertMessage=function Owa$UIControls$Infobar$replaceOrInsertMessage(oDivMessage){var oExistingMessage=this.getMessageById(oDivMessage.get_Id());if(oExistingMessage){this.replaceMessage(oDivMessage,oExistingMessage)}else{this.insertMessage(oDivMessage)}};_oPrototype.buildReplaceOrInsertMessageAndRefresh=function Owa$UIControls$Infobar$buildReplaceOrInsertMessageAndRefresh(sHtml,sDivId,iType){var oMessage=this.buildMessage(sHtml,sDivId,iType);if(oMessage){this.replaceOrInsertMessage(oMessage);this.set_IsShown(1);safeResizeBodies()}return oMessage};_oPrototype.insertMessage=function Owa$UIControls$Infobar$insertMessage(oDivMessage){var oDivIB=this.getDivIB();if(oDivIB){var oBiggerMessage=oDivIB.forEachChild(this._compareTwoMessages,oDivMessage);if(oBiggerMessage){oBiggerMessage.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeBegin,oDivMessage)}else{oDivIB.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,oDivMessage)}}if(this._isHighSeverity(oDivMessage)){this.setColor(HIGH_SEVERITY_COLOR)}};_oPrototype.checkRemoveMessageAndRefresh=function Owa$UIControls$Infobar$checkRemoveMessageAndRefresh(sDivId,fSkipRefresh){var oMessage=this.getMessageById(sDivId);if(oMessage){this.removeMessage(oMessage);if(!fSkipRefresh){safeResizeBodies()}}};_oPrototype.removeMessage=function Owa$UIControls$Infobar$removeMessage(oDivMessage,fSkipRefresh){oDivMessage.remove(1);this.refreshRemoveOrHide(fSkipRefresh)};_oPrototype.hideMessage=function Owa$UIControls$Infobar$hideMessage(oDivMessage){oDivMessage.set_IsShown(0);this.refreshRemoveOrHide()};_oPrototype.refreshRemoveOrHide=function Owa$UIControls$Infobar$refreshRemoveOrHide(fSkipRefresh){if(!this._hasHighSeverityMessages()){this.setColor(LOW_SEVERITY_COLOR)}if(0==this.getMessages().length){this.set_IsShown(0,fSkipRefresh);this.oMailTipsButtonHandler.set_IsShown(0)}};_oPrototype.setColor=function Owa$UIControls$Infobar$setColor(iColor){var oDivInfobar=this._get_Element();var oDivInfobarColor=oDivInfobar.getChildById(COLOR_DIV_ID);var sTargetClass=LOW_SEVERITY_CLASS;var sExistingClass=HIGH_SEVERITY_CLASS;switch(iColor){case HIGH_SEVERITY_COLOR:sTargetClass=HIGH_SEVERITY_CLASS;sExistingClass=LOW_SEVERITY_CLASS;break;case LOW_SEVERITY_COLOR:sTargetClass=LOW_SEVERITY_CLASS;sExistingClass=HIGH_SEVERITY_CLASS;break}if(!oDivInfobarColor.hasCssClass(sTargetClass)){if(oDivInfobarColor.hasCssClass(sExistingClass)){oDivInfobarColor.removeCssClass(sExistingClass)}oDivInfobarColor.addCssClass(sTargetClass)}this.oMailTipsButtonHandler.updateIconAndColor(iColor,sExistingClass,sTargetClass)};_oPrototype.replaceMessage=function Owa$UIControls$Infobar$replaceMessage(oNewMessage,oExistingMessage){var oDivIB=this.getDivIB();if(oDivIB){oDivIB.replaceChild(oNewMessage,oExistingMessage)}};_oPrototype.setLoadingStatus=function Owa$UIControls$Infobar$setLoadingStatus(fLoading){var oDivInfobar=this._get_Element();if(fLoading&&(0==this.getMessages().length)){var oLoadingMessage=this.buildMessage(L_Ld,LOADING_DIV_ID,2);this.replaceOrInsertMessage(oLoadingMessage)}else if(!fLoading){this.checkRemoveMessageAndRefresh(LOADING_DIV_ID)}this.oMailTipsButtonHandler.toggleProgressIcon(fLoading)};_oPrototype.setHideByDefaultValue=function Owa$UIControls$Infobar$setHideByDefaultValue(fHideByDefault){_fHideByDefault=fHideByDefault};_oPrototype.focusToolbarOnButtonClick=function Owa$UIControls$Infobar$focusToolbarOnButtonClick(){this.oMailTipsButtonHandler.focusToolbar()};_oPrototype.refresh=function Owa$UIControls$Infobar$refresh(){var fWasShown=this.get_IsShown();if(fWasShown||(0<this.getMessages().length)){this.set_IsShown(true)}};_oPrototype._compareTwoMessages=function Owa$UIControls$Infobar$_compareTwoMessages(oMessageInBar,oMessage){var iTypeInBar=oMessageInBar.getIntAttribute("iType");var iType=oMessage.getIntAttribute("iType");var fIsBarMessageLater;if(!iTypeInBar&&0!=iTypeInBar){fIsBarMessageLater=1}else if(iTypeInBar>iType){fIsBarMessageLater=0}else if(iTypeInBar<iType){fIsBarMessageLater=1}else{var sContentInBar=oMessageInBar.get_TextContent();var sContent=oMessage.get_TextContent();fIsBarMessageLater=(sContentInBar>sContent)}return fIsBarMessageLater};_oPrototype._isHighSeverity=function Owa$UIControls$Infobar$_isHighSeverity(oMessage){if(oMessage.get_IsShown()){var iType=oMessage.getIntAttribute("iType");return(4<iType)}return 0};_oPrototype._hasHighSeverityMessages=function Owa$UIControls$Infobar$_hasHighSeverityMessages(){var oDivIB=this.getDivIB();if(oDivIB){return oDivIB.forEachChild(this._isHighSeverity)}return 0};Owa.UIControls.Infobar.createClass("Owa.UIControls.Infobar",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/Infobar.js".toLowerCase()]=1;function sendRefresh(oSubPage,oContext,fRR){try{if(oSubPage.getSubPageVariable("a_fCal")){rfCalVw(a_fPrv,isDf(typeof(a_sId))?a_sId:null)}else{if(fRR==1)oSubPage._setTimeout(oSubPage.rfVwRemoveIrm,100,oContext);if(fRR==0)oSubPage._setTimeout(oSubPage.rfVwPhsh,100,oContext);if(fRR==2)oSubPage._setTimeout(oSubPage.rfVwRemoveWB,100,oContext)}}catch(e){}}function clkIbBm(sT,sA,sS,fPhsh,fWb,fRR){if(isDf(typeof(a_fTxt))&&((a_fTxt==0)||(fPhsh==1)||(fRR==1))){var url=getUrl(sT,sA,sS,fPhsh,fWb,0,0,fRR);if(isDf(typeof(a_fSmEmb))&&a_fSmEmb){a_fSmEmb=0;url+="&smemb=1&exdltdrft=1"}var oAnchor=null;if(fRR==1){oAnchor=$("aIbRR")}else{oAnchor=$("aIbBlk")}sendUrl(url+gtMmPar(),oAnchor);if(!isDf(typeof(a_sId))){return}var oSubPage=0;if(((fRR==1)||(fPhsh==1)||(fWb==1))&&isDf(typeof(a_fPrv))){try{var oCurrentSubPageController=Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController();var oSubPageController=a_fPrv?oCurrentSubPageController.get_ParentController():oCurrentSubPageController.get_OpenerController();if(oSubPageController){oSubPage=oSubPageController.get_SubPage()}}catch(e){}}if((fRR==1)&&oSubPage){sendRefresh(oSubPage,{fUdRP:(a_fPrv?0:1)},1)}if((fPhsh==1)&&oSubPage){sendRefresh(oSubPage,{sId:a_sId,fUdRP:(a_fPrv?0:1)},0)}if((fWb==1)&&oSubPage){sendRefresh(oSubPage,{fUdRP:(a_fPrv?0:1)},2)}}}function tglInfo(o){var oD=o.parentNode;var oImg=getOneDescendant(oD,"imgExp");var oI=getOneDescendant(oD,"divIbE");var oSh=getOneDescendant(oD,"spnS");var oH=getOneDescendant(oD,"spnH");var fShw=0;var oInfobarNode=Owa.Dom.Node.wrapDomNode(o).getAncestorById("divInfobar");var oInfobar=new Owa.UIControls.Infobar(oInfobarNode);if(!isDisp(oI)){fShw=0;oImg.src=getThmF("cllps.gif");showEm(oI);if(oI.offsetHeight>150)oI.style.height=150;oInfobar.expandHeight(oI.offsetHeight)}else{fShw=1;oImg.src=getThmF("expnd.gif");showEm(oI,1);var tmp=oI.offsetHeight}showEm(oH,fShw);showEm(oSh,!fShw);safeResizeBodies()}function showErr(oDivErr,sErr,sErrDbg,fTxt){if(!Owa.Dom.Node.isInstance(oDivErr)){oDivErr=Owa.Dom.Node.wrapDomNode(oDivErr)}var otdMsgBar=oDivErr.getDescendantById("tdMsg");if((fTxt!=null)&&(fTxt==1)){otdMsgBar.set_TextContent(sErr)}else{otdMsgBar.set_InnerHtml(sErr)}if(sErrDbg){var oDivErrDbg=Owa.Dom.Document.get_Current().createElement("DIV");oDivErrDbg=Owa.Dom.Document.get_Current().appendChild(oDivErrDbg);hideEm(oDivErrDbg);oDivErrDbg.set_InnerHtml(sErrDbg);var sErrorText=oDivErrDbg.get_TextContent();oDivErr.getDescendantById("imgEICpy").setAttribute("_sErrDbg",sErrorText);oDivErr.getDescendantById("imgEISnd").setAttribute("_sErrDbg",sErrorText);showEm(oDivErr.getDescendantById("tdEICpy"));showEm(oDivErr.getDescendantById("tdEISnd"));oDivErr._get_DomNode().title=sErrorText;oDivErrDbg.remove(true)}else{oDivErr.getDescendantById("imgEICpy").setAttribute("_sErrDbg","");oDivErr.getDescendantById("imgEISnd").setAttribute("sErrDbg","");oDivErr._get_DomNode().title="";hideEm(oDivErr.getDescendantById("tdEICpy"));hideEm(oDivErr.getDescendantById("tdEISnd"))}showEm(oDivErr);var oInfobar=new Owa.UIControls.Infobar(oDivErr.getAncestorById("divInfobar"));oInfobar.checkRemoveMessageAndRefresh("divDAErr",1);oInfobar.set_IsShown(1);resizeBodyOffset()}function hideErr(divErr){if(!Owa.Dom.Node.isInstance(divErr)){divErr=Owa.Dom.Node.wrapDomNode(divErr)}var oInfobar=new Owa.UIControls.Infobar(divErr.getAncestorById("divInfobar"));oInfobar.hideMessage(divErr);safeResizeBodies();resizeBodyOffset()}function canEvt(e){if(e==null)e=getEvt(this);if(!Owa.Dom.Event.isInstance(e))e=new Owa.Dom.Event(e,getEvtTgt(e));e.cancelBubble();e.preventDefault()}function canEdEvt(){var e=edEvt();canEvt(e)}function onEvtCanInpt(oEvent){if(oEvent.isCtrlKeyDown()){return}var oElement=oEvent.get_Target();if(!oElement){return}if(isInpt(oElement)){return}while(oElement){if(oElement.getAttribute(Owa.Strings.Attributes.AllowContextMenu)){return}oElement=oElement.get_ParentElement()}oEvent.preventDefault();oEvent.cancelBubble()}function isInpt(oE){if(!oE){return}if(!Owa.Dom.Node.isInstance(oE)){oE=Owa.Dom.Node.wrapDomNode(oE)}var sTagName=oE.get_TagName().toLowerCase();return sTagName=="input"||sTagName=="textarea"||oE.getAttribute("contentEditable")=="true"||oE.get_OwnerDocument().get_IsDesignMode()}function cancelSelectStart(oEvent){if(isInpt(oEvent.get_Target()))return;oEvent.preventDefault()}var isWP,isSWP,isStOpPg,isStPg,wt,getCSW,getWindowClientLeft,getWindowClientTop,isNavigationPageObject,isCalendarPageObject,isFolderViewSubPageObject;(function(){Type.createNamespace("Owa.PageHierarchy");isWP=Owa.PageHierarchy.isWebPart=function Owa$PageHierarchy$isWebPart(){return(isDf(typeof(a_fWP))&&a_fWP)};isSWP=Owa.PageHierarchy.isSmallWebPart=function Owa$PageHierarchy$isSmallWebPart(){return(isDf(typeof(a_fSWP))&&a_fSWP)};isStOpPg=Owa.PageHierarchy.isInStartOrOptionPage=function Owa$PageHierarchy$isInStartOrOptionPage(){var oW=wt();return(isDf(typeof(oW.a_fStPg))&&oW.a_fStPg)||(isDf(typeof(oW.a_fOpPg))&&oW.a_fOpPg)};isStPg=Owa.PageHierarchy.isInStartPage=function Owa$PageHierarchy$isInStartPage(){var oW=wt();return isDf(typeof(oW.a_fStPg))&&oW.a_fStPg};Owa.PageHierarchy.getOwaTopWindow=function Owa$PageHierarchy$getOwaTopWindow(){return new Owa.Dom.Window(wt())};wt=function Owa$PageHierarchy$wt(oW){oW=oW||window;while(1){try{var oF=0;if(isDf(typeof(oW.frameElement))&&oW.frameElement&&isDf(typeof(oW.frameElement.ownerDocument))&&oW.frameElement.ownerDocument){oF=oW.frameElement.ownerDocument.parentWindow||oW.frameElement.ownerDocument.defaultView}if(!isDf(typeof(oF))||!isDf(typeof(oF.g_fOwa))||!oF.g_fOwa)break;oW=oF}catch(e){break}}return oW};Owa.PageHierarchy.getElementByIdFromTop=function Owa$PageHierarchy$getElementByIdFromTop(sId){return Owa.PageHierarchy.getOwaTopWindow().get_Document().getElementById(sId)};getCSW=Owa.PageHierarchy.getCentralStorageWindow=function Owa$PageHierarchy$getCentralStorageWindow(){var oW=window;try{while(!oW.isStOpPg()){var oP=oW.opener;if(oP&&oP.g_fOwa)oW=oP;else break}oW=oW.wt()}catch(e){}return oW};function getWindowClientValue(oElement,sFunctionName){var iValue=oElement[sFunctionName]();var oWindow=oElement.get_OwnerDocument().get_ContainerWindow();if(!Owa.PageHierarchy.isWebPart()){while(1){try{var oFrame=oWindow.get_FrameElement();var oParent=oWindow.get_ParentWindow();if(!oParent.getGlobalVariable("g_fOwa"))break;iValue+=oFrame[sFunctionName]();oWindow=oParent}catch(e){break}}}return iValue}getWindowClientLeft=Owa.PageHierarchy.getWindowClientLeft=function Owa$PageHierarchy$getWindowClientLeft(oElement){return getWindowClientValue(oElement,"get_DocumentLeft")};getWindowClientTop=Owa.PageHierarchy.getWindowClientTop=function Owa$PageHierarchy$getWindowClientTop(oElement){return getWindowClientValue(oElement,"get_DocumentTop")};function isSubPageObject(oCallerSubPage,sTypeName){return oCallerSubPage.sTypeName==sTypeName}function isOneOfSubPageObject(oCallerSubPage,oTypeNameHashtable){return oTypeNameHashtable[oCallerSubPage.sTypeName]}isNavigationPageObject=Owa.PageHierarchy.isNavigationPageObject=function Owa$PageHierarchy$isNavigationPageObject(oCallerSubPage){return isSubPageObject(oCallerSubPage,"NavigationPage")};isCalendarPageObject=Owa.PageHierarchy.isCalendarPageObject=function Owa$PageHierarchy$isCalendarPageObject(oCallerSubPage){return isSubPageObject(oCallerSubPage,"CalendarViewPage")};isReadConversationPageObject=Owa.PageHierarchy.isReadConversationPageObject=function Owa$PageHierarchy$isReadConversationPageObject(oCallerSubPage){return isSubPageObject(oCallerSubPage,"ReadConversationPage")};var oFolderViewSubPageHashtable={FolderViewsSubPage:true,DirectoryView:true,MessageViewSubPage:true,ContactViewPage:true,TaskViewPage:true,DumpsterViewPage:true};isFolderViewSubPageObject=Owa.PageHierarchy.isFolderViewSubPageObject=function Owa$PageHierarchy$isFolderViewSubPageObject(oCallerSubPage){return isOneOfSubPageObject(oCallerSubPage,oFolderViewSubPageHashtable)};Owa.PageHierarchy.getFolderViewSubPageFromSubPageController=function Owa$PageHierarchy$getVirtualListViewFromSubPageController(oSubPageController){if(!oSubPageController){return null}var oSubPage=oSubPageController.get_SubPage();return oSubPage&&Owa.PageHierarchy.isFolderViewSubPageObject(oSubPage)?oSubPage:null};Owa.PageHierarchy.getVirtualListViewFromSubPageController=function Owa$PageHierarchy$getVirtualListViewFromSubPageController(oSubPageController){var oSubPage=Owa.PageHierarchy.getFolderViewSubPageFromSubPageController(oSubPageController);return oSubPage?oSubPage.get_VirtualListView():null}})();(function(){Owa.Controls.EventDispatcher=function Owa$Controls$EventDispatcher(){Owa.Controls.EventDispatcher.baseClass.call(this);this.init()};Owa.Utility.inherit(Owa.Controls.EventDispatcher,Owa.Controls.Control);Owa.Controls.EventDispatcher.prototype.init=function Owa$Controls$EventDispatcher$init(){this._ev={}};Owa.Controls.EventDispatcher.prototype.register=function Owa$Controls$EventDispatcher$register(sEN){if(this._ev[sEN])return;this._ev[sEN]=[]};Owa.Controls.EventDispatcher.prototype.fire=function Owa$Controls$EventDispatcher$fire(sEN){var oW=wt();if(oW!=window)return oW.g_oEd.fire.apply(oW.g_oEd,arguments);if(!this._ev[sEN])return;var oArgs=[];for(var i=1;i<arguments.length;i++)oArgs.push(arguments[i]);var cbs=this._ev[sEN].slice(0);for(var i=0;i<cbs.length;i++){var oThis=cbs[i][0];var sFn=cbs[i][1];var oFnArgs=cbs[i][2];if(!oThis)oThis=window;var oFn=oThis[sFn];if(!oFn)continue;if(oFnArgs){var oTmpArgs=[];for(var j=0;j<oFnArgs.length;j++)oTmpArgs.push(oFnArgs[j]);for(var j=0;j<oArgs.length;j++)oTmpArgs.push(oArgs[j]);oFn.apply(oThis,oTmpArgs)}else{oFn.apply(oThis,oArgs)}}};Owa.Controls.EventDispatcher.prototype.attachEvent=function Owa$Controls$EventDispatcher$attachEvent(sEN,oThis,sFn){var oW=wt();if(oW!=window)return oW.g_oEd.attachEvent.apply(oW.g_oEd,arguments);if(!this._ev[sEN])return;if(this.isAttached(sEN,oThis,sFn))return;var cbs=this._ev[sEN];var args=[];for(var i=3;i<arguments.length;i++)args.push(arguments[i]);cbs.push([oThis,sFn,args.length?args:null])};Owa.Controls.EventDispatcher.prototype.isAttached=function Owa$Controls$EventDispatcher$isAttached(sEN,oThis,sFn){var oW=wt();if(oW!=window)return oW.g_oEd.isAttached.apply(oW.g_oEd,arguments);if(!this._ev[sEN])return;var cbs=this._ev[sEN];for(var i=0;i<cbs.length;i++)if(cbs[i][0]==oThis&&cbs[i][1]==sFn)return 1};Owa.Controls.EventDispatcher.prototype.detachEvent=function Owa$Controls$EventDispatcher$detachEvent(sEN,oThis,sFn){var oW=wt();if(oW!=window)return oW.g_oEd.detachEvent.apply(oW.g_oEd,arguments);if(!this._ev[sEN])return;var cbs=this._ev[sEN];var i=0;for(;i<cbs.length;i++)if(cbs[i][0]==oThis&&cbs[i][1]==sFn)break;if(i<cbs.length){if(i==cbs.length-1)cbs.pop();else cbs[i]=cbs.pop()}}})();if(!window.g_oEd){window.g_oEd=new Owa.Controls.EventDispatcher()}g_oEd.register("ReloadNavigationTree");Owa.Components.OehRequest.get_onResponseReceived().add(checkEveryOehResponse);var g_iFlrTimer=0;function checkEveryOehResponse(oResponse){if(oResponse.iErr==26){var oDivMsg=Owa.Dom.Document.get_Current().createElement("div");oDivMsg.set_InnerHtml(oResponse.sErr);var oSpRedirUrl=oDivMsg.getDescendantById("spRedirUrl");if(oSpRedirUrl)setFlrReTimer(oSpRedirUrl.get_InnerHtml());oResponse.sErr=oDivMsg.get_TextContent()}}function setFlrReTimer(sUrl){if(g_iFlrTimer!=0)return;g_iFlrTimer=setTimeout("flrRedir(\""+sUrl+"\")",30000)}function flrRedir(sUrl){g_iFlrTimer=0;var oW=getCSW();oW.document.location.href=sUrl}(function(){Owa.Controls.OEHManagerBase=function Owa$Controls$OEHManagerBase(){Owa.Controls.OEHManagerBase.baseClass.call(this)};Owa.Utility.inherit(Owa.Controls.OEHManagerBase,Owa.Controls.Control);Owa.Controls.OEHManagerBase.prototype.prepCtx=function Owa$Controls$OEHManagerBase$prepCtx(rgArg,oCtx){var rgR=[];for(var i=0;i<rgArg.length;i++)rgR.push(rgArg[i]);rgR.push(oCtx);return rgR};Owa.Controls.OEHManagerBase.prototype.prepArgs=function Owa$Controls$OEHManagerBase$prepArgs(sEvtNm,oR){var rgArg=oR.oCtx;oR.oCtx=rgArg.pop();rgArg.unshift(oR);rgArg.unshift(sEvtNm);return rgArg};Owa.Controls.OEHManagerBase.prototype.prepCB=function Owa$Controls$OEHManagerBase$prepCB(sEvtNm,fB){fB=fB?1:0;return this.crtCbWA("fire",sEvtNm,fB)};Owa.Controls.OEHManagerBase.prototype.fire=function Owa$Controls$OEHManagerBase$fire(sNm,fB,oR){var rgArg=this.prepArgs(sNm,oR);g_oEd.fire.apply(g_oEd,rgArg);if(fB){var oW=window;while(oW&&!oW.isStOpPg()){try{var oP=oW.opener;if(oP&&oP.g_fOwa){oW=oP;if(oW.g_oEd)oW.g_oEd.fire.call(oW.g_oEd,rgArg[0],rgArg[1],rgArg[2],rgArg[3],rgArg[4],rgArg[5],rgArg[6],rgArg[7],rgArg[8],rgArg[9],rgArg[10],rgArg[11])}else{break}}catch(e){break}}}}})();function tryGtActMd(f){var oW=wt();if(oW&&oW.gtActMd)return oW.gtActMd();if(!f){try{oW=oW.opener;if(!(oW&&oW.g_fOwa))return[];else return oW.tryGtActMd(0)}catch(e){}}return[]}var FL_MBX="MBX";var FL_PUB="PSF";var FL_OUM="OUM";var FL_AMB="AMB";var FL_GS="GS";var NM_MAIL=0;var NM_CAL=1;var NM_CTS=2;var NM_TSK=3;var NM_AB=5;var NM_DOC=6;var NM_PF=7;(function(){Owa.Controls.FolderManager=function Owa$Controls$FolderManager(){Owa.Controls.FolderManager.baseClass.call(this)};Owa.Utility.inherit(Owa.Controls.FolderManager,Owa.Controls.OEHManagerBase);Owa.Controls.FolderManager.prototype.isMyFId=function Owa$Controls$FolderManager$isMyFId(sFId){return this.gtFL(sFId)==FL_MBX};Owa.Controls.FolderManager.prototype.gtFL=function Owa$Controls$FolderManager$gtFL(sFId){return Owa.Controls.FolderManager.getOwaStoreObjectIdPrefix(sFId)};Owa.Controls.FolderManager.prototype.isDelFId=function Owa$Controls$FolderManager$isDelFId(sFId){for(var i=0;i<a_rgDlItms.get_Length();i++){if(sFId==a_rgDlItms.get_Item(i)){return 1}}return 0};Owa.Controls.FolderManager.prototype.prstTrExpSt=function Owa$Controls$FolderManager$prstTrExpSt(){if(!g_oMMFrst)return;var oFT=g_oMMFrst.gtTr("favorite");var oMT=g_oMMFrst.gtTr("mail");var oBT=g_oMMFrst.gtTr("buddy");var oR=new oeReq("Tree","PersistExpand",null,null,POST);if(oFT)oR.add("fts",oFT.gtNdFrstChld(oFT.gtNdRt()).isExp()?1:0);if(oMT)oR.add("mts",oMT.gtNdRt().isExp()?1:0);if(oBT)oR.add("bts",oBT.gtNdRt().isExp()?1:0);oR.send()};Owa.Controls.FolderManager.prototype.rnmFld=function Owa$Controls$FolderManager$rnmFld(oSndr,sFId,sNwNm,oCCtx){var oR=new oeReq("Tree","Rename",this.prepCtx(arguments,oCCtx),this.prepCB("RenameFolder",1),POST);oR.add("destId",sFId);oR.add("fN",sNwNm);oR.send()};Owa.Controls.FolderManager.prototype.nwFld=function Owa$Controls$FolderManager$nwFld(oSndr,sPFId,fD,sCC,sNwNm,fExp,iFrt,oCCtx){var oR=new oeReq("Tree","New",this.prepCtx(arguments,oCCtx),this.prepCB("NewFolder",1),POST);oR.add("destId",sPFId);oR.add("fDstD",fD?1:0);oR.add("fN",sNwNm);oR.add("fC",sCC);oR.addRg("cms",tryGtActMd());oR.add("exp",fExp?1:0);oR.add("rdt",iFrt);oR.send()};Owa.Controls.FolderManager.prototype.cpMvFld=function Owa$Controls$FolderManager$cpMvFld(oSndr,sSrcFId,fSrcD,sDstPFId,fDstD,fC,fExp,iFrt,oCCtx){var oR;if(fC)oR=new oeReq("Tree","Copy",this.prepCtx(arguments,oCCtx),this.prepCB("CopyFolder",1),POST);else oR=new oeReq("Tree","Move",this.prepCtx(arguments,oCCtx),this.prepCB("MoveFolder",1),POST);oR.add("id",sSrcFId);oR.add("destId",sDstPFId);oR.add("fSrcD",fSrcD?1:0);oR.add("fDstD",fDstD?1:0);oR.addRg("cms",tryGtActMd());oR.add("exp",fExp?1:0);oR.add("rdt",fDstD?FRT_ALL:iFrt);oR.send()};Owa.Controls.FolderManager.prototype.cpMvItms=function Owa$Controls$FolderManager$cpMvItms(oSndr,oCallerSubPage,sSourceFolderId,rgIds,sDstFId,fC,fCal,oCCtx){var oR;var oListView;oCallerSubPage=oCallerSubPage||Owa.UIControls.SubPage.get_Instance();if(isNavigationPageObject(oCallerSubPage)){oListView=oCallerSubPage.getLstVw(oCallerSubPage.getSubPageVariable("a_sLstFID"))}else if(isFolderViewSubPageObject(oCallerSubPage)){oListView=oCallerSubPage.get_VirtualListView()}if(fC)oR=new oeReq("MsgVLV2","Copy",this.prepCtx(arguments,oCCtx),this.prepCB("CopyItems",1),POST);else oR=new oeReq("MsgVLV2","Move",this.prepCtx(arguments,oCCtx),this.prepCB("MoveItems",1),POST);if(rgIds&&rgIds.length)oR.addRg("id",rgIds);if(sSourceFolderId){oR.add("fId",sSourceFolderId)}oR.add("destId",sDstFId);if(oListView&&oListView.isCnvVw&&oListView.isCnvVw())oListView.cnvCpMv(oR,rgIds,sDstFId,fC);else oR.send()};Owa.Controls.FolderManager.prototype.delFld=function Owa$Controls$FolderManager$delFld(oSndr,sFId,fD,fP,oCCtx){var oR=new oeReq("Tree","Delete",this.prepCtx(arguments,oCCtx),this.prepCB("DeleteFolder",1),POST);oR.add("id",sFId);oR.add("fSrcD",fD?1:0);oR.add("pd",fP?1:0);oR.addRg("cms",tryGtActMd());oR.send()};Owa.Controls.FolderManager.prototype.mkAllRd=function Owa$Controls$FolderManager$mkAllRd(oSndr,sFId,oCCtx){var oR=new oeReq("Tree","MarkAllAsRead",this.prepCtx(arguments,oCCtx),this.prepCB("MarkAllAsRead",1),POST);oR.add("id",sFId);oR.send()};Owa.Controls.FolderManager.prototype.emptyFld=function Owa$Controls$FolderManager$emptyFld(oSndr,sMthd,sFId,oCCtx){var oR=new oeReq("Tree",sMthd,this.prepCtx(arguments,oCCtx),this.prepCB("EmptyFolder",1),POST);if(sMthd=="EmptyJunkEmail")oR.addRg("cms",tryGtActMd());else oR.add("id",sFId);oR.send()};Owa.Controls.FolderManager.getOwaStoreObjectIdPrefix=function Owa$Controls$FolderManager$getOwaStoreObjectIdPrefix(id){if(id.startsWith("PSF."))return FL_PUB;if(id.startsWith("OUM."))return FL_OUM;if(id.startsWith("AMB."))return FL_AMB;if(id.startsWith("GS."))return FL_GS;return FL_MBX};g_oEd.register("NewFolder");g_oEd.register("MoveFolder");g_oEd.register("DeleteFolder");g_oEd.register("MarkAllAsRead");g_oEd.register("EmptyFolder");g_oEd.register("UpdateFolderCount");g_oEd.register("CopyFolder");g_oEd.register("CopyItems");g_oEd.register("MoveItems");g_oEd.register("RenameFolder");g_oEd.register("UpdateCount")})();var g_oFldrMgr;if(!g_oFldrMgr){g_oFldrMgr=new Owa.Controls.FolderManager()}function isAB(){return isDf(typeof(initAB))}function isSngPkr(){return(isAB()&&isDf(typeof(a_fSngPk))&&a_fSngPk)}function isADOnly(){return(isAB()&&isDf(typeof(a_fADOnly))&&a_fADOnly)}function isPaaPkr(){return(isAB()&&isDf(typeof(a_fPaaPk))&&a_fPaaPk)}function isMblPkr(){return(isAB()&&isDf(typeof(a_fMblPk))&&a_fMblPk)}function isRepFw(){return(isDf(typeof(a_iNit))&&(a_iNit==RF_RPLY||a_iNit==RF_FWD||a_iNit==RF_PSTRPLY))}function isJnkEnbl(){if(isDf(typeof(a_fJnkEnbl)))return a_fJnkEnbl;return 0}function isJnkFld(oCallerSubPage){if(!oCallerSubPage){oCallerSubPage=Owa.UIControls.SubPage.get_Instance()}if((oCallerSubPage)&&isDf(typeof(oCallerSubPage.getSubPageVariable("a_fJnkFld"))))return oCallerSubPage.getSubPageVariable("a_fJnkFld");return 0}function isPI(){if(isDf(typeof(a_fP)))return a_fP;return 0}if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\core/browserconstants.js".toLowerCase()])(function(){(function(){Type.createNamespace("Owa.KeyCodes");var ns=Owa.KeyCodes;ns.BACK_SPACE=8;ns.DELETE=46;ns.DOWN=40;ns.END=35;ns.ENTER=13;ns.ESC=27;ns.F9=120;ns.HOME=36;ns.PAGE_DOWN=34;ns.PAGE_UP=33;ns.TAB=9;ns.UP=38})()})();g_fModuleLoaded[".\\core/browserconstants.js".toLowerCase()]=1;Type.createNamespace("Owa.Components");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/hotkey.js".toLowerCase()])(function(){var KC=Owa.KeyCodes;var keyNameValueMap={"TAB":KC.TAB,"ENTER":KC.ENTER,"UP":KC.UP,"DOWN":KC.DOWN,"HOME":KC.HOME,"END":KC.END,"PAGEUP":KC.PAGE_UP,"PAGEDOWN":KC.PAGE_DOWN,"ESC":KC.ESC};Owa.Components.HotKey=function Owa$Components$HotKey(oKeyPart,sCommand,fIngoreEventFromInput,fIngoreEventFromExternalFrame){this._oKeyPart=oKeyPart;this._sCmd=sCommand;this._fEnabled=true;this._fIgnoreEventFromInput=fIngoreEventFromInput;this._ffIngoreEventFromExternalFrame=fIngoreEventFromExternalFrame};Owa.Components.HotKey.createFromKeyStroke=function Owa$Components$createFromKeyStroke(sKey,sCommand,fIngoreEventFromInput,fIngoreEventFromExternalFrame){return new Owa.Components.HotKey(parseKey(sKey),sCommand,fIngoreEventFromInput,fIngoreEventFromExternalFrame)};var _oPrototype=Owa.Components.HotKey.prototype;_oPrototype.get_IngoreEventFromInput=function Owa$Components$HotKey$get_IngoreInputEvent(){return this._fIgnoreEventFromInput};_oPrototype.get_IngoreEventFromExternalFrame=function Owa$Components$HotKey$get_IngoreEventFromExternalFrame(){return this._ffIngoreEventFromExternalFrame};_oPrototype.get_oKeyPart=function Owa$Components$HotKey$get_oKeyPart(){return this._oKeyPart};_oPrototype.get_Command=function Owa$Components$HotKey$get_Command(){return this._sCmd};_oPrototype.get_IsEnabled=function Owa$Components$HotKey$get_IsEnabled(){return this._fEnabled};_oPrototype.set_IsEnabled=function Owa$Components$HotKey$set_IsEnabled(fEnable){this._fEnabled=fEnable};function parseKey(sKey){var iCtrl=0,iShift=0,iAlt=0,iMacCtrl=0,iKey=0;var rgKey=sKey.toUpperCase().split("+");for(var i=0;i<rgKey.length;i++){var s=rgKey[i];if("CTRL"==s){iCtrl=1}else if("MACCTRL"==s){iMacCtrl=1}else if("SHIFT"==s){iShift=1}else if("ALT"==s){iAlt=1}else if(keyNameValueMap[s]){iKey=keyNameValueMap[s]}else{if(isNaN(getInt(s)))iKey=s.charCodeAt(0);else iKey=getInt(s)}}return{"iCtrl":iCtrl,"iShift":iShift,"iAlt":iAlt,"iMacCtrl":iMacCtrl,"iKey":iKey}}})();g_fModuleLoaded[".\\components/hotkey.js".toLowerCase()]=1;var g_fLckd=0;var g_fPrcSp=0;var g_fShPrg=0;var g_SplLng=SP_RESET;var g_sLstSpTx=SP_RESET;var g_iLstSpLng=0;var g_oCurSel=0;var g_oCurrentSpellCheckRequest=null;var g_sImgPHId="OWAImgPlaceHolder";var SP_RESET=-1;function onKDBuf(){var e=edEvt();if(!e)return;if(getKeyCode(e)==27&&g_fPrcSp){g_fPrcSp=0;if(g_oCurrentSpellCheckRequest){g_oCurrentSpellCheckRequest.cancelCallback();g_oCurrentSpellCheckRequest=null}g_sLstSpTx=SP_RESET;g_rgWR=0;g_sSCTxt=0;cnclBbl(e);window.setTimeout(relLck,500)}else{return false}}function relLck(){lckBdy(0);updCmp(window,window.oR)}function lckBdy(f){if(g_fLckd==f)return;var oEdD=edDoc();if(f){try{setFcsBdy(0)}catch(e){return 0}g_fLckd=f;if(isHtml()){var oDivFmtBr=$("divFmtBr");if(isFormatBarInitialized(oDivFmtBr)){oDivFmtBr.getExpando("formatBar").enableFormatbar(0)}}var buffer=getEm("SPAN",oEdD);buffer=oEdD.appendChild(buffer);buffer.id="buffer";buffer.style.pixelWidth=1;buffer.style.overflow="hidden";buffer.contentEditable=true;buffer.onkeydown=onKDBuf;setFcs(buffer);var oEdDoc=Owa.Dom.Node.wrapDomNode(oEdD);oEdDoc.detachAllEvents("activate");oEdDoc.detachAllEvents("deactivate");oEdDoc.attachEvent("deactivate",new Function("setFcs(ifBdy.document.all.buffer);"));oEdDoc.attachEvent("activate",new Function("setFcs(ifBdy.document.all.buffer);"))}else{g_fPrcSp=0;var oEdDoc=Owa.Dom.Node.wrapDomNode(oEdD);if(isHtml()){var oDivFmtBr=$("divFmtBr");if(isFormatBarInitialized(oDivFmtBr)){var oEditor=$("divFmtBr").getExpando("formatBar");oEditor._attachContentWindowEvents();oEditor.enableFormatbar(1)}}var oBuffer=getOneDescendant(oEdD,"buffer");if(oBuffer){oBuffer.onkeydown=null;rn(oBuffer)}g_fLckd=f;try{setFcsBdy(0)}catch(e){return 0}if(g_oCurSel){doCllps(g_oCurSel,0);g_oCurSel=0}if(g_fShPrg){g_fShPrg=0;hdPrgrsInd()}}return 1}function procSpl(oCb,iOp){if(Owa.Components.OehRequest.hasPendingRequests()||g_fLckd)return;g_oCurSel=crtSelTxR();if(!lckBdy(1))return;var oC=new Object();oC.iOp=iOp;oC.oCb=oCb;var oDivSpl=$("divSpl").getExpando("oSpellCheckerComboBox");if(oDivSpl.oSpSel){g_oCurSel=oDivSpl.oSpSel;oDivSpl.oSpSel=0}var rgImg=edDoc().images;for(var i=0;i<rgImg.length;i++){iaeh(rgImg[i],"<span id="+g_sImgPHId+" style=\"width:0px;height:0px;overflow:hidden\">&nbsp;</span>")}try{oC.oRng=gtSpTxtR(oC.iOp);oC.sTxt=oC.oRng.text;if((oC.oRng.text=="")||((g_sLstSpTx==oC.oRng.text)&&(g_iLstSpLng==g_SplLng))){lckBdy(0);if(oC.iOp&&(oC.iOp&OP_SND))oCb(oC.iOp);updCmp(window);return}if(g_SplLng==SP_RESET)g_SplLng=a_iSp;g_sLstSpTx=oC.oRng.text;g_iLstSpLng=g_SplLng;clrSpUI(1);var oR=new oeReq("SpellChecker","SpellCheck",oC,cbProcSpl);oR.add("Tx",oC.oRng.text);oR.add("Lng",g_SplLng);g_fShPrg=1;shwPrgrsInd(L_ChkSpl,100);g_fPrcSp=1;oR.send();g_oCurrentSpellCheckRequest=oR}finally{var rgSpn=edDoc().all(g_sImgPHId);if(rgSpn&&!rgSpn.length){rgSpn=[rgSpn]}if(rgSpn){for(var i=rgSpn.length-1;i>=0;i--){rn(rgSpn[i])}}}}function cbProcSpl(oR){g_oCurrentSpellCheckRequest=null;if(!g_fPrcSp)return;var oC=oR.oCtx;var oSR=oC.oRng;var sTxt=oC.sTxt;var sEr=0;var rg;if(oR.sErr){if(oR.fST)popLgn();sEr=oR.sErr}if(!sEr){rg=eval(oR.sBody);if(!rg.length){lckBdy(0);if(oC.iOp&&(oC.iOp&OP_SND)){oC.oCb(oC.iOp);return}replaceOrInsertInfobarMessage(L_ChkSplNoErr,"divSpIB");setFcsBdy(0)}else{checkRemoveInfobarMessage("divSpIB");if(oC.iOp&&(oC.iOp&OP_SND)){var oMessage=replaceOrInsertInfobarMessage(L_ChkSplOnSnd,"divSpIB",7);oMessage.addCssClass("error")}prcSCk(rg,oSR,sTxt);posElm(edDoc().body,1);setFcsBdy(0);window.oR=oR;return true}}else{g_sLstSpTx=SP_RESET;lckBdy(0);if(!oR.fST)shwErrDlg(oR)}}function mvToCh(oSR,iOff){var oR=oSR.duplicate();oR.collapse(1);oR.move("character",iOff);return oR}var g_iLsIdxCRLFs=0;var g_iTotCRLFs=0;function cntCRLFs(sTxt,iOff){var ix=sTxt.indexOf("\r\n",g_iLsIdxCRLFs);while(ix>=0&&ix<iOff){g_iTotCRLFs++;g_iLsIdxCRLFs=ix+2;ix=sTxt.indexOf("\r\n",g_iLsIdxCRLFs)}return g_iTotCRLFs}var g_oCurRng=0;function initRng(iOff,iLen,sW,iS){g_oCurRng.moveStart("character",iS);g_oCurRng.moveEnd("character",iLen);if(g_oCurRng.text==sW){var oRng=g_oCurRng.duplicate();oRng.collapse(0);oRng.pasteHTML("<a></a>");return g_oCurRng.duplicate()}else{var oT=g_oCurRng.duplicate();if(oT.text==sW)return oT;var o=gtCurPos(g_oCurRng);var iS=0;var iE=0;var iEnd=iOff+iLen;if(o.st!=iOff)iS=iOff-o.st;if(o.end!=iEnd)iE=iEnd-o.end;if(iS)g_oCurRng.moveStart("character",iS);if(iE)g_oCurRng.moveEnd("character",iE);if(g_oCurRng.text==sW)return g_oCurRng.duplicate()}}function doPrcSCk(){if(g_iResIdx==g_rgRes.length||!g_fPrcSp){if(g_fPrcSp)mrkRngs();return}for(var i=0;g_iResIdx<g_rgRes.length&&i<2;i++){var r=g_rgRes[g_iResIdx];++g_iResIdx;if(!r)continue;var iL;var rgSg;var oR;var iS;var iLFs;var iT=r[0];var iOff=r[1];switch(iT){case 0:iL=r[2];rgSg=r[3];break;case 1:iT=0;var dup=g_rgRes[r[2]];iL=dup[2];rgSg=dup[3];break;case 2:iL=r[2];rgSg=null;break}var iCOff=iOff-cntCRLFs(g_sSCTxt,iOff);iS=iCOff-g_iLS;var sW=g_sSCTxt.substr(iOff,iL);oR=initRng(iOff,iL,sW,iS);g_iLS=iCOff;if(!oR||isIgA(oR.text))continue;oR.iT=iT;oR.rgSg=rgSg;g_rgWR.push(oR)}window.setTimeout(doPrcSCk,1)}var g_rgSg=0;var g_rgWR=0;var g_iDxWR=0;var g_rgRes=0;var g_iResIdx=0;var g_sSCTxt=0;var g_iLS=0;function prcSCk(rg,oSR,sTxt){g_iLsIdxCRLFs=0;g_iTotCRLFs=0;g_rgSg=new Array();g_rgWR=new Array();g_iDxWR=0;g_rgRes=rg;g_iResIdx=0;g_iLS=0;g_sSCTxt=sTxt;var iOff=rg[0][1];g_iLS=iOff-cntCRLFs(sTxt,iOff);g_oCurRng=mvToCh(oSR,g_iLS);doPrcSCk()}function mrkRngs(){if(!g_fPrcSp)return;if(g_iDxWR==g_rgWR.length){lckBdy(0);g_rgWR=0;g_sSCTxt=0;updCmp(window,window.oR);return}for(var i=0;g_iDxWR<g_rgWR.length&&i<2;i++){var oR=g_rgWR[g_iDxWR];g_rgWR[g_iDxWR]=0;++g_iDxWR;doMrkRng(oR)}window.setTimeout(mrkRngs,1)}function doMrkRng(oR){var iT=oR.iT;var rgSg=oR.rgSg;var idx=-1;if(rgSg){idx=g_rgSg.length;g_rgSg[idx]=rgSg}var s=oR.htmlText;try{s="<span id=misspelled tabIndex=-1 t="+iT+" s='"+idx+"'>"+s+"</span>";oR.pasteHTML("");oR.pasteHTML(s)}catch(e){}}function unmrkW(oSpn){if(!Owa.Dom.Node.isInstance(oSpn)){oSpn=Owa.Dom.Node.wrapDomNode(oSpn)}oSpn.remove(false)}function clrSpUI(f){if(f){g_rgSg.length=0}var rgW=gtInvWs();if(rgW){var enumerator=rgW.get_Enumerator();while(enumerator.moveNext()){unmrkW(enumerator.get_Current())}}return(rgW?1:0)}function gtWrd(f,keyCode,e){var oR=crtSelTxR();if(!oR)return;var oW=gtCurWrd(oR.parentElement());if(oW){var iP=gtCurPos(oR);gtElPos(oW);if(!f||(iP.st!=iP.end)||(keyCode!=32)||((keyCode==32)&&(iP.st>oW.st&&iP.end<oW.end)))return oW;var sp=getEm("SPAN",edDoc());if(iP.st<=oW.st)sp=ibb(oW,sp);else sp=iae(oW,sp);sp.innerText=" ";oR.moveToElementText(sp);if(iP.end==oW.end)doCllps(oR,0);var oC=oW.firstChild;if(oC&&(oC.nodeType==1)&&(oC.tagName=="DIV"))oC.removeNode();sp.removeNode();canEvt(e);return 0}return oW}function gtSpTxtR(iOp){var oR;var o=gtCurPos(g_oCurSel,1,1);if((o.end==o.st)||(iOp==OP_SND)){oR=gtSpTxt()}else{oR=o.sel}return oR}function replW(oW,s){var oR=oW.oR.duplicate();var oC=oW.firstChild;while(oC){if(oC.nodeType==3){oC.parentNode.innerText=s;break}oC=oC.firstChild}unmrkW(oW);oR.findText(s);doCllps(oR,0)}function delDupW(oW){var oR=oW.oR.duplicate();oR.setEndPoint("StartToEnd",oR);oR.moveEnd("character",1);if(oR.text==" ");{oR.collapse(0);oW.oR.moveEnd("character",1)}oW.oR.text="";rn(oW);doCllps(oR,0)}function igNW(oW){var oR=oW.oR.duplicate();unmrkW(oW);doCllps(oR,0)}var g_rgIgA=new Array();function isIgA(s){for(var i=0;i<g_rgIgA.length;++i){if(g_rgIgA[i]==s)return 1}return 0}function addIgA(s){if(!isIgA(s))g_rgIgA.push(s)}function ignrAll(oSpnWord){var oR=oSpnWord.oR.duplicate();var sW=Owa.Dom.Node.wrapDomNode(oSpnWord).get_TextContent();addIgA(sW);var rgW=gtInvWs();if(rgW){var enumerator=rgW.get_Enumerator();while(enumerator.moveNext()){var o=enumerator.get_Current();var s=o.get_TextContent();if(s.lc()==sW.lc())unmrkW(o)}}doCllps(oR,0)}function gtCurWrd(o){while(o){if(o.id=="misspelled"){return o}if(o.tagName&&o.tagName.lc()=="body"){return null}o=o.parentNode}return null}function gtInvWs(){var rg=edDoc(1).get_Body().getAllDescendantsById("misspelled");if(!rg.length){return null}return rg}function crtTxR(){return edDoc().body.createTextRange()}function crtSelTxR(){try{var oSel=edDoc().selection;if(oSel.type=="None"||oSel.type=="Text")return oSel.createRange()}catch(e){}}function selWrd(oW){var oR=crtTxR();oR.moveToElementText(oW);oR.select()}function gtCurPos(oSR,fS,fE){var o=new Object();if(!oSR)oSR=crtSelTxR();if(oSR&&cntns(edDoc().body,oSR.parentElement(),1)){gtOffset(oSR,o,fS,fE)}else{oSR=crtTxR();doCllps(oSR,1);o.st=o.end=0;if(fS)o.sel=oSR}return o}function gtOffset(oSR,o,fS,fE){if(fE&&oSR.text.length)oSR.expand("word");var oR=gtBdTxR(oSR,'EndToEnd');o.st=oR.text.length-oSR.text.length;o.end=o.st+oSR.text.length;if(fS)o.sel=oSR}function gtBdTxR(oSR,sEP){var oR=oSR.duplicate();oR.moveToElementText(edDoc().body);oR.setEndPoint(sEP,oSR);return oR}function gtSpTxt(){var oR;var oDv=wtda(g_sRFId,edDoc().parentWindow);if(!isRepFw()||!oDv||oDv.length){oR=crtTxR()}else{var oSR=crtTxR();oSR.moveToElementText(oDv);oR=gtBdTxR(oSR,'EndToStart')}return oR}function gtElPos(o){var oR=crtTxR();oR.moveToElementText(o);gtOffset(oR,o)}var SP_E="0";var SP_DE="1";var SP_D="2";function cmPreShwSpl(o){switch(o.t){case SP_E:case SP_DE:cmPreShwErr(o);break;case SP_D:cmPreShwDup();break}}function cmPreShwEd(){function Itm(o,sC){this.itm=o;this.cmd=sC}var rg=new Array(new Itm(wda("divUndo"),"Undo"),new Itm(wda("divCut"),"Cut"),new Itm(wda("divCpy"),"Copy"),new Itm(wda("divPst"),"Paste"),new Itm(wda("divDel"),"Delete"),new Itm(wda("divSlA"),"SelectAll"));for(var i=0;i<rg.length;++i){var o=rg[i];var st;var smimeDisable=g_oMmBdy&&(o.cmd=="Cut"||o.cmd=="Copy"||o.cmd=="Paste");var irmDisable=isDf(typeof(a_fCopyRestricted))&&(a_fCopyRestricted==1)&&(o.cmd=="Cut"||o.cmd=="Copy");if(smimeDisable||irmDisable){st=0}else{st=queryStatus(o.cmd)}o.itm.UNSELECTABLE="on";ctxMnuDsbl(o.itm,!st)}}function cmPreShwErr(o){var rg=g_rgSg[o.s];var divScm=wda("divScm");var rgD=divScm.all["divSg"];var rgShw=new Array();var i;if(!rg||!rg.length){showEm(divScm.all["nSg"])}else{for(i=0;i<rg.length;++i){if(rg[i]&&rgD[i]){rgD[i].all["spnT"].innerText=rg[i];if(rg[i]==L_ChkSplNoSug)o=rgD[i];rgShw.push(rgD[i])}}showEm(divScm.all["nSg"],1);cmShwEm(rgShw,0)}showEm(divScm.all["divS1"]);if(rgShw.length<rgD.length){var rgH=new Array();i=rgShw.length;for(i;i<rgD.length;++i){rgH.push(rgD[i])}cmShwEm(rgH,1)}cmShwEm(new Array(divScm.all["divIgA"]));cmShwEm(new Array(divScm.all["divDdw"]),1)}function cmPreShwDup(){var divScm=wda("divScm");showEm(divScm.all["nSg"],1);cmShwEm(divScm.all["divSg"],1);cmShwEm(new Array(divScm.all["divIgA"]),1);showEm(divScm.all["divS1"],1);cmShwEm(new Array(divScm.all["divDdw"]),0)}function shwCMSp(e,oW){var iY=getEvtCY(e)+12+gtHdrHgt();var iX=getEvtCX(e)+10;var divScm=wda("divScm");divScm.preShw(oW);divScm.lnks=cmLnks(divScm);divScm.show(e,iX,iY);selWrd(divScm.word)}function gtHdrHgt(){var iH=0;var oDivFmtBr=$("divFmtBr");if(oDivFmtBr){iH=getCY(oDivFmtBr)+goh(oDivFmtBr._get_DomNode())}return iH}function shwCMEd(e){var divEcm=wda("divEcm");showEm(divEcm);var iY=getEvtCY(e)+12+gtHdrHgt();var iX=getEvtCX(e)+10;divEcm.preShw();divEcm.lnks=cmLnks(divEcm);divEcm.show(e,iX,iY);divEcm.word.select()}function doCllps(oR,f){oR.collapse(f);oR.select()}function onSelSpl(sC,oV){if(gtAttrN(oV,"_lnk")==0)return;var divScm=wda("divScm");var oW=divScm.word;if(!oW.oR){oW.oR=crtTxR();oW.oR.moveToElementText(oW)}switch(sC){case"replace":replW(oW,oV.all["spnT"].innerText);g_sLstSpTx=SP_RESET;drty();break;case"delete":delDupW(oW);g_sLstSpTx=SP_RESET;drty();break;case"ignore":igNW(oW);break;case"ignoreall":ignrAll(oW);break}oW.oR=null}function onSelEdt(sC,oV){doEdCtxM(sC,wda("divEcm").word)}function onCMEd(o){var e=edEvt();var s=0;if(e)s=getEvtTgt(edEvt());if(!o.id)o=gtCurWrd(s);var divScm=wda("divScm");var divEcm=wda("divEcm");if(o&&divScm){var oEdB=edDoc().body;divScm.word=o;divScm.word.fR=0;shwCMSp(e,o)}else if(divEcm){var sr=crtSelTxR();if(!sr){if(isDf(typeof(a_fCopyRestricted))&&(a_fCopyRestricted==1)){canEvt(e)}return}divEcm.word=sr;divEcm.word.fR=1;shwCMEd(e)}canEvt(e)}function onEdWScr(){if(onEdWScr.caller)return;clsEdCtxMs()}function clsEdCtxMs(){var oDivScm=$("divScm");var oDivEcm=$("divEcm");if(oDivScm&&oDivScm.hide){oDivScm.hide()}if(oDivEcm&&oDivEcm.hide){oDivEcm.hide()}}function lstCntns(o){var len=arguments.length;for(var i=1;i<len;i++){if(o==arguments[i])return 1}}function hndSpK(e){if(g_fLckd)return false;var code=getKeyCode(e);var fCtrl=isCtrlKD(e);var fEsc=(code==27)?1:0;var fOpKey=lstCntns(code,8,13,32,46);var f=(code==46)?1:((code==8)?-1:1);var fTextKey=((code>=48&&code<=90)||(code>=186&&code<=222));if(!fEsc&&!fCtrl&&(fOpKey||fTextKey)){var o=gtWrd(f,code,e);if(o)unmrkW(o)}}var g_SplLng=SP_RESET;function queryStatus(sC){return(edDoc().queryCommandSupported(sC))&&(edDoc().queryCommandEnabled(sC))?1:0}function doEdCtxM(sC,sR){if(sR)sR.select();Owa.ExecCommand.execute(edDoc(),sC)}function onMUSpl(){var e=getEvt(this);canEvt(e)}function clkSpOK(){g_SplLng=$("divSpl").getExpando("oSpellCheckerComboBox").get_SelectedValue();wda("spellcheck").click()}function clkSpCn(){var oB=Owa.UIControls.MenuButton.get_CurrentPopupButton();if(oB&&(oB.get_Id()=="spellcheckd"))oB.hide()}function dispSp(){var oDivSpl=$("divSpl");if(oDivSpl){var oCombo=oDivSpl.getExpando("oSpellCheckerComboBox");if(oCombo){oCombo.oSpSel=0;oCombo.dispose()}}var divScm=wda("divScm");divScm.word=0;dispCtxMnu(divScm)}if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/ComboDropDownList.js".toLowerCase()])(function(){var ON_CHANGE="onChange";var sSelectedItemCssClass=Owa.Strings.CssClass.ComboDropDownSelectedItem;Owa.UIControls.ComboDropDownList=function Owa$UIControls$ComboDropDownList(oElement,oParent,fDisableOffscreenBox,fForceOnChangeHandlers){Owa.UIControls.ComboDropDownList.constructBase(this,[oElement,oParent,fDisableOffscreenBox]);this._rgListItems=false;this._oComboBox=oParent;this._iSelectedItemIndex=-1;this._fForceOnChangeHandlers=fForceOnChangeHandlers};Owa.UIControls.ComboDropDownList.prototype.initialize=function Owa$UIControls$ComboDropDownList$prototype$initialize(){Owa.UIControls.ComboDropDownList.callBase(this,"initialize");this._get_Element().addCssClass("dropDownListMaxHeight");this._initializeItems();this.get_OnPreShow().add(this._createCallback(this._onPreShow));this._attachEvent(this._get_Element(),"click",this._onClick)};Owa.UIControls.ComboDropDownList.prototype.dispose=function Owa$UIControls$ComboDropDownList$prototype$dispose(){this._get_Element().detachAllEvents();for(var iItem=0;iItem<this._rgListItems.length;++iItem){this._rgListItems[iItem].oDomItem.detachAllEvents()}Owa.UIControls.ComboDropDownList.callBase(this,"dispose")};Owa.UIControls.ComboDropDownList.prototype.get_OnChange=function Owa$UIControls$ComboDropDownList$prototype$get_OnChange(){return this._getEventHandlerCollection(ON_CHANGE)};Owa.UIControls.ComboDropDownList.prototype._onClick=function Owa$UIControls$ComboDropDownList$prototype$_onClick(oEvent){oEvent.cancelBubble()};Owa.UIControls.ComboDropDownList.prototype._onKeyDown=function Owa$UIControls$ComboDropDownList$prototype$_onKeyDown(oEvent){switch(oEvent.get_KeyCodeForKeyUpDown()){case 9:this.close();break;case 40:this._arrowDown();break;case 38:this._arrowUp();break;case 13:this.close();break;case 36:this.set_SelectedItemIndex(0);break;case 35:this.set_SelectedItemIndex(this._rgListItems.length-1);break;case 34:this._pageDown();break;case 33:this._pageUp();break;default:return}oEvent.cancelBubble()};Owa.UIControls.ComboDropDownList.prototype._onPreShow=function Owa$UIControls$ComboDropDownList$prototype$_onPreShow(){var iComboBoxWidth=this._oComboBox._get_Element().get_OffsetWidth();var oList=this._get_Element();var iScrollPadding=(oList.get_OffsetHeight()<oList.get_ScrollHeight())?20:0;oList.set_Width(null);if(oList.get_OffsetWidth()+iScrollPadding<iComboBoxWidth){oList.set_Width(iComboBoxWidth)}else{oList.set_Width(oList.get_OffsetWidth()+iScrollPadding)}this._ensureVisible()};Owa.UIControls.ComboDropDownList.prototype._onItemClick=function Owa$UIControls$ComboDropDownList$prototype$_onItemClick(oEvent,oItem){for(var iItem=0;iItem<this._rgListItems.length;++iItem){if(this._rgListItems[iItem].oDomItem==oItem){this.set_SelectedItemIndex(iItem,this._fForceOnChangeHandlers);break}}this.close()};Owa.UIControls.ComboDropDownList.prototype._pageDown=function Owa$UIControls$ComboDropDownList$prototype$_pageDown(){var iNextHighlight=this.get_SelectedItemIndex()+this._get_PageSize();if(iNextHighlight>=this._rgListItems.length-1){iNextHighlight=this._rgListItems.length-1}this.set_SelectedItemIndex(iNextHighlight)};Owa.UIControls.ComboDropDownList.prototype._pageUp=function Owa$UIControls$ComboDropDownList$prototype$_pageUp(){var iNextHighlight=this.get_SelectedItemIndex()-this._get_PageSize();if(iNextHighlight<0){iNextHighlight=0}this.set_SelectedItemIndex(iNextHighlight)};Owa.UIControls.ComboDropDownList.prototype._arrowDown=function Owa$UIControls$ComboDropDownList$prototype$_arrowDown(){if(this.get_SelectedItemIndex()<this._rgListItems.length-1){this.set_SelectedItemIndex(this.get_SelectedItemIndex()+1)}};Owa.UIControls.ComboDropDownList.prototype._arrowUp=function Owa$UIControls$ComboDropDownList$prototype$_arrowUp(){if(this.get_SelectedItemIndex()>0){this.set_SelectedItemIndex(this.get_SelectedItemIndex()-1)}};Owa.UIControls.ComboDropDownList.prototype.hasValue=function Owa$UIControls$ComboDropDownList$prototype$hasValue(oValue){return this._getValueIndex(oValue)>=0};Owa.UIControls.ComboDropDownList.prototype.selectValue=function Owa$UIControls$ComboDropDownList$prototype$selectValue(oValue,fSkipOnChangeHandlers){var valueIndex=this._getValueIndex(oValue);if(valueIndex>=0){this.set_SelectedItemIndex(valueIndex,0,fSkipOnChangeHandlers)}else{throw new Error("value specified for selection not present")}};Owa.UIControls.ComboDropDownList.prototype.get_SelectedValue=function Owa$UIControls$ComboDropDownList$prototype$get_SelectedValue(){if(this.get_SelectedItemIndex()>=0){return this._rgListItems[this.get_SelectedItemIndex()].oValue}else{return undefined}};Owa.UIControls.ComboDropDownList.prototype.get_SelectedItem=function Owa$UIControls$ComboDropDownList$prototype$get_SelectedItem(){if(this.get_SelectedItemIndex()>=0){return this._rgListItems[this.get_SelectedItemIndex()]}else{return undefined}};Owa.UIControls.ComboDropDownList.prototype.addItem=function Owa$UIControls$ComboDropDownList$prototype$addItem(sDisplayText,oValue){if(this.hasValue(oValue)){throw new Error("value already present in comboBoxList")}var oNewElement=this._get_Element().get_OwnerDocument().createElement("DIV");var oNewSpan=this._get_Element().get_OwnerDocument().createElement("SPAN");oNewSpan.addCssClass("listItm");oNewSpan.set_TextContent(sDisplayText);oNewElement.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,oNewSpan);this._get_Element().insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,oNewElement);this._addDomItem(oNewElement,oValue)};Owa.UIControls.ComboDropDownList.prototype.clearItems=function Owa$UIControls$ComboDropDownList$prototype$clearItems(){this.set_SelectedItemIndex(-1);for(var iIndex=0;iIndex<this._rgListItems.length;){this._remove(iIndex)}};Owa.UIControls.ComboDropDownList.prototype.getDomItemByIndex=function Owa$UIControls$ComboDropDownList$prototype$getDomItemByIndex(iIndex){if(iIndex<0||iIndex>=this._rgListItems.length){throw new Error("Argument out of range")}return this._rgListItems[iIndex].oDomItem};Owa.UIControls.ComboDropDownList.prototype.getValueByIndex=function Owa$UIControls$ComboDropDownList$prototype$getValueByIndex(iIndex){if(iIndex<0||iIndex>=this._rgListItems.length){throw new Error("Argument out of range")}return this._rgListItems[iIndex].oValue};Owa.UIControls.ComboDropDownList.prototype.getItemCount=function Owa$UIControls$ComboDropDownList$prototype$getItemCount(){return this._rgListItems.length};Owa.UIControls.ComboDropDownList.prototype.get_SelectedItemIndex=function Owa$UIControls$ComboDropDownList$prototype$get_SelectedItemIndex(){return this._iSelectedItemIndex};Owa.UIControls.ComboDropDownList.prototype.set_SelectedItemIndex=function Owa$UIControls$ComboDropDownList$prototype$set_SelectedItemIndex(iIndex,fForceOnChangeHandlers,fSkipOnChangeHandlers){if(iIndex==this._iSelectedItemIndex&&!fForceOnChangeHandlers){return}if(iIndex>=this._rgListItems.length){throw new Error("Argument out of range")}if(this._iSelectedItemIndex>=0){this._rgListItems[this._iSelectedItemIndex].oDomItem.removeCssClass(sSelectedItemCssClass)}this._iSelectedItemIndex=iIndex;if(this._iSelectedItemIndex>=0){this._rgListItems[this._iSelectedItemIndex].oDomItem.addCssClass(sSelectedItemCssClass);this._ensureVisible()}else{this._iSelectedItemIndex=-1;this._get_Element().set_ScrollTop(0)}if(!fSkipOnChangeHandlers){this._dispatchEvent(ON_CHANGE,this)}};Owa.UIControls.ComboDropDownList.prototype._ensureVisible=function Owa$UIControls$ComboDropDownList$prototype$_ensureVisible(){var iItemHeight=this._get_Element().get_ScrollHeight()/this._rgListItems.length;var iFirstVisibleItem=this._get_Element().get_ScrollTop()/iItemHeight;if(this._iSelectedItemIndex<iFirstVisibleItem){this._get_Element().set_ScrollTop(this._iSelectedItemIndex*iItemHeight)}else{var iLastVisibleItem=(this._get_Element().get_ScrollTop()+this._get_Element().get_OffsetHeight())/iItemHeight-1;if(this._iSelectedItemIndex>iLastVisibleItem){this._get_Element().set_ScrollTop((this._iSelectedItemIndex+1)*iItemHeight-this._get_Element().get_OffsetHeight())}}};Owa.UIControls.ComboDropDownList.prototype._getValueIndex=function Owa$UIControls$ComboDropDownList$prototype$_getValueIndex(oValue){for(var i=0;i<this._rgListItems.length;++i){if(Owa.Utility.isEqual(this._rgListItems[i].oValue,oValue)){return i}}return -1};Owa.UIControls.ComboDropDownList.prototype._remove=function Owa$UIControls$ComboDropDownList$prototype$_remove(iIndex){if(this.get_SelectedItemIndex()==iIndex){this.set_SelectedItemIndex(-1)}else if(this.get_SelectedItemIndex()>iIndex){this._iSelectedItemIndex--}this._rgListItems[iIndex].oDomItem.detachAllEvents();this._rgListItems[iIndex].oDomItem.remove(true);this._rgListItems.removeAt(iIndex)};Owa.UIControls.ComboDropDownList.prototype._get_PageSize=function Owa$UIControls$ComboDropDownList$prototype$_get_PageSize(){var iRetVal=(this._rgListItems.length*this._get_Element().get_OffsetHeight())/this._get_Element().get_ScrollHeight();return new Number(iRetVal.toFixed(0))};Owa.UIControls.ComboDropDownList.prototype._initializeItems=function Owa$UIControls$ComboDropDownList$prototype$_initializeItems(){if(this._rgListItems){throw new Error("Invalid operation")}this._rgListItems=new Array();var childEnumerator=this._get_Element().get_Enumerator();while(childEnumerator.moveNext()){var oDomItem=childEnumerator.get_Current();if(this._get_Element().getAttribute("_fUseChildItem")){oDomItem=oDomItem.get_FirstChild()}this._addDomItem(oDomItem,oDomItem.getAttribute(Owa.Strings.Attributes.Value))}};Owa.UIControls.ComboDropDownList.prototype._addDomItem=function Owa$UIControls$ComboDropDownList$prototype$_addDomItem(oDomItem,oValue){this._rgListItems.add({oDomItem:oDomItem,oValue:oValue});this._attachEvent(oDomItem,"click",this._onItemClick,oDomItem)};Owa.UIControls.ComboDropDownList.createClass("Owa.UIControls.ComboDropDownList",Owa.UIControls.Popup)})();g_fModuleLoaded[".\\uicontrols/ComboDropDownList.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/ComboBox.js".toLowerCase()])(function(){var ON_SHOW="onShow";var ON_CHANGE="onChange";Owa.UIControls.ComboBox=function Owa$UIControls$ComboBox(oElement,oParent,fDisableOffscreenBox,fForceOnChangeHandlers){Owa.UIControls.ComboBox.constructBase(this,[oElement,oParent]);this._oDropDownList=null;this._oClientAction=null;this._oSelectedValue=null;this._oTextBox=null;this._fSelectedValueCanBeNull=false;this._fDisableOffscreenBox=fDisableOffscreenBox;this._fForceOnChangeHandlers=fForceOnChangeHandlers};Owa.UIControls.ComboBox.prototype.initialize=function Owa$UIControls$ComboBox$prototype$initialize(){this._attachEvent(this._get_Element(),"mousedown",this._onMouseDown);this._attachEvent(this._get_Element(),"click",this._onClick);this._attachEvent(this._get_Element(),"keydown",this._onKeyDown);this._initializeDropDown();this._oDropDownList.get_OnDataBind().add(this._createCallback(this._onPreShow));this._oDropDownList.get_OnChange().add(this._createCallback(this._onChange));this._initializeSelection();this.set_IsEnabled(this._getIntAttribute("fEnbld"))};Owa.UIControls.ComboBox.prototype.dispose=function Owa$UIControls$ComboBox$dispose(){this._oDropDownList.dispose();this._oDropDownList=null;if(Owa.UIControls.ComboBox.prototype._isEditable())this._oTextBox.detachAllEvents();Owa.UIControls.ComboBox.callBase(this,"dispose")};Owa.UIControls.ComboBox.prototype.get_OnShow=function Owa$UIControls$ComboBox$prototype$get_OnShow(){return this._getEventHandlerCollection(ON_SHOW)};Owa.UIControls.ComboBox.prototype.get_OnChange=function Owa$UIControls$ComboBox$prototype$get_OnChange(){return this._getEventHandlerCollection(ON_CHANGE)};Owa.UIControls.ComboBox.prototype._onChange=function Owa$UIControls$ComboBox$prototype$_onChange(){var oSelectedValue=this._oDropDownList.get_SelectedValue();if((isDf(typeof(oSelectedValue))&&oSelectedValue!==null)||this._fSelectedValueCanBeNull){this._selectValue(oSelectedValue)}};Owa.UIControls.ComboBox.prototype._onPreShow=function Owa$UIControls$ComboBox$prototype$_onPreShow(){if(this._oDropDownList.hasValue(this._oSelectedValue)){this._oDropDownList.selectValue(this._oSelectedValue)}this._dispatchEvent(ON_SHOW,this)};Owa.UIControls.ComboBox.prototype._onMouseDown=function Owa$UIControls$ComboBox$prototype$_onMouseDown(oEvent){if(this.get_IsEnabled()&&oEvent.isLeftButtonDown()&&(!this._isEditable()||(this._isEditable()&&!oEvent.get_Target().equals(this._oTextBox)))){this.showDropDown()}};Owa.UIControls.ComboBox.prototype._onClick=function Owa$UIControls$ComboBox$prototype$_onClick(oEvent){oEvent.preventDefault()};Owa.UIControls.ComboBox.prototype._onKeyDown=function Owa$UIControls$ComboBox$prototype$_onKeyDown(oEvent){if(this.get_IsEnabled()){if(this._isEditable()&&(oEvent.get_KeyCodeForKeyUpDown()==9))this.hideDropDown();if(oEvent.get_KeyCodeForKeyUpDown()==13){this.showDropDown()}}};Owa.UIControls.ComboBox.prototype.get_SelectedValue=function Owa$UIControls$ComboBox$prototype$get_SelectedValue(){return this._oSelectedValue};Owa.UIControls.ComboBox.prototype.set_SelectedValue=function Owa$UIControls$ComboBox$prototype$set_SelectedValue(oValue,fSkipOnChangeHandlers){this._selectValue(oValue,fSkipOnChangeHandlers)};Owa.UIControls.ComboBox.prototype.renderValue=function Owa$UIControls$ComboBox$prototype$renderValue(sText){var oComboSpan=this._get_Element().getDescendantById(Owa.Strings.Ids.ComboTextDisplaySpan);if(Owa.Utility.isIE()){oComboSpan.set_InnerHtmlIEWorkaround(sText)}else{oComboSpan.set_InnerHtml(sText)}this._oDropDownList.set_SelectedItemIndex(-1);this._oSelectedValue=null};Owa.UIControls.ComboBox.prototype.get_IsEnabled=function Owa$UIControls$ComboBox$prototype$get_IsEnabled(){return this._getIntAttribute(Owa.Strings.Attributes.IsDisabled)!=1};Owa.UIControls.ComboBox.prototype.set_IsEnabled=function Owa$UIControls$ComboBox$prototype$set_IsEnabled(fEnable){this._setIntAttribute(Owa.Strings.Attributes.IsDisabled,fEnable?0:1);if(fEnable){this._get_Element().removeCssClass(Owa.Strings.CssClass.ComboBoxDisable)}else{this._get_Element().addCssClass(Owa.Strings.CssClass.ComboBoxDisable)}};Owa.UIControls.ComboBox.prototype.showDropDown=function Owa$UIControls$ComboBox$prototype$showDropDown(){this._oDropDownList.showRelative(0,this._get_Element().get_OffsetHeight())};Owa.UIControls.ComboBox.prototype.hideDropDown=function Owa$UIControls$ComboBox$prototype$hideDropDown(){this._oDropDownList.close()};Owa.UIControls.ComboBox.prototype.get_DropDownList=function Owa$UIControls$ComboBox$prototype$get_DropDownList(){return this._oDropDownList};Owa.UIControls.ComboBox.prototype._selectValue=function Owa$UIControls$ComboBox$prototype$_selectValue(oValue,fSkipOnChangeHandlers){var oCurrentValue=this._oSelectedValue;if(!Owa.Utility.isEqual(oCurrentValue,oValue)){this._oSelectedValue=oValue;if(this._oDropDownList.hasValue(oValue)){this._oDropDownList.selectValue(oValue,fSkipOnChangeHandlers)}this._renderSelectedValue()}if(!fSkipOnChangeHandlers&&(this._fForceOnChangeHandlers||!Owa.Utility.isEqual(oCurrentValue,oValue))){this._dispatchEvent(ON_CHANGE,this);if(this._oClientAction!=null){this._oClientAction.get_ActionEventHandlers().dispatch({oValue:this._oSelectedValue})}}};Owa.UIControls.ComboBox.prototype._renderSelectedValue=function Owa$UIControls$ComboBox$prototype$_renderSelectedValue(){var oComboSpan=this._get_Element().getDescendantById(Owa.Strings.Ids.ComboTextDisplaySpan);var sInnerHtml=this._oDropDownList.get_SelectedItem().oDomItem.get_InnerHtml();if(Owa.Utility.isIE()){oComboSpan.set_InnerHtmlIEWorkaround(sInnerHtml)}else{oComboSpan.set_InnerHtml(sInnerHtml)}};Owa.UIControls.ComboBox.prototype._initializeDropDown=function Owa$UIControls$ComboBox$prototype$_initializeDropDown(){this._oDropDownList=new Owa.UIControls.ComboDropDownList(this._getDescendant(Owa.Strings.Ids.ComboDropDownList),this,this._fDisableOffscreenBox,this._fForceOnChangeHandlers);this._oDropDownList.set_SubPage(this.get_SubPage());this._oDropDownList.initialize()};Owa.UIControls.ComboBox.prototype._initializeSelection=function Owa$UIControls$ComboBox$prototype$_initializeSelection(){var oTmpSelectedValue=this._getAttribute(Owa.Strings.Attributes.Value);if(oTmpSelectedValue){this._oDropDownList.selectValue(oTmpSelectedValue)}else if(this._oDropDownList.getItemCount()>0){this._oDropDownList.set_SelectedItemIndex(0)}};Owa.UIControls.ComboBox.createClass("Owa.UIControls.ComboBox",Owa.UIControls.UIControl);Owa.UIControls.ComboBox.prototype._isEditable=function Owa$UIControls$ComboBox$prototype$_isEditable(){return false}})();g_fModuleLoaded[".\\uicontrols/ComboBox.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/spellcheckcombobox.js".toLowerCase()])(function(){Owa.UIControls.SpellCheckComboBox=function Owa$UIControls$SpellCheckComboBox(oElement,oParent){Owa.UIControls.SpellCheckComboBox.constructBase(this,[oElement,oParent])};Owa.UIControls.SpellCheckComboBox.prototype.initialize=function Owa$UIControls$SpellCheckComboDropDownList$prototype$initialize(){Owa.UIControls.SpellCheckComboBox.callBase(this,"initialize");this._oDropDownList.get_OnClose().add(this._createCallback(this._onClose))};Owa.UIControls.SpellCheckComboBox.create=function Owa$UIControls$SpellCheckComboBox$create(oElement,oParent){var SpellCheckComboBox=new Owa.UIControls.SpellCheckComboBox(oElement,oParent);SpellCheckComboBox.initialize();return SpellCheckComboBox};Owa.UIControls.SpellCheckComboBox.prototype._initializeDropDown=function Owa$UIControls$SpellCheckComboBox$prototype$_initializeDropDown(){this._oDropDownList=new Owa.UIControls.SpellCheckComboDropDownList(this._getDescendant(Owa.Strings.Ids.ComboDropDownList),this);this._oDropDownList.initialize()};Owa.UIControls.SpellCheckComboBox.prototype.showDropDown=function Owa$UIControls$SpellCheckComboBox$prototype$showDropDown(){this._get_Parent()._suppressClose(false);this._oDropDownList.showRelative(0,this._get_Element().get_OffsetHeight())};Owa.UIControls.SpellCheckComboBox.prototype._onClose=function Owa$UIControls$SpellCheckComboBox$prototype$_onClose(){this._get_Parent()._setTimeout(this._get_Parent()._enableClose,1)};Owa.UIControls.SpellCheckComboBox.createClass("Owa.UIControls.SpellCheckComboBox",Owa.UIControls.ComboBox)})();g_fModuleLoaded[".\\uicontrols/spellcheckcombobox.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/spellcheckcombodropdownlist.js".toLowerCase()])(function(){var ON_CLOSE="onClose";Owa.UIControls.SpellCheckComboDropDownList=function Owa$UIControls$SpellCheckComboDropDownList(oElement,oParent){Owa.UIControls.SpellCheckComboDropDownList.constructBase(this,[oElement,oParent]);this._containingPopup=oParent._get_Parent()};Owa.UIControls.SpellCheckComboDropDownList.create=function Owa$UIControls$SpellCheckComboDropDownList$create(oElement,oParent){var SpellCheckComboDropDownList=new Owa.UIControls.SpellCheckComboDropDownList(oElement,oParent);SpellCheckComboDropDownList.initialize();return SpellCheckComboDropDownList};Owa.UIControls.SpellCheckComboDropDownList.prototype.get_OnClose=function Owa$UIControls$SpellCheckComboDropDownList$prototype$get_OnClose(){return this._getEventHandlerCollection(ON_CLOSE)};Owa.UIControls.SpellCheckComboDropDownList.prototype._onItemClick=function Owa$UIControls$SpellCheckComboDropDownList$prototype$_onItemClick(oEvent,oItem){for(var iItem=0;iItem<this._rgListItems.length;++iItem){if(this._rgListItems[iItem].oDomItem==oItem){this.set_SelectedItemIndex(iItem);break}}this._containingPopup._setTimeout(this._containingPopup._enableClose,1);this.close();oEvent.cancelBubble()};Owa.UIControls.SpellCheckComboDropDownList.createClass("Owa.UIControls.SpellCheckComboDropDownList",Owa.UIControls.ComboDropDownList)})();g_fModuleLoaded[".\\uicontrols/spellcheckcombodropdownlist.js".toLowerCase()]=1;var MASTER_WINDOW_COOKIE_NAME_1="MstrPgLd1";var MASTER_WINDOW_COOKIE_NAME_2="MstrPgLd2";var MASTER_WINDOW_COOKIE_RENEW_TIME=45*1000;var MASTER_WINDOW_COOKIE_EXPIRY_TIME=60*1000;var g_mstrCk=0;var g_mstrCk2=0;var g_fIsMasterWindowErrorShown=0;var g_mstrWindow=null;function removeFromWindowManager(){try{var oMasterWindow=gtMstr();if(oMasterWindow){var oWM=oMasterWindow.g_winMgr;if(window.sHash)oWM.RmWin(window.sHash)}}catch(e){}}function gtIMMgr(){try{if(!g_IMMgr)g_IMMgr=gtMstrIMMgr();else g_IMMgr.Chk()}catch(e){g_IMMgr=gtMstrIMMgr()}return g_IMMgr}function gtMstrIMMgr(){var win=gtMstr();if(win&&win.g_IMMgr)return win.g_IMMgr;else return 0}function gtMstr(){if(g_mstrWindow){try{if(!g_mstrWindow.closed){return g_mstrWindow}}catch(e){return null}}var fIsMstr=0;var oW=window;while(1){try{if(isDf(typeof(oW.a_isMstr))&&oW.a_isMstr){fIsMstr=1;break}if((oW.parent==oW&&!(oW.opener||(oW.dialogArguments&&oW.dialogArguments.opener)))||(oW.opener==oW&&oW.parent==oW))break;if((oW.opener)&&(oW.opener!=oW))oW=oW.opener;else if((oW.dialogArguments)&&(oW.dialogArguments.opener)&&(oW.dialogArguments.opener!=oW))oW=oW.dialogArguments.opener;else if(oW.parent!=oW)oW=oW.parent;else break;if(isDf(typeof(oW.g_mstrWindow))&&oW.g_mstrWindow){g_mstrWindow=oW.g_mstrWindow;return g_mstrWindow}}catch(e){break}}g_mstrWindow=(fIsMstr)?oW:null;return g_mstrWindow}function createMasterWindowCookies(){if(isDf(typeof(a_oPndGt))&&isDf(typeof(a_isMstr))){if(!g_mstrCk){g_mstrCk=new Cky(MASTER_WINDOW_COOKIE_NAME_1);g_mstrCk2=new Cky(MASTER_WINDOW_COOKIE_NAME_2)}if(g_mstrCk.IsLdd()&&g_mstrCk2.IsLdd()){Owa.Components.Application.failWithWarning(htmlEnc(L_ErrNoOthrIns));g_fIsMasterWindowErrorShown=1;return false}else{g_mstrCk.Add();var oD=new Date();oD.setTime(oD.getTime()+MASTER_WINDOW_COOKIE_EXPIRY_TIME);g_mstrCk2.Add(oD);setTimeout("refreshMasterWindowCookies()",MASTER_WINDOW_COOKIE_RENEW_TIME)}}return true}function expireMasterWindowCookies(){if(g_mstrCk&&!g_fIsMasterWindowErrorShown){g_mstrCk.Expire()}if(g_mstrCk2&&!g_fIsMasterWindowErrorShown){g_mstrCk2.Expire()}}function refreshMasterWindowCookies(){var oD=new Date();oD.setTime(oD.getTime()+MASTER_WINDOW_COOKIE_EXPIRY_TIME);g_mstrCk2=new Cky(MASTER_WINDOW_COOKIE_NAME_2);g_mstrCk2.Add(oD);setTimeout("refreshMasterWindowCookies()",MASTER_WINDOW_COOKIE_RENEW_TIME)}function gtMmPar(){var sPar=getCSVAsStr(CSV_MM_PAR_STR);if(!sPar){sPar=getSMimeParameters();setCSVAsStr(CSV_MM_PAR_STR,sPar)}return sPar}function getSMimeParameters(){if(!chkMime()){return""}var rgPars=new Array();rgPars.push("SSL:"+(isSSL()?"1":"0"));rgPars.push("Ver:"+gtMmCtrlVer());var sPar="&smime="+urlEnc(rgPars.join(";"));return sPar}function gtMmCt(){if((typeof a_fEnbSMm)!="undefined"&&!a_fEnbSMm){return null}if(!gtMmCt.oMmCt){try{gtMmCt.oMmCt=new ActiveXObject("OwaSMime2.MimeCtlVer")}catch(e){}}return gtMmCt.oMmCt}gtMmCt.oMmCt=null;function isSSL(){return window.document.location.protocol=="https:"}function gtMmCtrlVer(){var sMmVer="0.0.0000.0";if(!chkMime()){return sMmVer}var oMmCt=gtMmCt();if(oMmCt){try{sMmVer=oMmCt.VersionString}catch(e){}}return sMmVer}function chkMime(){return(Owa.Utility.isIE()&&Owa.Utility.isWin()&&gtMmCt())}var DLF_URI="?ae=Folder&t=IPF.DocumentLibrary&URL=";var RF_W=459;var RF_H=582;var SMS_W=581;var SMS_H=432;var ECP_W=450;var ECP_H=550;var NO_DLG_OPNER="eaf27cfa0a0b4ec9b690cb47f61d53bd";function openEcpChangeCalendarSharingPermissionWin(sFolderId){opnWin(getEcpVdir()+"customize/calendarsharing.slab?id="+Owa.Encoder.urlEncode(sFolderId),ECP_W,ECP_H)}function newMail(fInOthersMailbox,oCallerSubPage){newItm(IT_MSG,null,gtCCUrl()+(fInOthersMailbox?"&fOMF=1":""),null,null,oCallerSubPage)}function newCnt(fId,oCallerSubPage){newItm(IT_CNT,fId,"",RF_W,RF_H,oCallerSubPage)}function newPdl(fId,oCallerSubPage){newItm(IT_PDL,fId,"",null,null,oCallerSubPage)}function newSms(oCallerSubPage){newItm(IT_SMS,null,null,SMS_W,SMS_H,oCallerSubPage)}function newCstm(o,fId,oCallerSubPage){if(o.get_TagName().toLowerCase()=="div")o=o.getDescendantById("nwCstm");var sType=o.getAttribute("_t");if(sType)newItm(sType,fId,"",null,null,oCallerSubPage)}function newItm(sT,sFolderId,sO,iW,iH,oCallerSubPage){var sUrl="?ae=Item&a=New&t="+sT;sUrl+=(String.isNullOrEmpty(sFolderId)?"":("&fId="+urlEnc(sFolderId)));sUrl+=(sO?sO:"");openItm(sUrl,0,0,iW,iH,oCallerSubPage)}function opnNwMsg(sEm,sDn,sSbj,sAo,fMR,oCallerSubPage){var sUrl="?ae=Item&t="+(fMR?IT_APP:IT_MSG)+"&a=New&to="+urlEnc(sEm)+"&nm="+urlEnc(sDn);if(sSbj&&sSbj!="")sUrl+="&subject="+urlEnc(sSbj);if(sAo)sUrl+="&ao="+urlEnc(sAo);openItm(sUrl,null,null,null,null,oCallerSubPage)}function addrBk(){opnWin("?ae=Dialog&t=AddressBook",a_iABW,a_iABH,1,null,null,null,getNavigationPage())}function newMsgToCt(oCallerSubPage,rgIds,fMsg){if(rgIds.length>0){var fDir=(isDf(typeof(oCallerSubPage.getSubPageVariable("a_fDir")))&&oCallerSubPage.getSubPageVariable("a_fDir"));newMessageOrMeeting(oCallerSubPage,fMsg,rgIds,fDir)}}function newMessageOrMeeting(oCallerSubPage,fMsg,rgIds,fDir){var sNameSpace=(fDir?"ABDA":"ABCA");var oContext={};oContext.oCallerSubPage=oCallerSubPage;var oR=new oeReq(sNameSpace,"MsgToPeople",oContext,cbNewMessageOrMeeting);oR.addRg("id",rgIds);oR.add("msg",fMsg);oR.send()}function cbNewMessageOrMeeting(oR){if(!cbOeh(oR)){return}openItm(oR.sBody,null,null,null,null,oR.oCtx.oCallerSubPage)}function openItmRdFm(sT,sId,sEm,oCallerSubPage){var sUrl="?ae=Item&a=Open&t="+urlEnc(sT)+"&id="+urlEnc(sId);if(sEm)sUrl=sUrl+"&email="+urlEnc(sEm);openItm(sUrl,null,null,RF_W,RF_H,oCallerSubPage)}function openItm(sUrl,sNme,fCl,iW,iH,oCallerSubPage){var nWin=opnWin(sUrl+gtMmPar(),iW,iH,null,sNme,null,null,oCallerSubPage);if(nWin){try{if(fCl)nWin.close();else nWin.focus()}catch(e){}}return nWin}function opnWin(sUrl,iW,iH,fC,sWN,fMB,fNST,oCallerSubPage,fExternalUrl,fUseActiveWindow,fHidePopUpBlockerDialog,fTB,fAB){if(!fExternalUrl){if(Owa.Utility.isSafari()&&sUrl.indexOf("?ae=")==0){sUrl=getOwaVdir()+sUrl}sUrl+=sUrl.indexOf("?")>=0?"&":"?";if(oCallerSubPage){sUrl+=PARENT_SUBPAGE_ID_ATTR+"="+oCallerSubPage.get_SubPageController().get_UniqueId()}else{sUrl+=PARENT_SUBPAGE_ID_ATTR+"="+Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().get_UniqueId()}}fHidePopUpBlockerDialog=fHidePopUpBlockerDialog||fExternalUrl;var fNoDimension=false;if((!iW)&&(!iH))fNoDimension=true;if(!iW)iW=700;if(!iH)iH=500;if(fC){var iT=Math.round((screen.availHeight-iH)/2);var iL=Math.round((screen.availWidth-iW)/2)}var oWin;var oWrappedWindow=Owa.Dom.Window.get_Current();if((sWN)&&(oWrappedWindow.get_Name()==sWN)){if(fC)oWrappedWindow.moveTo(iT,iL);if(!fNoDimension)oWrappedWindow.resizeTo(iW,iH);oWrappedWindow.navigate(sUrl);oWin=oWrappedWindow._domWindow}else{var iMB=0;if(fMB)iMB=1;var iST=1;if(fNST)iST=0;var iTB=0;if(fTB)iTB=1;var iAB=0;if(fAB)iAB=1;var sF="toolbar="+iTB+",location="+iAB+",directories=0,status="+iST+",menubar="+iMB+",scrollbars=1,resizable=1,width="+iW+",height="+iH;if(fC){sF+=",top="+iT+",left="+iL}if(!sWN)sWN=new String(rndm());if(fUseActiveWindow){var oMasterWindow=gtMstr();if(oMasterWindow&&oMasterWindow.g_winMgr){var oOpener=oMasterWindow.g_winMgr.GetActiveWindow();if(oOpener){try{if(oOpener.dialogArguments){oOpener=oOpener.dialogArguments.opener}oWin=oOpener.open(sUrl,sWN,sF);if(oWin){addWM(oWin);oWin.opener=window}}catch(e){}}}}if(!oWin){oWin=sfWinOpn(sUrl,sWN,sF,null,fHidePopUpBlockerDialog,true)}}return oWin}function _sfWinOpnPrivate(oW,sUrl,sName,sFeatures,bReplace,fAddToWinManager){try{var oNewWindow;if(bReplace){oNewWindow=oW.open(sUrl,sName,sFeatures,bReplace)}else if(sFeatures){oNewWindow=oW.open(sUrl,sName,sFeatures)}else if(sName){oNewWindow=oW.open(sUrl,sName)}else if(sUrl){oNewWindow=oW.open(sUrl)}else{oNewWindow=oW.open()}if(oNewWindow&&fAddToWinManager){addWM(oNewWindow)}return oNewWindow}catch(e){Owa.BrowserErrorHandler.handleNewWindowError(e)}}function sfWinOpn(sUrl,sName,sFeatures,bReplace,fHidePopUpBlockerDialog,fAddToWinManager){var oW=window;try{if(oW.dialogArguments)oW=oW.dialogArguments.opener}catch(e){throw new Error(NO_DLG_OPNER)}var oNewWindow=_sfWinOpnPrivate(oW,sUrl,sName,sFeatures,bReplace,fAddToWinManager);if(!oNewWindow&&!fHidePopUpBlockerDialog){var oContext=new Object();oContext.oWindow=oW;oContext.sUrl=sUrl;oContext.sName=sName;oContext.sFeatures=sFeatures;oContext.bReplace=bReplace;oContext.fAddToWinManager=fAddToWinManager;var oDialog=new BtnDlg("divPopUpBlockerYesNoDialog",L_PopUpError.format("<br><br>"),null,new Array(L_Yes,L_No),500,Owa.BUTTON_DIALOG_ICON.QUESTION,onClosePopUpBlockerDialog,oW,null,null,null,null,oContext);oDialog.show()}return oNewWindow}function onClosePopUpBlockerDialog(i,oContext){if(i==0){var oWin=_sfWinOpnPrivate(oContext.oWindow,oContext.sUrl,oContext.sName,oContext.sFeatures,oContext.bReplace,oContext.fAddToWinManager);if(!oWin){var oDialog=new BtnDlg("divPopUpBlockerOKDialog",L_PopUpFinalError.format("<br><br>"),null,[L_OK],500,Owa.BUTTON_DIALOG_ICON.INFORMATION,null,oContext.oWindow,null,null,null,null,null);oDialog.show()}}}function opnHlp(url){if(!url){try{var oSubPageController=getViewSubPageControllerByFolderId(a_sLstFID);url=oSubPageController.getVariable("a_sHlpUrl")}catch(e){}if(!url)return}var oW=opnWin(url,a_iHW,a_iHH,1,a_sHWN,1,0,null,true,null,null,1,1);if(oW)oW.focus()}function addWM(oWin){try{var oMasterWindow=gtMstr();if(oMasterWindow){oMasterWindow.g_winMgr.AddWin(oWin)}}catch(e){}}function opnDocItm(sU,iUF,sId,fNw){if(isFldr(iUF)||isShpSt(iUF)||isUncSt(iUF)){opnDocFldr(sU,0,sId,fNw)}else if(isDoc(iUF)){var sN;if(isUnc(iUF))sN="UncDocument";else if(isShp(iUF))sN="SharepointDocument";else return;sfWinOpn("ev.owa?ns="+sN+"&ev=GetDoc&URL="+urlEnc(sU)+(sId?("&id="+urlEnc(sId)):"")+"&"+a_sCnNm+"="+rtrvUCCk())}}function opnWebRFrm(sU,iUF){if(isDoc(iUF)){var sType;if(isUnc(iUF))sType="unc";else if(isShp(iUF))sType="wss";else return;openItm("WebReadyView.aspx?t="+sType+"&URL="+urlEnc(sU))}}function opnDocFldr(sU,fR,sId,fNw){var o=window.parent;var sfx=sId?("&id="+urlEnc(sId)):"";var sPfUri="";if(isDf(typeof(a_sCurUri)))sPfUri="&prntFId="+(a_sCurUri?urlEnc(a_sCurUri):"");if(fNw){sfWinOpn(DLF_URI+urlEnc(sU))}else if(o.nav){var oN=o.nvCtx();oN.fR=fR;oN.oC=sfx;oN.sPrntFdrUri=sPfUri;o.nav(o.NM_DOC,o.T_DOC,sU,oN)}else{document.location.href=DLF_URI+urlEnc(sU)+sfx+sPfUri}}function isDoc(iUF){return(iUF&0x10)==0x10}function isFldr(iUF){return(((iUF&4)==4)||((iUF&0x20)==0x20))}function isUnc(iUF){return(iUF&2)==2}function isShp(iUF){return(iUF&1)==1}function isShpSt(iUF){return(iUF==1)}function isUncSt(iUF){return(iUF==2)}Type.createNamespace("Owa.Components");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/application.js".toLowerCase()])(function(){Owa.Components.Application={};var _oRootSubPage=null;var _oActiveSubPage=null;var _fIsWinLoaded=false;var _oActiveElement=null;var g_oLoadedScriptFile={};var g_oPendingControllerSet=new Owa.Collection.Set();window.onload=Owa$Components$Application$_onWindowLoad;window._fIsWinFocused=false;Owa.Components.Application.get_IsWinLoaded=function Owa$Components$Application$get_IsWinLoaded(){return _fIsWinLoaded};Owa.Components.Application.get_RootSubPage=function Owa$Components$Application$get_RootSubPage(){return _oRootSubPage};Owa.Components.Application.set_ActiveSubPage=function Owa$Components$Application$set_ActiveSubPage(oPage){_oActiveSubPage=oPage};Owa.Components.Application.get_ShouldExplicitDisposeResource=function Owa$Components$Application$get_ShouldExplicitDisposeResource(){return(_oRootSubPage&&(_oRootSubPage._fSupportHostSubPages||_oRootSubPage._fSupportHostedInSubPage))};function GlobalResourceManager(){GlobalResourceManager.constructBase(this)}GlobalResourceManager.createClass("GlobalResourceManager",Owa.Components.Control);var oGlobalResourceManager;Owa.Components.Application.get_GlobalResourceManager=function Owa$Components$Application$get_GlobalResourceManager(){if(!oGlobalResourceManager){oGlobalResourceManager=new GlobalResourceManager()}return oGlobalResourceManager};function Owa$Components$Application$_onWindowLoad(){var oWindow=Owa.Dom.Window.get_Current();var oDocument=oWindow.get_Document();if(Owa.Utility.isIE()){oDocument.attachEvent("focusin",Owa$Components$Application$_onWindowFocus);oDocument.attachEvent("focusout",Owa$Components$Application$_onWindowBlur)}else{_oActiveElement=document.activeElement;oWindow.attachEvent("focus",Owa$Components$Application$_onWindowFocus);oWindow.attachEvent("blur",Owa$Components$Application$_onWindowBlur)}checkScripts()}Owa.Components.Application.start=function Owa$Components$Application$start(){if(Owa.Utility.isIE()&&!Owa.Utility.isActiveXControlSupported()){if(Owa.PageHierarchy.getOwaTopWindow().equals(Owa.Dom.Window.get_Current())){Owa.Components.Application.failWithWarning(htmlEnc(L_ActiveXDisabled).format("<a href=\"logoff.owa\">","</a>"));return}}stJS=setJSReady;getLoadedScript();if(!_oRootSubPage){var oBody=Owa.Dom.Document.get_Current().get_Body();if(oBody&&oBody.getAttribute("_PageType")){var oSubPageType=eval("Owa.Pages."+oBody.getAttribute("_PageType"));_oRootSubPage=new oSubPageType(oBody)}else{_oRootSubPage=new Owa.UIControls.SubPage(oBody)}}Owa.Components.Application.set_ActiveSubPage(_oRootSubPage);attachApplicationWiseEventHandlers();if(Owa.Utility.isDefined(typeof(createGlobalVariables))){createGlobalVariables(_oRootSubPage);createGlobalVariables=null}_oRootSubPage.initialize();if(Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().get_IsShown()){_oRootSubPage.fireIsVisibleChanged(true)}if(_oApplicationStart){_oApplicationStart.dispatch()}gtMstr()};function getLoadedScript(){for(var sFileName in window.oJS){g_oLoadedScriptFile[sFileName]=true}}function setJSReady(sFileName){g_oLoadedScriptFile[sFileName]=true;Owa.Components.Application._notifyAllPendingController()}function attachApplicationWiseEventHandlers(){cancelDragDrop();var oWindow=Owa.Dom.Window.get_Current();var oDocument=oWindow.get_Document();oWindow.attachEvent("unload",Owa$Components$Application$_onWindowUnload);oWindow.attachEvent("resize",Owa.Utility.createWindowResizeHandler(oWindow,Owa$Components$Application$_onWindowResize));oWindow.attachEvent("beforeunload",Owa$Components$Application$_onWindowBeforeUnload);oDocument.attachEvent("contextmenu",onEvtCanInpt);oDocument.attachEvent("keydown",Owa$Components$Application$_onKeyDown);if(Owa.Utility.isFirefox()){oDocument.attachEvent("keypress",Owa.Components.Application.preventFirefoxDefaultKeyEvent)}window.onerror=window$onerror}function cancelDragDrop(){var oBody=Owa.Dom.Document.get_Current().get_Body();oBody.attachEvent("dragenter",canEvt);oBody.attachEvent("dragover",canEvt);oBody.attachEvent("drop",canEvt);oBody.attachEvent("dragend",clearDragContext)}function clearDragContext(oEvent){var oDragDrop=new Owa.Components.Storage.DragDrop(oEvent);oDragDrop.clear();oEvent.cancelBubble();oEvent.preventDefault()}Owa.Components.Application.preventFirefoxDefaultKeyEvent=function Owa$Components$Application$preventFirefoxDefaultKeyEvent(oEvent){var rgKeys=[78,110,114,82,107];if(Owa.Utility.isFirefox()&&oEvent.isCtrlKeyDown()){for(var i=1;i<rgKeys.length;i++){if(rgKeys[i]==oEvent.get_CharCodeForKeyPress()){oEvent.preventDefault()}}}};function checkScripts(){var rgS=new Array();for(var i=0;;i++){var oScr=$("_scr"+i);if(oScr)rgS.push(oScr);else break}if(!rgS.length)return;for(var i=0;i<rgS.length;i++){var oS=rgS[i];if(!chkScr(oS)){setTimeout(checkScripts,50);return}}if(!$("divEOF")){setTimeout(checkScripts,50);return}var oCurrentWindow=Owa.Dom.Window.get_Current();var oParentWindow=oCurrentWindow.get_ParentWindow();var oFrameElement=oCurrentWindow.get_FrameElement();if(oFrameElement&&oParentWindow){if(oParentWindow.getGlobalVariable("g_fOwa")&&!oFrameElement.getAttribute(PARENT_SUBPAGE_ID_ATTR)){setTimeout(checkScripts,50);return}}_fIsWinLoaded=true;Owa.Components.Application.start()}function chkScr(oS){var sR=oS._get_DomNode().readyState;var sid=oS.getAttribute("_sid");if(!isDf(typeof(sR))&&isJS(sid))return 1;else if((sR=="complete"||sR=="loaded")&&isJS(sid))return 1;return 0}function Owa$Components$Application$_onWindowUnload(){_oRootSubPage.dispose();Owa.Dom.AjaxRequest.disposeAjaxRequests();removeFromWindowManager();detachApplicationWiseEventHandlers();UniqueIdHashSet.get_Instance().clear();Owa.Dom.Document.dispose();Owa.Dom.Window.dispose()}function detachApplicationWiseEventHandlers(){Owa.Dom.Document.get_Current().get_Body().detachAllEvents();Owa.Dom.Document.get_Current().detachAllEvents();window.onload=window.onunload=window.onbeforeunload=window.onerror=null;Owa.Dom.Window.get_Current().detachAllEvents();var rgsEvents=["onbeforeunload","onafterprint","onerror","onresize","onblur","onload","onscroll","onfocus","onbeforeprint","onunload","onhelp"];for(var i=0;i<rgsEvents.length;i++){window[rgsEvents[i]]=null}}function Owa$Components$Application$_onWindowBeforeUnload(oEvent){return _oRootSubPage.onBeforeUnload(oEvent)}function Owa$Components$Application$_onWindowResize(oEvent){return _oRootSubPage.fireSizeChanged(oEvent)}function Owa$Components$Application$_onWindowFocus(oEvent){window._fIsWinFocused=true}function Owa$Components$Application$_onWindowBlur(oEvent){if(!Owa.Utility.isIE()&&document.activeElement!=_oActiveElement){_oActiveElement=document.activeElement;return}window._fIsWinFocused=false}function Owa$Components$Application$_onKeyDown(oEvent){return _oActiveSubPage.fireKeyDownPageEvent(oEvent)}function window$onerror(sMsg,sUrl,sLn){annotateFunctions(Owa);try{sMsg=sMsg.trim();if(Owa.BrowserErrorHandler.isAccessDeny(sMsg)){shwErrDlg(0,L_ErrRfBrws);return true}if(Owa.BrowserErrorHandler.isNoMemoryError(sMsg)){shwErrDlg(0,L_ErrOOM);return true}else if(sMsg==NO_DLG_OPNER){sMsg="window.open failed: the opener window of this IE dialog window is closed. Try close this dialog and reopen it"}var oES=new Object();oES.sMsg=sMsg;oES.sLn=sLn;oES.sCS="";oES.sBdy="Client Information"+"\n------------------"+"\nUser Agent: "+htmlEnc(navigator.userAgent)+"\nCPU Class: "+htmlEnc(navigator.cpuClass)+"\nPlatform: "+htmlEnc(navigator.platform)+"\nSystem Language: "+htmlEnc(navigator.systemLanguage)+"\nUser Language: "+htmlEnc(navigator.userLanguage?navigator.userLanguage:navigator.language)+"\nCookieEnabled: "+htmlEnc(navigator.cookieEnabled)+"\nException Details"+"\n-----------------"+"\nDate: "+(new Date())+"\nMessage: "+htmlEnc(sMsg)+"\nUrl: "+htmlEnc(sUrl)+"\nLine: "+sLn;oES.sBdy+="\n\nCall Stack\n----------\n";if(arguments.caller){var oCS=arguments.caller.callee;var iD=0;var sCS="",sDCS="";while(oCS&&iD<20){var sF=oCS.toString();var sFnNm=oCS.sFnNm;if(!sFnNm)sFnNm=sF.substring(9,sF.indexOf("("));sFnNm+=sF.substring(sF.indexOf("("),sF.indexOf(")")+1);if(iD==0)oES.sFn="\n"+sFnNm;else oES.sCS+='\n';oES.sCS+="\n"+sFnNm;var iArgS=sF.indexOf("(")+1;var iArgE=sF.indexOf(")");var sArgs=expArgs(sF.substring(iArgS,iArgE),oCS.arguments);sCS+=htmlEnc(sFnNm)+"\r\n";sDCS+=htmlEnc(sFnNm)+sArgs+"\r\n";if(sFnNm.startsW("anonymous")){var sSep="-----------------------\r\n";sCS+=sSep+sF+"\r\n"+sSep;sDCS+=sSep+sF+"\r\n"+sSep}oCS=oCS.caller;++iD}oES.sBdy+=sCS+"\n\nDetailed Call Stack\n-------------------\n"+sDCS}else{var stackFrameStrings=new Error().stack.split('\n');for(var i in stackFrameStrings){sCS+=htmlEnc(stackFrameStrings[i])+"\r\n"}oES.sBdy+=sCS+"\n\n"}if(window.event){oES.sBdy+="\n\nDump Event\n----------";var sEv="";for(var oProp in event){sEv+="\r\n\t"+oProp.toString()+" = "+event[oProp]}oES.sBdy+=sEv}var oDlg=shwErrDlg(0,L_ScptErr,0,(a_fSndClntErr?L_ScptErrDtls:null),htmlEnc(oES.sBdy),oES,0)}catch(e){window.status=e.message}return true}function expArgs(sArgs,rgArgVal){var rgArgNms=sArgs.split(",");sArgs="";if(rgArgNms[0]){for(var i=0;i<rgArgNms.length;i++){sArgs+="\r\n\t";var oArg=rgArgVal[i];if(oArg===null)oArg="null";else if(oArg===undefined)oArg="undefined";sArgs+=rgArgNms[i].trim()+" = ";var sT=typeof(oArg);var sV;if(sT=="string"){sV="'"+oArg+"'"}else if(sT=="function"){var sFn=oArg.toString();sV='['+sFn.substr(0,sFn.indexOf("("))+']'}else if(sT=="object"){if(oArg.toString)sV=oArg.toString();else sV="[object]";for(var oProp in oArg){if(oProp=="outerText"||oProp=="innerText"||oProp=="innerHTML")continue;var sPropV;try{sPropV=oArg[oProp]}catch(e){sPropV="error: ["+e.message+"]"}if(oProp=="outerHTML"&&sPropV.length>500)sPropV=sPropV.substring(0,500)+"[...]";sV+="\r\n\t\t"+oProp.toString()+" = "+sPropV}}else{sV=oArg}sArgs+=sV}}for(var i=rgArgNms.length;i<rgArgVal.length;i++){sArgs+=","+rgArgVal[i]}return sArgs}function annotateFunctions(oN,sPfx){try{if(!sPfx)sPfx="Owa.";for(var s in oN){var o=oN[s];if(typeof(o)=="function"){if(!o.sFnNm)o.sFnNm=sPfx+s;if(o.prototype)annotateFunctions(o.prototype,o.sFnNm+".")}else if(typeof(o)=="object"){annotateFunctions(o,sPfx+s+".")}}}catch(e){}}Owa.Components.Application.loadExternalScript=function Owa$Components$Application$loadExternalScript(rgExternalScriptFiles){for(var iIndex=0;iIndex<rgExternalScriptFiles.length;iIndex++){var sFileName=getFileName(rgExternalScriptFiles[iIndex]);if(!g_oLoadedScriptFile[sFileName]){var oHead=document.getElementsByTagName("head")[0]||document.documentElement;var oScript=document.createElement("SCRIPT");oScript.type="text/javascript";oScript.src=rgExternalScriptFiles[iIndex];oHead.insertBefore(oScript,oHead.firstChild)}}};Owa.Components.Application.failWithWarning=function Owa$Components$Application$failWithWarning(sWarningHtml){Owa.Dom.Document.get_Current().get_Body().set_InnerHtml("<body class=\"err\"><table class=\"errDesc\"><tr>"+"<td style=\"width:1%\"><img src=\""+getThmF("bdi_wrn.gif")+"\"></td>"+"<td id=\"errMsg\">"+sWarningHtml+"</td>"+"</tr></table><hr class=\"line\" size=\"2\"></body>")};Owa.Components.Application.isScriptLoaded=function Owa$Components$Application$isScriptLoaded(sPath){return !!g_oLoadedScriptFile[getFileName(sPath)]};function getFileName(sPath){var rgPart=sPath.split("/");return rgPart[rgPart.length-1]}Owa.Components.Application._notifyAllPendingController=function Owa$Components$Application$_notifyAllPendingController(){var rgController=g_oPendingControllerSet.toArray();for(var iIndex=0;iIndex<rgController.length;iIndex++){rgController[iIndex].notifyScriptReady()}};Owa.Components.Application.addPendingController=function Owa$Components$Application$addPendingController(oController){g_oPendingControllerSet.add(oController)};Owa.Components.Application.removePendingController=function Owa$Components$Application$removePendingController(oController){g_oPendingControllerSet.remove(oController)};var _oApplicationStart;Owa.Components.Application.get_OnApplicationStart=function Owa$Components$Application$get_OnApplicationStart(){if(!_oApplicationStart){_oApplicationStart=new Owa.Utility.EventHandlerCollection()}return _oApplicationStart}})();g_fModuleLoaded[".\\components/application.js".toLowerCase()]=1;Type.createNamespace("Owa.Components");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/hotkeymanager.js".toLowerCase()])(function(){Owa.Components.HotKeyManager=function Owa$Components$HotKeyManager(oActionTable,oFallbackHotkeyManager){Owa.Components.HotKeyManager.constructBase(this);this._fEnabled=true;this._oHotKeyTable={};this._oActionTable=oActionTable;this._oFallbackHotkeyManager=oFallbackHotkeyManager};var _oPrototype=Owa.Components.HotKeyManager.prototype;_oPrototype.addHotKey=function Owa$Components$HotKeyManager$addHotKey(sKey,sCommand,fIngoreEventFromInput,fIngoreEventFromExternalFrame){var oHotKey=Owa.Components.HotKey.createFromKeyStroke(sKey,sCommand,fIngoreEventFromInput,fIngoreEventFromExternalFrame);this._insertHotKey(oHotKey);var oKeyParts=oHotKey.get_oKeyPart();if(Owa.Utility.isMac()&&oKeyParts.iCtrl&&!oKeyParts.iMacCtrl){var oNewKeyParts={"iCtrl":0,"iShift":oKeyParts.iShift,"iAlt":oKeyParts.iAlt,"iMacCtrl":1,"iKey":oKeyParts.iKey};oHotKey=new Owa.Components.HotKey(oNewKeyParts,sCommand,fIngoreEventFromInput);this._insertHotKey(oHotKey)}return this};_oPrototype.dispose=function Owa$Components$HotKeyManager$dispose(){};_oPrototype.set_Enabled=function Owa$Components$HotKeyManager$set_Enabled(fEnable){this._fEnabled=fEnable};_oPrototype._insertHotKey=function Owa$Components$HotKeyManager$_insertHotKey(oHotKey){var sHash=calculateHashFromKey(oHotKey);this._oHotKeyTable[sHash]=oHotKey;var oThis=this;var oAction=this._oActionTable.getAction(oHotKey.get_Command());oAction.get_StateChangeEventHandlers().add(function(oEventArgs){oThis._oHotKeyTable[sHash].set_IsEnabled(oEventArgs.fEnabled)})};_oPrototype._onKeyDown=function Owa$Components$HotKeyManager$_onKeyDown(oEvent){if(!this._fEnabled){return}var fTargetIsInput=isInpt(oEvent.get_Target());if(this._fHookOnDocumentDueToNonFocusableTarget&&(fTargetIsInput&&!this._oTargetNode.contains(oEvent.get_Target()))){return}var sHash=calculateHashFromEvent(oEvent);var oHotKey=this._oHotKeyTable[sHash];if(oHotKey){if(oHotKey.get_IngoreEventFromInput()&&fTargetIsInput){return}if(oHotKey.get_IngoreEventFromExternalFrame()&&!Owa.Dom.Document.get_Current().contains(oEvent.get_Target())){return}var fUseDefaultAction=false;if(oHotKey.get_IsEnabled()){fUseDefaultAction=this._oActionTable.getAction(oHotKey.get_Command()).triggerAction(oEvent.get_Target(),oEvent,true)}if(!fUseDefaultAction){oEvent.preventDefault();oEvent.cancelBubble()}}else if(this._oFallbackHotkeyManager){this._oFallbackHotkeyManager._onKeyDown(oEvent)}};function calculateHashFromKey(oHotKey){var oParts=oHotKey.get_oKeyPart();return computeHash(oParts.iCtrl,oParts.iAlt,oParts.iShift,oParts.iMacCtrl,oParts.iKey)}function calculateHashFromEvent(oEvent){return computeHash(oEvent.isCtrlKeyDown()?1:0,oEvent.isAltKeyDown()?1:0,oEvent.isShiftKeyDown()?1:0,oEvent.isMacCtrlKeyDown()?1:0,oEvent.get_KeyCodeForKeyUpDown())}function computeHash(iCtrl,iAlt,iShift,iMacCtrl,iKey){return getInt(iKey.toString()+iCtrl+iAlt+iShift+iMacCtrl)}Owa.Components.HotKeyManager.createClass("Owa.Components.HotKeyManager",Owa.Components.Control)})();g_fModuleLoaded[".\\components/hotkeymanager.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/hotkeymanagerpage.js".toLowerCase()])(function(){Type.createNamespace("Owa.Components");Owa.Components.HotKeyManagerPage=function Owa$Components$HotKeyManagerPage(oActionTable,oPage,oFallbackHotkeyManager){Owa.Components.HotKeyManagerPage.constructBase(this,[oActionTable,oFallbackHotkeyManager]);oPage.get_KeyDownPage().add(this._createCallback(this._onKeyDown))};Owa.Components.HotKeyManagerPage.createClass("Owa.Components.HotKeyManagerPage",Owa.Components.HotKeyManager)})();g_fModuleLoaded[".\\components/hotkeymanagerpage.js".toLowerCase()]=1;Type.createNamespace("Owa.UIControls");var VARIABLE_SCOPE_GLOBAL=1;var VARIABLE_SCOPE_SUBPAGE=2;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/subpage.js".toLowerCase()])(function(){var oInstance;Owa.UIControls.SubPage=function Owa$UIControls$SubPage(oElement){Owa.UIControls.SubPage.constructBase(this,[oElement]);if(!this._fSupportHostSubPages&&!this._fSupportHostedInSubPage){oInstance=this}this._fIsActivate=false;this._oSubPageVariable={};this._rgSubPageVariableScope={};this.sTypeName=oElement.getAttribute("_PageType");Owa.Components.Application.get_GlobalResourceManager().addResource(this);if(!this.sTypeName){this.sTypeName="SubPage"}this._oClientActionTable=new Owa.Components.ClientActionTable(Owa.Utility.createDelegate(this,this._onUserAction));this._oHotKeyManager=new Owa.Components.HotKeyManagerPage(this._oClientActionTable,this);this._fCloseOnEsc=true};var _oPrototype=Owa.UIControls.SubPage.prototype;_oPrototype._fSupportUniqueId=true;_oPrototype._fSupportHostedInSubPage=false;_oPrototype._fSupportHostSubPages=false;_oPrototype._fIsFirstShow=true;_oPrototype.initialize=function Owa$UIControls$SubPage$initialize(){Owa.UIControls.SubPage.callBase(this,"initialize");if(isDf(typeof(onWL))&&onWL&&!window._wl){onWL()}if(this._fSupportHostedInSubPage){var createGlobalVariables=null;var oScriptElement=this._get_Element().getChildById("divVariableDeclarations");if(oScriptElement){eval(oScriptElement.get_TextContent())}if(createGlobalVariables){createGlobalVariables(this)}}this._get_Element().attachEvent("mousedown",this._createCallback(this._onMouseDown));this._initializeHotkeys();window._wl=1};_oPrototype.dispose=function Owa$UIControls$SubPage$dispose(){if(isDf(typeof(unload))&&unload){unload()}this.get_SizeChanged().clear();this.get_IsVisableChanged().clear();this.get_FirstShow().clear();this._oHotKeyManager.dispose();this._clearEventCollections();Owa.UIControls.SubPage.callBase(this,"dispose")};_oPrototype.fireFirstShow=function Owa$UIControls$SubPage$fireFirstShow(){if(this._fIsFirstShow){this.onFirstShow();this._dispatchEvent(ON_FIRST_SHOW);this._fIsFirstShow=false}};_oPrototype.fireIsVisibleChanged=function Owa$UIControls$SubPage$fireIsVisibleChanged(fIsVisible){if(fIsVisible){this.fireSizeChanged()}if(fIsVisible&&this._fIsFirstShow){this.fireFirstShow()}this.onIsVisibleChanged(fIsVisible);this._dispatchEvent(ON_ISVISIBLECHANGED,{fIsVisible:fIsVisible});var oSubPageController=this.get_SubPageController();var rgChildrenSubPageController=oSubPageController.get_ChildrenControllers();for(var iIndex=0;iIndex<rgChildrenSubPageController.length;iIndex++){var oSubPage=rgChildrenSubPageController[iIndex].get_SubPage();if(oSubPage&&rgChildrenSubPageController[iIndex].get_IsShown(false)){oSubPage.fireIsVisibleChanged(fIsVisible)}}};_oPrototype.fireSizeChanged=function Owa$UIControls$SubPage$fireSizeChanged(oEvent){if(!this.get_IsShown(true)){return}this.onResize(oEvent);this._dispatchEvent(ON_SIZECHANGED);var oSubPageController=this.get_SubPageController();var rgChildrenSubPageController=oSubPageController.get_ChildrenControllers();for(var iIndex=0;iIndex<rgChildrenSubPageController.length;iIndex++){var oSubPage=rgChildrenSubPageController[iIndex].get_SubPage();if(oSubPage&&Owa.UIControls.DivSubPageController.isInstance(rgChildrenSubPageController[iIndex])){oSubPage.fireSizeChanged(oEvent)}}};_oPrototype.fireKeyDownPageEvent=function Owa$UIControls$SubPage$fireKeyDownPageEvent(oEvent){this.onKeyDown(oEvent);this._dispatchEvent(ON_KEYDOWNPAGE,oEvent)};_oPrototype.activate=function Owa$UIControls$SubPage$activate(){Owa.Components.Application.set_ActiveSubPage(this);this._fIsActivate=true};_oPrototype.deactivate=function Owa$UIControls$SubPage$deactivate(){this._fIsActivate=false};_oPrototype.get_IsShown=function Owa$UIControls$SubPage$get_IsShown(fActual){return this.get_SubPageController().get_IsShown(fActual)};_oPrototype.get_SubPageController=function Owa$UIControls$SubPage$get_SubPageController(){return Owa.Components.SubPageControllerFactory.getControllerByElement(this._get_Element())};_oPrototype.onBeforeUnload=function Owa$UIControls$SubPage$onBeforeUnload(){};_oPrototype.onFirstShow=function Owa$UIControls$SubPage$onFirstShow(){};_oPrototype.onIsVisibleChanged=function Owa$UIControls$SubPage$onIsVisibleChanged(fIsVisible){};_oPrototype.onResize=function Owa$UIControls$SubPage$onResize(){};_oPrototype.onKeyDown=function Owa$UIControls$SubPage$onKeyDown(oEvent){};_oPrototype._onUserAction=function Owa$UIControls$SubPage$_onUserAction(sAction,oContext){switch(sAction){case"disabledAction":break;case"new":this._onNewItem();break;case"close":var oParentPage=this.get_ParentSubPage();if(oParentPage){oParentPage.get_ActionTable().getAction("close").triggerAction()}else{if(this._fCloseOnEsc){Owa.Dom.Window.get_Current().close()}}}};_oPrototype._onNewItem=function Owa$UIControls$SubPage$_onNewItem(){};_oPrototype._initializeHotkeys=function Owa$UIControls$SubPage$_initializeHotkeys(){this.addHk(L_HKBrwsRfrsh,"disabledAction");this.addHk(L_HkSv,"disabledAction");this.get_HotKeyManager().addHotKey(L_HkSel,"disabledAction",true,true);this.get_HotKeyManager().addHotKey(Owa.KeyCodes.BACK_SPACE.toString(),"disabledAction",true);this.addHk(L_HkNew,"new");this.addHk("27","close")};_oPrototype.get_ActionTable=function Owa$UIControls$SubPage$get_ActionTable(){return this._oClientActionTable};_oPrototype.get_HotKeyManager=function Owa$UIControls$SubPage$get_HotKeyManager(){return this._oHotKeyManager};_oPrototype.addHk=function Owa$UIControls$SubPage$addHk(sKS,sCmd){this.get_HotKeyManager().addHotKey(sKS,sCmd)};_oPrototype.declareSubPageVariable=function Owa$UIControls$SubPage$declareSubPageVariable(sVariableName,oValue,iVariableScope){if(!this._fSupportHostedInSubPage||iVariableScope==VARIABLE_SCOPE_GLOBAL){window[sVariableName]=oValue}else{this._rgSubPageVariableScope[sVariableName]=iVariableScope;this.setSubPageVariable(sVariableName,oValue)}};_oPrototype.invokeSubPageFunction=function Owa$UIControls$SubPage$invokeSubPageFunction(sFunctionName,rgArgs){if(typeof(this[sFunctionName])==Type.Const.Function){return Owa.Dom.Window.get_Current().invokeFunction(sFunctionName,rgArgs,this)}else if(typeof(window[sFunctionName])==Type.Const.Function){return Owa.Dom.Window.get_Current().invokeFunction(sFunctionName,rgArgs)}};_oPrototype.isSubPageFunctionExists=function Owa$UIControls$SubPage$isSubPageFunctionExists(sFunctionName){if(typeof(this[sFunctionName])==Type.Const.Function){return true}else{return typeof(Owa.Dom.Window.get_Current().getGlobalVariable(sFunctionName))==Type.Const.Function}return false};_oPrototype.setSubPageVariable=function Owa$UIControls$SubPage$setSubPageVariable(sName,oValue){if(this._fSupportHostedInSubPage){var iVariableScope=this._rgSubPageVariableScope[sName];if(typeof iVariableScope=="undefined"||iVariableScope==VARIABLE_SCOPE_GLOBAL){window[sName]=oValue}else{this._oSubPageVariable[sName]=oValue}}else{window[sName]=oValue}};_oPrototype.getSubPageVariable=function Owa$UIControls$SubPage$getSubPageVariable(sName){if(this._fSupportHostedInSubPage){var iVariableScope=this._rgSubPageVariableScope[sName];if(typeof iVariableScope=="undefined"||iVariableScope==VARIABLE_SCOPE_GLOBAL){return window[sName]}else{return this._oSubPageVariable[sName]}}else{return window[sName]}};_oPrototype.get_ActionHandler=function Owa$UIControls$SubPage$get_ActionHandler(){if(!this._cbActionHandler){this._cbActionHandler=Owa.Utility.createDelegate(this,this._onUserAction)}return this._cbActionHandler};_oPrototype.get_SubPage=function Owa$UIControls$SubPage$get_SubPage(){return this};_oPrototype.get_ParentSubPage=function Owa$UIControls$SubPage$get_ParentSubPage(){var oParentController=this.get_SubPageController().get_ParentController();return oParentController&&oParentController.get_SubPage()};_oPrototype._onMouseDown=function Owa$UIControls$SubPage$_onMouseDown(oEvent){if(Owa.UIControls.Popup.get_HasAnyPopupShown()){return}Owa.Components.Application.set_ActiveSubPage(this);oEvent.cancelBubble()};Owa.UIControls.SubPage.get_Instance=function Owa$UIControls$SubPage$get_Instance(){return oInstance};var ON_FIRST_SHOW="FirstShow";var ON_ISVISIBLECHANGED="IsVisableChanged";var ON_SIZECHANGED="SizeChanged";var ON_KEYDOWNPAGE="KeyDownPage";_oPrototype.get_FirstShow=function Owa$UIControls$SubPage$get_FirstShow(){return this._getEventHandlerCollection(ON_FIRST_SHOW)};_oPrototype.get_IsVisableChanged=function Owa$UIControls$SubPage$get_IsVisableChanged(){return this._getEventHandlerCollection(ON_ISVISIBLECHANGED)};_oPrototype.get_SizeChanged=function Owa$UIControls$SubPage$get_SizeChanged(){return this._getEventHandlerCollection(ON_SIZECHANGED)};_oPrototype.get_KeyDownPage=function Owa$UIControls$SubPage$get_KeyDownPage(){return this._getEventHandlerCollection(ON_KEYDOWNPAGE)};Owa.UIControls.SubPage.createClass("Owa.UIControls.SubPage",Owa.UIControls.UIControlBase)})();g_fModuleLoaded[".\\uicontrols/subpage.js".toLowerCase()]=1;var g_oFormatCombobox=null;function onIsVisibleChanged(fIsVisible){if(fIsVisible){while(g_rgPendingResizeOperation.length>0){var fnResize=g_rgPendingResizeOperation.shift();if(fnResize){fnResize()}}}var oRdCnv=this.get_SubPageController().getExpando("oRdCnv");if(oRdCnv){oRdCnv.onShowHide(fIsVisible)}}if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/formutility.js".toLowerCase()])(function(){Type.createNamespace("Owa.Pages");Owa.Pages.FormSubPage=function Owa$Pages$FormSubPage(oElement,fCompose){this._fCompose=fCompose;Owa.Pages.FormSubPage.constructBase(this,[oElement])};var _oPrototype=Owa.Pages.FormSubPage.prototype;_oPrototype.initialize=function Owa$Pages$FormSubPage$initialize(){Owa.Pages.FormSubPage.callBase(this,"initialize");var oDoc=Owa.Dom.Document.get_Current();var otxtBdy=$("txtBdy");var oDivBdy=$("divBdy");if(otxtBdy&&oDivBdy){oDivBdy.appendChild(otxtBdy)}if(!this._fCompose){g_oEd.attachEvent("CopyItems",null,"cbCpMvItms");g_oEd.attachEvent("MoveItems",null,"cbCpMvItms")}Owa.Components.ToolbarCollection.get_Current().addToolbars(["divTB"],this.get_ActionTable());initCmbFrmt();var oB=oDoc.get_Body();oB.attachEvent("onscroll",safeResizeBodies);var oCallerSubPage=this.get_SubPage();initAw(oCallerSubPage);if(wda("ifBdy")||wda("txtBdy")){initCB(oCallerSubPage,this._fCompose,this._createCallback(this.onResize))}var oDivSpl=$("divSpl");if(oDivSpl){var oTblSplchkMnu=Owa.Components.ToolbarCollection.get_Current().getButton("spellcheckd")._get_SubMenuPopup();var oSpellCheckerComboBox=new Owa.UIControls.SpellCheckComboBox.create(oDivSpl,oTblSplchkMnu);oDivSpl.setExpando("oSpellCheckerComboBox",oSpellCheckerComboBox)}var fEnabled=isNxtPrvEnabled();var oActions=[this.get_ActionTable().getAction("next"),this.get_ActionTable().getAction("previous")];for(var i=0;i<oActions.length;i++){oActions[i].set_Enabled(fEnabled)}if(isDf(typeof(a_fPrv))&&a_fPrv){this._setTimeout(this._fireOnLoadReadingPane,1)}};_oPrototype.dispose=function Owa$Pages$FormSubPage$dispose(){if(this._fCompose){window.oR=null}dispCmbFrmt();Owa.Components.ToolbarCollection.get_Current().dispose();dispAw();if(wda("ifBdy")||wda("txtBdy"))dispCB(this._fCompose);dispFrmDrp();if(isDf(typeof(dispRecipContextMenus))){dispRecipContextMenus()}if(isDf(typeof(a_fSmEmb))&&a_fSmEmb){delMsg(1,1)}Owa.Pages.FormSubPage.callBase(this,"dispose")};_oPrototype.onIsVisibleChanged=onIsVisibleChanged;_oPrototype.onResize=function Owa$Pages$FormSubPage$onResize(){Owa.Pages.FormSubPage.callBase(this,"onResize");safeResizeBodies()};_oPrototype.onKeyDown=function Owa$Components$FormSubPage$onKeyDown(oEvent){if(oEvent.get_KeyCodeForKeyUpDown()==Owa.KeyCodes.TAB){var sId=oEvent.get_Target().get_Id();if(oEvent.isShiftKeyDown()){if(sId=="send"||sId=="saveclose"){oEvent.cancelBubble();oEvent.preventDefault()}}else{if(sId=="txtBdy"&&!Owa.Utility.isIE()){oEvent.cancelBubble();oEvent.preventDefault()}else if(this._isEditorTabAfterSubject()&&sId=="txtSubj"&&Owa.Utility.isSafari()){oEvent.cancelBubble();oEvent.preventDefault();setFcsBdy(0)}}}};_oPrototype.onBeforeUnload=function Owa$Pages$FormSubPage$onBeforeUnload(oEvent){if((this._fCompose||this._oEditor)&&g_fDrty){if(Owa.Utility.isSafari()){return L_ClsPmpt}else{oEvent._oEvent.returnValue=L_ClsPmpt}clrDrty();window.setTimeout("drty();",100)}};_oPrototype._onUserAction=function Owa$Pages$FormSubPage$_onUserAction(sAction,oContext){switch(sAction){case"save":procItm(OP_SAV);break;case"saveclose":procItm(OP_SAV|OP_CLS);break;case"send":if(isSpC()&&(a_fSpSn==1)){procSpl(rslvNms,OP_ANR|OP_SND|OP_CLS)}else{rslvNms(OP_ANR|OP_SND|OP_CLS)}break;case"forward":repFwItm(a_sT,"Forward",a_fPrv);break;case BID_PT:procItm(OP_SND|OP_CLS);break;case"close":window.close();break;case"attachfile":shwAttchDlg();break;case"checknames":rslvNms(OP_ANR);break;case"delete":delItm();break;case"insertsignature":addSignatureToExistingMessage();break;case"imphigh":case"implow":case"msgsgnd":case"msgencypt":drty();break;case"flag":shwFlgMnu();break;case"cat":frmShwCM();break;case"spellcheck":procSpl();break;case BID_MV:var oCallerSubPage=this.get_SubPage();shwCMMnu(oCallerSubPage,frmCpMv);break;case"help":opnHlp(oContext.getAttribute("href"));break;default:Owa.Pages.FormSubPage.callBase(this,"_onUserAction",[sAction,oContext]);break}};_oPrototype._isEditorTabAfterSubject=function Owa$Pages$FormSubPage$_isEditorTabAfterSubject(){return true};_oPrototype.refreshVirtualListView=function Owa$Pages$FormSubPage$refreshVirtualListView(fNotRefreshReadingPane){var oCurrentWindowController=Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController();var oOpenerController=oCurrentWindowController.get_OpenerController();if(oOpenerController){try{oOpenerController.invokeFunction("ref")}catch(e){return}if(!fNotRefreshReadingPane){try{oOpenerController.invokeFunction("udRP",[1])}catch(e){}}}};_oPrototype._fireOnLoadReadingPane=function Owa$Pages$FormSubPage$_fireOnLoadReadingPane(){var oParentController=Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().get_ParentController();oParentController.invokeFunction("onLoadReadingPane")};Owa.Pages.FormSubPage.createClass("Owa.Pages.FormSubPage",Owa.UIControls.SubPage)})();g_fModuleLoaded[".\\components/formutility.js".toLowerCase()]=1;function initEdit(oCallerSubPage,sB,oFrame,fnRsz){initTxtBdy(oCallerSubPage,"txtBdy");var oSubject=$("txtSubj");if(oSubject){oSubject.attachEvent("keydown",onKDTxt);oSubject.attachEvent("paste",drty)}var oLocation=$("txtLoc");if(oLocation){oLocation.attachEvent("keydown",onKDTxt)}var fRF=isRepFw();if(isDf(typeof(a_iDltDrft))&&!fRF){g_fDltDrft=a_iDltDrft}else if(fRF&&isDf(typeof(a_fCbResp))){g_fDltDrft=0}else if(fRF){g_fDltDrft=1}if(!oFrame){return}var isInternetExplorer=Owa.Utility.isIE();if(isInternetExplorer){oFrame.set_IsShown(false)}var sOuterHtml;if(!sB.match(/<html/i)||a_fTxt){sOuterHtml=oFrame.get_ContentDocument().get_DocumentElement().get_OuterHtml()}var s="";if(sOuterHtml){s=sOuterHtml}else if(!a_fTxt){s=sB}var oDivFmtBr=$("divFmtBr");if(oDivFmtBr&&isHtml()&&!(g_oMmBdy&&a_sId)){var oDialogHelper=Owa.Utility.isIE()?dlgHelper:null;var oEditor=GetNewOwaEditor(oDivFmtBr,oFrame.get_ContentDocument(),oDialogHelper,s)}else{oFrame.get_ContentDocument().set_DesignMode(1);wrtBdy(oFrame.get_ContentDocument(),s)}var oEdD=oFrame.get_ContentDocument();var oEdB=oEdD.get_Body();if(fRF){g_sRFId="divRpF"+rndm()}if(sOuterHtml){if(a_fTxt){if(!fRF){oEdB.set_TextContent(sB)}else{if(sB.trim()){var sDir=g_fRtl?"rtl":"ltr";oEdB.set_InnerHtml("<DIV>&nbsp;</DIV><DIV dir=\""+sDir+"\" id="+g_sRFId+"></DIV>");oEdD.getElementById(g_sRFId).set_TextContent(sB)}}}else{oEdB.set_InnerHtml(sB);insFnt(oEdD,oEdB,fRF)}}if(fRF&&!a_fTxt){var sDefaultPlaintextCss="font-family: Times New Roman; color: #000000; font-size: 16px";wrapHtmlBodyWithDefaultFont(oEdD,oEdB,sDefaultPlaintextCss);insFnt(oEdD,oEdB,1);var oDv=oEdD.getElementById("divRplyFwdMsg");if(!oDv){oDv=oEdD.getElementById("x_divRplyFwdMsg")}if(oDv){oDv.set_Id(g_sRFId);oDv._get_DomNode().style.direction=g_fRtl?"rtl":"ltr"}}if(!(g_oMmBdy&&a_sId)){addSignatureToNewMessage()}initializeIFrameBodyEditor(oEdD,oEdB,fnRsz);if(isInternetExplorer&&$("divEcm")){oEdB.attachEvent("contextmenu",onCMEd);oEdD.get_ContainerWindow().attachEvent("scroll",onEdWScr)}oEdB.attachEvent("paste",onPste);if(!chkMime()){var oContext={};oContext.oCallerSubPage=oCallerSubPage;if(!Owa.Utility.isFirefox()){oEdB.attachEvent("drop",Owa.Utility.createArgumentContextDelegate(window,procIA,oContext));oEdB.attachEvent("paste",Owa.Utility.createArgumentContextDelegate(window,procIA,oContext));oEdB.attachEvent("dragenter",setDE);oEdB.attachEvent("dragover",setDE)}else{oEdD.attachEvent("drop",Owa.Utility.createArgumentContextDelegate(window,procIA,oContext));oEdD.attachEvent("paste",Owa.Utility.createArgumentContextDelegate(window,procIA,oContext));oEdD.attachEvent("dragenter",setDE);oEdD.attachEvent("dragover",setDE)}}if(isSpC()){oEdB.attachEvent("cut",onPste);oEdB.attachEvent("dragstart",onPste);oEdB.attachEvent("dragend",onPste)}oEdB.attachEvent("drop",drty);if(isInternetExplorer){var oDivScm=$("divScm");if(oDivScm){CtxMnu(oDivScm._get_DomNode(),onSelSpl);oDivScm._get_DomNode().preShw=cmPreShwSpl}var oDivEcm=$("divEcm");if(oDivEcm){CtxMnu(oDivEcm._get_DomNode(),onSelEdt);oDivEcm._get_DomNode().preShw=cmPreShwEd}}var oTextBody=$("txtBdy");if(a_fTxt){var oDivFmtBr=$("divFmtBr");if(oDivFmtBr){oDivFmtBr.set_IsShown(false)}if(!isInternetExplorer){oTextBody.set_Value(oTextBody.get_Value());oFrame.set_IsShown(false);oTextBody.set_IsShown(true);rszBdy(oTextBody)}}if(isDf(typeof(a_fCopyRestricted))&&(a_fCopyRestricted==1)){oEdB.attachEvent("copy",canEvt);oEdB.attachEvent("cut",canEvt);oEdB.attachEvent("dragstart",canEvt)}if(isInternetExplorer){oFrame.set_IsShown(true)}updCmp(window)}function initializeIFrameBodyEditor(oEdD,oEdB,fnRsz){initializeIFrameBodyEditorHotkeys(oEdD);oEdD.attachEvent("keydown",onKDBdy);oEdD.attachEvent("click",onClkBdy);oEdB.attachEvent("paste",drty);oEdB.attachEvent("paste",fnRsz);initializeIFrameBody(oEdD,oEdB,fnRsz)}function onKDBdy(oEvent){if(oEvent&&isSpC()&&g_iLstSpLng){hndSpK(oEvent._oEvent)}sndKA();if(edDoc(1).get_IsDesignMode()&&oEvent){switch(oEvent.get_KeyCodeForKeyUpDown()){case 8:var oSel=createSelectionRange(edDoc());if(oSel.IsTypeControl()){break}var oSelD=oSel.duplicate();oSelD.collapse(true);var oE=Owa.Dom.Node.wrapDomNode(oSelD.parentElement());if(oE.get_TextContent()==""){var oOfficeList=isOfficeList(oE);if(oOfficeList){oOfficeList.set_Margin(Owa.Style.Side.Left,0);oOfficeList.set_textIndent(0);oEvent.preventDefault();oEvent.cancelBubble()}}break;case 9:hndlTb(oEvent);break}}onKDTxt(oEvent);Owa.UIControls.AutoCompleteCache.hide()}function hndlTb(oEvent){if(Owa.Utility.isSafari()){return}var sTb="&nbsp;&nbsp;&nbsp;&nbsp;";var oSel=createSelectionRange(edDoc());var oSelD=oSel.duplicate();oSelD.collapse(true);var oE=oSelD.parentElement();if(isLst(oE)){g_oIFrameBodyActionTable.getAction(oEvent.isShiftKeyDown()?"outdent":"indent").triggerAction(null,oEvent);oEvent.preventDefault()}else if(!oEvent.isShiftKeyDown()){var oDivW=Owa.Dom.Document.get_Current().createElement("div");oDivW.set_InnerHtml(oSel.htmlText());if(oSel.getText()==""||oDivW.get_FirstChild().get_NodeType()==3){oSelD.pasteHtml(sTb);oSelD.select()}else{oSel.pasteHtml(tbTxt(oDivW,sTb));oSel.select()}oEvent.preventDefault();oEvent.cancelBubble()}else{try{oEvent.get_Target().get_OwnerDocument().get_ContainerWindow().get_FrameElement().focus(0)}catch(e){}}}function tbTxt(oE,sTb){var rgoDiv=oE.getDescendantsByTagName("DIV");var rgoP=oE.getDescendantsByTagName("P");for(var i=0;i<rgoDiv.length;i++){var o=rgoDiv[i];o.set_InnerHtml(sTb+o.get_InnerHtml())}for(var i=0;i<rgoP.length;i++){var o=rgoP[i];o.set_InnerHtml(sTb+o.get_InnerHtml())}return oE.get_InnerHtml()}function isLst(oE){while(oE.tagName!="LI"&&oE.tagName!="BODY")oE=oE.parentNode;return(oE.tagName=="LI")}function isOfficeList(oE){var oMsoList=0;while(oE.get_TagName()!="BODY"){if(oE.get_TagName()=="P"&&oE._oDomNode.className.contains("MsoListParagraph")){oMsoList=oE;break}oE=oE.get_ParentElement()}return oMsoList}function dispCmbFrmt(){if(g_oFormatCombobox){g_oFormatCombobox.dispose()}}function dispTxtBdy(sId){var oTxt=$(sId);if(oTxt){if(!chkMime()){dispDE(sId)}oTxt.detachAllEvents()}}function adjustMessageBody(){var iHeaderOffsetHeight=$("divHdrMessage").get_OffsetHeight();var oDivBdy=$("divBdy");if(!oDivBdy){oDivBdy=$("mimeEdit")}oDivBdy.set_Top(iHeaderOffsetHeight);var oTextBody=$("txtBdy");var fIsShown=oTextBody&&oTextBody.get_IsShown();if(a_fTxt&&fIsShown){var iDivBodyOffsetWidth=oDivBdy.get_OffsetWidth();var iDivBodyOffsetHeight=oDivBdy.get_OffsetHeight();var iLeftPadding=oTextBody.getEffectivePadding(Owa.Style.Side.Left);var iRightPadding=oTextBody.getEffectivePadding(Owa.Style.Side.Right);var iTopPadding=oTextBody.getEffectivePadding(Owa.Style.Side.Top);var iBottomPadding=oTextBody.getEffectivePadding(Owa.Style.Side.Bottom);var iHeight=0;var iWidth=0;if(Owa.Utility.isIE()){iHeight=(iDivBodyOffsetHeight-(iTopPadding+iBottomPadding));iWidth=(iDivBodyOffsetWidth-(iLeftPadding+iRightPadding))}else{iHeight=(iDivBodyOffsetHeight-(iTopPadding+iBottomPadding)/2);iWidth=(iDivBodyOffsetWidth-(iLeftPadding+iRightPadding)/2)}iWidth=(iWidth<0)?0:iWidth;iHeight=(iHeight<0)?0:iHeight;oTextBody.set_Width(iWidth);oTextBody.set_Height(iHeight)}}function rszCtrls(oAll,rgoCtrl){var i=0,o=null;var nWidth=0;for(i=0;i<rgoCtrl.length;i++){o=oAll[rgoCtrl[i]];if(o!=null){var n=0;if(o.scrollWidth>o.clientWidth)n=o.scrollWidth-o.clientWidth+o.offsetWidth+8;else n=o.offsetWidth+8;if(n>nWidth)nWidth=n}}if(nWidth<50)nWidth=50;if(0<nWidth){for(i=0;i<rgoCtrl.length;i++){o=oAll[rgoCtrl[i]];if(o!=null)o.style.width=""+nWidth+"px"}}}function rszCol(oTd,oCol,iO){oCol.style.pixelWidth=oTd.offsetWidth;if(iO)oCol.style.pixelWidth+=iO}function initCB(oCallerSubPage,fC,fnRsz){var otxtBdy=$("txtBdy");var oFrame=$("ifBdy");var sB;if(otxtBdy){sB=otxtBdy.get_Value()}else{sB="<html><body></body></html>"}if(fC){initEdit(oCallerSubPage,sB,oFrame,fnRsz)}else{initRead(sB,oFrame,fnRsz)}if(!oFrame){otxtBdy.set_IsShown(true);if(!fC)otxtBdy.setBoolAttribute("readOnly",true)}var fn=Owa.Utility.createWindowResizeHandler(Owa.Dom.Window.get_Current(),fnRsz);Owa.Dom.Window.get_Current().attachEvent("resize",fn);window.setTimeout(fnRsz,10)}function dispCB(fC){if(g_oIFrameBodyHotkeyManager){g_oIFrameBodyHotkeyManager.dispose()}var oDoc=edDoc(1);if(oDoc){var oEdB=oDoc.get_Body();oEdB.detachAllEvents()}if(isRichTextEditorSupported()&&fC){if(isSpC()){dispSp()}}if(fC){var oFrame=$("ifBdy");if(oFrame)oFrame.get_ContentDocument().detachAllEvents();dispTxtBdy("txtBdy");var oTxtSubj=$("txtSubj");if(oTxtSubj){oTxtSubj.detachAllEvents()}var oTxtLoc=$("txtLoc");if(oTxtLoc){oTxtLoc.detachAllEvents()}var oDivFmtBr=$("divFmtBr");if(oDivFmtBr&&isFormatBarInitialized(oDivFmtBr)){oDivFmtBr.getExpando("formatBar").dispose()}}}function initAw(oCallerSubPage){var oDivA=$("divAtch");if(!oDivA){return}oDivA.attachEvent("contextmenu",onCtxAtch);if(!oDivA.getBoolAttribute("_isRW")){return}if(oDivA.getBoolAttribute("_isEventAttach")){if(Owa.Utility.isSafari()){Owa.Dom.Document.get_Current().attachEvent("keydown",onKeyDownAw);Owa.Dom.Document.get_Current().attachEvent("click",onAwBlur)}else{oDivA.attachEvent("keydown",onKeyDownAw)}oDivA.attachEvent("resize",rszAw);oDivA.attachEvent("click",onClickAw);oDivA.attachEvent("dblclick",onDblClickAw)}if(!chkMime()){var oContext={};oContext.oCallerSubPage=oCallerSubPage;oDivA.attachEvent("drop",Owa.Utility.createArgumentContextDelegate(window,procIA,oContext));oDivA.attachEvent("paste",Owa.Utility.createArgumentContextDelegate(window,procIA,oContext));initDE("divAtch")}rszAw()}function dispAw(){var oDivAtch=$("divAtch");if(!oDivAtch){return}if((!chkMime())&&oDivAtch.getAttribute("_isRW")){dispDE("divAtch")}if(Owa.Utility.isSafari()){Owa.Dom.Document.get_Current().detachEvent("keydown",onKeyDownAw)}oDivAtch.detachAllEvents()}function dispFrmDrp(){var oBody=Owa.Dom.Document.get_Current().get_Body();oBody.detachAllEvents("dragenter");oBody.detachAllEvents("dragover");oBody.detachAllEvents("drop");oBody.detachAllEvents("dragend")}function initDE(sId){var oE=$(sId);if(oE){oE.attachEvent("dragenter",setDE);oE.attachEvent("dragover",setDE)}}function dispDE(sId){var oE=$(sId);if(oE){oE.detachAllEvents()}}function setDE(e){var e=e?e:edEvt();if(!e)e=getEvt(this);if(!e)return;var oEvent=Owa.Dom.Event.isInstance(e)?e:new Owa.Dom.Event(e);var oDragDrop=new Owa.Components.Storage.DragDrop(oEvent);var oDraggableObject=Owa.Components.Storage.StorableObject.createFromStorage(oDragDrop);if(oDraggableObject){oEvent.cancelBubble();oEvent.preventDefault();oDragDrop.setEffect(Owa.Components.Storage.DragDrop.Effect.Copy)}else{oEvent.cancelBubble();oEvent.preventDefault()}}var g_rgPendingResizeOperation=[];function safeResizeHelper(fnRealResizeFunction){if(!Owa.UIControls.SubPage.get_Instance().get_IsShown()){g_rgPendingResizeOperation.push(fnRealResizeFunction)}else{fnRealResizeFunction()}}function safeResizeWells(){if(isDf(typeof(resizeWells))){safeResizeHelper(resizeWells)}}function safeResizeBodies(){safeResizeHelper(resizeBodies)}function insertSS(oDoc,sId,sMedia){var oSS=getSS(oDoc,sId);var iC=oDoc.get_StyleSheetCount();if(!oSS){if(iC<31){oSS=sMedia?oDoc.insertBlankStyleSheet(sId,sMedia):oDoc.insertBlankStyleSheet(sId)}else{oSS=oDoc.getStyleSheetAt(iC-1)}}return oSS}function getSS(oDoc,sId){return oDoc.getStyleSheetByAttribute("id",sId)}function applyParagraphStylesToDocument(oDoc,fR){if(oDoc.get_Body().getIntAttribute("fPStyle")){return}if(Owa.Utility.isIE()){var iStyleSheetCount=oDoc.get_StyleSheetCount();for(var i=0;i<iStyleSheetCount;i++){var oSheet=oDoc.getStyleSheetAt(i);if(oSheet.get_OwnerNode()){var sStyleSheetHtml=oSheet.get_OwnerNode().get_InnerHtml();sStyleSheetHtml=sStyleSheetHtml.replace(new RegExp("p[\\s]*?{[\\S\\s]*?}","gi"),"");oSheet._oDomStyleSheet.cssText=sStyleSheetHtml}}}var oSS=getSS(oDoc,"owaParaStyle");if(!oSS){oSS=insertSS(oDoc,"owaParaStyle")}if(!fR){oSS.addRule("P","margin-top:0;margin-bottom:0;")}oDoc.get_Body().setIntAttribute("fPStyle",1)}function applyNoPrintStylesToDocument(oDoc){var oSS=getSS(oDoc,"owaPrintStyle");if(!oSS){oSS=insertSS(oDoc,"owaPrintStyle","print");var iC=oDoc.get_StyleSheetCount();if(oSS.get_Id()=="owaPrintStyle"){oSS.addRule("BODY","display:none;visibility:hidden;")}}}function removeNoPrintStylesFromDocument(oDoc){var oSS=getSS(oDoc,"owaPrintStyle");if(oSS){oSS.remove()}}function removeTempEditStylesFromDocument(oDoc){var oSS=getSS(oDoc,"owaTempEditStyle");if(oSS){oSS.remove()}}function isHtml(){var oComboBoxDom=$("divCmbFrmt");if(!oComboBoxDom){return false}var oComboBox=oComboBoxDom.getExpando("oComboBox");return(oComboBox.get_SelectedValue()=="0")}function isBdy(o){return Owa.Dom.Node.wrapDomNode(o.ownerDocument).get_IsDesignMode()}function getFB(oDP,rgFId,cb){var oCtx=new Object();oCtx.oDP=oDP;oCtx.cbOnErr=cb;var oR=new oeReq("DatePicker","GetFreeBusy",oCtx,cbGetFB,POST);oR.add("m",oDP.dt);oR.addRg("fId",rgFId);oR.send()}function cbGetFB(oR){if(oR.fST){popLgn();return}if(oR.sErr){if(oR.oCtx.cbOnErr)oR.oCtx.cbOnErr(oR,1);return}var oDP=oR.oCtx.oDP;var div=Owa.Dom.Document.get_Current().createElement("div");div.set_InnerHtml(oR.sBody);var divFb=div.getChildById("fb");var dt=toDate(divFb.getIntAttribute("_y"),divFb.getIntAttribute("_m"),1);oDP.updateFb(divFb.get_TextContent(),dt);oR.oCtx.cbOnErr(oR,0)}var g_ver="14.0.722.0";var g_iLgn=1;var UP=38;var DOWN=40;var g_fRtl=(window.document.documentElement.getAttribute("dir")=="rtl");var g_sDE=g_fRtl?"&#x200F;":"&#x200E;";var g_ocmS;var T_CAL="IPF.Appointment";var T_CON="IPF.Contact";var T_DOC="IPF.DocumentLibrary";var T_MSG="IPF.Note";var T_TSK="IPF.Task";var T_NTS="IPF.StickyNote";var T_JNL="IPF.Journal";var g_iMinVWW=156;var g_iMinRPW=50;var BTN_BIU=0x0001;var BTN_JUSTIFY=0x0002;var BTN_LISTS=0x0004;var BTN_INDENT=0x0008;var BTN_DIR=0x0010;var BTN_FORE_COLOR=0x0020;var BTN_BACK_COLOR=0x0040;var BTN_REMOVE_FORMAT=0x0080;var BTN_INSERT_RULE=0x0100;var BTN_UNDO_REDO=0x0200;var BTN_LINKS=0x0400;var BTN_SUBSCRIPT_SUPERSCRIPT=0x0800;var BTN_STRIKE=0x1000;var BTN_CUSTOMIZE=0x2000;function isFlgSt(iV,iFlg){return(iV&iFlg)==iFlg}function isPFId(s){return s.startsW("PSF.")}function updateCalendarFolders(){setCSVAsStr(CSV_CALENDAR_FOLDERS_DT,new Date())}function padF(sId){return"f"+sId}function canDrg(e){e=e?e:event;var oEvent=Owa.Dom.Event.isInstance(e)?e:new Owa.Dom.Event(e);var oDragDrop=new Owa.Components.Storage.DragDrop(oEvent);oDragDrop.deny()}function wda(sId){return window.document.getElementById(sId)}function getExpLgnAddress(){var address="";var parts=window.location.pathname.split('/');if((parts.length>2)&&(parts[2].indexOf('@')!==-1)){address+=parts[2]+'/'}return address}function getEcpVdir(){return"/ecp/"+getExpLgnAddress()}function getOwaVdir(){return"/owa/"}if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/hotkeymanagerdom.js".toLowerCase()])(function(){Type.createNamespace("Owa.Components");Owa.Components.HotKeyManagerDom=function Owa$Components$HotKeyManagerDom(oActionTable,oTargetElement,oFallbackHotkeyManager){Owa.Components.HotKeyManagerDom.constructBase(this,[oActionTable,oFallbackHotkeyManager]);this._oTargetNode=oTargetElement||Owa.Dom.Document.get_Current();this._oEventTargetNode=this._oTargetNode;this._fHookOnDocumentDueToNonFocusableTarget=false;if(!Owa.Dom.Document.isInstance(this._oTargetNode)&&!isInpt(this._oTargetNode)){this._fHookOnDocumentDueToNonFocusableTarget=true;this._oEventTargetNode=this._oTargetNode.get_OwnerDocument()}this._oEventTargetNode.attachEvent("keydown",this._createCallback(this._onKeyDown))};var _oPrototype=Owa.Components.HotKeyManagerDom.prototype;_oPrototype.dispose=function Owa$Components$HotKeyManagerDom$dispose(){this._oEventTargetNode.detachEvent("keydown",this._createCallback(this._onKeyDown));this._oTargetNode=null;this._oEventTargetNode=null;Owa.Components.HotKeyManagerDom.callBase(this,"dispose")};Owa.Components.HotKeyManagerDom.createClass("Owa.Components.HotKeyManagerDom",Owa.Components.HotKeyManager)})();g_fModuleLoaded[".\\components/hotkeymanagerdom.js".toLowerCase()]=1;function ButtonStyle(o,sC){o.className=sC;var oS=gtStl(o);this.color=oS.color;this.backgroundColor=oS.backgroundColor;this.borderColor=oS.borderTopColor;this.borderStyle=oS.borderTopStyle;this.borderWidth=oS.borderTopWidth;this.padding=oS.padding;this.fontWeight=oS.fontWeight}function showEms(rg,fH){if(!rg.length)rg=new Array(rg);for(var i=0;i<rg.length;i++)showEm(rg[i],fH)}function showEm(oElement,fHide){if(Owa.Dom.Node.isInstance(oElement))oElement=oElement._get_DomNode();if(fHide){hideEm(oElement)}else{oElement.style.display=""}}function hideEm(oElement){if(Owa.Dom.Node.isInstance(oElement))oElement=oElement._get_DomNode();oElement.style.display="none"}function setVsblEm(o,fV){o.style.visibility=fV?"visible":"hidden"}function isDisp(o){if(Owa.Dom.Node.isInstance(o))o=o._get_DomNode();return o!=null&&gtStl(o)["display"]!="none"}function getEm(sTag,oD){if(!oD){oD=window.document}return oD.createElement(sTag)}function wdb(){return window.document.body}function wtda(sId,oW){if(!oW){oW=wt()}return getOneDescendant(gtWD(oW),sId)}function adEm(sTag,sId,sT,oPar,sC,fTxt){var o=getEm(sTag,oPar?god(oPar):0);if(sId)o.id=sId;if(sC)o.className=sC;if(sT)fTxt?(o.innerText=sT):(o.innerHTML=sT);if(oPar)oPar.appendChild(o);return o}function posEm(o,iX,iY){spl(o,iX);spt(o,iY)}function rszEm(o,iW,iH){spw(o,iW);sph(o,iH)}function gtScrPrnt(o,fB){var oC=o;var oP=null;while((oC=oC.offsetParent)!=null&&(!fB||!(oC.nodeName.match(/^body$/i)||oC.nodeName.match(/^html$/i)))){if(oC.scrollHeight>oC.offsetHeight){oP=oC;break}}return oP}function getCX(o,fA,oP){if(!Owa.Dom.Node.isInstance(o))o=Owa.Dom.Node.wrapDomNode(o);if(oP&&!Owa.Dom.Node.isInstance(oP))oP=Owa.Dom.Node.wrapDomNode(oP);return fA?o.get_PositionalLeft():o.get_DocumentLeft()}function getCY(o,fA,oP){if(!Owa.Dom.Node.isInstance(o))o=Owa.Dom.Node.wrapDomNode(o);if(oP&&!Owa.Dom.Node.isInstance(oP))oP=Owa.Dom.Node.wrapDomNode(oP);return fA?o.get_PositionalTop():o.get_DocumentTop()}function sph(o,iH){if("pixelHeight" in o.style)o.style.pixelHeight=iH;else o.style.height=iH+"px"}function spw(o,iW){if(iW>=0)o.style.width=iW+"px"}function gch(o){return o.clientHeight}function gcw(o){return o.clientWidth}function goh(o){return o.offsetHeight}function gow(o){return o.offsetWidth}function got(o){return o.offsetTop}function gol(o){return o.offsetLeft}function gsw(o){return o.scrollWidth}function spl(o,iL){if("pixelLeft" in o.style)o.style.pixelLeft=iL;else o.style.left=iL+"px"}function splc(o,iL){if(gol(o)!=iL)spl(o,iL)}function spt(o,iT){if("pixelTop" in o.style)o.style.pixelTop=iT;else o.style.top=iT+"px"}function ibb(oC,oE){return Owa.Dom.Node.wrapDomNode(oC).insertAdjacentElement("beforeBegin",Owa.Dom.Node.wrapDomNode(oE))._get_DomNode()}function iab(oC,oE){return Owa.Dom.Node.wrapDomNode(oC).insertAdjacentElement("afterBegin",Owa.Dom.Node.wrapDomNode(oE))._get_DomNode()}function ibe(oC,oE){return Owa.Dom.Node.wrapDomNode(oC).insertAdjacentElement("beforeEnd",Owa.Dom.Node.wrapDomNode(oE))._get_DomNode()}function iae(oC,oE){return Owa.Dom.Node.wrapDomNode(oC).insertAdjacentElement("afterEnd",Owa.Dom.Node.wrapDomNode(oE))._get_DomNode()}function ibeh(oC,sH){Owa.Dom.Node.wrapDomNode(oC).insertAdjacentHtml("beforeEnd",sH)}function iaeh(oC,sH){Owa.Dom.Node.wrapDomNode(oC).insertAdjacentHtml("afterEnd",sH)}function iatae(oC,sT){Owa.Dom.Node.wrapDomNode(oC).insertAdjacentText("afterEnd",sT)}function rn(o){Owa.Dom.Node.wrapDomNode(o).remove(true)}function ra(o,sA){o.removeAttribute(sA)}function chk(o){if(Owa.Dom.Node.isInstance(o))o=o._get_DomNode();o.checked=1}function chkd(o){if(Owa.Dom.Node.isInstance(o))o=o._get_DomNode();return o.checked?1:0}function ac(o){document.documentElement.appendChild(o)}function god(o){return o.ownerDocument}function gtw(o){var iW=gow(o);iW+=parseInt(0+gtStl(o,"marginLeft"),10);iW+=parseInt(0+gtStl(o,"marginRight"),10);return iW}function setFcs(o,iTO){if(Owa.Dom.Node.isInstance(o))o=o._get_DomNode();try{function fcs(){try{o.focus()}catch(e){}}if(god(o).parentWindow)god(o).parentWindow.setTimeout(fcs,iTO?iTO:1);else if(god(o).defaultView)god(o).defaultView.setTimeout(fcs,iTO?iTO:1)}catch(e){}}function setData(sT){if(sT!=null)window.clipboardData.setData('Text',sT)}String.prototype.startsW=function String$startsW(s){return this.indexOf(s)==0};String.prototype.lc=function String$lc(){return this.toLowerCase()};function errSty(o,f){if(!g_oDsSty){g_oDsSty=getStyle("cmDsbld")}var oS=o.style;oS.color=f?g_oDsSty.color:"";oS.cursor=f?g_oDsSty.cursor:""}function getStyle(sC,sEl){if(sEl)var o=getEm(sEl);else var o=getEm("A");o.style.display="none";o.className=sC;ibe(document.body,o);return gtStl(o)}function btnOnMsOvrBtn(o){Owa.Dom.Node.wrapDomNode(o).addCssClass("btnHvr")}function btnOnMsOutBtn(o){Owa.Dom.Node.wrapDomNode(o).removeCssClass("btnHvr")}function gtWD(oW){try{return oW.document}catch(e){Owa.BrowserErrorHandler.handleFrameAccessError(e)}}var g_oDsSty=null;function gtStl(oE,sStl){if(oE.currentStyle)return sStl?oE.currentStyle[sStl]:oE.currentStyle;else return sStl?window.getComputedStyle(oE,sStl):window.getComputedStyle(oE,'')}function getOneDescendant(oElement,sId){if(oElement.getElementById){return oElement.getElementById(sId)}var rgAll=oElement.getElementsByTagName("*");var oDescendant=rgAll[sId];if(isRg(oDescendant)){oDescendant=oDescendant[0]}else if((oDescendant==null)&&(!Owa.Utility.isIE())){for(var i=0;i<rgAll.length;i++){if(rgAll[i].id==sId){oDescendant=rgAll[i];break}}}return oDescendant}function getOneChild(oE,sId){var o=oE.firstChild;while(o){if(o.id==sId)return o;o=o.nextSibling}return null}function getDescendants(oE,sId){var rg=new Array();if(oE.all){var o=oE.all[sId];if(o){if(isRg(o))rg=o;else rg.push(o)}}else{var rgAll=oE.getElementsByTagName("*");for(var i=0;i<rgAll.length;i++){if(rgAll[i].id==sId)rg.push(rgAll[i])}}return rg}function scrollIntoView(oE,oP){var iT=0;var oTemp=oE;while(oTemp&&oTemp!=oP){iT+=got(oTemp);oTemp=oTemp.offsetParent}oP.scrollTop=iT}function getVisiblePositionX(oElement,iX){var iWindowWidth=gcw(god(oElement).body);var iElementWidth=gcw(oElement);var iBorderWidth=getInt(gtStl(oElement,"borderLeftWidth"))+getInt(gtStl(oElement,"borderRightWidth"));if(!isNaN(iBorderWidth))iElementWidth+=iBorderWidth;var iOffsetX=0;var iBodyX=iX;var oDomParent=Owa.Dom.Node.wrapDomNode(oElement.parentNode);if(oDomParent.get_OverflowX()==Owa.Style.Overflow.Scroll||oDomParent.get_OverflowX()==Owa.Style.Overflow.Auto){iWindowWidth=oDomParent.get_Width()}else{iOffsetX=getCX(oElement.offsetParent);iBodyX=iOffsetX+iX}if(!g_fRtl){var iOverhang=(iBodyX+iElementWidth-iWindowWidth);if(iOverhang>0)iBodyX-=iOverhang;if(iBodyX<0)iBodyX=0}else{if(iBodyX<0)iBodyX=0;if(iBodyX+iElementWidth>iWindowWidth)iBodyX=iWindowWidth-iElementWidth}return(iBodyX-iOffsetX)}function getVisiblePositionY(oElement,iY){var oDocumentElement=god(oElement).body;var iElementHeight=gch(oElement);var iBorderHeight=getInt(gtStl(oElement,"borderTopWidth"))+getInt(gtStl(oElement,"borderBottomWidth"));if(!isNaN(iBorderHeight))iElementHeight+=iBorderHeight;var iOffsetY=0;var iBodyY=iY;var oDomParent=Owa.Dom.Node.wrapDomNode(oElement.parentNode);if(oDomParent.get_OverflowY()==Owa.Style.Overflow.Scroll||oDomParent.get_OverflowY()==Owa.Style.Overflow.Auto){oDocumentElement=oElement.parentNode}else{iOffsetY=getCY(oElement.offsetParent);iBodyY=iOffsetY+iY}var iOverhang=iBodyY+iElementHeight-goh(oDocumentElement)-oDocumentElement.scrollTop;if(iOverhang>0)iBodyY-=iOverhang;if(iBodyY<0)iBodyY=0;return(iBodyY-iOffsetY)}function gtFrEm(oW){try{return oW.frameElement}catch(e){Owa.BrowserErrorHandler.handleFrameAccessError(e)}}var IMNS="IM";function sndIMReq(sC,cb,oCtrl,oRCtx){var oC=new Object();oC.sC=sC;oC.cb=cb;oC.oCtrl=oCtrl;oC.oRCtxt=oRCtx;var oR=new oeReq(IMNS,sC,oC,cbIM,POST);switch(sC){case IM_SCM:oR.add("cMsg",oRCtx.sMsg);oR.add("frmt",oRCtx.sFrmt);oR.add("cId",oRCtx.sChtId);oR.addRg("sUris",oRCtx.rgoRcp);break;case IM_SNCM:oR.add("cMsg",oRCtx.sMsg);oR.add("frmt",oRCtx.sFrmt);oR.addRg("sUris",oRCtx.rgoRcp);if(isMSNPrv()){if(isDf(typeof(oRCtx.rType))&&oRCtx.rType.length>0&&oRCtx.rType[0]!=null){oR.add("iType",oRCtx.rType[0])}}break;case IM_SC:oR.add("sbsUris",(isDf(typeof(oRCtx.sUrisSub))?oRCtx.sUrisSub:""));oR.add("unsbsUris",(isDf(typeof(oRCtx.sUrisUnsub))?oRCtx.sUrisUnsub:""));break;case IM_QP:oR.add("qryUris",(isDf(typeof(oRCtx.sQryUris))?oRCtx.sQryUris:""));break;case IM_AB:if(isDf(typeof(oRCtx.bdyAddr)))oR.add("bdyAddr",oRCtx.bdyAddr);if(isDf(typeof(oRCtx.sDN)))oR.add("dName",oRCtx.sDN);if(isDf(typeof(oRCtx.msg)))oR.add("msg",oRCtx.msg);if(isDf(typeof(oRCtx.sGroupID)))oR.add("grpId",oRCtx.sGroupID);if(isDf(typeof(oRCtx.sGroupName)))oR.add("grpNme",oRCtx.sGroupName);break;case IM_RFBL:if(isDf(typeof(oRCtx.sUri)))oR.add("bdyAddr",oRCtx.sUri);if(isDf(typeof(oRCtx.sGid)))oR.add("sGid",oRCtx.sGid);if(isDf(typeof(oRCtx.iType))&&oRCtx.iType!=null)oR.add("iType",oRCtx.iType);break;case IM_ACPT:case IM_DCL:case IM_UNBLK:case IM_BLK:if(isDf(typeof(oRCtx.sUri)))oR.add("bdyAddr",oRCtx.sUri);if(isDf(typeof(oRCtx.iType)))oR.add("iType",oRCtx.iType);break;case IM_RFG:if(isDf(typeof(oRCtx.sUri)))oR.add("bdyAddr",oRCtx.sUri);if(isDf(typeof(oRCtx.sGid)))oR.add("sGid",oRCtx.sGid);if(isDf(typeof(oRCtx.sGroupID)))oR.add("grpId",oRCtx.sGroupID);if(isDf(typeof(oRCtx.sGroupName)))oR.add("grpNme",oRCtx.sGroupName);if(isDf(typeof(oRCtx.sBuddyName)))oR.add("dName",oRCtx.sBuddyName);if(isDf(typeof(oRCtx.fTagged)))oR.add("tag",oRCtx.fTagged);if(isDf(typeof(oRCtx.rgGrpIds)))oR.addRg("grpIds",oRCtx.rgGrpIds);break;case IM_MB:if(isDf(typeof(oRCtx.sUri)))oR.add("bdyAddr",oRCtx.sUri);if(isDf(typeof(oRCtx.sGid)))oR.add("sGid",oRCtx.sGid);if(isDf(typeof(oRCtx.sOldGroupId)))oR.add("oldGrpId",oRCtx.sOldGroupId);if(isDf(typeof(oRCtx.sOldGroupName)))oR.add("oldGrpNme",oRCtx.sOldGroupName);if(isDf(typeof(oRCtx.sNewGroupId)))oR.add("newGrpId",oRCtx.sNewGroupId);if(isDf(typeof(oRCtx.sNewGroupName)))oR.add("newGrpNme",oRCtx.sNewGroupName);if(isDf(typeof(oRCtx.sBuddyName)))oR.add("dName",oRCtx.sBuddyName);if(isDf(typeof(oRCtx.fTagged)))oR.add("tag",oRCtx.fTagged);if(isDf(typeof(oRCtx.rgGrpIds)))oR.addRg("grpIds",oRCtx.rgGrpIds);break;case IM_CB:if(isDf(typeof(oRCtx.sUri)))oR.add("bdyAddr",oRCtx.sUri);if(isDf(typeof(oRCtx.sGid)))oR.add("sGid",oRCtx.sGid);if(isDf(typeof(oRCtx.sGroupId)))oR.add("grpId",oRCtx.sGroupId);if(isDf(typeof(oRCtx.sGroupName)))oR.add("grpNme",oRCtx.sGroupName);if(isDf(typeof(oRCtx.sBuddyName)))oR.add("dName",oRCtx.sBuddyName);if(isDf(typeof(oRCtx.fTagged)))oR.add("tag",oRCtx.fTagged);if(isDf(typeof(oRCtx.rgGrpIds)))oR.addRg("grpIds",oRCtx.rgGrpIds);break;case IM_CRG:if(isDf(typeof(oRCtx.sGroupName)))oR.add("grpNme",oRCtx.sGroupName);break;case IM_RMG:if(isDf(typeof(oRCtx.sGroupName)))oR.add("grpNme",oRCtx.sGroupName);if(isDf(typeof(oRCtx.sGroupID)))oR.add("grpId",oRCtx.sGroupID);break;case IM_RNG:if(isDf(typeof(oRCtx.sGroupID)))oR.add("grpId",oRCtx.sGroupID);if(isDf(typeof(oRCtx.sOldGroupName)))oR.add("oldGrpNme",oRCtx.sOldGroupName);if(isDf(typeof(oRCtx.sNewGroupName)))oR.add("newGrpNme",oRCtx.sNewGroupName);break;case IM_GBL:break;case IM_ISO:break;case IM_NTP:case IM_NTPC:if(isDf(typeof(oRCtx.sChtId))&&oRCtx.sChtId)oR.add("cId",oRCtx.sChtId);break;case IM_EDL:break;case IM_SI:if(isDf(typeof(oRCtx.fMnlSI)))oR.add("mnlSI",oRCtx.fMnlSI);break;case IM_CPR:if(isDf(typeof(oRCtx.prsnc)))oR.add("prsnce",oRCtx.prsnc);break;case IM_ADIMM:break;case IM_ATCS:break;case IM_RFCS:break;case IM_ECS:oR.add("cId",oRCtx.sChtId);oR.add("fDisc",oRCtx.fDisc);break;case IM_ITMINFO:oR.add("mId",oRCtx.sMsgId);if(isDf(typeof(oRCtx.gtNrmSub))&&oRCtx.gtNrmSub)oR.add("gtNrmSub","1");break;case IM_PSTEXP:oR.addRg("grpIds",oRCtx.rgGrpIds);break;case IM_PXY:oR.addRg("sUris",oRCtx.rgsUris);break;case IM_PIC:oR.add("cId",oRCtx.sChtId);break;default:break}if(oRCtx.sLDn)oR.add("lDn",oRCtx.sLDn);oR.send()}function cbIM(oR){hdPrgrsInd();if(oR.sErr){var oRCtx=oR.oCtx.oRCtxt;if(!cbOehST(oR)){if(isDf(typeof(oRCtx.feOnST))&&oRCtx.feOnST){oRCtx.feOnST(oRCtx,true)}return}if(oRCtx){oRCtx.iErr=oR.iErr;oRCtx.sErr=oR.sErr}if(isDf(typeof(oRCtx.feOnErr))&&oRCtx.feOnErr)oRCtx.feOnErr(oRCtx);return}var oC=oR.oCtx;if(oC&&oC.cb&&oC.oRCtxt)oC.cb(oC.oRCtxt,oR.sBody)}var BID_PR="postreply";var BID_PT="post";var BID_RE="reply";var BID_RECMB="replycombo";var BID_RED="replydrpdwn";var BID_REC="replybychat";var BID_RES="replybysms";var BID_REP="replybyphone";var BID_RA="replyall";var BID_FW="forward";var BID_FWA="fwia";var BID_FWCMB="forwardcombo";var BID_FWD="forwarddrpdwn";var BID_FWAD="fwiadrpdwn";var BID_NP="newpst";var BID_NT="newtsk";var BID_DL="delete";var BID_PDLT="permanentdelete";var BID_IGNCNV="ignoreconversation";var BID_CANIGNCNV="cancelignoreconversation";var BID_CANIGNCNVDD="cancelignoreconversationdd";var BID_DLDD="deletedrpdwn";var BID_DLIGNDD="deleteigndrpdwn";var BID_CM="checkmessages";var BID_PN="print";var BID_EDT="edt";var BID_MV="move";var BID_CHT="chat";var BID_ABLST="ablst";var BID_RMBLST="rmblst";var BID_CHP="chgperm";var BID_SHCAL="shcurcal";var BID_OPNCAL="opnshcal";var BID_SHCNT="shcurcnt";var BID_OPNCNT="opnshcnt";var BID_SHTSK="shcurtsk";var BID_OPNTSK="opnshtsk";var BID_CAT="cat";var BID_EXPALL="expandAll";var BID_CLPSALL="collapseAll";var BID_UNBLKBDY="unblkbdy";var BID_BLKBDY="blkbdy";var g_oDwn="btnDn";var g_oRsd="btnR";var g_oDsa="btnDa";var g_oDwnTB="tbfP";var g_oRsdTB="tbfHvr";var g_oDsaTB="tbfD";var g_oEmtDa="miDa";var g_oMir="miR";var g_oMid="miDn";var g_oFlt="flat";var g_oChtBtnFlt="chtBtnflat";var g_oChtBtnDn="chtBtnDn";var g_rgAllStyles=[g_oDwn,g_oRsd,g_oDsa,g_oDwnTB,g_oRsdTB,g_oDsaTB,g_oEmtDa,g_oMir,g_oMid,g_oFlt,g_oChtBtnFlt,g_oChtBtnDn];function ApplyButtonStyle(oButtonElement,oStyle){if(!Owa.Dom.Node.isInstance(oButtonElement)){oButtonElement=Owa.Dom.Node.wrapDomNode(oButtonElement)}var oButtonFrame;oButtonFrame=oButtonElement.get_ParentElement();if(oButtonFrame==null){oButtonFrame=oButtonElement}var rgClasses=oButtonFrame.get_CssClasses();for(var i=0;i<g_rgAllStyles.length;i++){rgClasses.remove(g_rgAllStyles[i])}rgClasses.add(oStyle);oButtonFrame.set_CssClasses(rgClasses)}function initCmbFrmt(){var oComboElement=$("divCmbFrmt");if(oComboElement){g_oFormatCombobox=new Owa.UIControls.ComboBox(oComboElement);g_oFormatCombobox.initialize();oComboElement.setExpando("oComboBox",g_oFormatCombobox);g_oFormatCombobox.get_OnChange().add(onChgHtmlTxt);if(isDf(typeof(a_fEdtMsg))&&a_fEdtMsg&&isDf(typeof(a_fTxt))){if(a_fTxt){g_oFormatCombobox.set_SelectedValue("1")}else{g_oFormatCombobox.set_SelectedValue("0")}}}}if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/transparentmask.js".toLowerCase()])(function(){Owa.UIControls.TransparentMask=function Owa$UIControls$TransparentMask(sId,zIndex,oDocument){var oMaskDiv=oDocument.createElement("div");oDocument.appendChild(oMaskDiv);Owa.UIControls.TransparentMask.constructBase(this,[oMaskDiv]);var oImg=oDocument.createElement("img");oMaskDiv.appendChild(oImg);oImg.setAttribute("src",getThmF("clear1x1.gif"));oMaskDiv.addCssClass("dlgMask");oMaskDiv._get_DomNode().style.zIndex=zIndex;oMaskDiv.set_Id(sId);this._cancelEvent(oMaskDiv,"keydown");this._cancelEvent(oMaskDiv,"contextmenu");this._cancelEvent(oMaskDiv,"click");this._cancelEvent(oMaskDiv,"mousedown")};Owa.UIControls.TransparentMask.prototype.dispose=function Owa$UIControls$TransparentMask$prototype$dispose(){this._get_Element().remove(true);Owa.UIControls.TransparentMask.callBase(this,'dispose')};Owa.UIControls.TransparentMask.prototype.setHandler=function Owa$UIControls$TransparentMask$setHandler(sEventName,fnNewHandler){var oMaskDiv=this._get_Element();oMaskDiv.detachAllEvents(sEventName);this._attachEvent(oMaskDiv,sEventName,fnNewHandler)};Owa.UIControls.TransparentMask.createClass("Owa.UIControls.TransparentMask",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/transparentmask.js".toLowerCase()]=1;var g_iDlgZ=10;var g_iDlgZFct=5;var Dlg;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/dialog.js".toLowerCase()])(function(){var rgDialogInOtherFrame=[];var ON_CLOSE="onClose";var ON_SHOW="onShow";var ON_CANCEL="onCancel";Dlg=Owa.UIControls.Dialog=function Owa$UIControls$Dialog(sId,sHtml,fClickAway,fFocus,oDialogParent,fNoDispose,fKeyDown){this.sId=sId;this._fClickAway=fClickAway;this._fFocus=fFocus;this._fNoDispose=fNoDispose;this._oDialogParent=oDialogParent;this._fKeyDown=fKeyDown;var oTopWindow=new Owa.Dom.Window(wt());if(sHtml){sHtml="<div id=\""+sId+"\" class=\"dlg\">"+sHtml+"</div>";oTopWindow.get_Document().get_Body().insertAdjacentHtml(Owa.ElementInsertionPoint.BeforeEnd,sHtml)}var oD=oTopWindow.get_Document().getElementById(sId);oD._get_DomNode().style.zIndex=g_iDlgZ+g_iDlgZFct;oD._get_DomNode().oDlg=this;Owa.UIControls.Dialog.constructBase(this,[oD]);this._attachEvent(oD,"dragstart",this._onDragStart);this._fOnOtherFrame=!oTopWindow.equals(Owa.Dom.Window.get_Current());this.set_SubPage(Owa.Components.Application.get_RootSubPage())};Owa.UIControls.Dialog.prototype._fRemoveElementInDisposing=true;Owa.UIControls.Dialog.prototype.dispose=function Owa$UIControls$Dialog$dispose(){var oD=this._get_Element();oD._get_DomNode().oDlg=null;Owa.UIControls.Dialog.callBase(this,'dispose');this.fDisposed=1};Owa.UIControls.Dialog.prototype.show=function Owa$UIControls$Dialog$show(iX,iY,fY,fX){var oDialogElement=this._get_Element();var oDocument=oDialogElement.get_OwnerDocument();var oBody=oDocument.get_Body();oDialogElement.set_IsShown(true);if(iX==null){iX=(oBody.get_ClientWidth()-oDialogElement.get_ClientWidth())/2;iY=(oBody.get_ClientHeight()-oDialogElement.get_ClientHeight())/2;if((iX<0)||(iY<0)){var iDX=0;if(iX<0){iDX=(iX*(-2)+50);iX=25}var iDY=0;if(iY<0){iDY=(iY*(-2)+100);iY=50}var oWrappedWindow=oDocument.get_ContainerWindow();oWrappedWindow.resizeBy(iDX,iDY)}}oDialogElement.set_Left(iX);oDialogElement.set_Top(iY);g_iDlgZ+=g_iDlgZFct;this._oMask=new Owa.UIControls.TransparentMask(this.sId+"C",0,oDocument);this._oMask.set_SubPage(this.get_SubPage());this._oMask.setHandler("keydown",this._createCallback(this._onKeyDown,null));this._oMask.setHandler("dragstart",this._createCallback(this._onDragStart,null));this._oMask._get_Element().moveToTop();oDialogElement.moveToTop();if(!this._fKeyDown)this._attachEvent(oDialogElement,"keydown",this._onKeyDown);if(this._fClickAway){var oClickAwayHandler=this._createCallback(this._onClickAway,null);this._oMask.setHandler("click",oClickAwayHandler);this._oMask.setHandler("contextmenu",oClickAwayHandler)}if(fY)oDialogElement.set_Top(getVisiblePositionY(oDialogElement._get_DomNode(),iY)+oBody.get_ClientHeight()-Owa.Dom.Document.get_Current().get_Body().get_ClientHeight());if(fX)oDialogElement.set_Left(oDialogElement.get_Left()-oDialogElement.get_ClientWidth());if(this._fFocus)oDialogElement.focus(1);if(this._fOnOtherFrame&&rgDialogInOtherFrame.indexOf(this)==-1){rgDialogInOtherFrame.push(this)}this._dispatchEvent(ON_SHOW)};Owa.UIControls.Dialog.prototype.hide=function Owa$UIControls$Dialog$hide(fCan,fSilent){if(this._fIsHiding)return;this._fIsHiding=1;if(this._oMask){this._oMask.dispose();this._oMask=null}if(this._oDialogParent)setFcs(this._oDialogParent);this._get_Element().set_IsShown(false);if(!fSilent){this._dispatchEvent(ON_CLOSE);if(fCan)this._dispatchEvent(ON_CANCEL)}g_iDlgZ-=g_iDlgZFct;if(this._fOnOtherFrame){rgDialogInOtherFrame.remove(this)}if(!this._fNoDispose)this.dispose();this._fIsHiding=0};Owa.UIControls.Dialog.prototype.get_OnClose=function Owa$UIControls$Dialog$get_OnClose(){return this._getEventHandlerCollection(ON_CLOSE)};Owa.UIControls.Dialog.prototype.get_OnShow=function Owa$UIControls$Dialog$get_OnShow(){return this._getEventHandlerCollection(ON_SHOW)};Owa.UIControls.Dialog.prototype.get_OnCancel=function Owa$UIControls$Dialog$get_OnCancel(){return this._getEventHandlerCollection(ON_CANCEL)};Owa.UIControls.Dialog.prototype._onClickAway=function Owa$UIControls$Dialog$_onClickAway(e){e.preventDefault();e.cancelBubble();this.hide(1)};Owa.UIControls.Dialog.prototype._onKeyDown=function Owa$UIControls$Dialog$_onKeyDown(e){if(e.get_KeyCodeForKeyUpDown()==27)this.hide(1);e.cancelBubble()};Owa.UIControls.Dialog.prototype._onDragStart=function Owa$UIControls$Dialog$_onDragStart(e){var oDragDrop=new Owa.Components.Storage.DragDrop(e);oDragDrop.deny()};Owa.UIControls.Dialog.createClass("Owa.UIControls.Dialog",Owa.UIControls.UIControl);function closeAllOpenedDialog(){var rgDialog=rgDialogInOtherFrame.slice(0);for(var iIndex=0;iIndex<rgDialog.length;iIndex++){rgDialog[iIndex].hide(null,true)}}Owa.Dom.Window.get_Current().attachEvent("onunload",closeAllOpenedDialog)})();g_fModuleLoaded[".\\uicontrols/dialog.js".toLowerCase()]=1;var BtnDlg;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/buttondialog.js".toLowerCase()])(function(){Owa.BUTTON_DIALOG_ICON={INFORMATION:0,QUESTION:1,WARNING:2,ERROR:3,OOF:7};var ON_BUTTON_DIALOG_CLOSE="onButtonDialogClose";BtnDlg=Owa.UIControls.ButtonDialog=function Owa$UIControls$ButtonDialog(sId,sHtmlContent,sTtl,rgBtns,iW,iIcn,fnOnCls,oDialogParent,fClickAway,fNoDispose,sBtnMsg,sScMsg,oCtx,fAutoExpandWidth){var sHtml="<div class=\"btnDlg\">";if(sTtl!=null){sHtml+="<img id=\"imgX\" src=\""+getThmF("closedlg.gif")+"\" class=\"dlgX\" tabindex=\"0\">"+"<div id=\"divDlgTtl\" class=\"dlgTtl\">"+(sTtl==""?"&nbsp;":htmlEnc(sTtl))+"</div>"}sHtml+="<div class=\"dlgSpacer\"></div>";sHtml+="<div class=\"dlgBdy\" id=\"divBtnDlgBdy\"><div class=\"dlgPrMsg\">";if(iIcn!=null){sHtml+="<img src=\""+getBtnDlgIcn(iIcn)+"\"><div class='msgWithIcon'>"+sHtmlContent+"</div>"}else{sHtml+=sHtmlContent}sHtml+="</div><div class=\"dlgBtns\">";if(sBtnMsg){sHtml+="<div class=\"btnMsg\">"+htmlEnc(sBtnMsg)+"</div>"}for(var i=0;i<rgBtns.length;++i){sHtml+="<button id=\"btn"+i+"\">"+htmlEnc(rgBtns[i])+"</button>"}if(sBtnMsg){sHtml+="<div class=\"btnMsgClr\"></div>"}sHtml+="</div>";if(sScMsg){sHtml+="<div class=\"dlgSecMsg\">"+htmlEnc(sScMsg)+"</div>"}sHtml+="</div></div>";Owa.UIControls.ButtonDialog.constructBase(this,[sId,sHtml,fClickAway,1,oDialogParent,fNoDispose]);this.get_OnCancel().add(this._createCallback(this._onDialogCancel));if(fnOnCls)this.get_OnButtonDialogClose().add(fnOnCls);this.oContext=oCtx;if(fAutoExpandWidth){var iDialogOffsetWidth=this._get_Element().get_OffsetWidth();var iExpandedWidth=iW?Math.max(iW,iDialogOffsetWidth):iDialogOffsetWidth;this._get_Element().set_Width(iExpandedWidth)}else{if(iW)this._get_Element().set_Width(iW);else this._get_Element()._get_DomNode().style.width="30em"}this.iBC=rgBtns.length;for(var i=0;i<rgBtns.length;++i){var oButton=this._getDescendant("btn"+i);oButton.setIntAttribute("iIcnTp",i);this._attachEvent(oButton,"click",this._onClickButton);oButton.onmouseover=new Function("btnOnMsOvrBtn(this)");oButton.onmouseout=new Function("btnOnMsOutBtn(this)")}this._adjustWidthForButtons();var oImgX=this._getDescendant("imgX");if(oImgX)this._attachEvent(oImgX,"click",this._onClickXImg)};Owa.UIControls.ButtonDialog.prototype.dispose=function Owa$UIControls$ButtonDialog$dispose(){for(var i=0;i<this.iBC;++i){var oButton=this._getDescendant("btn"+i);oButton.detachAllEvents()}var oImgX=this._getDescendant("imgX");if(oImgX)oImgX.detachAllEvents();Owa.UIControls.ButtonDialog.callBase(this,'dispose')};Owa.UIControls.ButtonDialog.prototype.getButton=function Owa$UIControls$ButtonDialog$getButton(sTxt){for(var i=0;i<this.iBC;i++){var oButton=this._getDescendant("btn"+i);if((oButton.get_TagName().lc()=="button")&&(oButton.get_TextContent()==sTxt))return oButton}};Owa.UIControls.ButtonDialog.prototype.enableButton=function Owa$UIControls$ButtonDialog$enableButton(sTxt,fEnable){var oButton=this.getButton(sTxt);if(oButton){oButton.set_IsDisabled(!fEnable);if(fEnable){if(!Owa.Utility.isIE())oButton.removeCssClass("dsbl")}else{oButton.removeCssClass("btnHvr");if(!Owa.Utility.isIE())oButton.addCssClass("dsbl")}}};Owa.UIControls.ButtonDialog.prototype.get_OnButtonDialogClose=function Owa$UIControls$ButtonDialog$get_OnButtonDialogClose(){return this._getEventHandlerCollection(ON_BUTTON_DIALOG_CLOSE)};Owa.UIControls.ButtonDialog.prototype._adjustWidthForButtons=function Owa$UIControls$ButtonDialog$_adjustWidthForButtons(){var iW=50;var iAdjustWidth=1;for(var i=0;i<this.iBC;++i){iW=Math.max(iW,this._getDescendant("btn"+i).get_OffsetWidth()+iAdjustWidth)}var width=0;var oButton=0;for(var i=0;i<this.iBC;++i){oButton=this._getDescendant("btn"+i);oButton.set_Width(iW);width+=oButton.getEffectivePadding(Owa.Style.Side.Left)+oButton.getEffectiveMargin(Owa.Style.Side.Left)+oButton.getEffectivePadding(Owa.Style.Side.Right)+oButton.getEffectiveMargin(Owa.Style.Side.Left)+iW}if(oButton){oButton.focus(1)}if(this._get_Element().get_OffsetWidth()<width){this._get_Element().set_Width(width)}};Owa.UIControls.ButtonDialog.prototype._onDialogCancel=function Owa$UIControls$ButtonDialog$_onDialogCancel(){this._dispatchEvent(ON_BUTTON_DIALOG_CLOSE,-1,this.oContext)};Owa.UIControls.ButtonDialog.prototype._onClickButton=function Owa$UIControls$ButtonDialog$_onClickButton(e){var oButton=e.get_Target();if(oButton.get_IsDisabled())return;var iIndex=oButton.getIntAttribute("iIcnTp");this.triggerButtonClickEvent(iIndex)};Owa.UIControls.ButtonDialog.prototype._onClickXImg=function Owa$UIControls$ButtonDialog$_onClickXImg(e){this.triggerButtonClickEvent(-1)};Owa.UIControls.ButtonDialog.prototype.triggerButtonClickEvent=function Owa$UIControls$ButtonDialog$triggerButtonClickEvent(iButtonIndex){var fPreventHide=this._dispatchEvent(ON_BUTTON_DIALOG_CLOSE,iButtonIndex,this.oContext);if(!fPreventHide)this.hide()};function getBtnDlgIcn(i){switch(i){case Owa.BUTTON_DIALOG_ICON.INFORMATION:return getThmF("bdi_inf.gif");case Owa.BUTTON_DIALOG_ICON.QUESTION:return getThmF("bdi_qst.gif");case Owa.BUTTON_DIALOG_ICON.WARNING:return getThmF("bdi_wrn.gif");case Owa.BUTTON_DIALOG_ICON.OOF:return getThmF("oof.gif");case Owa.BUTTON_DIALOG_ICON.ERROR:return getThmF("warn.png")}}Owa.UIControls.ButtonDialog.createClass("Owa.UIControls.ButtonDialog",Owa.UIControls.Dialog)})();g_fModuleLoaded[".\\uicontrols/buttondialog.js".toLowerCase()]=1;function alrt(sMsg,oDlgPar,iIcn,sTtl){OKDlg(sMsg,oDlgPar,null,iIcn,sTtl).show()}function OKDlg(sMsg,oDialogParent,fnOnCls,iIcn,sTtl){return OKDlgHtml(htmlEnc(sMsg),oDialogParent,fnOnCls,iIcn,sTtl)}function OKDlgHtml(sHtml,oDialogParent,fnOnCls,iIcn,sTtl){var oDlg=new BtnDlg("okDlg"+rndm(),sHtml,(sTtl?sTtl:""),[L_OK],null,iIcn,fnOnCls,oDialogParent);return oDlg}function showConfirmDialog(sMessage,fnOnConfirm,oContext){var oDialog=new BtnDlg("okDlg"+rndm(),htmlEnc(sMessage),"",[L_OK,L_Cncl],null,Owa.BUTTON_DIALOG_ICON.QUESTION,null,null,null,null,null,null,oContext);oDialog.get_OnButtonDialogClose().add(function(iButtonIndex){if(iButtonIndex==0){fnOnConfirm(oContext)}});oDialog.show()}if(!Owa.IM){Owa.IM={}}var imns=Owa.IM;var g_IMMgr=0;var g_fIsIMEnab=0;var g_fSignedIn=0;var g_fSigningIn=(isDf(typeof(a_fSignedOutOfIM))&&!a_fSignedOutOfIM)?1:0;var g_iIM_SI=0;var IM_TYPE_NONE=0;var IM_TYPE_OCS=1;var IM_TYPE_MSN=2;var IM_PRTM1=5000;var IM_PRTM2=0;var IM_PRTM_FRM=1;var IM_SNCM="SndNwChtMsg";var IM_SCM="SndChtMsg";var IM_SC="SubChng";var IM_QP="QryPrsnc";var IM_AB="AddBdy";var IM_RFBL="RemFrmBdyLst";var IM_ACPT="AcceptInvt";var IM_DCL="DeclineInvt";var IM_BLK="BlockBuddy";var IM_UNBLK="UnblockBuddy";var IM_RFG="RemFrmGrp";var IM_MB="MvBdy";var IM_CB="CpBdy";var IM_CRG="CrGrp";var IM_RMG="RemGrp";var IM_RNG="RenGrp";var IM_GBL="GtBdyLst";var IM_ISO="InvSmOne";var IM_NTP="NtfyTpng";var IM_NTPC="NtfyTpngCncl";var IM_EDL="ExpndDL";var IM_SI="SgnIn";var IM_SO="SgnOut";var IM_CPR="ChngPrsnc";var IM_ADIMM="AccptDeclIMMsg";var IM_ATCS="AddToChtSsn";var IM_RFCS="RemFrmChtSsn";var IM_ECS="EndChtSsn";var IM_ITMINFO="GetItemIMInfo";var IM_PSTEXP="PersistExpand";var IM_PXY="GetProxies";var IM_PIC="ParticipateInConversation";var IM_PR_AV=0;var IM_PR_MBAV=1;var IM_PR_BSY=2;var IM_PR_MBBSY=3;var IM_PR_DND=4;var IM_PR_BRB=5;var IM_PR_AWAY=6;var IM_PR_OFFL=7;var IM_PR_ONLN=8;var IM_PR_APPROFFL=9;var IM_PR_IDLE=10;var IM_PR_INCLL=11;var IM_PR_OUTLNCH=12;var IM_PR_BLKD=13;var IM_PR_UNKNWN=14;var g_rgsPrsncNm=["available","maybeavailable","busy","maybebusy","donotdisturb","berightback","away","offline","online","appearoffline","idle","inacall","outtolunch","blocked","unknown"];if(isDf(typeof(L_Avlbl)))var g_rgsPrsncLocNm=[L_Avlbl,L_MbAvlbl,L_Bsy,L_MbBsy,L_DND,L_BRB,L_Awy,L_Offl,L_Onln,L_ApprOffl,L_Idle,L_InCll,L_OutL,L_Blkd,L_Unknwn];var g_rgsJBF=[["avlbl.png","maybe-av.png","busy.png","maybe-busy.png","dnd.png","away.png","away.png","offline.png","avlbl.png","offline.png","maybe-av.png","busy.png","away.png","blocked.png","unkwn.png"],["big-avlbl.png","big-maybe-av.png","big-busy.png","big-maybe-busy.png","big-dnd.png","big-away.png","big-away.png","big-offline.png","big-avlbl.png","big-offline.png","big-maybe-av.png","big-busy.png","big-away.png","big-blocked.png","big-unkwn.png"],["exbig-avlbl.png","exbig-maybe-av.png","exbig-busy.png","exbig-maybe-busy.png","exbig-dnd.png","exbig-away.png","exbig-away.png","exbig-offline.png","exbig-avlbl.png","exbig-offline.png","exbig-maybe-av.png","exbig-busy.png","exbig-away.png","exbig-blocked.png","exbig-unkwn.png"]];var JBSIZE_NRM=0;var JBSIZE_BIG=1;var JBSIZE_EXBIG=2;var OCS_Nn=0;var OCS_Onln=3000;var OCS_IdlOnln=4500;var OCS_Bsy=6000;var OCS_IdlBsy=7500;var OCS_DND=9000;var OCS_BRB=12000;var OCS_Awy=15000;var OCS_Offln=18000;var MSN_Offln=0;var MSN_Onln=1;var MSN_ApprOffln=2;var MSN_Bsy=3;var MSN_Idl=4;var MSN_BRB=5;var MSN_Awy=6;var MSN_InCll=7;var MSN_OtTLnch=8;function gtIMType(){var oMaster=gtMstr();if(oMaster){var iIMType=oMaster.a_iIMType;if(isDf(typeof(iIMType))){return iIMType}}return IM_TYPE_NONE}function isMSNPrv(){if(gtIMType()==IM_TYPE_MSN)return 1;return 0}function isOCSPrv(){if(gtIMType()==IM_TYPE_OCS)return 1;return 0}function gtDfltPrsnc(){if(isMSNPrv())return IM_PR_OFFL;return IM_PR_UNKNWN}function stIMEnabFlg(){var oMasterWindow=gtMstr();if(!oMasterWindow||(oMasterWindow&&isDf(typeof(oMasterWindow.a_fIsExpLgn))&&oMasterWindow.a_fIsExpLgn)){g_fIsIMEnab=0;return}if(isDf(typeof(oMasterWindow.a_fIsImEnab)))g_fIsIMEnab=oMasterWindow.a_fIsImEnab}function initIM(fNPR){stIMEnabFlg();if(g_fIsIMEnab){g_IMMgr=gtMstrIMMgr();if(!isDf(typeof(fNPR)))window.setTimeout(function(){updFrmPrsnc()},IM_PRTM_FRM)}}function dispIM(){g_IMMgr=0}function isSlfUri(sUri){if(!isDf(typeof(sUri))&&!sUri)return 0;sUri=gtIMMgr().pxyLst.GetBuddyPrimaryUri(sUri);var a_sUri="";var win=gtMstr();try{a_sUri=win.a_sUri}catch(e){}return(isSameUri(a_sUri,sUri)?1:0)}function isSameUri(a,b){a=(typeof a=="string")?Owa.IM.IMUtils.CleanUri(a):a;b=(typeof b=="string")?Owa.IM.IMUtils.CleanUri(b):b;return(a==b)}function gtSlfPrsnc(fL){var win=gtMstr();var iPrsnc=gtDfltPrsnc();try{if(isDf(typeof(fL))&&fL)iPrsnc=win.a_iIMLstPrsnc;else iPrsnc=win.a_iIMPrsnc}catch(e){}return iPrsnc}function stSlfPrsnc(iPrsnc,fL){if(!isDf(typeof(iPrsnc)))return;var win=gtMstr();try{if(isDf(typeof(iPrsnc))){if(isDf(typeof(fL))&&fL)win.a_iIMLstPrsnc=iPrsnc;else win.a_iIMLstPrsnc=win.a_iIMPrsnc;win.a_iIMPrsnc=iPrsnc}var oImg=$("imgUserTileJB");if(oImg)Owa.Components.CssSprites.updateImage(oImg,gtIMFFrmId(win.a_iIMPrsnc,JBSIZE_EXBIG));var rgoPrsnc=[];var oPrsnc={};oPrsnc.prsnc=iPrsnc;oPrsnc.fNm=gtIMFFrmId(iPrsnc);oPrsnc.sUri=a_sUri;rgoPrsnc.push(oPrsnc);pushPrsnc(rgoPrsnc)}catch(e){}}function gtDN(){var win=gtMstr();if(win){if(isDf(typeof(win.a_sDN))&&win.a_sDN)return win.a_sDN;else if(isDf(typeof(win.a_sUri))&&win.a_sUri)return imns.IMUtils.NrmSipUri(win.a_sUri);else return""}}function gtIMFFrmId(iPrsnc,nSize){if(iPrsnc>IM_PR_UNKNWN)return null;if(nSize!=JBSIZE_BIG&&nSize!=JBSIZE_EXBIG)nSize=JBSIZE_NRM;return g_rgsJBF[nSize][iPrsnc]}function gtPrsncIdFrmVal(sVal){var imType=gtIMType();if(imType==IM_TYPE_OCS){switch(sVal){case OCS_Nn:return IM_PR_UNKNWN;case OCS_Onln:return IM_PR_AV;case OCS_IdlOnln:return IM_PR_MBAV;case OCS_Bsy:return IM_PR_BSY;case OCS_IdlBsy:return IM_PR_MBBSY;case OCS_DND:return IM_PR_DND;case OCS_BRB:return IM_PR_BRB;case OCS_Awy:return IM_PR_AWAY;case OCS_Offln:return IM_PR_OFFL}}else if(imType==IM_TYPE_MSN){switch(sVal){case MSN_Offln:return IM_PR_OFFL;case MSN_Onln:return IM_PR_ONLN;case MSN_ApprOffln:return IM_PR_APPROFFL;case MSN_Bsy:return IM_PR_BSY;case MSN_Idl:return IM_PR_IDLE;case MSN_BRB:return IM_PR_BRB;case MSN_Awy:return IM_PR_AWAY;case MSN_InCll:return IM_PR_INCLL;case MSN_OtTLnch:return IM_PR_OUTLNCH}}return gtDfltPrsnc()}function gtPrsncValFrmNm(sNm){var imType=gtIMType();for(var i=0;i<g_rgsPrsncNm.length;i++)if(sNm==g_rgsPrsncNm[i]){if(imType==IM_TYPE_OCS){switch(i){case IM_PR_UNKNWN:return OCS_Nn;case IM_PR_AV:return OCS_Onln;case IM_PR_MBAV:return OCS_IdlOnln;case IM_PR_BSY:return OCS_Bsy;case IM_PR_MBBSY:return OCS_IdlBsy;case IM_PR_DND:return OCS_DND;case IM_PR_BRB:return OCS_BRB;case IM_PR_AWAY:return OCS_Awy;case IM_PR_OFFL:return OCS_Offln}return OCS_Nn}else if(imType==IM_TYPE_MSN){switch(i){case IM_PR_OFFL:return MSN_Offln;case IM_PR_ONLN:return MSN_Onln;case IM_PR_APPROFFL:return MSN_ApprOffln;case IM_PR_BSY:return MSN_Bsy;case IM_PR_IDLE:return MSN_Idl;case IM_PR_BRB:return MSN_BRB;case IM_PR_AWAY:return MSN_Awy;case IM_PR_INCLL:return MSN_InCll;case IM_PR_OUTLNCH:return MSN_OtTLnch}return MSN_Offln}}if(imType==IM_TYPE_MSN)return MSN_Offln;else return OCS_Nn}function pushPrsnc(rgiPrsnc){if(!isDf(typeof(a_isMstr)))pushFrmPrsnc(rgiPrsnc);else{pushPrsncRP(rgiPrsnc);g_winMgr.PushPrsnc(rgiPrsnc)}}function pushPrsncRP(rgiPrsnc){var oWin=0;if(isDf(typeof(a_sLstFID))&&a_sLstFID){var oRp;try{oRp=getViewSubPageControllerByFolderId(a_sLstFID).getElementById("ifRP")}catch(e){}if(oRp&&isDisp(oRp)){oRp=oRp._get_DomNode();oWin=oRp.contentWindow;if(oWin&&oWin.pushFrmPrsnc)oWin.pushFrmPrsnc(rgiPrsnc)}}}function updFrmPrsnc(){if(g_fIsIMEnab&&gtMstr()&&(gtMstr().g_fSignedIn||gtMstr().g_fSigningIn)){if(!g_utRecipientWellPresence){g_utRecipientWellPresence=new Owa.IM.UriTable()}updSndrPrsnc();updAllRwPrsnc();if(isOCSPrv()){if(!isDf(typeof(a_fChtWin))){window.setTimeout(qryPrsnc,IM_PRTM1)}else{window.setTimeout(subPrsnc,IM_PRTM2)}}}}function pushFrmPrsnc(rgiPrsnc){if(isDf(typeof(rgiPrsnc))&&rgiPrsnc&&rgiPrsnc.length){var i,j,oPrsnc,sUri;for(i=0;i<rgiPrsnc.length;i++){oPrsnc=rgiPrsnc[i];sUri=oPrsnc.sUri;var rgProxies=[];var rgBuddyProxies=gtIMMgr().pxyLst.GetProxies(sUri);if(rgBuddyProxies&&rgBuddyProxies.length){rgProxies=rgBuddyProxies}else{rgProxies.push(sUri)}for(var j=0;j<rgProxies.length;j++){var sProxy=rgProxies[j];pushFrmPrsncForUri(sProxy,oPrsnc)}}}}function pushFrmPrsncForUri(sUri,oPrsnc){var j,rgArr,oSpn;if(!g_utRecipientWellPresence){return}rgArr=g_utRecipientWellPresence.Get(sUri);if(rgArr){for(j=0;j<rgArr.length;j++){setJBPrsnc(rgArr[j].jb,oPrsnc.prsnc,rgArr[j].fBig);if(isDf(typeof(a_fChtWin))){oSpn=rgArr[j].spn;if(isSameUri(oSpn.getAttribute("_uri"),sUri)&&isDf(typeof(oPrsnc.sDN))){oSpn._oDomNode.childNodes[1].nodeValue=oPrsnc.sDN;rszRw($(TO));gtIMMgr().UpdChtTtl(g_oChtWin.sChtId,0,sUri,oPrsnc.sDN)}}}}}function qryPrsnc(){if(g_fIsIMEnab&&gtMstr()&&(gtMstr().g_fSignedIn||gtMstr().g_fSigningIn)){var rgoRcp=[];for(var sUri in g_utQueryPresence.Keys()){rgoRcp.push(sUri)}try{gtIMMgr().QryPrsnc(rgoRcp)}catch(e){}}}function subPrsnc(){var rgoRcp=[];for(var sUri in g_utQueryPresence.Keys()){rgoRcp.push(sUri)}try{gtIMMgr().SubPrsnc(rgoRcp)}catch(e){}}function gtPrsncFrmMstr(sUri,fBig){var oRt={};if(sUri&&gtIMMgr()){try{oRt.prsnc=gtIMMgr().gtPrsnc(sUri);var sDN=gtIMMgr().gtDN(sUri);if(sDN){oRt.sDN=sDN}}catch(e){oRt.prsnc=gtDfltPrsnc()}}else{oRt.prsnc=gtDfltPrsnc()}oRt.fNm=gtIMFFrmId(oRt.prsnc,fBig?JBSIZE_BIG:JBSIZE_NRM);return oRt}function isBuddy(sUri){if(!isDf(typeof(sUri))||!sUri)return 0;if(gtIMMgr())try{return gtIMMgr().IsBdy(sUri)}catch(e){return 0}else return 0}function gtStlUri(sUri){if(!isDf(typeof(sUri))||!sUri)return;if(gtIMMgr())try{return gtIMMgr().GtStlUri(sUri)}catch(e){return 0}else return}function addBdyLstReq(oCallerSubPage,oRcp,sMsg,fnCallback){if(!isDf(typeof(oRcp))||!oRcp)return;var sDN=gtRcpDn(oRcp);var sUri=gtRcpIM(oRcp);var fSndPreAcnt=0;if((oRcp._ao==AO_D)&&(oRcp._sipTrsp))fSndPreAcnt=1;if((!sUri)&&(!oRcp._sipTrsp)){noIMInfoErr();return}if(isSlfUri(sUri)&&(!oRcp._sipTrsp)){slfBddyErr();return}if((isBuddy(sUri))&&(!oRcp._sipTrsp))return;var oRCtx={};if(fSndPreAcnt)oRCtx.sLDn=oRcp._em;oRCtx.sDN=sDN;oRCtx.bdyAddr=sUri;oRCtx.sEml=(isDf(typeof(oRcp._em))&&oRcp._em)?oRcp._em:0;oRCtx.msg=(isDf(typeof(sMsg))&&sMsg)?sMsg:"";var oBuddyList=gtIMMgr().bdyLst;var oGroup=oBuddyList.GetGroup(oBuddyList.sOtherContactsID);if(oGroup){oRCtx.sGroupID=imns.IMUtils.NrmGrpID(oGroup.groupID);oRCtx.sGroupName=oGroup.groupName}oRCtx.feOnErr=onErrAdBlst;oRCtx.prm1=sDN;oRCtx.fnCallback=fnCallback;oRCtx.oCallerSubPage=oCallerSubPage;sndIMReq(IM_AB,cbAddBdyReq,0,oRCtx)}function cbAddBdyReq(oRCtx,sNwUri){var oCallerSubPage=oRCtx.oCallerSubPage;if(isMSNPrv()){Owa.Components.ToolbarCollection.get(oCallerSubPage).set_IsButtonDisabled(BID_ABLST,true)}else if(isDf(typeof(a_fOrgP))||(isDf(typeof(oCallerSubPage.getSubPageVariable("a_fDir")))&&oCallerSubPage.getSubPageVariable("a_fDir"))){Owa.Components.ToolbarCollection.get(oCallerSubPage).set_IsButtonShown(BID_RMBLST,true);Owa.Components.ToolbarCollection.get(oCallerSubPage).set_IsButtonShown(BID_ABLST,false);Owa.Components.ToolbarCollection.get(oCallerSubPage).set_IsButtonDisabled(BID_RMBLST,false)}if(sNwUri){if(gtIMMgr())try{gtIMMgr().StStlUri(sNwUri,oRCtx.bdyAddr)}catch(e){}}if(oRCtx.fnCallback){oRCtx.fnCallback()}}function rmBdyLstReq(oCallerSubPage,oRcp){if(!isDf(typeof(oRcp))||!oRcp)return;var sNm=gtRcpDn(oRcp);var sUri=gtRcpIM(oRcp);sUri=gtIMMgr().pxyLst.GetBuddyPrimaryUri(sUri);var fSndPreAcnt=0;if((oRcp._ao==AO_D)&&(oRcp._sipTrsp))fSndPreAcnt=1;var oBuddyList=gtIMMgr().bdyLst;var sGid;if(!fSndPreAcnt){sGid=oBuddyList.GtBdy(sUri).sGid}if((!sUri)&&(!oRcp._sipTrsp)){noIMInfoErr();return}if((!isBuddy(sUri))&&(!oRcp._sipTrsp))return;var oRCtx={};if(fSndPreAcnt)oRCtx.sLDn=oRcp._em;oRCtx.sUri=sUri;oRCtx.sGid=sGid;oRCtx.iType=oBuddyList.GetBuddyType(sUri);oRCtx.feOnErr=onErrRmBlst;oRCtx.prm1=sNm;oRCtx.oCallerSubPage=oCallerSubPage;sndIMReq(IM_RFBL,cbRmBdyReq,0,oRCtx)}function cbRmBdyReq(oRCtx,sNwUri){var oCallerSubPage=oRCtx.oCallerSubPage;if(isMSNPrv()){Owa.Components.ToolbarCollection.get(oCallerSubPage).set_IsButtonDisabled(BID_RMBLST,true);Owa.Components.ToolbarCollection.get(oCallerSubPage).set_IsButtonDisabled(BID_CHT,true)}else if(isDf(typeof(a_fOrgP))||(isDf(typeof(a_fDir))&&a_fDir)){Owa.Components.ToolbarCollection.get(oCallerSubPage).set_IsButtonShown(BID_RMBLST,false);Owa.Components.ToolbarCollection.get(oCallerSubPage).set_IsButtonShown(BID_ABLST,true);Owa.Components.ToolbarCollection.get(oCallerSubPage).set_IsButtonDisabled(BID_ABLST,false)}if(sNwUri){if(gtIMMgr())try{gtIMMgr().StStlUri(sNwUri,oRCtx.sUri)}catch(e){}}}function rmFrmGrpReq(oCallerSubPage,oRcp){if(!isDf(typeof(oRcp))||!oRcp)return;var sNm=gtRcpDn(oRcp);var sUri=gtRcpIM(oRcp);var fSndPreAcnt=0;var sGroupName,sGroupID=0;if((oRcp._ao==AO_D)&&(oRcp._sipTrsp))fSndPreAcnt=1;var oBuddyList=gtIMMgr().bdyLst;var oBuddy=oBuddyList.GtBdy(sUri);var sGid;if(!fSndPreAcnt){sGid=oBuddy.sGid}if((!sUri)&&(!oRcp._sipTrsp)){noIMInfoErr();return}if((!isBuddy(sUri))&&(!oRcp._sipTrsp))return;var sGroupId=oRcp.getAttribute("_gID");if(sGroupId){sGroupName=oBuddyList.GetGroup(sGroupId).groupName;sGroupID=imns.IMUtils.NrmGrpID(sGroupId)}var oRCtx={};if(fSndPreAcnt)oRCtx.sLDn=oRcp._em;oRCtx.sUri=sUri;oRCtx.sGid=sGid;oRCtx.iType=oBuddyList.GetBuddyType(sUri);if(sGroupID){oRCtx.sGroupID=sGroupID;oRCtx.sGroupName=sGroupName}oRCtx.feOnErr=onErrRmBlst;oRCtx.prm1=sNm;if(isOCSPrv()){oRCtx.sBuddyName=oBuddy.dn;oRCtx.fTagged=oBuddy.fTag;var rgGrpIds=oBuddy.GetBuddyGroups();for(var i=0;i<rgGrpIds.length;i++){rgGrpIds[i]=parseInt(imns.IMUtils.NrmGrpID(rgGrpIds[i].groupID))}oRCtx.rgGrpIds=rgGrpIds}oRCtx.oCallerSubPage=oCallerSubPage;if(sGroupID==imns.IMUtils.NrmGrpID(oBuddyList.sOtherContactsID)){sndIMReq(IM_RFBL,cbRmBdyReq,0,oRCtx)}else{sndIMReq(IM_RFG,null,0,oRCtx)}}function copyToGroupRequest(sUri,sGroupId){var oBuddyList=gtIMMgr().bdyLst;var oBuddy=oBuddyList.GtBdy(sUri);if(!oBuddy){return}var oGroup=oBuddyList.GetGroup(sGroupId);if(!oGroup){return}var oRCtx={};oRCtx.sUri=oBuddy.uri;oRCtx.sGid=oBuddy.sGid;oRCtx.sGroupId=imns.IMUtils.NrmGrpID(oGroup.groupID);oRCtx.sGroupName=oGroup.groupName;oRCtx.feOnErr=onErrRmBlst;oRCtx.prm1=oBuddy.dn;if(isOCSPrv()){oRCtx.sBuddyName=oBuddy.dn;oRCtx.fTagged=oBuddy.fTag;var rgGrpIds=oBuddy.GetBuddyGroups();for(var i=0;i<rgGrpIds.length;i++){rgGrpIds[i]=parseInt(imns.IMUtils.NrmGrpID(rgGrpIds[i].groupID))}oRCtx.rgGrpIds=rgGrpIds}sndIMReq(IM_CB,null,0,oRCtx)}function moveToGroupRequest(sUri,sOldGroupId,sNewGroupId){var oBuddyList=gtIMMgr().bdyLst;var oBuddy=oBuddyList.GtBdy(sUri);if(!oBuddy){return}var oOldGroup=oBuddyList.GetGroup(sOldGroupId);var oNewGroup=oBuddyList.GetGroup(sNewGroupId);if(!oOldGroup||!oNewGroup){return}var oRCtx={};oRCtx.sUri=oBuddy.uri;oRCtx.sGid=oBuddy.sGid;oRCtx.sOldGroupId=imns.IMUtils.NrmGrpID(oOldGroup.groupID);oRCtx.sOldGroupName=oOldGroup.groupName;oRCtx.sNewGroupId=imns.IMUtils.NrmGrpID(oNewGroup.groupID);oRCtx.sNewGroupName=oNewGroup.groupName;oRCtx.feOnErr=onErrRmBlst;oRCtx.prm1=oBuddy.dn;if(isOCSPrv()){oRCtx.sBuddyName=oBuddy.dn;oRCtx.fTagged=oBuddy.fTag;var rgGrpIds=oBuddy.GetBuddyGroups();for(var i=0;i<rgGrpIds.length;i++){rgGrpIds[i]=parseInt(imns.IMUtils.NrmGrpID(rgGrpIds[i].groupID))}oRCtx.rgGrpIds=rgGrpIds}sndIMReq(IM_MB,null,0,oRCtx)}function removeGroupRequest(sGroupId){var oIMManager=gtIMMgr();if(!oIMManager){return}var oGroup=oIMManager.bdyLst.GetGroup(sGroupId);if(!oGroup){return}var oRCtx={};oRCtx.sGroupID=imns.IMUtils.NrmGrpID(oGroup.groupID);oRCtx.sGroupName=oGroup.groupName;sndIMReq(IM_RMG,null,0,oRCtx)}function renameGroupRequest(oGroup,sNewGroupName){var oRCtx={};oRCtx.sGroupID=imns.IMUtils.NrmGrpID(oGroup.groupID);oRCtx.sOldGroupName=oGroup.groupName;oRCtx.sNewGroupName=sNewGroupName;oRCtx.feOnErr=onErrGroupNameChange;oRCtx.feOnST=onErrGroupNameChange;sndIMReq(IM_RNG,null,0,oRCtx)}function createGroupRequest(sGroupName){var oRCtx={};oRCtx.sGroupName=sGroupName;oRCtx.feOnErr=onErrGroupNameChange;oRCtx.feOnST=onErrGroupNameChange;sndIMReq(IM_CRG,null,0,oRCtx)}function cbBuddyInviteRequest(oRCtx){Owa.UIControls.BuddyDialog.getDialog().removeBuddy(oRCtx.sUri)}function blkBdyReq(oRcp,fUnblk){if(!isDf(typeof(oRcp))||!oRcp)return;var sUri=gtRcpIM(oRcp);blockBuddyRequest(sUri,fUnblk)}function blockBuddyRequest(sUri,fUnblk){if(!sUri){noIMInfoErr();return}sUri=gtIMMgr().pxyLst.GetBuddyPrimaryUri(sUri);var oRCtx={};oRCtx.sUri=sUri;oRCtx.iType=gtIMMgr().bdyLst.GetBuddyType(sUri);if(isDf(typeof(fUnblk))&&fUnblk){sndIMReq(IM_UNBLK,null,0,oRCtx)}else{sndIMReq(IM_BLK,null,0,oRCtx)}}function gtRcpDn(oRcp){var oRecip=Owa.Dom.Node.wrapDomNode(oRcp);if(isDf(typeof(oRcp._dn))&&oRcp._dn&&oRcp._dn!="0")return oRcp._dn;else if(oRcp.getAttribute&&oRcp.getAttribute("_dn")&&oRcp.getAttribute("_dn")!="0")return oRcp.getAttribute("_dn");else if(isDf(typeof(oRcp.dn))&&oRcp.dn)return oRcp.dn;else if(oRecip.get_TextContent()&&oRecip.get_TextContent()!="0")return oRecip.get_TextContent();else if(isDf(typeof(oRcp._em))&&oRcp._em)return oRcp._em;else if(oRcp.getAttribute&&oRcp.getAttribute("_em"))return oRcp.getAttribute("_em");else if(isDf(typeof(oRcp.eml))&&oRcp.eml)return oRcp.eml;else if(isDf(typeof(oRcp._uri))&&oRcp._uri)return imns.IMUtils.NrmSipUri(oRcp._uri);else if(oRcp.getAttribute&&oRcp.getAttribute("_uri"))return imns.IMUtils.NrmSipUri(oRcp.getAttribute("_uri"));else if(isDf(typeof(oRcp.uri))&&oRcp.uri)return oRcp.uri;else return""}function enbIMBtns(oCallerSubPage,fIM,fBdy,fPsh){var fIMEnabled=fIM&&(gtMstr()&&gtMstr().g_fSignedIn)&&(!isJnkFld(oCallerSubPage))&&(!fPsh);var fChatEnabled=fIMEnabled&&(isOCSPrv()||(fBdy&&isMSNPrv()));if(fPsh)enblIMBtnsRP(fChatEnabled);with(Owa.Components.ToolbarCollection.get(oCallerSubPage)){set_IsButtonDisabled(BID_CHT,!fChatEnabled);set_IsButtonDisabled(BID_REC,!fChatEnabled);set_IsButtonShown(BID_ABLST,!fBdy);set_IsButtonDisabled(BID_ABLST,!fIMEnabled);set_IsButtonShown(BID_RMBLST,fBdy);set_IsButtonDisabled(BID_RMBLST,!fIMEnabled)}}function enblIMBtnsRP(fIM){if(isDf(typeof(a_sLstFID))&&a_sLstFID){var oSubPageController=getViewSubPageControllerByFolderId(a_sLstFID);if(oSubPageController)oSubPageController.invokeFunction("enblIMBtnsFrm",[fIM])}}function enblIMBtnsFrm(fIM){var oCallerSubPage=Owa.Components.Application.get_RootSubPage();Owa.Components.ToolbarCollection.get(oCallerSubPage).set_IsButtonDisabled(BID_CHT,!fIM);Owa.Components.ToolbarCollection.get(oCallerSubPage).set_IsButtonDisabled(BID_REC,!fIM)}function onErrAdBlst(oRCtx){if(oRCtx.iErr==28)noIMInfoErr();else if(oRCtx.iErr==29)slfBddyErr();else alrt(L_ErrAblst.replace(/\{0\}/,htmlEnc(oRCtx.prm1)),null,Owa.BUTTON_DIALOG_ICON.WARNING,L_ErrAblstTtl)}function onErrGroupNameChange(oRCtx,fTimeout){if(g_oBddyLst){if(!fTimeout&&oRCtx&&oRCtx.sErr)g_oBddyLst.shwErr(oRCtx.sErr,true);if(g_oBddyLst._edting){if(!fTimeout)g_oBddyLst.reEdtNd();else g_oBddyLst.qtEdtNd()}}}function onErrRmBlst(oRCtx){if(oRCtx.iErr==28)noIMInfoErr();else if(oRCtx.iErr==29)slfBddyErr();else alrt(L_ErrRmblst.replace(/\{0\}/,htmlEnc(oRCtx.prm1)),null,Owa.BUTTON_DIALOG_ICON.WARNING,L_ErrRmblstTtl);if(gtIMMgr())try{gtIMMgr().StStlUri(oRCtx.bdyAddr)}catch(e){}}function noIMInfoErr(){alrt(L_ErrNoIMInfo,null,Owa.BUTTON_DIALOG_ICON.WARNING)}function slfChtErr(){alrt(L_ErrSlfCht,null,Owa.BUTTON_DIALOG_ICON.WARNING,L_Wrng)}function slfBddyErr(){alrt(L_ErSlfBdy,null,Owa.BUTTON_DIALOG_ICON.WARNING)}function failStrtCht(){alrt(L_ErrStrtCht,null,Owa.BUTTON_DIALOG_ICON.WARNING)}function failChtMsgDlv(oRCtx){if(oRCtx.iErr==28)noIMInfoErr();else if(oRCtx.iErr==29)slfChtErr();else if(oRCtx.oChtWin)oRCtx.oChtWin.InActMsg(imns.ACT_FAILMSGDLV)}function nwChtFrmRcp(oRcp){try{gtIMMgr().NwChtSsnRcp(oRcp)}catch(e){}}function nwChtSsnFrm(){var oFrom=$("spnFrom");var oRecip=crtRecipObjectFromDomObject(oFrom);if(gtIMMgr()){var sFolderId=Owa.Utility.isDefined(typeof a_sFId)?a_sFId:null;var sMessageId=Owa.Utility.isDefined(typeof a_sId)?a_sId:null;var oSubject=$("divSubj");var sSubject="";if(oSubject){sSubject=oSubject.get_TextContent()}gtIMMgr().NwChtSsnMw(sSubject,oRecip,sFolderId,sMessageId)}}Owa.IM.UriTable=function Owa$IM$UriTable(){this.table={};this.count=0};Owa.IM.UriTable.prototype.Keys=function Owa$IM$UriTable$Keys(){return this.table};Owa.IM.UriTable.prototype.Get=function Owa$IM$UriTable$Get(sUri){if(!sUri||typeof sUri!="string"){return 0}var oValue=this.table[sUri];if(typeof(oValue)!="undefined"){return oValue}oValue=this.table[Owa.IM.IMUtils.CleanUri(sUri)];if(typeof(oValue)=="undefined"){return 0}return oValue};Owa.IM.UriTable.prototype.Set=function Owa$IM$UriTable$Set(sUri,oValue){if(!sUri||typeof sUri!="string"){return 0}var sCleanUri=Owa.IM.IMUtils.CleanUri(sUri);var iAdd=0;if(!this.Get(sCleanUri)){iAdd=1}this.table[sCleanUri]=oValue;if(oValue!==null){this.count+=iAdd;return iAdd}return 0};Owa.IM.UriTable.prototype.Remove=function Owa$IM$UriTable$Remove(sUri,fDelete,fRemove){if(!sUri||typeof sUri!="string"){return 0}var sCleanUri=Owa.IM.IMUtils.CleanUri(sUri);if(typeof this.table[sCleanUri]=="undefined"){return 0}if(fDelete){delete this.table[sCleanUri]}this.table[sCleanUri]=fRemove?null:0;this.count--;return 1};Owa.IM.UriTable.prototype.Count=function Owa$IM$UriTable$Count(){return this.count};Owa.IM.IMUtils=function Owa$IM$IMUtils(){};Owa.IM.IMUtils.CleanUri=function Owa$IM$IMUtils$CleanUri(sUri){if(typeof sUri!="string"){return""}return isOCSPrv()?Owa.IM.IMUtils.FrmSipUri(sUri.toLowerCase()):Owa.IM.IMUtils.NrmSipUri(sUri.toLowerCase())};Owa.IM.IMUtils.NrmSipUri=function Owa$IM$IMUtils$NrmSipUri(sUri){return Owa.IM.IMUtils.NormalizeString("sip",sUri)};Owa.IM.IMUtils.NrmGrpID=function Owa$IM$IMUtils$NrmGrpID(sGroupID){return Owa.IM.IMUtils.NormalizeString("grp",sGroupID)};Owa.IM.IMUtils.NormalizeString=function Owa$IM$IMUtils$NormalizeString(sPrefix,sString){if(sString==null||sString=="")return"";if(sPrefix==null||sPrefix=="")return sString;sPrefix=sPrefix+":";if(typeof(sString)!='string'){sString+=""}var sString=sString.trim();if(sString.lc().indexOf(sPrefix)==0)return sString.substring(sPrefix.length,sString.length);else return sString};Owa.IM.IMUtils.FrmSipUri=function Owa$IM$IMUtils$FrmSipUri(sUri){return Owa.IM.IMUtils.FormalizeString("sip",sUri)};Owa.IM.IMUtils.FormalizeString=function Owa$IM$IMUtils$FormalizeString(sPrefix,sString){if(sPrefix==null||sPrefix=="")return sString;if(sString==null)return"";sPrefix=sPrefix+":";if(typeof(sString)!='string'){sString+=""}if(sString=="")return"";sString=sString.trim();if(sString.lc().indexOf(sPrefix)!=0)sString=sPrefix+sString;return sString};var oToastButtonTimer=0;var oPendingToasts={};var iPendingToastsCount=0;Owa.IM.IMUtils.ShowNewChatToast=function Owa$IM$IMUtils$ShowNewChatToast(sChatId,sUri,sDN,sMessage,fIsConf){var iTIMEOUT=15000;var o=$(Owa.Strings.Ids.NewChatNotificationButtonId);if(!o){return}if(iPendingToastsCount>0){window.clearTimeout(oToastButtonTimer);sDN=L_MultipleToastsHeader;sMessage=L_MultipleToastsBody.replace(/\{0\}/,(iPendingToastsCount+1))}else if(fIsConf){sMessage=L_InvitedToConference.replace(/\{0\} /,"")}oPendingToasts[sChatId]={"sChatId":sChatId,"sUri":sUri,"fIsConf":fIsConf};iPendingToastsCount++;showNotificationButton(Owa.Strings.Ids.NewChatNotificationButtonId,true);Owa.UIControls.NewItemAlertDialog.hideDialog(1);Owa.UIControls.NewItemAlertDialog.clearTimer();if(!Owa.UIControls.NotificationDialog.anyDialogsOpen()){var nmDlg=new Owa.UIControls.NewItemAlertDialog(Owa.Strings.Ids.NewChatNotificationButtonId,sDN,sMessage,getThmF("newchat.gif"),function(){},Owa.IM.IMUtils.ClickNewChatToast);nmDlg.show();Owa.UIControls.NewItemAlertDialog.setTimer("Owa.UIControls.NewItemAlertDialog.hideDialog();",iTIMEOUT)}oToastButtonTimer=window.setTimeout("Owa.IM.IMUtils.HideNewChatToast();",iTIMEOUT)};Owa.IM.IMUtils.HideNewChatToast=function Owa$IM$IMUtils$HideNewChatToast(sChatId){if(!sChatId){oPendingToasts={};iPendingToastsCount=0}else{var oPendingToast=oPendingToasts[sChatId];if(oPendingToast){delete oPendingToasts[sChatId];if(iPendingToastsCount>0){iPendingToastsCount--}}}if(iPendingToastsCount>0){return}window.clearTimeout(oToastButtonTimer);oToastButtonTimer=0;showNotificationButton(Owa.Strings.Ids.NewChatNotificationButtonId,false);if(Owa.UIControls.NewItemAlertDialog.isType(Owa.Strings.Ids.NewChatNotificationButtonId)){Owa.UIControls.NewItemAlertDialog.hideDialog()}};Owa.IM.IMUtils.ClickNewChatToast=function Owa$IM$IMUtils$ClickNewChatToast(){window.clearTimeout(oToastButtonTimer);showNotificationButton(Owa.Strings.Ids.NewChatNotificationButtonId,false);var sChatId;for(sChatId in oPendingToasts){var oToast=oPendingToasts[sChatId];NIM(sChatId,oToast.sUri,"","","",null,oToast.fIsConf);var oRCtx={};oRCtx.sChtId=sChatId;sndIMReq(IM_PIC,0,0,oRCtx)}oPendingToasts={};iPendingToastsCount=0};Owa.IM.IMUtils.SetMenuSISO=function Owa$IM$IMUtils$SetMenuSISO(fHide){if(!g_oPresenceMenu)return;if(fHide){g_oPresenceMenu.showMenuItem("divSOIM",false);g_oPresenceMenu.showMenuItem("divSIIM",false);g_oPresenceMenu.showMenuItem("divD2",false)}else{g_oPresenceMenu.showMenuItem("divSOIM",gtMstr()&&gtMstr().g_fSignedIn);g_oPresenceMenu.showMenuItem("divSIIM",gtMstr()&&!gtMstr().g_fSignedIn)}};var g_utQueryPresence=new Owa.IM.UriTable();var g_utRecipientWellPresence=0;var OP_SAV=0x01;var OP_SND=0x02;var OP_CLS=0x04;var OP_ANR=0x08;var OP_DEL=0x10;var OP_SN_ALL=0x20;var OP_SN_MD=0x40;var OP_GT_CERT=0x80;var OP_VLD_CERT=0x100;var OP_SND_MR=0x200;var RF_EXPDFT=1;var RF_IMPDFT=2;var RF_RPLY=3;var RF_FWD=4;var RF_PSTRPLY=5;var R_TNT=2;var R_ACC=3;var R_DEC=4;var ACTN_NTJNK=1;var ACTN_ADDBSL=2;var SSL=1;var BSL=2;var SRL=3;function delMsg(fP,fC){if(!fC){if(fP&&!confirm(L_PrDelPrp)){return}}g_fdelMsg=1;var oR=new oeReq("ReadMessage",fP?"PermanentDelete":"Delete",null,cbDelMsg);oR.add("Id",a_sId);oR.send()}function cbDelMsg(oR){if(oR.fST){popLgn();return}if(oR.sErr){shwErrDlg(oR);return}var fCl=0;try{var oSubPageController=Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().get_OpenerController();var oListView=null;if(oSubPageController){oListView=Owa.PageHierarchy.getVirtualListViewFromSubPageController(oSubPageController)}var fConversationView=(oListView&&oListView.isCnvVw&&oListView.isCnvVw());if(oListView){var sWindowContext=fConversationView?null:window.name;fCl=oListView.rmvRws(new Array(a_sId),sWindowContext,a_fNxtSel)}else{fCl=1}if(fCl||!oListView.gtSelCnt()||fConversationView){window.close()}}catch(e){}}(function(){Owa.Controls.NavigationManager=function Owa$Controls$NavigationManager(){Owa.Controls.NavigationManager.baseClass.call(this);this._NFDicts={}};Owa.Utility.inherit(Owa.Controls.NavigationManager,Owa.Controls.OEHManagerBase);Owa.Controls.NavigationManager.prototype.addFvr=function Owa$Controls$NavigationManager$addFvr(oSndr,sFId,sNId,fIsAft,oCCtx){var oR=new oeReq("NavigationNode","AddToFavorites",this.prepCtx(arguments,oCCtx),this.prepCB("AddToFavorites",1),POST);oR.add("Id",sFId);if(sNId){oR.add("tgtid",sNId);oR.add("mt",fIsAft?2:1)}oR.send()};Owa.Controls.NavigationManager.prototype.rmvFrmFvr=function Owa$Controls$NavigationManager$rmvFrmFvr(oSndr,sFId,oCCtx){if(!g_oMMFrst)return;var oFavT=g_oMMFrst.gtTr("favorite");if(!oFavT)return;var oJN=oFavT.gtNdByFId(sFId);if(oJN)this.rmv(oSndr,oJN.gtNId(),GS_FVR,oCCtx)};Owa.Controls.NavigationManager.prototype.rmv=function Owa$Controls$NavigationManager$rmv(oSndr,sNId,sGS,oCCtx){var oR=new oeReq("NavigationNode","Remove",this.prepCtx(arguments,oCCtx),this.prepCB("RemoveNavigation",1),POST);oR.add("srcNId",sNId);oR.add("GS",sGS);oR.addRg("cms",tryGtActMd());oR.send()};Owa.Controls.NavigationManager.prototype.rmvOUM=function Owa$Controls$NavigationManager$rmvOUM(oSndr,sFId,oCCtx){var oR=new oeReq("NavigationNode","RemoveOtherInbox",this.prepCtx(arguments,oCCtx),this.prepCB("RemoveFromView",1),POST);oR.add("Id",sFId);oR.send()};Owa.Controls.NavigationManager.prototype.canAddToFvr=function Owa$Controls$NavigationManager$canAddToFvr(sFId,sFCC,sFT,isInDel){return(g_oFldrMgr.gtFL(sFId)==FL_MBX||g_oFldrMgr.gtFL(sFId)==FL_AMB)&&isOfClss(sFCC,T_MSG)&&sFT!=DFT_ROT&&!isInDel&&!this.isInFvr(sFId)};Owa.Controls.NavigationManager.prototype.nw=function Owa$Controls$NavigationManager$nw(oSndr,sGS,sPNId,sNm,oCCtx){if(sPNId){var oR=new oeReq("NavigationNode","AddFolder",this.prepCtx(arguments,oCCtx),this.prepCB("NewNavigation",1),POST);oR.add("SB",sNm);oR.add("pid",sPNId);oR.add("GS",sGS);oR.send()}else{var oR=new oeReq("NavigationNode","AddGroup",this.prepCtx(arguments,oCCtx),this.prepCB("NewNavigation",1),POST);oR.add("SB",sNm);oR.add("GS",sGS);oR.send()}};Owa.Controls.NavigationManager.prototype.rnm=function Owa$Controls$NavigationManager$rnm(oSndr,sGS,sNId,sNm,oCCtx){var oR=new oeReq("NavigationNode","Rename",this.prepCtx(arguments,oCCtx),this.prepCB("RenameNavigation",1),POST);oR.add("srcNId",sNId);oR.add("SB",sNm);oR.add("GS",sGS);oR.send()};Owa.Controls.NavigationManager.prototype.isInFvr=function Owa$Controls$NavigationManager$isInFvr(sFId){var oDict=this._NFDicts[GS_FVR];if(oDict)return !!oDict[padF(sFId)]};Owa.Controls.NavigationManager.prototype.stNFDict=function Owa$Controls$NavigationManager$stNFDict(sGS,oDict){this._NFDicts[sGS]=oDict};Owa.Controls.NavigationManager.prototype.addFltrToFav=function Owa$Controls$NavigationManager$addFltrToFav(oSndr,sFId,sNm,oLV,oCCtx){var oR=new oeReq("MsgVLV2","AddFilterToFavorites",this.prepCtx(arguments,oCCtx),this.prepCB("AddFilterToFavorites",1),POST);oR.add("fltrSbj",sNm);this.addFltrVwSt(oLV,sFId,oR);oR.send()};Owa.Controls.NavigationManager.prototype.addFltrVwSt=function Owa$Controls$NavigationManager$addFltrVwSt(oLV,sFId,oR){var oFilterCriteria=oLV.get_FilterViewCriteria();if(oFilterCriteria)oFilterCriteria.addStatement(oR,sFId)};g_oEd.register("AddToFavorites");g_oEd.register("AddFilterToFavorites");g_oEd.register("RemoveFromView");g_oEd.register("RemoveNavigation");g_oEd.register("NewNavigation");g_oEd.register("RenameNavigation")})();var g_oNvNdMgr;if(!g_oNvNdMgr){g_oNvNdMgr=new Owa.Controls.NavigationManager()}var EVT_ERR_EP=24;function pndGt(){this.pndGtMgr=new PndGtMgr();this.pndGtMgr.sndFnshRq(cbFnshRq,true);function disp(){this.pndGtMgr.fDisposed=1;this.pndGtMgr.sndFnshRq(null,true);if(this.pndGtMgr.hdnIfrm){try{var htmlDoc=this.pndGtMgr.htmlDoc;htmlDoc.parentWindow.pdnRsp=null;htmlDoc.removeChild(this.pndGtMgr.ifrDiv)}catch(e){}this.pndGtMgr.hdnIfrm.src="about:blank"}}this.disp=disp}function PndGtMgr(){if(Owa.Utility.isIE()){this.hdnIfrm=this.CreatePendingGetIFrame()}this.CHK_TMOUT=60000;this.CHK_FNSH_TMOUT=30000;this.CHK_FNSH_CNT=18000;this.lstNtf=-1;this.fStpTmr=1;this.fRqAlive=0;this.retryCnt=0;this.finishRetryCnt=0;this.MAX_FINISH_RETRY=3;this.fDisposed=0;this.fDisposed=0;this.lstErrTmStmp=-1;this.MIN_TM_BTWN_ERR=30000;this.iSrvErrCnt=0;this.fErrLstPndGt=0;this.oCheckStateTimer;this.fLastFinishRequest=0;return this}PndGtMgr.prototype.CreatePendingGetIFrame=function PndGtMgr$CreatePendingGetIFrame(){var htmlDoc=new ActiveXObject("htmlfile");this.htmlDoc=htmlDoc;htmlDoc.open();htmlDoc.write("<html>");htmlDoc.write("<script>try{document.domain='"+document.domain+"';}catch(e){}</script>");htmlDoc.write("</html>");htmlDoc.close();htmlDoc.parentWindow.pdnRsp=function htmlDoc$parentWindow$pdnRsp(a){window.evlRsp(a)};var ifrDiv=htmlDoc.createElement("div");this.ifrDiv=ifrDiv;htmlDoc.appendChild(ifrDiv);ifrDiv.innerHTML="<iframe id='hdnIfrm'></iframe>";return this.htmlDoc.parentWindow.document.all["hdnIfrm"]};PndGtMgr.prototype.finishReqTimeout=function PndGtMgr$finishReqTimeout(iReqIssuedTime,oR){if(iReqIssuedTime==this.fLastFinishRequest){try{oR.cancelCallback()}catch(e){}this.sndFnshRq(cbFnshRq)}};PndGtMgr.prototype.updTmStmp=function PndGtMgr$updTmStmp(){this.lstNtf=new Date().getTime();this.startTmr()};PndGtMgr.prototype.chkPndGtState=function PndGtMgr$chkPndGtState(ckTm){if(this.fDisposed)return;if(!this.fStpTmr){if(this.lstNtf==-1)this.lstNtf=new Date().getTime();var tmElpsd=new Date().getTime()-this.lstNtf;if(tmElpsd>this.CHK_TMOUT){this.hndErrPndGt();this.sndFnshRq(cbFnshRq)}else{this.startTmr()}}};PndGtMgr.prototype.sndFnshRq=function PndGtMgr$sndFnshRq(cb,fFnlRq){this.fStpTmr=1;this.fRqAlive=0;if(this.hdnIfrm){this.hdnIfrm.src="about:blank"}var oR=new oeReq("PendingRequest","FinishNotificationRequest",this,cb,POST,null,false,true,true);if(fFnlRq)oR.add("Fn",1);oR.send();if(!Owa.Utility.isIE()){var iCurrentTime=new Date().getTime();this.fLastFinishRequest=iCurrentTime;setTimeout(function(){a_oPndGt.pndGtMgr.finishReqTimeout(iCurrentTime,oR)},this.CHK_FNSH_TMOUT)}};PndGtMgr.prototype.startTmr=function PndGtMgr$startTmr(){this.fStpTmr=0;if(this.oCheckStateTimer){clearTimeout(this.oCheckStateTimer)}this.oCheckStateTimer=setTimeout("a_oPndGt.pndGtMgr.chkPndGtState()",this.CHK_TMOUT)};PndGtMgr.prototype.retryPndGt=function PndGtMgr$retryPndGt(){if(this.fDisposed)return;if(!this.fRqAlive){this.retryCnt=this.retryCnt+1;if(this.retryCnt>2){this.hndErrPndGt();this.retryCnt=0;this.startTmr()}else{this.sndPndGt();setTimeout("a_oPndGt.pndGtMgr.retryPndGt()",this.CHK_FNSH_CNT+10000)}}else{if(!a_oPndGt.pndGtMgr.fErrLstPndGt)shwNE(0,0,1);this.retryCnt=0;this.startTmr()}};PndGtMgr.prototype.sndPndGt=function PndGtMgr$sndPndGt(){if(this.hdnIfrm){this.hdnIfrm.src="ev.owa?UA=0&oeh=1&ns=PendingRequest&ev=PendingNotificationRequest&"+a_sCnNm+"="+rtrvUCCk()}else{var byteOffset=0;function handler(){var oXmlHttp=this;if(oXmlHttp!=null){if(oXmlHttp.readyState==3){var buffer=oXmlHttp.responseText;var newdata=buffer.substring(byteOffset);byteOffset=buffer.length;var remaining=executeResponse(newdata);byteOffset=buffer.length-remaining}else if(oXmlHttp.readyState==4){var buffer=oXmlHttp.responseText;var newdata=buffer.substring(byteOffset);delete oXmlHttp}}}var iUniquePendingGetUrl=new Date().getTime().toString(36);var xmlHttp=new XMLHttpRequest();xmlHttp.onreadystatechange=handler;xmlHttp.open("GET","ev.owa?UA=0&oeh=1&ns=PendingRequest&ev=PendingNotificationRequest&"+a_sCnNm+"="+rtrvUCCk()+"n="+iUniquePendingGetUrl,true);xmlHttp.send(null)}};PndGtMgr.prototype.hndErrPndGt=function PndGtMgr$hndErrPndGt(fSrvCall){var oR=new oeReq("PendingRequest","PendingNotificationRequest",this,null,GET);var oDiv=document.createElement("div");if((!this.errorDiv)&&(fSrvCall))throw new Error("Server should not call hndErrPndGt without an error div!");oDiv.innerHTML=this.errorDiv;var oErr=getOneDescendant(oDiv,"err");if(oErr){oR.sErr=oErr.getAttribute("_msg");var sErrorCode=oErr.getAttribute("_cd");if(sErrorCode){oR.iErr=getInt(sErrorCode)}}else{oR.sErr=L_PndGtErr}if((fSrvCall)&&(this.fStpTmr)&&isDf(typeof(oR.iErr))&&oR.iErr==EVT_ERR_EP)return;var divDbg=getOneDescendant(oDiv,"debugInfo");if(divDbg)oR.sErrDbg=divDbg.outerHTML;var divCustom=getOneDescendant(oDiv,"divCstInfo");if(divCustom)oR.divCustom=divCustom;else oR.divCustom=null;if(fSrvCall&&!this.fStpTmr){var currTm=new Date().getTime();if(this.lstErrTmStmp==-1)this.lstErrTmStmp=currTm;if(currTm-this.lstErrTmStmp<=this.MIN_TM_BTWN_ERR)this.iSrvErrCnt++;else this.iSrvErrCnt=0;this.lstErrTmStmp=currTm;this.fErrLstPndGt=1;if(this.iSrvErrCnt<2)this.sndFnshRq(cbFnshRq)}shwNE(1,oR,1)};function cbFnshRq(oR){a_oPndGt.pndGtMgr.fLastFinishRequest=new Date().getTime();if(oR.sErr){if(oR.fST){rplLgn();a_oPndGt.pndGtMgr.finishRetryCnt=0;a_oPndGt.pndGtMgr.startTmr()}else{if(a_oPndGt.pndGtMgr.finishRetryCnt>=a_oPndGt.pndGtMgr.MAX_FINISH_RETRY){shwNE(1,oR,1);a_oPndGt.pndGtMgr.finishRetryCnt=0;a_oPndGt.pndGtMgr.startTmr()}else{a_oPndGt.pndGtMgr.finishRetryCnt++;a_oPndGt.pndGtMgr.sndFnshRq(cbFnshRq)}}}else{a_oPndGt.pndGtMgr.finishRetryCnt=0;eval(oR.sBody);if(a_oPndGt.pndGtMgr.lstNtf==-1){setTimeout("a_oPndGt.pndGtMgr.sndPndGt()",1)}else{a_oPndGt.pndGtMgr.sndPndGt()}if(syncFnshRq){a_oPndGt.pndGtMgr.startTmr()}else{setTimeout("a_oPndGt.pndGtMgr.retryPndGt()",a_oPndGt.pndGtMgr.CHK_FNSH_CNT)}}}function executeResponse(data){var newdata=data;if(!newdata)return 0;while(1){var start=newdata.indexOf("<script>");if(start!=-1){var end=newdata.indexOf("</script>",start);if(end!=-1){eval(newdata.substring((start+8),end));newdata=newdata.substring(end+9)}else{return newdata.length}}else{return newdata.length}}return 0}function evlRsp(sScrptBlk){a_oPndGt.pndGtMgr.updTmStmp();window.eval(sScrptBlk);updCmp(window,sScrptBlk,1);if((a_oPndGt.pndGtMgr.fRqAlive)&&(!a_oPndGt.pndGtMgr.fErrLstPndGt))shwNE(0,0,1)}function rstPndRq(){a_oPndGt.pndGtMgr.fErrLstPndGt=0;a_oPndGt.pndGtMgr.sndFnshRq(cbFnshRq)}var ER_MDF=0x1;var ER_RD=0x2;var ER_DLT=0x4;var ER_CH=0x8;var ER_CC=0x10;function hasER(iR,iER){return iR&iER}(function(){Owa.Controls.PolicyTagManager=function Owa$Controls$PolicyTagManager(){Owa.Controls.PolicyTagManager.baseClass.call(this)};Owa.Utility.inherit(Owa.Controls.PolicyTagManager,Owa.Controls.OEHManagerBase);Owa.Controls.PolicyTagManager.prototype.applyPolicy=function Owa$Controls$PolicyTagManager$applyMovePolicy(sPolicyType,oSndr,rgIds,sTag,sFId,oCCtx){var oR=new oeReq(sPolicyType,"ApplyPolicy",this.prepCtx(arguments,oCCtx),this.prepCB("Apply"+sPolicyType,1),POST);oR.addRg("id",rgIds);oR.add("tag",sTag);if(sFId){oR.add("fId",sFId)}oR.send()};Owa.Controls.PolicyTagManager.prototype.inheritPolicy=function Owa$Controls$PolicyTagManager$inheritPolicy(sPolicyType,oSndr,rgIds,sFId,oCCtx){var oR=new oeReq(sPolicyType,"InheritPolicy",this.prepCtx(arguments,oCCtx),this.prepCB("Inherit"+sPolicyType,1),POST);oR.addRg("id",rgIds);if(sFId){oR.add("fId",sFId)}oR.send()};g_oEd.register("ApplyDeletePolicy");g_oEd.register("InheritDeletePolicy");g_oEd.register("ApplyMovePolicy");g_oEd.register("InheritMovePolicy")})();var g_oPtgMgr;if(!g_oPtgMgr){g_oPtgMgr=new Owa.Controls.PolicyTagManager()}var RBT_ADDL=0x1;var RBT_PDL=0x2;var AO_N=0;var AO_S=1;var AO_D=2;var AO_O=3;var RESOLVE_IN_PROGRESS=0;var RESOLVE_NO_RECIPIENTS=1;var RESOLVE_MAX_RECIPIENTS=2;var RESOLVE_COMPLETE=3;var RESOLVE_ANR_CANCEL=4;var RESOLVE_UNRESOLVED_RECIPIENTS=5;var RESOLVE_REQUEST_ERROR=6;var RESOLVE_ANR_COMPLETE=7;var TO="divTo";var CC="divCc";var BCC="divBcc";var SMIMEFROM="divSMimeFrom";var FROM="divFrom";var BTNFROM="btnFrom";var MAX_LPW=5;var RCP_RES=0x1;var RCP_AMB=0x2;var RCP_PND=0x4;var g_rgoRcp=0;var RT_EX="EX";var RT_SMTP="SMTP";var RT_PDL="MAPIPDL";var RT_MBL="MOBILE";var R_DL=0x01;var R_RM=0x02;var MAX_RECIPIENT_ROWS=5;var g_primaryRecipient;var g_subscriptionRecipients;var g_mruRecipients;function updSndrPrsnc(){var rgIds=["spnFrom","spnOrg","spnSender"];var oBody=Owa.Dom.Document.get_Current().get_Body();for(var i=0;i<rgIds.length;i++){var sId=rgIds[i];var rgSpans=oBody.getAllDescendantsById(sId);for(var j=0;j<rgSpans.length;j++){updRSpnPrsnc(rgSpans[j],1)}}}function updAllRwPrsnc(){var i,j,rgDivs,rgIds;var oBody=Owa.Dom.Document.get_Current().get_Body();if(!isDf(typeof(a_fCal))){rgIds=[TO,CC,BCC]}else{rgIds=[TO,CC,BCC,"divAccept","divTent","divDecline"]}for(i=0;i<rgIds.length;i++){var sId=rgIds[i];rgDivs=oBody.getAllDescendantsById(sId);for(j=0;j<rgDivs.length;j++){updRwPrsnc(rgDivs[j])}}}function updRwPrsnc(oDiv){var rgRcps=oDiv.getAllDescendantsById("spnR");var length=(rgRcps.length<128)?rgRcps.length:128;for(var i=0;i<length;i++){updRSpnPrsnc(rgRcps[i],0)}}function updRSpnPrsnc(oSpn,fBig){var oFirstChild=oSpn.getDescendantById("spnR");var iPresence=gtDfltPrsnc();if(oFirstChild){oSpn=oFirstChild}var sUri=gtRcpIM(oSpn);if(sUri){sUri=sUri.trim()}if(!sUri){return}var oImg=oSpn.get_FirstChild();if(oImg&&(oImg.get_NodeType()==Owa.NodeType.Element)&&(oImg.get_TagName().toLowerCase()=="img")){var oPresence=gtPrsncFrmMstr(sUri,fBig);iPresence=oPresence.prsnc;Owa.Components.CssSprites.updateImage(oImg,oPresence.fNm);oImg.set_Title(g_rgsPrsncLocNm[iPresence]);if(g_utRecipientWellPresence){var oPR=new Object();oPR.spn=oSpn;oPR.sUri=sUri;oPR.jb=oImg;oPR.fBig=fBig;var rgoPrsnc=g_utRecipientWellPresence.Get(sUri);if(!rgoPrsnc){rgoPrsnc=[];g_utRecipientWellPresence.Set(sUri,rgoPrsnc)}rgoPrsnc.push(oPR)}}if((iPresence==IM_PR_UNKNWN)&&!g_utQueryPresence.Get(sUri)){g_utQueryPresence.Set(sUri,sUri)}}function setJBPrsnc(jb,iPrsnc,fBig){jb.setAttribute("src",getThmF("clear1x1.gif"));Owa.Components.CssSprites.updateImage(jb,gtIMFFrmId(iPrsnc,fBig?JBSIZE_BIG:JBSIZE_NRM));jb.set_Title(g_rgsPrsncLocNm[iPrsnc])}function renderJB(oSpn,fBig,sId,fBddy,iPrsnc){if(!oSpn){return}var oChld=oSpn.get_FirstChild();if(!oChld){return}var oImg=Owa.Dom.Document.get_Current().createElement("img");oImg.set_Id(sId?sId:"imgjb");oImg.addCssClass("jb");oImg.addCssClass(fBig?"jbb":"jbs");if(!fBddy){oImg.attachEvent("click",onRwCmJb);oImg.attachEvent("dblclick",onDblClkJb)}oImg.setAttribute("unselectable","on");oImg.setIntAttribute("tabIndex",-1);if(!Owa.Utility.isDefined(typeof iPrsnc)){iPrsnc=gtDfltPrsnc()}setJBPrsnc(oImg,iPrsnc,fBig);oSpn._get_DomNode().insertBefore(oImg._get_DomNode(),oChld._get_DomNode())}function gtRcpIM(oSpn){if(isDf(typeof(oSpn))&&oSpn&&oSpn._uri){return oSpn._uri}if(isDf(typeof(oSpn))&&oSpn&&oSpn.uri){return oSpn.uri}if(!Owa.Dom.Node.isInstance(oSpn)){oSpn=Owa.Dom.Node.wrapDomNode(oSpn)}var sUri=0;if(!oSpn.getAttribute){return sUri}if(oSpn.getAttribute("_uri")){sUri=oSpn.getAttribute("_uri")}else if(oSpn.getAttribute("uri")){sUri=oSpn.getAttribute("uri")}else if(oSpn.getAttribute("_sa")&&(oSpn.getAttribute("_rt")==RT_SMTP)){sUri=imns.IMUtils.FrmSipUri(oSpn.getAttribute("_sa"))}else if((getInt(oSpn.getAttribute("_ao"))==AO_O)&&(oSpn.getAttribute("_em")!=null)){sUri=imns.IMUtils.FrmSipUri(oSpn.getAttribute("_em"))}return sUri}function dispRwPrsnc(){var j,sUri,rgArr;if(!g_utRecipientWellPresence){return}for(sUri in g_utRecipientWellPresence.Keys()){rgArr=g_utRecipientWellPresence.Get(sUri);if(!rgArr){continue}for(j=0;j<rgArr.length;j++){rgArr[j].spn=null;rgArr[j].jb=null}}g_utRecipientWellPresence=0}function dispJB(oSpn){if(!Owa.Dom.Node.isInstance(oSpn)){oSpn=Owa.Dom.Node.wrapDomNode(oSpn)}var oImg=oSpn.getDescendantById("imgjb");if(oImg){oImg.detachAllEvents()}}function onRwCmJb(e){if(e==null){e=getEvt(this)}if(Owa.Dom.Event.isInstance(e)){e=e._oEvent}var oSpn=getEvtTgt(e).parentNode;shwRcpMnu(oSpn,e)}function onDblClkJb(e){if(e==null){e=getEvt(this)}canEvt(e)}function addRcpForIM(oDiv,sDN,sEM,sRT,sSmtp,iAO,iRF,sId,iEI,sUri){var oSpnOuter=createOwaRcpSpan(sDN,sEM,sRT,sSmtp,iAO,iRF,sId,iEI,sUri,1);var rgRecipientSpans=oDiv.getAllDescendantsById("spnR");if(rgRecipientSpans.length){oDiv.insertAdjacentText(Owa.ElementInsertionPoint.BeforeEnd,Owa.SeparatorSpace)}oDiv.appendChild(oSpnOuter);var oSpnInner=oSpnOuter.get_FirstChild();renderJB(oSpnInner);updRSpnPrsnc(oSpnInner,0);rszRw(oDiv)}function removeRcpForIM(oDiv,sUri){var rgAllChildNodes=oDiv.getChildrenSnapshot();for(var i=0;i<rgAllChildNodes.length;i++){var oChild=rgAllChildNodes[i];var sCurrentUri="";if(oChild.get_NodeType()==Owa.NodeType.Text){continue}if(oChild.get_Id()=="spnR"){sCurrentUri=oChild.getAttribute("_uri")}else{var oFirstChild=oChild.getDescendantById("spnR");if(oFirstChild){sCurrentUri=oFirstChild.getAttribute("_uri")}}if(isSameUri(sCurrentUri,sUri)){var oSibling;if(i==0){oSibling=oChild.get_NextSibling()}else{oSibling=oChild.get_PreviousSibling()}if(oSibling&&(oSibling.get_NodeType()==Owa.NodeType.Text)&&(oSibling.get_TextContent()==Owa.SeparatorSpace)){oSibling.remove(true)}oChild.remove(true)}}rszRw(oDiv)}function checkMaxRecipients(iTotal){if(!isDf(typeof(a_iMaxRcp))){return 1}if(iTotal>a_iMaxRcp){alrt(L_ErrMaxRcp.format(a_iMaxRcp,iTotal,iTotal-a_iMaxRcp));return 0}return 1}function isRecipientSpan(outerSpan){if(outerSpan&&outerSpan.nodeType==1){if(outerSpan.tagName=="SPAN"){if(outerSpan.childNodes.length==1){var sp=outerSpan.childNodes[0];if(sp&&sp.tagName=="SPAN"){if(sp.childNodes.length==1){if(sp.className.contains("rwRR")||sp.className.contains("rwUR")){var txn=sp.childNodes[0];if((txn.nodeType==3)&&(txn.nodeValue!=null)){return true}}}}}}}return false}function browserWorkAround(oDiv,fFocus){if(!Owa.Utility.isIE()){var firstChild=oDiv.firstChild;if(firstChild){var oTextNode=document.createTextNode("\u00a0");if(firstChild.nodeType!=3){oDiv.insertBefore(oTextNode,firstChild)}else if((firstChild.nodeValue==null)||(firstChild.nodeValue.length==0)){oDiv.replaceChild(oTextNode,firstChild)}}var lastChild=oDiv.lastChild;if(lastChild){var oTextNode=document.createTextNode("\u00a0");if(lastChild.nodeType!=3){oDiv.appendChild(oTextNode)}else if((lastChild.nodeValue==null)||(lastChild.nodeValue.length==0)){oDiv.replaceChild(oTextNode,lastChild)}if(Owa.Utility.isSafari()&&fFocus){oDiv.focus();var selection=window.getSelection();selection.setPosition(oTextNode,1);selection.collapseToEnd()}}if(Owa.Utility.isFirefox()){removeBrs(oDiv)}}}function removeBrs(oDiv){var rgBrs=oDiv.getElementsByTagName("BR");for(var i=rgBrs.length-1;i>=0;i--){Owa.Dom.Node.wrapDomNode(rgBrs[i]).remove(false)}}function isChar(iKey){if((iKey<=111&&iKey>=48)||iKey==32||(iKey<=192&&iKey>=187)||(iKey<=222&&iKey>=219)){return 1}else{return 0}}function hasNoRcpId(oSpn){return(((getInt(oSpn.getAttribute("_ao"))==AO_S)||(getInt(oSpn.getAttribute("_ao"))==AO_D))&&(!oSpn.getAttribute("_id")))}function gtDftRT(){return isDf(typeof(a_sDftRT))?a_sDftRT:RT_SMTP}function isDftRT(sRT){return(sRT==gtDftRT())}function isCstmRT(oRcp){return((!isNoE(oRcp._em))&&(!isNoE(oRcp._rt))&&(oRcp._rt!=RT_EX)&&(oRcp._rt!=RT_SMTP)&&(oRcp._rt!=RT_PDL))}function getSmtpOrCustomRoutingAddress(oRecip){var sAddress="";if(isCstmRT(oRecip)){var sRTEm=isDftRT(oRecip._rt)?oRecip._em:(oRecip._rt+": "+oRecip._em);if(oRecip._dn.lc().indexOf(sRTEm.lc())<0){sAddress=" "+g_sDE+"["+htmlEnc(sRTEm)+"]"+g_sDE}}else if((!isNoE(oRecip._sa))&&(oRecip._dn.lc().indexOf(oRecip._sa.lc())<0)){sAddress=" "+g_sDE+"["+htmlEnc(oRecip._sa)+"]"+g_sDE}return sAddress}function gtRBT(){if(isDf(typeof(a_iRBT))){return a_iRBT}else{return 0}}function isADDLAllw(){var iRBT=gtRBT();if(isFlgSt(iRBT,RBT_ADDL)){return 0}else{return 1}}function isPDLAllw(){var iRBT=gtRBT();if(isFlgSt(iRBT,RBT_PDL)){return 0}else{return 1}}function AnrOptions(fIsADOnly,fResolveAgainstAllContacts,sDefaultRoutingType,fOnlyAllowDefaultRoutingType,iRecipientBlockType){this.fResolveOnlyFromAddressBook=fIsADOnly;this.fResolveAgainstAllContacts=fResolveAgainstAllContacts;this.sDefaultRoutingType=sDefaultRoutingType;this.fOnlyAllowDefaultRoutingType=fOnlyAllowDefaultRoutingType;this.iRecipientBlockType=iRecipientBlockType}function getAnrOptions(fIsADOnly,fResolveAgainstAllContacts,iRBT){var oAnrOptions=new AnrOptions(fIsADOnly,fResolveAgainstAllContacts);if(isDf(typeof(a_sDftRT))){oAnrOptions.sDefaultRoutingType=a_sDftRT}if(isDf(typeof(a_fOlyDftRT))){oAnrOptions.fOnlyAllowDefaultRoutingType=a_fOlyDftRT}if(iRBT){oAnrOptions.iRecipientBlockType=iRBT}else if(isDf(typeof(a_iRBT))){oAnrOptions.iRecipientBlockType=a_iRBT}return oAnrOptions}function shwBcc(f){var oDivWellBcc=$("divWellBcc");if(oDivWellBcc){var oDivBcc=$(BCC);oDivWellBcc.set_IsShown(f);oDivBcc.set_IsDisabled(f?false:true);safeResizeBodies();safeResizeWells()}}function addRecipientSpanToContacts(oSpn){var iAddressOrigin=getInt(oSpn.getAttribute("_ao"));var oCallerSubPage=getSubPageFromRecipientSpan(oSpn);if(iAddressOrigin==AO_O){var oContext={};oContext.oCallerSubPage=oCallerSubPage;var oR=new oeReq("ABDA","AOOToCt",oContext,cbaddToCt);var sEmailAddress=oSpn.getAttribute("_em");if(isCstmRT(oSpn)){var sRoutingType=oSpn.getAttribute("_rt");if(sRoutingType==RT_MBL){oR.add("mp",sEmailAddress);oR.send();return}else{sEmailAddress="["+sRoutingType+": "+sEmailAddress+"]"}}oR.add("em",sEmailAddress);if(oSpn.getAttribute("_dn")){oR.add("dn",oSpn.getAttribute("_dn"))}oR.send()}else if(iAddressOrigin==AO_D){var oContext={};oContext.oCallerSubPage=oCallerSubPage;var oR=new oeReq("ABDA","AddToContacts",oContext,cbaddToCt);var sId=oSpn.getAttribute("_id");if(!isNoE(sId)){var rgIds=new Array();rgIds[0]=sId;oR.addRg("id",rgIds)}oR.add("email",oSpn.getAttribute("_em"));oR.send()}}function cbaddToCt(oR){if(oR.sErr){if(oR.fST)popLgn();else shwErrDlg(oR);return}if(oR.sBody){var oDivR=Owa.Dom.Document.get_Current().createElement("DIV");oDivR.set_InnerHtml(oR.sBody);var oCntUrl=oDivR.getDescendantById("sCntUrl");var oCntErr=oDivR.getDescendantById("sCntErr");if(oCntUrl&&oCntUrl.get_TextContent()){opnWin(oCntUrl.get_TextContent()+urlEnc(oDivR.getDescendantById("sCntId").get_TextContent()),null,null,null,null,null,null,oR.oCtx.oCallerSubPage)}else if(oCntErr&&oCntErr.get_InnerHtml()){alrt(oCntErr.get_InnerHtml(),0,Owa.BUTTON_DIALOG_ICON.WARNING,L_Wrng)}}}function getRcpStr(oR){return"new Recip('"+getStr(oR._dn,1)+"','"+getStr(oR._em,1)+"','"+getStr(oR._sa,1)+"','"+getStr(oR._al,1)+"','"+getStr(oR._rt,1)+"',"+getStr(oR._ao,1)+",'"+getStr(oR._id,1)+"',"+(oR._rf?getStr(oR._rf,1):"0")+","+(oR._ei?getStr(oR._ei,1):"0")+",'"+getStr(oR._uri,1)+"')"}function rszRw(oDivRecipientWell,fIsSingleRecipientWell){if(!Owa.Dom.Node.isInstance(oDivRecipientWell)){oDivRecipientWell=Owa.Dom.Node.wrapDomNode(oDivRecipientWell)}Owa.UIControls.EditRecipientWell.onResize(oDivRecipientWell,MAX_RECIPIENT_ROWS,fIsSingleRecipientWell)}function setRwHtml(oDiv,s){if(!Owa.Dom.Node.isInstance(oDiv)){oDiv=Owa.Dom.Node.wrapDomNode(oDiv)}oDiv.set_InnerHtml(s);var oRecipientWell=oDiv.getExpando("_oControl");if(oRecipientWell){oRecipientWell._onResize()}else{rszRw(oDiv)}}function shwRcpMnu(oSpn,e){if(!Owa.Dom.Node.isInstance(oSpn)){oSpn=Owa.Dom.Node.wrapDomNode(oSpn)}var oDivRecipientContextMenu=$("divRm");if(!oDivRecipientContextMenu){getRecipientContextMenu(oSpn,e);return}if(!shwRcpMnu.RecipientContextMenu){shwRcpMnu.RecipientContextMenu=Owa.UIControls.RecipientContextMenu.create(oDivRecipientContextMenu,oSpn)}else{shwRcpMnu.RecipientContextMenu.resetRecipient(oSpn)}shwRcpMnu.RecipientContextMenu.show(e.clientX,e.clientY)}function getRecipientContextMenu(oSpn,e){if(shwRcpMnu._fRequestInProgress){return}else{shwRcpMnu._fRequestInProgress=true}var oCtx=[oSpn,e.clientX,e.clientY];var oR=new oeReq("RecipWell","GetRecipientContextMenu",oCtx,cbGetRecipientContextMenu);if(isDf(typeof(a_iJnkMnuType))&&a_iJnkMnuType){oR.add("recipJnkMnuType",a_iJnkMnuType)}oR.send()}function cbGetRecipientContextMenu(oR){shwRcpMnu._fRequestInProgress=false;if(oR.fST){popLgn();return}var fIsError=(oR.sErr!=null);if(fIsError){return}else{var oDivR=Owa.Dom.Document.get_Current().createElement("DIV");oDivR=Owa.Dom.Document.get_Current().appendChild(oDivR);oDivR.set_IsShown(false);oDivR.set_InnerHtml(oR.sBody)}var oSpn=oR.oCtx[0];var iClientX=oR.oCtx[1];var iClientY=oR.oCtx[2];shwRcpMnu.RecipientContextMenu=Owa.UIControls.RecipientContextMenu.create($("divRm"),oSpn);shwRcpMnu.RecipientContextMenu.show(iClientX,iClientY)}function shwOneOffPrp(oRecipientSpan,fnOnClose){if(!Owa.Dom.Node.isInstance(oRecipientSpan)){oRecipientSpan=Owa.Dom.Node.wrapDomNode(oRecipientSpan)}var oDialog=new Owa.UIControls.RecipientOneOffDialog(oRecipientSpan,fnOnClose);oDialog.show()}var READWRITE_RECIP_SPAN=0;var READONLY_RECIP_SPAN=1;function getRecipientSpanState(oSpn){if(!Owa.Dom.Node.isInstance(oSpn)){oSpn=Owa.Dom.Node.wrapDomNode(oSpn)}var iState=READONLY_RECIP_SPAN;if(oSpn.hasCssClass("rwUR")||oSpn.hasCssClass("rwRR")){iState=READWRITE_RECIP_SPAN}return iState}var g_AnrCtxMnu=null;var g_AnrPnd=0;function isAnrMenuOpen(){return(g_AnrCtxMnu&&g_AnrCtxMnu.fIsOpen)}function shwAnrMnuForResolveNames(oAnrCtxt){g_AnrPnd=1;g_AnrCtxMnu=Owa.UIControls.RecipientAnrContextMenu.get_Instance();g_AnrCtxMnu.set_Action(ACTION_RESOLVE);g_AnrCtxMnu.set_Config(oAnrCtxt);g_AnrCtxMnu.set_FnAnrCallback(oAnrCtxt.fnCb);g_AnrCtxMnu.set_RecipientSpan(null);g_AnrCtxMnu.showAnrMenu()}function shwAnrMnuForContextMenu(oRecipientSpan){g_AnrPnd=1;g_AnrCtxMnu=Owa.UIControls.RecipientAnrContextMenu.get_Instance();g_AnrCtxMnu.set_Action(ACTION_CONTEXT);g_AnrCtxMnu.set_Config(null);if(!Owa.Dom.Node.isInstance(oRecipientSpan)){oRecipientSpan=Owa.Dom.Node.wrapDomNode(oRecipientSpan)}g_AnrCtxMnu.set_RecipientSpan(oRecipientSpan);g_AnrCtxMnu.showAnrMenu()}function getSubPageFromRecipientSpan(oSpan){if(!Owa.Dom.Node.isInstance(oSpan)){oSpan=Owa.Dom.Node.wrapDomNode(oSpan)}var oRecipientWell;try{oRecipientWell=oSpan.get_ParentElement().get_ParentElement().getExpando("_oControl")}catch(e){}return oRecipientWell&&oRecipientWell.get_SubPage()}function dispReadWells(){disposeReadRecipientSpans();if(g_fIsIMEnab){dispRwPrsnc()}}function disposeReadRecipientSpans(){var oDivTo=$(TO);var oDivCc=$(CC);var oDivBcc=$(BCC);if(oDivTo){dispSpans(oDivTo)}if(oDivCc){dispSpans(oDivCc)}if(oDivBcc){dispSpans(oDivBcc)}}function dispSpans(oDiv){var rgSpns=oDiv.getAllDescendantsById("spnR");for(var i=0;i<rgSpns.length;i++){var oSpan=rgSpns[i];oSpan.detachAllEvents();if(g_fIsIMEnab){dispJB(oSpan)}}}function dispRecipContextMenus(){if(shwRcpMnu.RecipientContextMenu){shwRcpMnu.RecipientContextMenu.dispose()}if(g_AnrCtxMnu){g_AnrCtxMnu.dispose()}}function addRcpForRule(oDiv,sDN,sEM,sRT,sSmtp,iAO,iRF,sId,iEI,sUri){var oSpnOuter=createOwaRcpSpan(sDN,sEM,sRT,sSmtp,iAO,iRF,sId,iEI,sUri);oDiv.appendChild(oSpnOuter);oDiv.insertAdjacentText(Owa.ElementInsertionPoint.BeforeEnd,Owa.SeparatorSpace)}var g_PropDefinitions={_dn:["_dn","","string"],_em:["_em","","string"],_sa:["_sa","","string"],_al:["_al","","string"],_rt:["_rt","","string"],_ao:["_ao",AO_N,"number"],_id:["_id","","string"],_rf:["_rf",0,"number"],_ei:["_ei",0,"number"],_uri:["_uri","","string"]};var PROP_NAME=0;var PROP_DEFAULT_VALUE=1;var PROP_TYPE=2;var FORCE_TYPE_STRING=1;function validateNumericProp(oValue,iDefaultValue){if(!iDefaultValue){iDefaultValue=0}var iValue=getInt(oValue);if(isNaN(iValue)){iValue=iDefaultValue}return iValue}function validateAddressOrigin(oAOValue){var iAO=getInt(oAOValue);if(isNaN(iAO)||((iAO!=AO_N)&&(iAO!=AO_S)&&(iAO!=AO_D)&&(iAO!=AO_O))){iAO=AO_N}return iAO}function validateProp(oProp,oValue,fForceAsString){var sPropName=g_PropDefinitions[oProp][PROP_NAME];var oDefault=g_PropDefinitions[oProp][PROP_DEFAULT_VALUE];var sType=g_PropDefinitions[oProp][PROP_TYPE];if(oValue!=oDefault){switch(sType){case"string":if(oValue){oValue=oValue.toString()}else{oValue=oDefault}break;case"number":if(sPropName=="_ao"){oValue=validateAddressOrigin(oValue)}else{oValue=validateNumericProp(oValue,oDefault)}break}}if(fForceAsString&&sType!="string"){oValue=oValue.toString()}return oValue}function getHtmlEncodedRecipPropsStr(oRecip){var sDomRecipientAttribs="";for(var oProp in g_PropDefinitions){var sValue=validateProp(oProp,oRecip[oProp],FORCE_TYPE_STRING);sDomRecipientAttribs+=" "+g_PropDefinitions[oProp][PROP_NAME]+"=\""+htmlEnc(sValue)+"\""}return sDomRecipientAttribs}function transferFromRecipToSpan(oRecipSrc,oSpnDest){for(var oProp in g_PropDefinitions){var sValue=validateProp(oProp,oRecipSrc[oProp],FORCE_TYPE_STRING);oSpnDest.setAttribute(g_PropDefinitions[oProp][PROP_NAME],sValue)}transferHelper(oSpnDest)}function transferBetweenDomObjects(oSrcElm,oDestElm){for(var oProp in g_PropDefinitions){var sPropName=g_PropDefinitions[oProp][PROP_NAME];var sValue=validateProp(oProp,oSrcElm.getAttribute(sPropName),FORCE_TYPE_STRING);oDestElm.setAttribute(sPropName,sValue)}transferHelper(oDestElm)}function transferHelper(oDestElm){if(Owa.Dom.Node.isInstance(oDestElm)){oDestElm=oDestElm._get_DomNode()}normalizeDisplayName(oDestElm);normalizeTitle(oDestElm);setRecipientSpanClass(oDestElm);renderDN(oDestElm)}function getDomPropsForRecip(oE){var oCollectionProps={};for(var oProp in g_PropDefinitions){var sPropName=g_PropDefinitions[oProp][PROP_NAME];var oValue=validateProp(oProp,oE.getAttribute(sPropName));oCollectionProps[oProp]=oValue}return oCollectionProps}function crtRecipObjectFromDomObject(oE){var oCollectionProps=getDomPropsForRecip(oE);return RecipFromCollection(oCollectionProps)}function crtRecipObjectFromAmbiguousSpan(oRecipientSpan){var oRecipient=crtRecipObjectFromDomObject(oRecipientSpan);if(!Owa.Dom.Node.isInstance(oRecipientSpan)){oRecipientSpan=Owa.Dom.Node.wrapDomNode(oRecipientSpan)}oRecipient._dn=oRecipientSpan.get_TextContent();oRecipient.fAmb=1;return oRecipient}function crtRecipObjectFromTextNode(sValue){var oRecipient=new Recip(sValue);oRecipient.fPnd=1;return oRecipient}function isPendingRecipient(oRecipient){if(oRecipient.fPnd&&oRecipient._dn&&!oRecipient._em&&!oRecipient._id&&!oRecipient._sa&&!oRecipient.fAmb){return true}return false}function RecipFromCollection(oCollectionValidProps){var oRecipient=new Recip();for(var oProp in g_PropDefinitions){oRecipient[oProp]=oCollectionValidProps[oProp]}return oRecipient}function Recip(sDN,sEM,sSA,sAl,sRT,iAO,sId,iRF,iEI,sUri,iType){this._dn=sDN;this._em=sEM;this._sa=sSA;this._al=sAl;this._rt=sRT;this._id=sId;this._ao=validateAddressOrigin(iAO);this._rf=validateNumericProp(iRF,0);this._ei=validateNumericProp(iEI,0);this._uri=sUri?sUri:"";this._type=iType?iType:null}function crtRcpSpanFromDomObject(oE){var sAmbText=Owa.Dom.Node.wrapDomNode(oE).get_TextContent();var oSpn=crtRcpSpan(oE.getAttribute("_dn"),oE.getAttribute("_em"),oE.getAttribute("_rt"),oE.getAttribute("_sa"),oE.getAttribute("_ao"),oE.getAttribute("_rf"),oE.getAttribute("_id"),oE.getAttribute("_ei"),oE.getAttribute("_uri"),0,0,0);var oInnerSpan=oSpn.childNodes[0];if(oInnerSpan.className=="rwUR"){Owa.Dom.Node.wrapDomNode(oInnerSpan).set_TextContent(sAmbText)}return oSpn}function normalizeDisplayName(oSpn){var sDisplayName=oSpn.getAttribute("_dn");var sSmtp=oSpn.getAttribute("_sa");var sEmailAddress=oSpn.getAttribute("_em");var sName="";if(isNoE(sDisplayName)){if(!isNoE(sSmtp)){sName=sSmtp}else if(!isNoE(sEmailAddress)){sName=sEmailAddress}}else{sName=sDisplayName}oSpn.setAttribute("_dn",sName)}function normalizeTitle(oSpn){var sSmtp=oSpn.getAttribute("_sa");var sUri=oSpn.getAttribute("_uri");var sTitle="";if(isNoE(sSmtp)){if(!isNoE(sUri)){sTitle=imns.IMUtils.NrmSipUri(sUri)}}else{sTitle=sSmtp}oSpn.setAttribute("title",sTitle)}function renderDN(oSpn,fBddy){var sDN=0;var sSA=oSpn.getAttribute("_sa");var sHtml;if(oSpn.getAttribute("_dn")){sDN=oSpn.getAttribute("_dn").trim()}if(sDN){var oRecip=crtRecipObjectFromDomObject(oSpn);var sAddress="";if((oSpn.getAttribute("_rt")!=RT_EX)&&(oSpn.getAttribute("_rt")!=RT_PDL)){sAddress=getSmtpOrCustomRoutingAddress(oRecip)}sHtml=htmlEnc(sDN)+sAddress}else if(sSA!=null){sHtml=htmlEnc(sSA)}if(fBddy){oSpn.innerHTML="<A id=bdyNm class=aUs>"+sHtml+"</A>"}else{oSpn.innerHTML=sHtml}}function setRecipientSpanClass(oSpn,fRO){var sC="rwRR";if(fRO){sC="rwRRO"}var iRF=validateNumericProp(oSpn.getAttribute("_rf"),0);var sId=oSpn.getAttribute("_id");var sRT=oSpn.getAttribute("_rt");var sEM=oSpn.getAttribute("_em");sC+=(iRF&R_DL)?" rwDL":"";var fIsPDL=((sRT==RT_PDL)&&(sId));if(isNoE(sEM)&&!fIsPDL&&!fRO){sC="rwUR"}oSpn.className=sC}function createOwaSpanFromRecip(oRecipient,fDoNotUpdateCache){return Owa.Dom.Node.wrapDomNode(createSpanFromRecip(oRecipient,fDoNotUpdateCache))}function createSpanFromRecip(oRecipient,fDoNotUpdateCache){var oSpanOuter=getEm("span");var oSpanInner=getEm("span");transferFromRecipToSpan(oRecipient,oSpanInner);var iType=getRecipientType(oRecipient);if((iType==RCP_RES)&&(!fDoNotUpdateCache)){oSpanInner.setAttribute("_acu","1")}oSpanOuter.appendChild(oSpanInner);return fixRSpn(oSpanOuter)}function createOwaRcpSpan(sDN,sEM,sRT,sSmtp,iAO,iRF,sId,iEI,sUri,fRO,fBddy,fNAcu,sGroupID,iType){return Owa.Dom.Node.wrapDomNode(crtRcpSpan(sDN,sEM,sRT,sSmtp,iAO,iRF,sId,iEI,sUri,fRO,fBddy,fNAcu,sGroupID,iType))}function crtRcpSpan(sDN,sEM,sRT,sSmtp,iAO,iRF,sId,iEI,sUri,fRO,fBddy,fNAcu,sGroupID,iType){var spn=getEm("span");var spnIn=getEm("span");if(sDN){spnIn.setAttribute("_dn",sDN)}if(sEM){spnIn.setAttribute("_em",sEM)}if(sSmtp){spnIn.setAttribute("_sa",sSmtp)}iAO=validateAddressOrigin(iAO);spnIn.setAttribute("_ao",iAO.toString());if(sRT){spnIn.setAttribute("_rt",sRT)}iRF=validateNumericProp(iRF,0);spnIn.setAttribute("_rf",iRF.toString());iEI=validateNumericProp(iEI,0);spnIn.setAttribute("_ei",iEI.toString());if(sId){spnIn.setAttribute("_id",sId)}if(sUri){spnIn.setAttribute("_uri",sUri)}iType=getInt(iType);if(isNaN(iType)){iType=null}if(iType){spnIn.setAttribute("_type",iType.toString())}if(fBddy&&sGroupID){spnIn.setAttribute("_gID",sGroupID)}setRecipientSpanClass(spnIn,fRO);if(spnIn.className!="rwUR"){normalizeTitle(spnIn);normalizeDisplayName(spnIn);renderDN(spnIn,fBddy);if(!fNAcu){spnIn.setAttribute("_acu","1")}}spn.appendChild(spnIn);return fixRSpn(spn,fRO,fBddy)}function addSpanToOEHStrctMessaging(oSpan,oRequest){var oRecipient=crtRecipObjectFromDomObject(oSpan);return convtToOEHStrctMessaging(oRecipient,oRequest)}function convtToOEHStrctMessaging(oRecipient,oRequest){var oRS=new oeSt(oRequest,"Rcp");oRS.add("DN",oRecipient._dn);oRS.add("EM",oRecipient._em);oRS.add("RT",oRecipient._rt);oRS.add("AO",oRecipient._ao);if(oRecipient._ao==AO_S){oRS.add("ID",oRecipient._id);oRS.add("EI",oRecipient._ei)}else if(oRecipient._ao==AO_D){oRS.add("RF",oRecipient._rf)}return oRS}function convtToOEHStrct(oRcp,oR){var oRS=new oeSt(oR,"recip");oRS.add("dn",oRcp._dn);oRS.add("sa",oRcp._sa);oRS.add("ra",oRcp._em);oRS.add("al",oRcp._al);oRS.add("rt",oRcp._rt);oRS.add("id",oRcp._id);oRS.add("ao",oRcp._ao);oRS.add("rf",oRcp._rf);oRS.add("ei",oRcp._ei?oRcp._ei:0);oRS.add("uri",isDf(typeof(oRcp._uri))?oRcp._uri:"");return oRS}function setRSpnEH(spn,fDsp,fBddy){spn.oncontextmenu=fDsp?null:onContextMenuSpnRw;spn.onclick=fDsp?null:onClkRcp;spn.ondrop=fDsp?null:canEvt;if(!fBddy)spn.ondblclick=fDsp?null:onDblClkRcp;if(Owa.Utility.isIE()){spn.onkeydown=fDsp?null:canEvt}else{spn.onkeydown=fDsp?null:onKDRcp}if(g_fIsIMEnab&&fDsp)dispJB(spn)}function fixRSpn(oSpn,fRO,fBddy){oSpn.tabIndex=-1;oSpn.setAttribute("contentEditable","false");var oSpnIn=oSpn.childNodes[0];oSpnIn.tabIndex=-1;if(Owa.Utility.isIE()){if(!fRO){oSpnIn.setAttribute("contentEditable","true")}}else{oSpnIn.setAttribute("contentEditable","false")}setRSpnEH(oSpnIn,fBddy);if(oSpnIn.title==null){oSpnIn.title=""}oSpnIn.id="spnR";return oSpn}function revtRSpn(fDsp){var rgsRW=new Array(TO,CC,BCC,FROM);for(var i=0;i<rgsRW.length;i++){var oRW=$(rgsRW[i]);if(!oRW)continue;var rgSpns=oRW.getAllDescendantsById("spnR");for(var j=0;j<rgSpns.length;j++){setRSpnEH(rgSpns[j]._get_DomNode(),fDsp)}}}function markRSpnForCacheUpd(oSpan){var oInnerSpan=oSpan.firstChild;if(getRcpT(oSpan)==RCP_RES){oInnerSpan.setAttribute("_acu","1");var oRecipient=crtRecipObjectFromDomObject(oInnerSpan);tryUpdCC(CC_ACC,getRcpStr(oRecipient),ADD)}return oSpan}function getRecipientType(oRecipient){if(oRecipient._em||((oRecipient._rt==RT_PDL)&&(oRecipient._id))){return RCP_RES}else if(isPendingRecipient(oRecipient)){return RCP_PND}else{return RCP_AMB}}function getRecipientSpanType(oRecipientSpan){if(Owa.Dom.Node.isInstance(oRecipientSpan)){return getRcpT(oRecipientSpan._oDomNode)}else{return getRcpT(oRecipientSpan)}}function getRcpT(oR){oR=getRcpSpn(oR);if(oR.nodeType==3){return RCP_PND}else if(oR.tagName=="SPAN"){var spnIn=oR.childNodes[0];if(spnIn.getAttribute("_em")||spnIn.getAttribute("_rt")==RT_PDL&&spnIn.getAttribute("_id")){return RCP_RES}else{return RCP_AMB}}}function getRcpSpn(oR){var oRP=oR.parentNode;return(oRP&&oRP.tagName=="SPAN")?oRP:oR}function getRcpW(oR){return getRcpSpn(oR).parentNode}function onContextMenuSpnRw(e){e=e||getEvt(this);if(this.parentNode&&this.parentNode.parentNode&&this.parentNode.parentNode.getAttribute("fSelOnly")){return}onRwCm(e)}function onRwCm(e){var oSpn=getEvtTgt(e);var cssClasses=oSpn.className;if(cssClasses.contains("rwRR")){shwRcpMnu(oSpn,e);canEvt(e)}else if(cssClasses.contains("rwUR")){shwAnrMnuForContextMenu(oSpn);canEvt(e)}}function onDblClkRcp(e){if(this.parentNode&&this.parentNode.parentNode&&this.parentNode.parentNode.getAttribute("fSelOnly"))return;if(e==null)e=getEvt(this);var o=getEvtTgt(e);if(o.className=="rwUR")return;if((Owa.Dom.Node.wrapDomNode(o).getAttribute("_rt")==RT_PDL)&&!isFtEnab(FT_CTS))return;onClicktoShowPropertiesSheet(o);canEvt(e)}function onClicktoShowPropertiesSheet(oSpn){if(!Owa.Dom.Node.isInstance(oSpn)){oSpn=Owa.Dom.Node.wrapDomNode(oSpn)}var sType;var sEm=null;if((getInt(oSpn.getAttribute("_ao"))==AO_O)||((getInt(oSpn.getAttribute("_ao"))==AO_D)&&!isFtEnab(FT_GAL))||((getInt(oSpn.getAttribute("_ao"))==AO_S)&&!isFtEnab(FT_CTS))){shwOneOffPrp(oSpn)}else if(hasNoRcpId(oSpn)){if((getInt(oSpn.getAttribute("_ao"))==AO_D)&&(oSpn.getAttribute("_em")!=null)){var sSa=urlEnc(oSpn.getAttribute("_em"));var oCallerSubPage=getSubPageFromRecipientSpan(oSpn);openItm("?ae=PreFormAction&a=OpenADObject&lDn="+sSa,null,null,RF_W,RF_H,oCallerSubPage)}else{OKDlg(L_NoMtchPrsnAddr,null,null,Owa.BUTTON_DIALOG_ICON.WARNING,L_NtFnd).show()}}else{if(getInt(oSpn.getAttribute("_ao"))==AO_S){if(oSpn.getAttribute("_rt")==RT_PDL){sType=IT_PDL}else{sType=IT_CNT}}else if(getInt(oSpn.getAttribute("_ao"))==AO_D){if(getInt(oSpn.getAttribute("_rf"))==R_DL){sType="ADDistList"}else{sType="AD.RecipientType.User"}sEm=((oSpn.getAttribute("_em")!=null)?urlEnc(oSpn.getAttribute("_em")):null)}var oCallerSubPage=getSubPageFromRecipientSpan(oSpn);openItmRdFm(sType,oSpn.getAttribute("_id"),sEm,oCallerSubPage)}}function onKDRcp(e){e=e||getEvt(this);if(Owa.Utility.isIE()){canEvt(e);return}var oS=getEvtTgt(e);var iKC=getKeyCode(e);var outerSpan=oS.parentNode;var oRW=getRcpW(outerSpan);var fIsReadonlyRW=Owa.Dom.Node.wrapDomNode(oRW).getExpando("_oControl").get_IsReadOnly();if(iKC==9||iKC==13||isCtrlKD(e)||isAltKD(e)||!Owa.Utility.isFirefox()||fIsReadonlyRW){return}if(isRecipientSpan(outerSpan)){oRW.focus();if(isChar(iKC)){var r=createTextRange();r.setCaretBefore(outerSpan);rn(outerSpan)}else if(!isShftKD(e)){switch(iKC){case 8:case 46:var r=createTextRange();r.setCaretBefore(outerSpan);rn(outerSpan);break;case 34:case 35:mvIP(oRW,0);break;case 33:case 36:mvIP(oRW,1);break;case 37:case 38:var r=createTextRange();r.setCaretBefore(outerSpan);break;case 39:case 40:var r=createTextRange();r.setCaretAfter(outerSpan);break}canEvt(e)}}}function onDblClkReadRcp(e){e=e||getEvt(this);var oSpn=getEvtTgt(e);if((oSpn.getAttribute("_rt")==RT_PDL)&&!isFtEnab(FT_CTS)){return}onClicktoShowPropertiesSheet(oSpn);canEvt(e)}function onClkRcp(e){e=e||getEvt(this);var oSpn=getEvtTgt(e);if(oSpn.className.contains("rwRR")||oSpn.className.contains("rwUR")){var oR=createSelectionRange();oR.selectRecipient(oSpn)}}if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/RecipientWellBase.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");var RECIPIENT_SPAN_ID="spnR";var FOCUS="focus";var BLUR="blur";Owa.RecipientType={To:1,Cc:2,Bcc:3,From:4};var TYPE_TO_NAME="To";var TYPE_CC_NAME="Cc";var TYPE_BCC_NAME="Bcc";var TYPE_FROM_NAME="From";Owa.UIControls.RecipientWellBase=function Owa$UIControls$RecipientWellBase(oElement,oParent){if(!oParent){oParent=Owa.Dom.Document.get_Current()}Owa.UIControls.RecipientWellBase.constructBase(this,[oElement,oParent])};var _oPrototype=Owa.UIControls.RecipientWellBase.prototype;_oPrototype.initialize=function Owa$UIControls$RecipientWellBase$initialize(){Owa.UIControls.RecipientWellBase.callBase(this,"initialize");var oRecipientWellBase=this._oElement;oRecipientWellBase.setExpando("_oControl",this);this._attachEvent(oRecipientWellBase,"dragstart",this._onDragStart);this._attachEvent(oRecipientWellBase,"dragenter",this._onDragEnter);this._attachEvent(oRecipientWellBase,"drop",this._onDrop)};_oPrototype.dispose=function Owa$UIControls$RecipientWellBase$dispose(){this._oElement.detachAllEvents();this._oElement.setExpando("_oControl",null);this._disposeRecipientSpans();Owa.UIControls.RecipientWellBase.callBase(this,"dispose")};_oPrototype.get_Recipients=function Owa$UIControls$RecipientWellBase$get_Recipients(){this._rgRecipientObjects=new Array();this._resetRecipientSpans();for(var i=0;i<this._rgRecipientSpans.length;++i){this._rgRecipientObjects.push(crtRecipObjectFromDomObject(this._rgRecipientSpans[i]._oDomNode))}return this._rgRecipientObjects};_oPrototype.get_RecipientSpans=function Owa$UIControls$RecipientWellBase$get_RecipientSpans(){this._resetRecipientSpans();return this._rgRecipientSpans};_oPrototype.addHandler=function Owa$UIControls$RecipientWellBase$addHandler(sEventName,fnCallback){sEventName=this.checkEventName(sEventName);this._attachEvent(this._oElement,sEventName,fnCallback)};_oPrototype.removeHandler=function Owa$UIControls$RecipientWellBase$removeHandler(sEventName,fnCallback){sEventName=this.checkEventName(sEventName);this._detachEvent(this._oElement,sEventName,fnCallback)};_oPrototype.checkEventName=function Owa$UIControls$RecipientWellBase$checkEventName(sEventName){if(Owa.Utility.isIE()){if(sEventName==FOCUS){sEventName="focusin"}else if(sEventName==BLUR){sEventName="focusout"}}return sEventName};_oPrototype.set_RecipientType=function Owa$UIControls$RecipientWellBase$set_RecipientType(iType){this._iRecipientType=iType};_oPrototype.get_RecipientType=function Owa$UIControls$RecipientWellBase$get_RecipientType(){if(!this._iRecipientType)return Owa.RecipientType.To;else return this._iRecipientType};_oPrototype.get_WellTypeName=function Owa$UIControls$RecipientWellBase$get_WellTypeName(){var sTypeName=TYPE_TO_NAME;var iType=this.get_RecipientType();switch(this.get_RecipientType()){case Owa.RecipientType.Cc:sTypeName=TYPE_CC_NAME;break;case Owa.RecipientType.Bcc:sTypeName=TYPE_BCC_NAME;break;case Owa.RecipientType.From:sTypeName=TYPE_FROM_NAME;break}return sTypeName};_oPrototype.set_IsReadOnly=function Owa$UIControls$RecipientWellBase$set_IsReadOnly(fReadOnly){this._fReadOnly=!!fReadOnly};_oPrototype.get_IsReadOnly=function Owa$UIControls$RecipientWellBase$get_IsReadOnly(){return this._fReadOnly};_oPrototype.set_IsSingleRecipient=function Owa$UIControls$RecipientWellBase$set_IsSingleRecipient(fSingle){this._fSingleWell=fSingle};_oPrototype.get_IsSingleRecipient=function Owa$UIControls$RecipientWellBase$get_IsSingleRecipient(){return this._fSingleWell};_oPrototype.set_IsADRecipientOnly=function Owa$UIControls$RecipientWellBase$set_IsADRecipientOnly(fADOnly){this._fADOnly=fADOnly};_oPrototype.get_IsADRecipientOnly=function Owa$UIControls$RecipientWellBase$get_IsADRecipientOnly(){return this._fADOnly};_oPrototype.set_IsRecipientMenuEnabled=function Owa$UIControls$RecipientWellBase$set_IsRecipientMenuEnabled(fEnable){this._oElement.setBoolAttribute("fSelOnly",fEnable)};_oPrototype.get_IsRecipientMenuEnabled=function Owa$UIControls$RecipientWellBase$get_IsRecipientMenuEnabled(){return this._oElement.getBoolAttribute("fSelOnly")};_oPrototype.set_MaxRows=function Owa$UIControls$RecipientWellBase$set_MaxRows(iMaxRows){this._iMaxRows=iMaxRows};_oPrototype.get_MaxRows=function Owa$UIControls$RecipientWellBase$get_MaxRows(){if(!isDf(typeof(this._iMaxRows))){return MAX_RECIPIENT_ROWS}return this._iMaxRows};_oPrototype.countRecipients=function Owa$UIControls$RecipientWellBase$countRecipients(){this._oPrototype._resetRecipientSpans();return this._rgRecipientSpans.length};_oPrototype.isEqual=function Owa$UIControls$RecipientWellBase$isEqual(oDivRecipientWell){return(this._oElement._oDomNode==oDivRecipientWell._oDomNode)};_oPrototype._disposeRecipientSpans=function Owa$UIControls$RecipientWellBase$_disposeRecipientSpans(){this._resetRecipientSpans();for(var i=0;i<this._rgRecipientSpans.length;i++){this._rgRecipientSpans[i].detachAllEvents();this._rgRecipientSpans[i]=null}this._rgRecipientSpans.length=0};_oPrototype._resetRecipientSpans=function Owa$UIControls$RecipientWellBase$_resetRecipientSpans(){this._rgRecipientSpans=this._get_Element().getAllDescendantsById(RECIPIENT_SPAN_ID)};_oPrototype._onDragStart=function Owa$UIControls$RecipientWellBase$_onDragStart(oEvent){oEvent.cancelBubble();oEvent.preventDefault()};_oPrototype._onDragEnter=function Owa$UIControls$RecipientWellBase$_onDragEntert(oEvent){oEvent.cancelBubble();oEvent.preventDefault()};_oPrototype._onDrop=function Owa$UIControls$RecipientWellBase$_onDrop(oEvent){oEvent.cancelBubble();oEvent.preventDefault()};Owa.UIControls.RecipientWellBase.createClass("Owa.UIControls.RecipientWellBase",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/RecipientWellBase.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/EditRecipientWell.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");var ON_RESIZE="onResize";var _iLineH=0;var MIN_LINE_HEIGHT=13;Owa.AutoCompleteEvent={Show:1,Hide:2,NavigateUp:3,NavigateDown:4,DeleteEntry:5,AddEntryToWell:6};Owa.RecipientState={Resolved:0x1,Ambiguous:0x2,Pending:0x4,All:(0x1|0x2|0x4)};Owa.SeparatorSpace="; ";Owa.Separator=";";var UPDATE_CACHE="_acu";var FONT_HEIGHT_DIV_ID="divFH";Owa.UIControls.EditRecipientWell=function Owa$UIControls$EditRecipientWell(oElement,oParent){Owa.UIControls.EditRecipientWell.constructBase(this,[oElement,oParent])};Owa.UIControls.EditRecipientWell.create=function Owa$UIControls$EditRecipientWell$create(oElement,oParent){var oEditRecipientWell=new Owa.UIControls.EditRecipientWell(oElement,oParent);return oEditRecipientWell};Owa.UIControls.EditRecipientWell.get_RequestOehStructs=function Owa$UIControls$EditRecipientWell$get_RequestOehStructs(oRequest,rgRecipients,fPending){var rgStructs=new Array();var oStruct=null;for(var i=0;i<rgRecipients.length;i++){var oNode=rgRecipients[i];if(fPending){oStruct=addPendingValueToOehStruct(oRequest,oNode.nodeValue)}else{var iRecipientState=getRecipientSpanType(oNode);var oRecipient=null;if(iRecipientState&Owa.RecipientState.Ambiguous){oRecipient=crtRecipObjectFromAmbiguousSpan(oNode)}else if(iRecipientState&Owa.RecipientState.Resolved){oRecipient=crtRecipObjectFromDomObject(oNode)}oStruct=convtToOEHStrctMessaging(oRecipient,oRequest)}rgStructs[i]=oStruct}return rgStructs};var _oPrototype=Owa.UIControls.EditRecipientWell.prototype;_oPrototype.initialize=function Owa$UIControls$EditRecipientWell$initialize(iRecipientType,fReadOnly){Owa.UIControls.EditRecipientWell.callBase(this,"initialize");this.set_IsReadOnly(fReadOnly,true);if(iRecipientType){this.set_RecipientType(iRecipientType)}this._resetRecipientData();this._initializeAutoCompleteMenu();var oEditRecipientWell=this._oElement;this._attachEvent(oEditRecipientWell,"paste",this._onPaste);this._attachEvent(oEditRecipientWell,"resize",this._onResize);this._attachEvent(oEditRecipientWell,"click",this._onClick);this._attachEvent(oEditRecipientWell,"dblclick",this._onClick);if(!this.get_HaveParentLoadCache()&&!this.fHasCache){this._getCache()}this._onResize()};_oPrototype.dispose=function Owa$UIControls$EditRecipientWell$dispose(){g_AnrPnd=0;this.oAutoCompleteFlags=null;this._oAutoCompleteCacheContainer=null;Owa.UIControls.EditRecipientWell.callBase(this,"dispose")};_oPrototype.set_Recipients=function Owa$UIControls$EditRecipientWell$set_Recipients(rgRecipientObjects,fUpdateCache){if(!rgRecipientObjects.length){throw"argument rgRecipientObjects cannot be empty"}for(var i=0;i<rgRecipientObjects.length;i++){}var sSeparator=Owa.SeparatorSpace;if(this.get_IsSingleRecipient()){this._oElement.set_TextContent("");sSeparator=""}for(var i=0;i<rgRecipientObjects.length;i++){if(this.get_IsSingleRecipient()&&(i==1)){break}var oRecipient=rgRecipientObjects[i];if(isPendingRecipient(oRecipient)){this._oElement.insertAdjacentText(Owa.ElementInsertionPoint.BeforeEnd,oRecipient._dn+sSeparator)}else{var oNewSpan=createSpanFromRecip(oRecipient,!fUpdateCache);this._oElement._oDomNode.appendChild(oNewSpan);if(!this.get_IsSingleRecipient()){this._oElement.insertAdjacentText(Owa.ElementInsertionPoint.BeforeEnd,sSeparator)}}}browserWorkAround(this._oElement._oDomNode);this._onResize()};_oPrototype.set_RecipientSpans=function Owa$UIControls$EditRecipientWell$set_RecipientSpans(rgRecipientSpans){if(!rgRecipientSpans.length){throw"argument rgRecipientSpans cannot be empty"}for(var i=0;i<rgRecipientSpans.length;i++){if(!isRecipientSpan(rgRecipientSpans[i]._oDomNode)){throw"argument is not of type Recipient Span"}}if(this.get_IsSingleRecipient()){this._oElement.set_TextContent("")}for(var i=0;i<rgRecipientSpans.length;i++){if(this.get_IsSingleRecipient()&&(i==1)){break}var oRecipientSpan=rgRecipientSpans[i];fixRSpn(oRecipientSpan._oDomNode);this._oElement.appendChild(oRecipientSpan);if(!this.get_IsSingleRecipient()){this._oElement.insertAdjacentText(Owa.ElementInsertionPoint.BeforeEnd,Owa.SeparatorSpace)}}browserWorkAround(this._oElement._oDomNode);this._onResize()};_oPrototype.get_ResolvedRecipientSpans=function Owa$UIControls$EditRecipientWell$get_ResolvedRecipientSpans(){var rgRecipientSpans=Owa.UIControls.EditRecipientWell.callBase(this,"get_RecipientSpans");var rgResolvedRecipientSpans=new Array();for(var i=0;i<rgRecipientSpans.length;++i){var oChild=rgRecipientSpans[i];var oOuterSpan=oChild.get_ParentElement();if(isRecipientSpan(oOuterSpan._oDomNode)){var iRecipientState=getRcpT(oOuterSpan._oDomNode);if(iRecipientState&Owa.RecipientState.Resolved){rgResolvedRecipientSpans.push(oChild)}}}return rgResolvedRecipientSpans};_oPrototype.get_Recipients=function Owa$UIControls$EditRecipientWell$get_Recipients(iRecipientState){if(!iRecipientState){iRecipientState=Owa.RecipientState.All}var oEditRecipientWell=this._oElement;var rgRecipientObjects=new Array();var rgChildNodes=oEditRecipientWell.getChildrenSnapshot();for(var i=0;i<rgChildNodes.length;i++){var oChild=rgChildNodes[i];if(isRecipientSpan(oChild._oDomNode)){var iState=getRcpT(oChild._oDomNode);var oInnerSpan=oChild.getDescendantsByTagName("span")[0];var oRecipient=null;if((iRecipientState&Owa.RecipientState.Ambiguous)&&(iState==Owa.RecipientState.Ambiguous)){oRecipient=crtRecipObjectFromAmbiguousSpan(oInnerSpan)}else if((iRecipientState&Owa.RecipientState.Resolved)&&(iState==Owa.RecipientState.Resolved)){oRecipient=crtRecipObjectFromDomObject(oInnerSpan)}if(oRecipient){rgRecipientObjects.push(oRecipient)}}else if(iRecipientState&Owa.RecipientState.Pending){var sValue=oChild.get_TextContent();var rgValues=sValue.split(Owa.Separator);for(var j=0;j<rgValues.length;j++){var sText=trmStrSpaces(rgValues[j]);if(sText){rgRecipientObjects.push(crtRecipObjectFromTextNode(sText))}}}}return rgRecipientObjects};_oPrototype.countRecipients=function Owa$UIControls$EditRecipientWell$countRecipients(){var iCount=0;var oEditRecipientWell=this._oElement;nrm(oEditRecipientWell._oDomNode);var rgChildNodes=oEditRecipientWell.getChildrenSnapshot();for(var i=0;i<rgChildNodes.length;i++){var oChild=rgChildNodes[i];if((oChild.get_NodeType()==1)&&(oChild.get_TagName().toLowerCase()=="span")){if(!isNoE(oChild.get_TextContent())){iCount++}}else{var s=oChild.get_TextContent();var rg=s.split(Owa.Separator);for(var j=0;j<rg.length;j++){var sPending=rg[j].trim();if(isValidPendingRecipient(sPending)){iCount++}}}}return iCount};_oPrototype.set_IsReadOnly=function Owa$UIControls$EditRecipientWell$set_IsReadOnly(fReadOnly,fInitialize){if(!fInitialize&&(this.get_IsReadOnly()==!!fReadOnly)){return}Owa.UIControls.EditRecipientWell.callBase(this,"set_IsReadOnly",[fReadOnly]);this.set_IsEnabled(!fReadOnly);if(fInitialize&&fReadOnly){return}this._set_Handlers(fReadOnly)};_oPrototype.set_Text=function Owa$UIControls$EditRecipientWell$set_Text(s){this._oElement.set_TextContent(s);if(s){this._cleanUpEditRecipientWell(true)}else{browserWorkAround(this._oElement._oDomNode);this._onResize()}this._resetRecipientSpans()};_oPrototype.get_Text=function Owa$UIControls$EditRecipientWell$get_Text(){return this._oElement.get_TextContent()};_oPrototype.set_Html=function Owa$UIControls$EditRecipientWell$set_Html(s){this._oElement.set_InnerHtml(s);if(s){this._cleanUpEditRecipientWell(true)}else{browserWorkAround(this._oElement._oDomNode);this._onResize()}this._resetRecipientSpans()};_oPrototype.get_Html=function Owa$UIControls$EditRecipientWell$get_Html(){return this._oElement.get_InnerHtml()};_oPrototype.set_HaveParentLoadCache=function Owa$UIControls$EditRecipientWell$set_HasParentLoadCache(fParentLoadsCache){this.fParentLoadsCache=fParentLoadsCache};_oPrototype.get_HaveParentLoadCache=function Owa$UIControls$EditRecipientWell$get_HaveParentLoadCache(){if(!isDf(typeof(this.fParentLoadsCache))){return true}else{return this.fParentLoadsCache}};_oPrototype.setFocus=function Owa$UIControls$EditRecipientWell$setFocus(fCollapseToBeginning){var oDiv=this._oElement._oDomNode;var fEmpty=(this._oElement.get_InnerHtml().length==0);if(fEmpty&&Owa.Utility.isFirefox()){browserWorkAround(oDiv);fEmpty=false}if(!fEmpty){var oR=createTextRange();oR.moveToElementText(oDiv);oR.collapse(fCollapseToBeginning);oR.select()}this._oElement.focus(1)};_oPrototype.set_IsEnabled=function Owa$UIControls$EditRecipientWell$set_IsEnabled(fEnable){if(this.get_IsReadOnly()){fEnable=false}if(!fEnable){this._handleCacheEvent(Owa.AutoCompleteEvent.Hide)}this._oElement.setAttribute("contentEditable",(fEnable?"true":"false"));this.fIsEnabled=fEnable};_oPrototype.get_IsEnabled=function Owa$UIControls$EditRecipientWell$get_IsEnabled(){if(!isDf(typeof(this.fIsEnabled))){return true}return this.fIsEnabled};_oPrototype.set_AutoCompleteSelection=function Owa$UIControls$EditRecipientWell$set_AutoCompleteSelection(oSelection){this._oSelection=oSelection};_oPrototype.get_AutoCompleteSelection=function Owa$UIControls$EditRecipientWell$get_AutoCompleteSelection(){return this._oSelection};_oPrototype.set_AutoCompleteContainer=function Owa$UIControls$EditRecipientWell$set_AutoCompleteContainer(oElement){this._oAutoCompleteCacheContainer=oElement};_oPrototype.get_AutoCompleteContainer=function Owa$UIControls$EditRecipientWell$get_AutoCompleteContainer(){if(!this._oAutoCompleteCacheContainer){return Owa.Dom.Document.get_Current().get_Body()}return this._oAutoCompleteCacheContainer};_oPrototype.set_OnUpdateFromCacheCallback=function Owa$UIControls$EditRecipientWell$set_OnUpdateFromCacheCallback(fnUpdateFromCacheCallback){this._fnUpdateFromCacheCallback=fnUpdateFromCacheCallback};_oPrototype.get_OnUpdateFromCacheCallback=function Owa$UIControls$EditRecipientWell$get_OnUpdateFromCacheCallback(){if(this._fnUpdateFromCacheCallback){return this._fnUpdateFromCacheCallback}return null};_oPrototype.set_IgnoreFromData=function Owa$UIControls$EditRecipientWell$set_IgnoreFromData(fIgnore){this._fIgnoreFrom=fIgnore};_oPrototype.get_IgnoreFromData=function Owa$UIControls$EditRecipientWell$get_IgnoreFromData(){return this._fIgnoreFrom};_oPrototype.set_OnAutoResolveCallback=function Owa$UIControls$EditRecipientWell$set_OnAutoResolveCallback(fnAutoResolveCallback){this._fnAutoResolveCallback=fnAutoResolveCallback};_oPrototype.get_OnAutoResolveCallback=function Owa$UIControls$EditRecipientWell$get_OnAutoResolveCallback(){if(this._fnAutoResolveCallback){return this._fnAutoResolveCallback}else{return null}};_oPrototype.get_OnResize=function Owa$UIControls$EditRecipientWell$get_OnResize(){return this._getEventHandlerCollection(ON_RESIZE)};_oPrototype.addRecipient=function Owa$UIControls$EditRecipientWell$addRecipient(sDN,sEM,sRT,sSmtp,iAO,iRF,sId,iEI,sUri,fRO,fUpdateCache){var oRecipient=new Recip(sDN,sEM,sSmtp,null,sRT,iAO,sId,iRF,iEI,sUri);this.set_Recipients([oRecipient],fUpdateCache)};_oPrototype.removeRecipient=function Owa$UIControls$EditRecipientWell$removeRecipient(oRecipientSpan){var oSpan=oRecipientSpan._oDomNode;var oSpanOuter=getRcpSpn(oSpan);var oNext=oSpanOuter.nextSibling;if(oNext){RemoveSemicolon(oNext)}var oPrev=oSpanOuter.previousSibling;while(oPrev&&oPrev.nodeType!=1){oPrev=oPrev.previousSibling}if(oPrev){var oR=createSelectionRange();oR.setCaretAfter(oPrev);this._oElement.focus()}else{mvIP(this._oElement._oDomNode,1)}rn(oSpanOuter);this._onResize()};_oPrototype.addRecipientFromCache=function Owa$UIControls$EditRecipientWell$addRecipientFromCache(){var oRecipient=Owa.UIControls.AutoCompleteCache.get_Instance().get_SelectedCacheEntry();var oNewElm=this._replaceNodeHelper(oRecipient);this._oElement.focus();if(oNewElm&&!Owa.Utility.isIE()){var r=createTextRange();var oNs=oNewElm.nextSibling;if(oNs&&(oNs.nodeType==3)&&(oNs.nodeValue==Owa.SeparatorSpace)){r.setCaretAfter(oNs)}else{r.setCaretAfter(oNewElm)}}this._handleCacheEvent(Owa.AutoCompleteEvent.Hide);var oInforDiv=$("divSmsReNumMis");if(oInforDiv)hideErr(oInforDiv);this._onResize();var fnUpdateFromCacheCallback=this.get_OnUpdateFromCacheCallback();if(fnUpdateFromCacheCallback){var oEventArgs={};oEventArgs.oRecipientWell=this;oEventArgs.oRecipient=oRecipient;oEventArgs.oNewElm=oNewElm;fnUpdateFromCacheCallback(oEventArgs)}};_oPrototype._onKeyDown=function Owa$UIControls$EditRecipientWell$_onKeyDown(oEvent){var iKeyCode=oEvent.get_KeyCodeForKeyUpDown();var fCanEvent=false;switch(iKeyCode){case 46:fCanEvent=this._handleCacheEvent(Owa.AutoCompleteEvent.DeleteEntry);case 8:if(g_AnrPnd||isAnrMenuOpen()){fCanEvent=true}else if(Owa.Utility.isSafari()&&(iKeyCode==8)&&!this.get_Text()){fCanEvent=true}else{var oR=createSelectionRange();if(!oR.selectionExists()){if(iKeyCode==46){oR.recipientDeleteKey(oEvent)}else{oR.recipientBackspaceKey(oEvent)}}if(Owa.Utility.isSafari()){setTimeout("removeBrs(wda(\""+this._oElement.get_Id()+"\"))",1)}if(!Owa.Utility.isIE()){this.get_RecipientSpans();if(this.get_RecipientSpans().length!=0){this._setTimeout(this._fixSemiColons,2)}}}break;case 9:if(!Owa.UIControls.AutoCompleteCache.isOpen()){break}case 13:var fCacheUpdate=this._handleCacheEvent(Owa.AutoCompleteEvent.AddEntryToWell);fCanEvent=true;if(oEvent.isCtrlKeyDown()||oEvent.isMacCtrlKeyDown()){fCanEvent=fCacheUpdate}break;case 27:fCanEvent=this._handleCacheEvent(Owa.AutoCompleteEvent.Hide);break;case 33:case 34:if(iKeyCode==33){this.setFocus(1)}else{this.setFocus(0)}this._handleCacheEvent(Owa.AutoCompleteEvent.Hide);fCanEvent=true;break;case 38:fCanEvent=this._handleCacheEvent(Owa.AutoCompleteEvent.NavigateUp);break;case 40:fCanEvent=this._handleCacheEvent(Owa.AutoCompleteEvent.NavigateDown);break}drty();if(this._isAutoResolve(oEvent)&&!fCacheUpdate){var oEventArgs={};oEventArgs.oRecipientWell=this;oEventArgs.isHotKey=(iKeyCode!=13);oEvent.preventDefault();oEvent.cancelBubble();this.get_OnAutoResolveCallback()(oEventArgs);return}if(fCanEvent){oEvent.cancelBubble();oEvent.preventDefault()}if(!fCacheUpdate){this._onResize()}};_oPrototype._isAutoResolve=function Owa$UIControls$EditRecipientWell$_isAutoResolve(oEvent){var fnAutoResolveCallback=this.get_OnAutoResolveCallback();var iKeyCode=oEvent.get_KeyCodeForKeyUpDown();if(fnAutoResolveCallback&&(isCheckNames(oEvent,iKeyCode))){return true}else{return false}};_oPrototype._onKeyPress=function Owa$UIControls$EditRecipientWell$_onKeyPress(oEvent){var iKeyCode=oEvent.get_CharCodeForKeyPress();if(59==iKeyCode){this._handleCacheEvent(Owa.AutoCompleteEvent.Hide);if(Owa.Utility.isIE()){anchortizeTxtNode(this._oElement.get_Id());if(!this.get_IsSingleRecipient()){var oCaret=createSelectionRange();oCaret.range.moveEnd("character",-1);var oElement=oCaret.range.parentElement();if(oElement.tagName=="A"){oElement.insertAdjacentText("AfterEnd",Owa.SeparatorSpace);oEvent.cancelBubble();oEvent.preventDefault()}}}}this._onResize()};_oPrototype._onKeyUp=function Owa$UIControls$EditRecipientWell$_onKeyUp(oEvent){var iKeyCode=oEvent.get_KeyCodeForKeyUpDown();if((isChar(iKeyCode)||iKeyCode==8)&&!oEvent.isCtrlKeyDown()&&!oEvent.isAltKeyDown()){this._handleCacheEvent(Owa.AutoCompleteEvent.Show)}else if((iKeyCode==35)&&!oEvent.isShiftKeyDown()){this.setFocus(0)}else if((iKeyCode==36)&&!oEvent.isShiftKeyDown()){this.setFocus(1)}};Owa.UIControls.EditRecipientWell.onResize=function Owa$UIControls$EditRecipientWell$onResize(oDivRecipientWell,iMaxRows,fIsSingleRecipient){initializeLineHeight(oDivRecipientWell.get_ParentElement().getDescendantById(FONT_HEIGHT_DIV_ID));_iLineH=((_iLineH==0)?MIN_LINE_HEIGHT:_iLineH);var iScrollHeight=(isNaN(oDivRecipientWell.get_ScrollHeight())?MIN_LINE_HEIGHT:oDivRecipientWell.get_ScrollHeight());var iLines=Math.floor(iScrollHeight/_iLineH);if((iLines==0)||fIsSingleRecipient){iLines=1}if(iLines>iMaxRows){iLines=iMaxRows}oDivRecipientWell.set_Height((_iLineH*iLines),"px");if($("divHdrMessage")){safeResizeBodies()}};_oPrototype._onResize=function Owa$UIControls$EditRecipientWell$_onResize(oEvent){var oEditRecipientWell=this._oElement;if(!oEditRecipientWell.get_IsShown()){return}Owa.UIControls.EditRecipientWell.onResize(oEditRecipientWell,this.get_MaxRows(),this.get_IsSingleRecipient());this._dispatchEvent(ON_RESIZE,this)};_oPrototype._onPaste=function Owa$UIControls$EditRecipientWell$_onPaste(oEvent){Owa.UIControls.AutoCompleteCache.hide();if(this.get_IsReadOnly()){oEvent.cancelBubble();oEvent.preventDefault()}else{this._setTimeout(this._cleanUpEditRecipientWell,1)}};_oPrototype._onFocus=function Owa$UIControls$EditRecipientWell$_onFocus(oEvent){this._fFocus=1;if(!this.fHasCache){this._getCache()}Owa.UIControls.AutoCompleteCache.get_Instance().resetRecipientWell(this)};_oPrototype._onBlur=function Owa$UIControls$EditRecipientWell$_onBlur(oEvent){this._fFocus=0};_oPrototype._onClick=function Owa$UIControls$EditRecipientWell$_onClick(oEvent){var oEditRecipientWell=this._oElement;if(Owa.Utility.isFirefox()){var isEmpty=(oEditRecipientWell.get_InnerHtml().length==0);if(isEmpty){oEditRecipientWell.set_InnerHtml("&nbsp;");mvIP(oEditRecipientWell._oDomNode,true)}oEditRecipientWell.focus()}this._handleCacheEvent(Owa.AutoCompleteEvent.Hide)};_oPrototype._initializeAutoCompleteMenu=function Owa$UIControls$EditRecipientWell$_initializeAutoCompleteMenu(){if(!Owa.UIControls.AutoCompleteCache.get_Instance()){Owa.UIControls.AutoCompleteCache.createInstance(this.get_AutoCompleteContainer())}this._set_AutoCompleteFlags()};_oPrototype._set_AutoCompleteFlags=function Owa$UIControls$EditRecipientWell$_set_AutoCompleteFlags(){var oAutoCompleteFlags={};oAutoCompleteFlags.isADDLAllw=isADDLAllw();oAutoCompleteFlags.isPDLAllw=isPDLAllw();oAutoCompleteFlags.iDefaultRoutingType=gtDftRT();oAutoCompleteFlags.isOnlyDefaultRouting=(isDf(typeof(a_fOlyDftRT))&&a_fOlyDftRT);oAutoCompleteFlags.isDefaultRoutingMobile=isDftRT(RT_MBL);this.oAutoCompleteFlags=oAutoCompleteFlags};_oPrototype._set_Handlers=function Owa$UIControls$EditRecipientWell$_set_Handlers(fReadOnly){if(!fReadOnly){this._attachHandlers()}else{this._detachHandlers()}};_oPrototype._attachHandlers=function Owa$UIControls$EditRecipientWell$_attachHandlers(){var oEditRecipientWell=this._oElement;this._attachEvent(oEditRecipientWell,"keydown",this._onKeyDown);this._attachEvent(oEditRecipientWell,"keypress",this._onKeyPress);this._attachEvent(oEditRecipientWell,"keyup",this._onKeyUp);if(Owa.Utility.isIE()){this._attachEvent(oEditRecipientWell,"focusin",this._onFocus);this._attachEvent(oEditRecipientWell,"focusout",this._onBlur)}else{this._attachEvent(oEditRecipientWell,"focus",this._onFocus);this._attachEvent(oEditRecipientWell,"click",this._onFocus);this._attachEvent(oEditRecipientWell,"blur",this._onBlur)}};_oPrototype._detachHandlers=function Owa$UIControls$EditRecipientWell$_detachHandlers(){var oEditRecipientWell=this._oElement;this._detachEvent(oEditRecipientWell,"keydown",this._onKeyDown);this._detachEvent(oEditRecipientWell,"keypress",this._onKeyPress);this._detachEvent(oEditRecipientWell,"keyup",this._onKeyUp);if(Owa.Utility.isIE()){this._detachEvent(oEditRecipientWell,"focusin",this._onFocus);this._detachEvent(oEditRecipientWell,"focusout",this._onBlur)}else{this._detachEvent(oEditRecipientWell,"focus",this._onFocus);this._detachEvent(oEditRecipientWell,"click",this._onFocus);this._detachEvent(oEditRecipientWell,"blur",this._onBlur)}};_oPrototype._handleCacheEvent=function Owa$UIControls$EditRecipientWell$_handleCacheEvent(iEvent){var iResult=0;switch(iEvent){case Owa.AutoCompleteEvent.Show:Owa.UIControls.AutoCompleteCache.get_Instance().show();iResult=1;break;case Owa.AutoCompleteEvent.DeleteEntry:if(Owa.UIControls.AutoCompleteCache.isOpen()){Owa.UIControls.AutoCompleteCache.get_Instance().deleteCacheEntry();iResult=1}break;case Owa.AutoCompleteEvent.AddEntryToWell:if(Owa.UIControls.AutoCompleteCache.isOpen()){this.addRecipientFromCache();iResult=1}break;case Owa.AutoCompleteEvent.Hide:if(Owa.UIControls.AutoCompleteCache.isOpen()){Owa.UIControls.AutoCompleteCache.hide();this.set_AutoCompleteSelection(null);iResult=1}break;case Owa.AutoCompleteEvent.NavigateUp:if(Owa.UIControls.AutoCompleteCache.isOpen()){if(Owa.UIControls.AutoCompleteCache.get_Instance().navigate(Owa.AutoCompleteEvent.NavigateUp)){iResult=1}else{Owa.UIControls.AutoCompleteCache.hide();iResult=0}}break;case Owa.AutoCompleteEvent.NavigateDown:if(Owa.UIControls.AutoCompleteCache.isOpen()){if(Owa.UIControls.AutoCompleteCache.get_Instance().navigate(Owa.AutoCompleteEvent.NavigateDown)){iResult=1}else{Owa.UIControls.AutoCompleteCache.hide();iResult=0}}break}return iResult};_oPrototype._getCache=function Owa$UIControls$EditRecipientWell$_getCache(){if(!this.fHasCache){this.fHasCache=true;try{if(!hasClientCacheAutoCompleteCache()){var oR=new oeReq("RecipWell","GetCache",0,this._createCallback(this._cbGetCache));oR.send()}else{g_rgoRcp=eval("new Array("+g_CC.sAcc+")")}}catch(e){}}};_oPrototype._cbGetCache=function Owa$UIControls$EditRecipientWell$_cbGetCache(oResponse){if(!cbOeh(oResponse)){return}try{var s=oResponse.sBody.toString();g_rgoRcp=eval("new Array("+s+")");tryUpdCC(CC_ACC,s,REF)}catch(e){}};_oPrototype._resetRecipientData=function Owa$UIControls$EditRecipientWell$_resetRecipientData(){this._rgPendingRecipients=new Array();this._rgResolvedRecipients=new Array();this._rgAmbiguousRecipients=new Array()};_oPrototype._loadRecipientData=function Owa$UIControls$EditRecipientWell$_loadRecipientData(){var iR=0;var oEditRecipientWell=this._oElement;if(Owa.Utility.isIE()){unlnk(oEditRecipientWell._oDomNode)}this._resetRecipientData();nrm(oEditRecipientWell._oDomNode);var rgChildNodes=oEditRecipientWell._oDomNode.childNodes;if(!rgChildNodes.length){return}var fSingleRecipientWell=this.get_IsSingleRecipient();var rgDel=new Array();for(var i=0;i<rgChildNodes.length;i++){var oChild=rgChildNodes[i];if((iR==1)&&fSingleRecipientWell){rgDel.push(oChild);continue}if(checkForEmptyTextNode(oChild)){continue}if((oChild.nodeType==1)&&!isRecipientSpan(oChild)){var sInnerText=Owa.Dom.Node.wrapDomNode(oChild).get_TextContent();if(isValidPendingRecipient(sInnerText)){var oTN=document.createTextNode(sInnerText);Owa.Dom.Node.wrapDomNode(oChild).replace(Owa.Dom.Node.wrapDomNode(oTN));oChild=rgChildNodes[i]}else{rgDel.push(oChild);continue}}var iT=getRcpT(oChild);if(iT==RCP_PND){var s=oChild.nodeValue;if(isValidPendingRecipient(s)){iR++;this._rgPendingRecipients.push(oChild)}}else if(iT==RCP_RES){iR++;this._rgResolvedRecipients.push(oChild.childNodes[0])}else if(iT==RCP_AMB){iR++;this._rgAmbiguousRecipients.push(oChild.childNodes[0])}}deleteInvalidNodes(rgDel)};_oPrototype._addPendingRecipientsToRequest=function Owa$UIControls$EditRecipientWell$_addPendingRecipientsToRequest(oRequest){if(this._rgPendingRecipients.length>0){var rgTextValues=new Array();for(var i=0;i<this._rgPendingRecipients.length;i++){rgTextValues.push(this._rgPendingRecipients[i].nodeValue)}oRequest.addRg(this.get_WellTypeName(this.get_RecipientType()),rgTextValues)}};_oPrototype._addCacheOehData=function Owa$UIControls$EditRecipientWell$_addCacheOehData(oRequest){var rgStructs=new Array();for(var i=0;i<this._rgResolvedRecipients.length;i++){if(this._rgResolvedRecipients[i].getAttribute(UPDATE_CACHE)){var oInnerSpan=this._rgResolvedRecipients[i];var oRecipient=crtRecipObjectFromDomObject(oInnerSpan);rgStructs.push(convtToOEHStrct(oRecipient,oRequest));tryUpdCC(CC_ACC,getRcpStr(oRecipient),ADD);oInnerSpan.setAttribute(UPDATE_CACHE,"0")}}return rgStructs};_oPrototype._replacePendingNodes=function Owa$UIControls$EditRecipientWell$_replacePendingNodes(oResponseDiv){if(!oResponseDiv){return}var rgDivChk=oResponseDiv.getAllDescendantsById("chk");if(!rgDivChk.length){return}for(var i=0;i<rgDivChk.length;i++){this._replacePendingNode(i,rgDivChk[i])}this._fixSemiColons();this._onResize()};_oPrototype._replacePendingNode=function Owa$UIControls$EditRecipientWell$_replacePendingNode(iPnd,oDivChunk){var oPendingNode=this._rgPendingRecipients[iPnd];var oDivChunkDom=oDivChunk._oDomNode;if(oDivChunkDom.childNodes.length==0){rn(oPendingNode);return}if(Owa.Utility.isIE()&&(oPendingNode.nodeType==3)){try{var sStr=oPendingNode.data}catch(e){return}}var oSpan=fixRSpn(oDivChunkDom.childNodes[0]);oSpan=markRSpnForCacheUpd(oSpan);replaceNode(oPendingNode,oSpan);while(oDivChunkDom.childNodes.length){var oSpanNew=oDivChunkDom.childNodes[0];oSpanNew=fixRSpn(oSpanNew);oSpanNew=markRSpnForCacheUpd(oSpanNew);oSpan=insertAdjacentElementAfterEnd(oSpan,oSpanNew)}};_oPrototype._addAllRecipientsToRequest=function Owa$UIControls$EditRecipientWell$_addAllRecipientsToRequest(oRequest){var rgTotalStructs=new Array();if(this._rgPendingRecipients.length>0){rgTotalStructs=rgTotalStructs.concat(Owa.UIControls.EditRecipientWell.get_RequestOehStructs(oRequest,this._rgPendingRecipients,true))}if(this._rgAmbiguousRecipients.length>0){rgTotalStructs=rgTotalStructs.concat(Owa.UIControls.EditRecipientWell.get_RequestOehStructs(oRequest,this._rgAmbiguousRecipients,false))}if(this._rgResolvedRecipients.length>0){rgTotalStructs=rgTotalStructs.concat(Owa.UIControls.EditRecipientWell.get_RequestOehStructs(oRequest,this._rgResolvedRecipients,false))}if(rgTotalStructs.length){var sTypeName=this.get_WellTypeName(this.get_RecipientType());if(this.get_IsSingleRecipient()){oRequest.addSt(sTypeName,rgTotalStructs[0])}else{oRequest.addRgSt(sTypeName,rgTotalStructs)}}};function addPendingValueToOehStruct(oRequest,sTextNodeValue){var oRS=new oeSt(oRequest,"Rcp");oRS.add("PND",sTextNodeValue);return oRS}_oPrototype._replaceNodeHelper=function Owa$UIControls$EditRecipientWell$_replaceNodeHelper(oRecipient){var oSelRecipient=this.get_AutoCompleteSelection();if(!oSelRecipient){return null}var oSrcNd=null;var oDivRecipientWell=this._oElement._oDomNode;var oSpnNew=createSpanFromRecip(oRecipient);if(Owa.Utility.isIE()){var oParentElement=oSelRecipient.parentElement();if(oParentElement.tagName=="A"){oSrcNd=oParentElement}else{oSrcNd=oSelRecipient.getStartRecipientTextNode(oDivRecipientWell)}if(!oSrcNd){return null}oDivRecipientWell.insertBefore(oSpnNew,oSrcNd);oDivRecipientWell.removeChild(oSrcNd)}else{oSelRecipient.insertNode(oSpnNew)}browserWorkAround(oDivRecipientWell);nrm(oDivRecipientWell);this._fixSemiColons();return oSpnNew};_oPrototype._fixSemiColons=function Owa$UIControls$EditRecipientWell$_fixSemiColons(){var div=this._oElement._oDomNode;var rgoCN=div.childNodes;if(rgoCN.length==0){return}if(!Owa.Utility.isIE()){var rgoSpns=new Array();for(var i=0;i<rgoCN.length;i++){var o=rgoCN[i];if(o.nodeType==1){rgoSpns.push(o)}}rgoSpns.pop();rgoCN=rgoSpns}for(var i=0;i<rgoCN.length;i++){var o=rgoCN[i];if((o.nodeType!=3)&&(o.nextSibling)){var oNs=o.nextSibling;var sTxt=Owa.Dom.Node.wrapDomNode(oNs).get_TextContent();sTxt=trmStrSpaces(sTxt);if(Owa.Utility.isIE()){if((oNs.nodeType!=3)&&!((oNs.tagName=="A")&&(sTxt.charAt(0)==Owa.Separator))){addSeparator(o)}}else{if(oNs.nodeType==3){if(sTxt.charAt(0)!=Owa.Separator){oNs.insertData(0,Owa.SeparatorSpace)}else if(sTxt.charAt(1)!=" "){oNs.insertData(1," ")}}else{addSeparator(o)}}}}browserWorkAround(div)};_oPrototype._cleanUpEditRecipientWell=function Owa$UIControls$EditRecipientWell$_cleanUpEditRecipientWell(fDoNotSetCaret){var oEditRecipientWell=this._oElement;var oDivRw=this._oElement._oDomNode;var iNodeCount=0;var oCaretNode=null;var fisIE=Owa.Utility.isIE();if(!fDoNotSetCaret&&!fisIE){var oCaret=createSelectionRange();oCaretNode=oCaret.range.startContainer}if(Owa.Utility.isSafari()){var rgSpns=oDivRw.getElementsByTagName("SPAN");for(var i=rgSpns.length-1;i>=0;i--){var oSpn=rgSpns[i];if(isSafariClipboardSpan(oSpn)){Owa.Dom.NonSingletonNode._removeDomNode(oSpn,false)}}var rgDivs=oDivRw.getElementsByTagName("DIV");for(var i=rgDivs.length-1;i>=0;i--){var oDiv=rgDivs[i];Owa.Dom.NonSingletonNode._removeDomNode(oDiv,false)}removeBrs(oDivRw)}var rgChildNodes=oDivRw.childNodes;if(!rgChildNodes.length){return}var fSingleRecipientWell=this.get_IsSingleRecipient();var rgDelete=new Array();if(fisIE){var rgTextNodes=new Array()}for(var i=0;i<rgChildNodes.length;i++){var oChild=rgChildNodes[i];if((iNodeCount==1)&&fSingleRecipientWell){rgDelete.push(oChild);continue}if(checkForSemicolonSeparator(oChild)){continue}if(checkForEmptyTextNode(oChild)){rgDelete.push(oChild);continue}if((oChild.nodeType==1)&&(!isRecipientSpan(oChild))){var sInnerText=Owa.Dom.Node.wrapDomNode(oChild).get_TextContent();if(isValidPendingRecipient(sInnerText)){iNodeCount++;var oTextNode=document.createTextNode(sInnerText);Owa.Dom.Node.wrapDomNode(oChild).replace(Owa.Dom.Node.wrapDomNode(oTextNode));if(fisIE){rgTextNodes.push(oTextNode)}}else{rgDelete.push(oChild)}continue}var iT=getRcpT(oChild);if((iT==RCP_RES)||(iT==RCP_AMB)){iNodeCount++;var oInnerSpan=oChild.childNodes[0];var oNewRecipientSpan=crtRcpSpanFromDomObject(oInnerSpan);if(oChild.id){oNewRecipientSpan.id=oChild.id;oNewRecipientSpan.setAttribute("_sWid",oChild.getAttribute("_sWid"))}if(!fisIE&&(oCaretNode==oChild)){oCaretNode=oNewRecipientSpan}Owa.Dom.Node.wrapDomNode(oChild).replace(Owa.Dom.Node.wrapDomNode(oNewRecipientSpan))}else if(iT==RCP_PND){if(fisIE){rgTextNodes.push(oChild)}iNodeCount++}}deleteInvalidNodes(rgDelete);if(fisIE&&rgTextNodes.length){processTextNodesForIE(rgTextNodes,oDivRw,fSingleRecipientWell)}if(!fSingleRecipientWell){this._fixSemiColons()}else{browserWorkAround(oDivRw)}this._onResize()};function processTextNodesForIE(rgTextNodes,oDivRw,fSingleRecipientWell){var iPending=0;for(var i=0;i<rgTextNodes.length;i++){if(fSingleRecipientWell&&iPending){break}var oNode=rgTextNodes[i];var sText=oNode.nodeValue;var rg=sText.split(Owa.Separator);for(var j=0;j<rg.length;j++){if(fSingleRecipientWell&&iPending){break}var sPending=rg[j].trim();if(isValidPendingRecipient(sPending)){var oA=createAnchorForIE(oNode,sPending,oDivRw);iPending++}}oDivRw.removeChild(oNode)}}function createAnchorForIE(oSrcNode,sText,oDivRw){var oA=getEm("A");oA.innerText=sText;oDivRw.insertBefore(oA,oSrcNode);return oA}function deleteInvalidNodes(rgDelete){for(var i=0;i<rgDelete.length;i++){var oNode=rgDelete[i];var oNext=oNode.nextSibling;if(oNext){RemoveSemicolon(oNext)}rn(oNode)}}function nrm(oElement){if(!Owa.Utility.isIE()){oElement.normalize()}else{var oFirst=oElement.firstChild;while(oFirst){if(oFirst.nodeType==3){var oNext=oFirst.nextSibling;while(oNext&&oNext.nodeType==3){oFirst.appendData(oNext.data);var oTemp=oNext;oNext=oTemp.nextSibling;oTemp.removeNode()}}oFirst=oFirst.nextSibling}}}function trmStrSpaces(sRcp){return sRcp.replace(new RegExp("^(\\s|\\u00a0)+"),'').replace(new RegExp("(\\s|\\u00a0)+$"),'')}function anchortizeTxtNode(sRw){var oRW=wda(sRw);var oSrcNd;var oSel=createRecipientRange(document);if(!oSel){return null}oSrcNd=oSel.getStartRecipientTextNode(oRW);if(!oSrcNd){return null}if(!isValidRecipientTextNode(oSrcNd.data)){return null}createAnchorForIE(oSrcNd,oSrcNd.data,oRW);oRW.removeChild(oSrcNd)}function addSeparator(oSpn){iatae(oSpn,Owa.SeparatorSpace)}function isSafariClipboardSpan(oSpn){if((oSpn.tagName=="SPAN")&&((oSpn.className=="Apple-style-span")||(oSpn.className=="Apple-converted-space"))){return true}return false}function unlnk(oDivRecipientWell){if(Owa.Utility.isIE()){var rgAnchors=oDivRecipientWell.getElementsByTagName("A");if(!rgAnchors.length){return}var oRng=createTextRange();oRng.moveToElementText(oDivRecipientWell);Owa.ExecCommand.execute(oRng.range,"unlink")}}function checkForEmptyTextNode(oN){return((oN.nodeType==3)&&!isValidPendingRecipient(oN.data))}function checkForSemicolonSeparator(oN){if(oN.nodeType!=3){return false}var sTxt=oN.nodeValue.trim();var sNewValue="";for(var i=0;i<sTxt.length;i++){var iCharCode=sTxt.charCodeAt(i);if(isEmptyChar(iCharCode)){continue}if(!isSemicolon(iCharCode)){return false}sNewValue+=sTxt.charAt(i)}if(sNewValue==Owa.Separator){oN.nodeValue=Owa.SeparatorSpace;return true}return false}function getHotKeyCharCode(sHotKey){return sHotKey.split("+")[1].charCodeAt(0)}function isCheckNames(oEvent,iKeyCode){var iCtrlCheckName=getHotKeyCharCode(L_HkRcps1);var iAltCheckName=getHotKeyCharCode(L_HkRcps2);if(iKeyCode==13){return true}else if((oEvent.isCtrlKeyDown()||oEvent.isMacCtrlKeyDown())&&(iKeyCode==iCtrlCheckName)){return true}else if(oEvent.isAltKeyDown()&&(iKeyCode==iAltCheckName)){return true}return false}function initializeLineHeight(oDivForHeight){if(_iLineH){return}var oTempDiv;if(!oDivForHeight){var oDocument=Owa.Dom.Document.get_Current();oTempDiv=oDocument.createElement("div");oTempDiv.set_Id(FONT_HEIGHT_DIV_ID);oDocument.appendChild(oTempDiv);oDivForHeight=oTempDiv}oDivForHeight.set_TextContent("M");_iLineH=oDivForHeight.get_ClientHeight();oDivForHeight.set_TextContent("");if(oTempDiv){oTempDiv.remove(true)}}function replaceNode(oNode,oNewNode){if((typeof oNode.replaceNode)!="undefined"){oNode.replaceNode(oNewNode)}else{oNode.parentNode.replaceChild(oNewNode,oNode)}}function insertAdjacentElementAfterEnd(oElement,oNewElement){if((oElement.nodeType==Owa.NodeType.Element)&&((typeof oElement.insertAdjacentElement)!="undefined")){oElement.insertAdjacentElement(Owa.ElementInsertionPoint.AfterEnd,oNewElement)}else{oElement.parentNode.insertBefore(oNewElement,oElement.nextSibling)}return oNewElement}Owa.UIControls.EditRecipientWell.createClass("Owa.UIControls.EditRecipientWell",Owa.UIControls.RecipientWellBase)})();g_fModuleLoaded[".\\uicontrols/EditRecipientWell.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/SingleEditRecipientWell.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");var DEFAULT_TEXT_CSS="addBdyTxtFaded";var TEXT_CSS="addBdyTxt";Owa.UIControls.SingleEditRecipientWell=function Owa$UIControls$SingleEditRecipientWell(oElement,oParent){Owa.UIControls.SingleEditRecipientWell.constructBase(this,[oElement,oParent])};Owa.UIControls.SingleEditRecipientWell.create=function Owa$UIControls$SingleEditRecipientWell$create(oElement,oParent){var oSingleEditRecipientWell=new Owa.UIControls.SingleEditRecipientWell(oElement,oParent);return oSingleEditRecipientWell};var _oPrototype=Owa.UIControls.SingleEditRecipientWell.prototype;_oPrototype.initialize=function Owa$UIControls$SingleEditRecipientWell$initialize(iRecipientType,fReadOnly){Owa.UIControls.SingleEditRecipientWell.callBase(this,"initialize",[iRecipientType,fReadOnly]);this.set_IsSingleRecipient(true)};_oPrototype.get_Recipient=function Owa$UIControls$SingleEditRecipientWell$get_Recipient(){var rgRecipientObjects=new Array();rgRecipientObjects=Owa.UIControls.SingleEditRecipientWell.callBase(this,"get_Recipients");var oRecipient=null;if(rgRecipientObjects.length){oRecipient=rgRecipientObjects[0]}return oRecipient};_oPrototype.set_DefaultText=function Owa$UIControls$SingleEditRecipientWell$set_DefaultText(sDefaultText,fUpdateText){this._sDefaultText=sDefaultText;if(fUpdateText){this._updateTextCss(true);this._oElement.set_TextContent(sDefaultText)}};_oPrototype.get_DefaultText=function Owa$UIControls$SingleEditRecipientWell$get_DefaultText(){if(this._sDefaultText)return this._sDefaultText;else return null};_oPrototype._onKeyUpSingleWell=function Owa$UIControls$SingleEditRecipientWell$_onKeyUpSingleWell(oEvent){var iKeyCode=oEvent.get_KeyCodeForKeyUpDown();if(!this._isActionKey(iKeyCode)&&this.get_RecipientSpans().length){this._handleCacheEvent(Owa.AutoCompleteEvent.Hide)}};_oPrototype._onKeyPressSingleWell=function Owa$UIControls$SingleEditRecipientWell$_onKeyPressSingleWell(oEvent){var iCharCode=oEvent.get_CharCodeForKeyPress();if(59==iCharCode){oEvent.cancelBubble();oEvent.preventDefault()}};_oPrototype._onKeyDownSingleWell=function Owa$UIControls$SingleEditRecipientWell$_onKeyDownSingleWell(oEvent){var iKeyCode=oEvent.get_KeyCodeForKeyUpDown();if((iKeyCode==13)||(iKeyCode==9)||(iKeyCode==46)||(iKeyCode==8)||oEvent.isAltKeyDown()||oEvent.isCtrlKeyDown()){return}if(this.get_RecipientSpans().length){var sText=this.get_Text();if((iKeyCode==37||iKeyCode==39)){this.set_Text(sText)}else{this.set_Text("")}mvIP(this._oElement._oDomNode,(iKeyCode!=37))}oEvent.cancelBubble()};_oPrototype._onFocusSingleWell=function Owa$UIControls$SingleEditRecipientWell$_onFocusSingleWell(oEvent){if(this.get_DefaultText()){if(this._oElement.get_TextContent()==this.get_DefaultText()){this._updateTextCss(false);this.set_Text("")}}};_oPrototype._onBlurSingleWell=function Owa$UIControls$SingleEditRecipientWell$_onBlurSingleWell(oEvent){if(this.get_DefaultText()){if(this._oElement.get_TextContent().trim()==""){this.set_DefaultText(this.get_DefaultText(),true)}}};var rgKeyActions=[13,9,8,46,37,39];_oPrototype._set_Handlers=function Owa$UIControls$SingleEditRecipientWell$_set_Handlers(fReadOnly){Owa.UIControls.SingleEditRecipientWell.callBase(this,"_set_Handlers",[fReadOnly]);if(!fReadOnly){this._addHandlers()}else{this._removeHandlers()}};_oPrototype._addHandlers=function Owa$UIControls$SingleEditRecipientWell$_addHandlers(){this.addHandler("focus",this._onFocusSingleWell);this.addHandler("blur",this._onBlurSingleWell);this.addHandler("keydown",this._onKeyDownSingleWell);this.addHandler("keypress",this._onKeyPressSingleWell);this.addHandler("keyup",this._onKeyUpSingleWell)};_oPrototype._removeHandlers=function Owa$UIControls$SingleEditRecipientWell$_removeHandlers(){this.removeHandler("focus",this._onFocusSingleWell);this.removeHandler("blur",this._onBlurSingleWell);this.removeHandler("keydown",this._onKeyDownSingleWell);this.removeHandler("keypress",this._onKeyPressSingleWell);this.removeHandler("keyup",this._onKeyUpSingleWell)};_oPrototype._isActionKey=function Owa$UIControls$SingleEditRecipientWell$_isActionKey(iKeyCode){for(var i=0;i<rgKeyActions.length;i++){if(iKeyCode==rgKeyActions[i]){return true}}return false};_oPrototype._updateTextCss=function Owa$UIControls$SingleEditRecipientWell$_updateTextCss(fDefault){this._oElement.removeCssClass(fDefault?TEXT_CSS:DEFAULT_TEXT_CSS);this._oElement.addCssClass(fDefault?DEFAULT_TEXT_CSS:TEXT_CSS)};Owa.UIControls.SingleEditRecipientWell.createClass("Owa.UIControls.SingeEditRecipientWell",Owa.UIControls.EditRecipientWell)})();g_fModuleLoaded[".\\uicontrols/SingleEditRecipientWell.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/FindSomeoneRecipientWell.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");var RECIPIENT_SPAN_ID="spnR";Owa.UIControls.FindSomeone=function Owa$UIControls$FindSomeone(oSubPage,oElement,oParent){Owa.UIControls.FindSomeone.constructBase(this,[oElement,oParent]);this.set_SubPage(oSubPage);this.sConsumerId=null};Owa.UIControls.FindSomeone.create=function Owa$UIControls$FindSomeone$create(oSubPage,oElement,oParent){var oFindSomeoneControl=new Owa.UIControls.FindSomeone(oSubPage,oElement,oParent);oFindSomeoneControl.initialize();return oFindSomeoneControl};var _oPrototype=Owa.UIControls.FindSomeone.prototype;_oPrototype.initialize=function Owa$UIControls$FindSomeone$initialize(){Owa.UIControls.FindSomeone.callBase(this,"initialize");this._oRecipientWell=this.addResource(Owa.UIControls.SingleEditRecipientWell.create(this._oElement));this._oRecipientWell.set_SubPage(this.get_SubPage());this._oRecipientWell.set_OnAutoResolveCallback(this._createCallback(this.checkNames));this._oRecipientWell.set_DefaultText(L_FndSo);this._oRecipientWell.set_OnUpdateFromCacheCallback(this._createCallback(this._onCompleteResolveOrUpdateFromCache));this._oRecipientWell.initialize();this.oAnrOptions=getAnrOptions(false,true);this.sConsumerId=Owa.Components.RecipientWellManager.get_Instance().registerWells([this._oRecipientWell],this.oAnrOptions)};_oPrototype.dispose=function Owa$UIControls$FindSomeone$dispose(){Owa.Components.RecipientWellManager.get_Instance().disposeWells(this.sConsumerId);Owa.UIControls.FindSomeone.callBase(this,"dispose")};_oPrototype.checkNames=function Owa$UIControls$FindSomeone$checkNames(){Owa.Components.RecipientWellManager.get_Instance().resolveWells(this.sConsumerId,this._createCallback(this._onCompleteResolveOrUpdateFromCache))};_oPrototype._onCompleteResolveOrUpdateFromCache=function Owa$UIControls$FindSomeone$_onCompleteResolveOrUpdateFromCache(iEventResults){var oRecipient=this._oRecipientWell.get_Recipient();if(oRecipient){var iRecipientType=getRecipientType(oRecipient);if(iRecipientType==RCP_RES){var oRecipientSpan=this._oElement.getDescendantById(RECIPIENT_SPAN_ID);onClicktoShowPropertiesSheet(oRecipientSpan);setTimeout("removeBrs(wda(\""+this._oRecipientWell._oElement.get_Id()+"\"))",1);this._oRecipientWell._setTimeout(this._oRecipientWell._onResize,2);return}}this._oRecipientWell.setFocus(0)};Owa.UIControls.FindSomeone.createClass("Owa.UIControls.FindSomeone",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/FindSomeoneRecipientWell.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/RecipientAutoCompleteCache.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");var MENU_ID="cchBx";var MENU_CLASS="rwACO";var MENUITEM_ID_PREFIX="AC";var MENUITEM_NAME_CLASS="rwACDn";var MENUITEM_ADDRESS_CLASS="rwACEm";var UNSELECTED="rwACIU";var SELECTED="rwACIH";var oInstance=null;Owa.UIControls.AutoCompleteCache=function Owa$UIControls$AutoCompleteCache(oElement,oParent){Owa.UIControls.AutoCompleteCache.constructBase(this,[oElement,oParent])};Owa.UIControls.AutoCompleteCache._createElement=function Owa$UIControls$AutoCompleteCache$_createElement(oParent){var oElement=Owa.Dom.Document.get_Current().createElement("div");oElement.set_IsShown(false);oParent.insertAdjacentElement(Owa.ElementInsertionPoint.AfterBegin,oElement);oElement.set_CssClasses([MENU_CLASS]);oElement.set_Id(MENU_ID);return oElement};Owa.UIControls.AutoCompleteCache.get_Instance=function Owa$UIControls$AutoCompleteCache$get_Instance(){return oInstance};Owa.UIControls.AutoCompleteCache.createInstance=function Owa$UIControls$AutoCompleteCache$createInstance(oParent){var oElement=Owa.UIControls.AutoCompleteCache._createElement(oParent);oInstance=new Owa.UIControls.AutoCompleteCache(oElement,oParent);oInstance.initialize();return oInstance};Owa.UIControls.AutoCompleteCache.hide=function Owa$UIControls$AutoCompleteCache$hide(){if(oInstance&&oInstance.get_IsOpen()){oInstance.hide()}};Owa.UIControls.AutoCompleteCache.isOpen=function Owa$UIControls$AutoCompleteCache$isOpen(){if(oInstance&&oInstance.get_IsOpen()){return true}return false};var _oPrototype=Owa.UIControls.AutoCompleteCache.prototype;_oPrototype.initialize=function Owa$UIControls$AutoCompleteCache$initialize(){Owa.UIControls.AutoCompleteCache.callBase(this,"initialize");this._attachEvent(this._oParent,"mousedown",this._onMouseDown);this._attachEvent(this._oParent,"mouseup",this._onMouseUp);this._rgMatchItems=new Array();this._rgMenuItems=new Array();this._iSelectedItemIndex=-1};_oPrototype.dispose=function Owa$UIControls$AutoCompleteCache$dispose(){this._detachEvent(this._oParent,"mousedown",this._onMouseDown);this._detachEvent(this._oParent,"mouseup",this._onMouseUp);this._rgMatchItems=null;this._rgMenuItems=null;Owa.UIControls.AutoCompleteCache.callBase(this,"dispose")};_oPrototype.resetRecipientWell=function Owa$UIControls$AutoCompleteCache$resetRecipientWell(oRecipientWell){if(oRecipientWell&&!oRecipientWell.get_IsDisposed()){this.oRecipientWell=oRecipientWell;var oParent=this.oRecipientWell.get_AutoCompleteContainer();if(this._oParent._oDomNode!=oParent._oDomNode){this._resetParentContainer(oParent)}this._oElement.moveToTop()}};_oPrototype._resetParentContainer=function Owa$UIControls$AutoCompleteCache$_resetParentContainer(oParent){this._oElement.remove();this._oElement=Owa.UIControls.AutoCompleteCache._createElement(oParent);this._oParent=oParent};_oPrototype.set_IsOpen=function Owa$UIControls$AutoCompleteCache$set_IsOpen(fOpen){this._fOpen=fOpen};_oPrototype.get_IsOpen=function Owa$UIControls$AutoCompleteCache$get_IsOpen(){return(this._fOpen?true:false)};_oPrototype.show=function Owa$UIControls$AutoCompleteCache$show(){var sPartialString=null;this.hide();if(this._isRecipientWellValid()&&this.oRecipientWell._oElement.hasChildNodes()){var oSel=null;try{oSel=createSelectionRange();var oParent=oSel.parentElement();if(!oParent||(oParent.tagName=="SPAN")){return}}catch(e){return}var oSelRecipient=createRecipientRange(document,oSel);if(!oSelRecipient){return}sPartialString=trmStrSpacesAndSemicolons(oSelRecipient.getText());if(!isNoE(sPartialString)){this._get_Matches(sPartialString,this.oRecipientWell.get_IsADRecipientOnly())}if(this._rgMatchItems.length){for(var i=0;i<this._rgMatchItems.length;i++){this._addCacheEntry(this._rgMatchItems[i],i)}if(isAnrMenuOpen()){g_AnrCtxMnu.close()}this._oElement.set_IsShown(true);this.set_IsOpen(true);this.oRecipientWell.set_AutoCompleteSelection(oSelRecipient);var oCchBx=this._oElement._oDomNode;var oStyle=oCchBx.style;var iCW=window.document.body.clientWidth;var iMW=oCchBx.offsetWidth;var iL=oSel.offset().iX;if(iMW>0.5*iCW){oStyle.overflow="hidden";oStyle.textOverflow="ellipsis";oStyle.width=getInt(0.5*iCW)+"px";iMW=oCchBx.offsetWidth}if(g_fRtl){iL-=iMW;if(iL<0){iL=(1<iCW-iMW)?1:(iCW-iMW)}}else if((iMW+iL+3)>iCW){iL=(1<iCW-iMW)?(iCW-iMW):1}var iX=iL-getCX(oCchBx.offsetParent);var iY=oSel.offset().iY+oSel.bounding().iHeight+5-getCY(oCchBx.offsetParent);posEm(oCchBx,iX,iY);this.set_SelectedItemIndex(0)}}};_oPrototype.hide=function Owa$UIControls$AutoCompleteCache$prototype$hide(){this.reset();this.set_IsOpen(false)};_oPrototype.reset=function Owa$UIControls$AutoCompleteCache$reset(){if(!this._oElement){return}this._oElement.set_IsShown(false);if(Owa.Utility.isSafari()){try{var oRange=createSelectionRange();if(oRange!=null){oRange.select()}}catch(e){if(this._isRecipientWellValid()){var oTextRange=createTextRange();oTextRange.moveToElementText(this.oRecipientWell._oElement._oDomNode);oTextRange.collapse(0);oTextRange.select()}}}this._oElement.set_InnerHtml("");this._rgMatchItems=new Array();this._rgMenuItems=new Array();this._iSelectedItemIndex=-1};_oPrototype._addCacheEntry=function Owa$UIControls$AutoCompleteCache$_addCacheEntry(oRecipient,iIndex){var sId=MENUITEM_ID_PREFIX;sId=sId.concat(iIndex);var oDivRcp=Owa.Dom.Document.get_Current().createElement("div");oDivRcp.set_Id(sId);oDivRcp.set_CssClasses([UNSELECTED]);var oFontRcp=Owa.Dom.Document.get_Current().createElement("font");oFontRcp.set_CssClasses([MENUITEM_NAME_CLASS]);oFontRcp.set_TextContent(oRecipient._dn.concat(" "));oDivRcp.appendChild(oFontRcp);var sAddress=getSmtpOrCustomRoutingAddress(oRecipient);if(!isNoE(sAddress)){oFontRcp=Owa.Dom.Document.get_Current().createElement("font");oFontRcp.set_CssClasses([MENUITEM_ADDRESS_CLASS]);oFontRcp.set_InnerHtml(sAddress);oDivRcp.appendChild(oFontRcp)}oDivRcp=this._oElement.appendChild(oDivRcp);this._rgMenuItems.push(oDivRcp)};_oPrototype._get_Matches=function Owa$UIControls$AutoCompleteCache$_get_Matches(sPartialString,fAdOnly){var iCount=0;var oFlags=this.oRecipientWell.oAutoCompleteFlags;for(var i=0;i<g_rgoRcp.length;i++){var oRecipient=g_rgoRcp[i];if(!oRecipient){continue}if(fAdOnly&&(oRecipient._ao!=AO_D)){continue}if(!oFlags.isADDLAllw&&(oRecipient._rf&R_DL)&&(oRecipient._ao==AO_D)){continue}if(!oFlags.isPDLAllw&&(oRecipient._rt==RT_PDL)){continue}if(oFlags.isOnlyDefaultRouting&&(oRecipient._rt!=oFlags.iDefaultRoutingType)){continue}if(!oFlags.isDefaultRoutingMobile&&(RT_MBL==oRecipient._rt)){continue}if(mch(sPartialString,oRecipient)){this._rgMatchItems.push(oRecipient);iCount++;if(iCount==10){break}}}};_oPrototype.get_SelectedCacheEntry=function Owa$UIControls$AutoCompleteCache$get_SelectedCacheEntry(){if(this._iSelectedItemIndex<0){return}var oRecipient=this._rgMatchItems[this._iSelectedItemIndex];return oRecipient};_oPrototype.deleteCacheEntry=function Owa$UIControls$AutoCompleteCache$deleteCacheEntry(){if(this._iSelectedItemIndex<0){return}var oRecipient=this._rgMatchItems[this._iSelectedItemIndex];var iNext=this._iSelectedItemIndex-1;iNext=iNext<0?0:iNext;delFrmRcpArry(oRecipient._em);tryUpdCC(CC_ACC,getRcpStr(oRecipient),DEL);this.show();this.set_SelectedItemIndex(iNext);var oR=new oeReq("RecipWell","DeleteFromCache",0,null,POST);oR.add("em",oRecipient._em);oR.add("id",oRecipient._id);oR.send()};_oPrototype.navigate=function Owa$UIControls$AutoCompleteCache$navigate(iDirection){var iResult=0;switch(iDirection){case Owa.AutoCompleteEvent.NavigateUp:var iResult=this._arrowUp();break;case Owa.AutoCompleteEvent.NavigateDown:var iResult=this._arrowDown();break}return iResult};_oPrototype._arrowDown=function Owa$UIControls$AutoCompleteCache$_arrowDown(){if(this.get_SelectedItemIndex()<this._rgMatchItems.length-1){this.set_SelectedItemIndex(this.get_SelectedItemIndex()+1);return 1}return 0};_oPrototype._arrowUp=function Owa$UIControls$AutoCompleteCache$_arrowUp(){if(this.get_SelectedItemIndex()>0){this.set_SelectedItemIndex(this.get_SelectedItemIndex()-1);return 1}return 0};_oPrototype.set_SelectedItemIndex=function Owa$UIControls$AutoCompleteCache$set_SelectedItemIndex(iIndex){if(iIndex==this._iSelectedItemIndex){return}if(this._iSelectedItemIndex>=0){this._rgMenuItems[this._iSelectedItemIndex].set_CssClasses([UNSELECTED])}if(iIndex>=this._rgMenuItems.length){iIndex=-1}this._iSelectedItemIndex=iIndex;if(this._iSelectedItemIndex>=0){this._rgMenuItems[this._iSelectedItemIndex].set_CssClasses([SELECTED])}};_oPrototype.get_SelectedItem=function Owa$UIControls$AutoCompleteCache$get_SelectedItem(){if(this.get_SelectedItemIndex()>=0){return this._rgMatchItems[this.get_SelectedItemIndex()]}else{return undefined}};_oPrototype.get_SelectedItemIndex=function Owa$UIControls$AutoCompleteCache$get_SelectedItemIndex(){return this._iSelectedItemIndex};_oPrototype._onMouseDown=function Owa$UIControls$AutoCompleteCache$_onMouseDown(oEvent){var oElement=oEvent.get_Target();var oDivRecipient=getDivRecipient(oElement);if(oDivRecipient){var sHighlightId=oDivRecipient.get_Id().substr(2);this.set_SelectedItemIndex(sHighlightId);oEvent.cancelBubble();oEvent.preventDefault()}else if(this.get_IsOpen()){this.hide()}};_oPrototype._onMouseUp=function Owa$UIControls$AutoCompleteCache$_onMouseUp(oEvent){var oElement=oEvent.get_Target();var oDivRecipient=getDivRecipient(oElement);if(oDivRecipient){var sHighlightId=oDivRecipient.get_Id().substr(MENUITEM_ID_PREFIX.length);this.set_SelectedItemIndex(sHighlightId);var oRecipient=this.get_SelectedItem();if(oRecipient&&this._isRecipientWellValid()){this.oRecipientWell.addRecipientFromCache(oRecipient)}oEvent.cancelBubble();oEvent.preventDefault()}};_oPrototype._isRecipientWellValid=function Owa$UIControls$AutoCompleteCache$_isRecipientWellValid(){return(this.oRecipientWell&&!this.oRecipientWell.get_IsDisposed())};function mch(sPartialString,oRecipient){var iSp=oRecipient._dn.lastIndexOf(" ");var sFirstName=oRecipient._dn.substring(0,iSp);var sLastName=oRecipient._dn.substr(iSp+1);sPartialString=sPartialString.toUpperCase();var rgV=new Array(sFirstName,sLastName,oRecipient._dn,oRecipient._em,oRecipient._sa,oRecipient._al);for(var i=0;i<rgV.length;++i){if(rgV[i]){if(sPartialString==rgV[i].substr(0,sPartialString.length).toUpperCase()){return 1}}}return 0}function getDivRecipient(oE){var oDivRecipient=null;if(oE){var oDivRecipient=oE.get_ParentElement();var oDivAutoComplete=(oDivRecipient?oDivRecipient.get_ParentElement():null);if(!oDivAutoComplete||oDivAutoComplete.get_Id()!=MENU_ID){oDivRecipient=null}}return oDivRecipient}function delFrmRcpArry(sEm){var i=0;while(i<g_rgoRcp.length){if(g_rgoRcp[i]!=null&&g_rgoRcp[i]._em==sEm){g_rgoRcp.removeAt(i);break}i++}}function trmStrSpacesAndSemicolons(sRcp){return sRcp.replace(new RegExp("^(\\s|\\u00a0|;)+"),'').replace(new RegExp("(\\s|\\u00a0|;)+$"),'')}Owa.UIControls.AutoCompleteCache.createClass("Owa.UIControls.AutoCompleteCache",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/RecipientAutoCompleteCache.js".toLowerCase()]=1;var SELECTED_MENU_ITEM_CLASS="cmHiLite";if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/ContextMenu.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");var ON_SELECT="onSelect";var COMMAND_ATTRIBUTE="cmd";var MENU_ITEM_ATTRIBUTE="_lnk";var MENU_DIVIDER_ATTRIBUTE="_isMnuDvdr";var SUBMENU_ATTRIBUTE="sSmId";var SUBMENU_LAZYLOAD_ATTRIBUTE="sSmScript";var CONTEXT_MENU_CLASS="ctxMnu";var MENU_ITEM_CLASS="cmLnk";var DISABLED_MENU_ITEM_CLASS="cmDsbld";var CUSTOM_MENU_ITEM_CLASS="cstmCM";Owa.UIControls.ContextMenu=function Owa$UIControls$ContextMenu(oElement,oParent,oSubPage){Owa.UIControls.ContextMenu.constructBase(this,[oElement,oParent]);if(oSubPage)this.set_SubPage(oSubPage);this._oSubmenus=new Object();this._oCurrentSubmenu=null;this._iCurrentSubmenuTimer=null};var _oPrototype=Owa.UIControls.ContextMenu.prototype;_oPrototype._fRemoveElementInDisposing=true;Owa.UIControls.ContextMenu.create=function Owa$UIControls$ContextMenu$create(oElement,oParent,oSubPage){var oContextMenu=new Owa.UIControls.ContextMenu(oElement,oParent,oSubPage);oContextMenu.initialize();return oContextMenu};Owa.UIControls.ContextMenu.createFromHtml=function Owa$UIControls$ContextMenu$createFromHtml(sHtml,fRemoveInDisposing,oSubPage){var oDiv=Owa.Dom.Document.get_Current().createElement("DIV");var oContextMenu;Owa.Dom.Document.get_Current().get_Body().appendChild(oDiv);oDiv.set_InnerHtml(sHtml);oContextMenu=new Owa.UIControls.ContextMenu(oDiv.get_FirstChild(),null,oSubPage);oContextMenu.set_RemoveElementInDisposing(fRemoveInDisposing);oContextMenu.initialize();return oContextMenu};_oPrototype.initialize=function Owa$UIControls$ContextMenu$initialize(){Owa.UIControls.ContextMenu.callBase(this,"initialize");this.setMenuItems();this._attachEvent(this._get_Element(),"mouseover",this._onMouseOver);this._attachEvent(this._get_Element(),"mouseout",this._onMouseOut);this._attachEvent(this._get_Element(),"click",this._onClick);if(this._get_Element().getAttribute("fScrl")){if(this._rgMenuItems.length>10){this._get_Element().set_Height(230);this.get_OnPreShow().add(this._createCallback(this._adjustMenuWithScrollbarWidth))}}this.get_OnPreShow().add(this._createCallback(this._adjustSpacerWidths))};_oPrototype._getDescendant=function Owa$UIControls$ContextMenu$_getDescendant(sId){var oElement=Owa.UIControls.ContextMenu.callBase(this,"_getDescendant",[sId]);if(oElement){return oElement}for(var sSubMenu in this._oSubmenus){oElement=this._oSubmenus[sSubMenu]._getDescendant(sId);if(oElement){return oElement}}};_oPrototype.setMenuItems=function Owa$UIControls$ContextMenu$setMenuItems(){this._rgMenuItems=new Array();this._rgCustomMenuIds=new Array();var oEnumerator=this._get_Element().get_AllDecendantsEnumerator();while(oEnumerator.moveNext()){var oElement=oEnumerator.get_Current();if(((oElement.getBoolAttribute(MENU_ITEM_ATTRIBUTE)||oElement.getBoolAttribute(MENU_DIVIDER_ATTRIBUTE))&&oElement.getAncestorByClass(CONTEXT_MENU_CLASS).equals(this._get_Element()))){this._rgMenuItems.push(oElement);var sSubmenuId=oElement.getAttribute(SUBMENU_ATTRIBUTE);if(sSubmenuId){var oSubmenuElement=this._get_Element().getDescendantById(sSubmenuId);this._oSubmenus[sSubmenuId]=this.addResource(this._createSubmenu(oSubmenuElement));this._oSubmenus[sSubmenuId].get_OnSelect().add(this._createCallback(this._fireOnSelect))}if(oElement.getAttribute(COMMAND_ATTRIBUTE)==CUSTOM_MENU_ITEM_CLASS){var sItemId=oElement.get_Id();if(!sItemId)throw"Customized menu item must have an Id.";this._rgCustomMenuIds.push(sItemId)}}}this._rgAllMenuItems=this._getAllMenuItems()};_oPrototype.dispose=function Owa$UIControls$ContextMenu$dispose(){if(this.fIsOpen){this.close()}this._rgMenuItems=null;this._rgCustomMenuIds=null;Owa.UIControls.ContextMenu.callBase(this,"dispose")};_oPrototype.close=function Owa$UIControls$ContextMenu$close(){if(this.fIsOpen&&this._oParentPopup&&Owa.UIControls.ContextMenu.isInstance(this._oParentPopup)){this._oParentPopup.selectMenuItemByAttribute('',0)}this._hideSubmenu();Owa.UIControls.ContextMenu.callBase(this,"close")};_oPrototype.getRootMenu=function Owa$UIControls$ContextMenu$getRootMenu(){var oRootMenu=this;while(oRootMenu._oParentPopup){oRootMenu=oRootMenu._oParentPopup}return oRootMenu};_oPrototype.getAllMenuItemIds=function Owa$UIControls$ContextMenu$getAllMenuItemIds(){var rgId=[];for(var iIndex=0;iIndex<this._rgMenuItems.length;iIndex++){rgId.push(this._rgMenuItems[iIndex].get_Id())}return rgId};_oPrototype.showAtEvent=function Owa$UIControls$ContextMenu$showAtEvent(e){this.show(e.get_ClientX(),e.get_ClientY())};_oPrototype.show=function Owa$UIControls$ContextMenu$show(iX,iY,fFarCorner){this._normalizeMenuDivider();return Owa.UIControls.ContextMenu.callBase(this,"show",arguments)};_oPrototype.showMenuItems=function Owa$UIControls$ContextMenu$showMenuItems(rgIds,f){for(var i=0;i<rgIds.length;i++){this.showMenuItem(rgIds[i],f)}};_oPrototype.showMenuItem=function Owa$UIControls$ContextMenu$showMenuItem(sId,f){var oMenuItem=this._getMenuItem(sId);if(null!=oMenuItem){showMenuItem(oMenuItem,f)}};_oPrototype._normalizeMenuDivider=function Owa$UIControls$ContextMenu$_normalizeMenuDivider(){var oLastDivider=null;var fHasVisibleMenuItemBefore=false;for(var iIndex=0;iIndex<this._rgMenuItems.length;iIndex++){var oMenuItem=this._rgMenuItems[iIndex];if(oMenuItem.getBoolAttribute(MENU_DIVIDER_ATTRIBUTE)){showMenuItem(oMenuItem,fHasVisibleMenuItemBefore);if(fHasVisibleMenuItemBefore)oLastDivider=oMenuItem;fHasVisibleMenuItemBefore=false}else if(oMenuItem.get_IsShown()){fHasVisibleMenuItemBefore=true}}if(!fHasVisibleMenuItemBefore&&oLastDivider)this.showMenuItem(oLastDivider.get_Id(),false)};_oPrototype.enableMenuItems=function Owa$UIControls$ContextMenu$enableMenuItems(rgIds,f){for(var i=0;i<rgIds.length;i++){this.enableMenuItem(rgIds[i],f)}};_oPrototype.enableMenuItem=function Owa$UIControls$ContextMenu$enableMenuItem(sId,f){setMenuItemEnabled(this._getMenuItem(sId),f)};_oPrototype.enableMenuItemByCommand=function Owa$UIControls$ContextMenu$enableMenuItemByCommand(sCommand,f){setMenuItemEnabled(this._getMenuItemByCommand(sCommand),f)};_oPrototype.checkMenuItem=function Owa$UIControls$ContextMenu$checkMenuItem(sId,f){var oMenuItem=this._getMenuItem(sId);var oImg=oMenuItem.getDescendantById("imgI");if(f){oImg.addCssClass(SELECTED_MENU_ITEM_CLASS)}else{oImg.removeCssClass(SELECTED_MENU_ITEM_CLASS)}};_oPrototype.selectMenuItem=function Owa$UIControls$ContextMenu$selectMenuItem(oMenuItem,fSelect){if(fSelect){oMenuItem.addCssClass(SELECTED_MENU_ITEM_CLASS)}else{oMenuItem.removeCssClass(SELECTED_MENU_ITEM_CLASS)}};_oPrototype.replaceMenuItemIcon=function Owa$UIControls$ContextMenu$replaceMenuItemIcon(sId,sImage){var oMenuItem=this._getMenuItem(sId);var oImg=oMenuItem.getDescendantById("imgI");Owa.Components.CssSprites.updateImage(oImg,sImage)};_oPrototype.get_CustomMenuIds=function Owa$UIControls$ContextMenu$get_CustomMenuIds(){return this._rgCustomMenuIds};_oPrototype.getMenuItemAttribute=function Owa$UIControls$ContextMenu$getMenuItemAttribute(sId,sAttributeName){return this._getMenuItem(sId).getAttribute(sAttributeName)};_oPrototype.selectMenuItemByAttribute=function Owa$UIControls$ContextMenu$selectMenuItemByAttribute(sAttributeName,sValue){for(var i=0;i<this._rgMenuItems.length;i++){this.selectMenuItem(this._rgMenuItems[i],(this._rgMenuItems[i].getAttribute(sAttributeName)==sValue))}};_oPrototype.getMenuItem=function Owa$UIControls$ContextMenu$getMenuItem(sId){return this._getMenuItem(sId)};_oPrototype.getAllMenuItems=function Owa$UIControls$ContextMenu$getAllMenuItems(){return this._rgAllMenuItems};_oPrototype.get_OnSelect=function Owa$UIControls$ContextMenu$get_OnSelect(){return this._getEventHandlerCollection(ON_SELECT)};_oPrototype._onMouseDown=function Owa$UIControls$ContextMenu$_onMouseDown(e){if(this._oCurrentSubmenu){this._oCurrentSubmenu._suppressClose(true)}Owa.UIControls.ContextMenu.callBase(this,"_onMouseDown",[e])};_oPrototype._clearMenuSelection=function Owa$UIControls$ContextMenu$_clearMenuSelection(){for(var i=0;i<this._rgMenuItems.length;i++){var oMenuItem=this._rgMenuItems[i];this.selectMenuItem(oMenuItem,false)}};_oPrototype._onMouseOver=function Owa$UIControls$ContextMenu$_onMouseOver(e){var oMenuItem=getMenuItemForEvent(e);if(oMenuItem&&oMenuItem.getBoolAttribute(MENU_ITEM_ATTRIBUTE)){this._clearMenuSelection();this.selectMenuItem(oMenuItem,true);var sSubmenuId=oMenuItem.getAttribute(SUBMENU_ATTRIBUTE);if(sSubmenuId){var oSubmenu=this._oSubmenus[sSubmenuId];this._showSubmenu(oMenuItem,oSubmenu)}else{var sSubmenuScript=oMenuItem.getAttribute(SUBMENU_LAZYLOAD_ATTRIBUTE);if(sSubmenuScript){var oFunction=new Function("return "+sSubmenuScript);var oSubmenu=oFunction(this.get_SubPage());oSubmenu._oParentPopup=this;this._showSubmenu(oMenuItem,oSubmenu)}else{this._hideSubmenu()}}}};_oPrototype._onMouseOut=function Owa$UIControls$ContextMenu$_onMouseOut(e){if(!this._oCurrentSubmenu||!this._oCurrentSubmenu.fIsOpen){this._clearMenuSelection();var o=getMenuItemForEvent(e);if(o){this.selectMenuItem(o,false)}}};_oPrototype._onClick=function Owa$UIControls$ContextMenu$_onClick(e){var oMenuItem=getMenuItemForEvent(e);if(!oMenuItem||!oMenuItem.getBoolAttribute(MENU_ITEM_ATTRIBUTE)){return}if(this._hasSubmenu(oMenuItem)){return}var sCommand=oMenuItem.getAttribute(COMMAND_ATTRIBUTE);var oEventArgs={};oEventArgs.sCommand=sCommand;oEventArgs.oMenuItem=oMenuItem;oEventArgs.oMenu=this;this._fireOnSelect(oEventArgs)};Owa.UIControls.ContextMenu.prototype._hasSubmenu=function Owa$UIControls$ContextMenu$_hasSubmenu(oMenuItem){return oMenuItem.getAttribute(SUBMENU_ATTRIBUTE)||oMenuItem.getAttribute(SUBMENU_LAZYLOAD_ATTRIBUTE)};_oPrototype._createSubmenu=function Owa$UIControls$ContextMenu$_createSubmenu(oSubmenuElement){var oSubMenu=Owa.UIControls.ContextMenu.create(oSubmenuElement,this,this.get_SubPage());return oSubMenu};_oPrototype._adjustMenuWithScrollbarWidth=function Owa$UIControls$ContextMenu$_adjustMenuWithScrollbarWidth(){this._get_Element().set_Width(this._get_Element().get_OffsetWidth()+10)};_oPrototype._adjustSpacerWidths=function Owa$UIControls$ContextMenu$_adjustSpacerWidths(){for(var i=0;i<this._rgMenuItems.length;i++){var oMenuItem=this._rgMenuItems[i];if(this._hasSubmenu(oMenuItem)&&oMenuItem.get_IsShown()){this._adjustSpacerWidth(oMenuItem)}}};_oPrototype._adjustSpacerWidth=function Owa$UIControls$ContextMenu$_adjustSpacerWidth(oMenuItem){var iWidth=oMenuItem.get_OffsetWidth();iWidth-=oMenuItem.getEffectivePadding(Owa.Style.Side.Left);iWidth-=oMenuItem.getEffectivePadding(Owa.Style.Side.Right);iWidth-=oMenuItem.getEffectiveBorderWidth(Owa.Style.Side.Left);iWidth-=oMenuItem.getEffectiveBorderWidth(Owa.Style.Side.Right);var oSpanImg=oMenuItem.getDescendantById("spnImg");if(oSpanImg){iWidth-=oSpanImg.get_OffsetWidth();iWidth-=oSpanImg.get_NextSibling().get_OffsetWidth()}var oSpanT=oMenuItem.getDescendantById("spnT");iWidth-=oSpanT.get_OffsetWidth();var oSubmenuArrow=oMenuItem.getDescendantById("imgRA");iWidth-=oSubmenuArrow.get_OffsetWidth();iWidth-=oSubmenuArrow.getEffectiveMargin(Owa.Style.Side.Left);iWidth-=oSubmenuArrow.getEffectiveMargin(Owa.Style.Side.Right);oSpanT.get_NextSibling().set_Width(iWidth)};_oPrototype._showSubmenu=function Owa$UIControls$ContextMenu$_showSubmenu(oMenuItem,oSubmenu){if(this._oCurrentSubmenu!=oSubmenu){this._hideSubmenu();var oContext=new Object();oContext.oMenuItem=oMenuItem;oContext.oSubmenu=oSubmenu;this._iCurrentSubmenuTimer=this._setTimeout(this._cbShowSubmenu,300,oContext)}};Owa.UIControls.ContextMenu.prototype._cbShowSubmenu=function Owa$UIControls$ContextMenu$_cbShowSubmenu(oContext){if(!this._iCurrentSubmenuTimer){throw"Hitting the timer callback without having the timer."}this._clearTimeout(this._iCurrentSubmenuTimer);this._iCurrentSubmenuTimer=null;var oMenuItem=oContext.oMenuItem;var oSubmenu=oContext.oSubmenu;if(this._oCurrentSubmenu==oSubmenu){throw"Trying to show the submenu again."}var iContextMenuWidth=this._get_Element().get_OffsetWidth();var iContextMenuLeft=this._get_Element().get_DocumentLeft();var iX=g_fRtl?iContextMenuLeft:iContextMenuLeft+iContextMenuWidth;var iY=oMenuItem.get_DocumentTop();oSubmenu.show(this._adjustSubmenuPosX(oSubmenu,this,iX),iY);this._oCurrentSubmenu=oSubmenu};Owa.UIControls.ContextMenu.prototype._adjustSubmenuPosX=function Owa$UIControls$ContextMenu$_adjustSubmenuPosX(oSubmenu,oParent,iX){var iContextMenuWidth=oParent._get_Element().get_OffsetWidth();var iContextMenuLeft=oParent._get_Element().get_DocumentLeft();var oSubmenuElement=oSubmenu._get_Element();if(oSubmenuElement){oSubmenuElement.set_IsShown(true);var iSubmenuWidth=oSubmenuElement.get_OffsetWidth();oSubmenuElement.set_IsShown(false);var iWindowWidth=oSubmenuElement.get_ParentElement().get_OffsetWidth();if(g_fRtl&&(iContextMenuLeft<iSubmenuWidth)){iX+=(iContextMenuWidth+iSubmenuWidth)}else if(!g_fRtl&&(iX+iSubmenuWidth>iWindowWidth)){iX-=(iContextMenuWidth+iSubmenuWidth)}}return iX};_oPrototype._hideSubmenu=function Owa$UIControls$ContextMenu$_hideSubmenu(){if(this._iCurrentSubmenuTimer){this._clearTimeout(this._iCurrentSubmenuTimer);this._iCurrentSubmenuTimer=null}if(this._oCurrentSubmenu){this._oCurrentSubmenu.close();this._oCurrentSubmenu=null}};_oPrototype._fireOnSelect=function Owa$UIControls$ContextMenu$_fireOnSelect(oEventArgs){this._suppressClose(true);this._removeTextBoxEventHandlers();var fKeepMenuOpen=this._dispatchEvent(ON_SELECT,oEventArgs);if(fKeepMenuOpen){this._addTextBoxEventHandlers();this._enableClose()}else{this.close()}return fKeepMenuOpen};_oPrototype._getMenuItem=function Owa$UIControls$ContextMenu$_getMenuItem(sId){var o=this._getDescendant(sId);if(o){return o}for(var sSubmenu in this._oSubmenus){o=this._oSubmenus[sSubmenu]._getMenuItem(sId);if(o){return o}}return null};_oPrototype._getMenuItemByCommand=function Owa$UIControls$ContextMenu$_getMenuItemByCommand(sCommand){for(var i=0;i<this._rgAllMenuItems.length;i++){var oMenuItem=this._rgAllMenuItems[i];if(oMenuItem.getAttribute(COMMAND_ATTRIBUTE)==sCommand){return oMenuItem}}return null};_oPrototype._getAllMenuItems=function Owa$UIControls$ContextMenu$_getAllMenuItems(){var rg=this._rgMenuItems;for(var sSubmenu in this._oSubmenus){rg=rg.concat(this._oSubmenus[sSubmenu]._rgMenuItems)}return rg};function getMenuItemForEvent(e){var o=e.get_Target();if(!o.hasCssClass(MENU_ITEM_CLASS)){o=o.getAncestorByClass(MENU_ITEM_CLASS,CONTEXT_MENU_CLASS)}return o}function setMenuItemEnabled(oMenuItem,fEnable){oMenuItem.setIntAttribute(MENU_ITEM_ATTRIBUTE,fEnable?1:0);if(fEnable){oMenuItem.removeCssClass(DISABLED_MENU_ITEM_CLASS)}else{oMenuItem.addCssClass(DISABLED_MENU_ITEM_CLASS)}}function showMenuItem(oMenuItem,fShow){oMenuItem.set_IsShown(fShow)}Owa.UIControls.ContextMenu.createClass("Owa.UIControls.ContextMenu",Owa.UIControls.Popup)})();g_fModuleLoaded[".\\uicontrols/ContextMenu.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/RecipientContextMenu.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");Owa.UIControls.RecipientContextMenu=function Owa$UIControls$RecipientContextMenu(oElement,oParent){Owa.UIControls.RecipientContextMenu.constructBase(this,[oElement,oParent])};var _oPrototype=Owa.UIControls.RecipientContextMenu.prototype;Owa.UIControls.RecipientContextMenu.create=function Owa$UIControls$RecipientContextMenu$create(oElement,oRecipientSpan){var oRecipientContextMenu=new Owa.UIControls.RecipientContextMenu(oElement,oRecipientSpan);oRecipientContextMenu.set_SubPage(Owa.Components.Application.get_RootSubPage());oRecipientContextMenu.initialize();oRecipientContextMenu.get_OnSelect().add(oRecipientContextMenu._createCallback(oRecipientContextMenu._onSelect));oRecipientContextMenu.get_OnClose().add(oRecipientContextMenu._createCallback(oRecipientContextMenu._onClose));oRecipientContextMenu.get_OnPreShow().add(oRecipientContextMenu._createCallback(oRecipientContextMenu._onPreShow));oRecipientContextMenu.oRecipientSpan=oRecipientSpan;oRecipientContextMenu.oRecipient=crtRecipObjectFromDomObject(oRecipientSpan);oRecipientContextMenu._attachEvent(oRecipientContextMenu._get_Element(),"keydown",oRecipientContextMenu._onKeyDown);return oRecipientContextMenu};_oPrototype.resetRecipient=function Owa$UIControls$RecipientContextMenu$resetRecipient(oRecipientSpan){this.oRecipientSpan=oRecipientSpan;this.oRecipient=crtRecipObjectFromDomObject(oRecipientSpan)};_oPrototype.showNoOpMenuItems=function Owa$UIControls$RecipientContextMenu$showNoOpMenuItems(rgIds,f){for(var i=0;i<rgIds.length;i++){this.showNoOpMenuItem(rgIds[i],f)}};_oPrototype.showNoOpMenuItem=function Owa$UIControls$RecipientContextMenu$showNoOpMenuItem(sId,f){var oMenuItem=this._getMenuItem(sId);oMenuItem.set_IsShown(f)};_oPrototype._onKeyDown=function Owa$UIControls$RecipientContextMenu$_onKeyDown(oEvent){if(!this.oRecipientSpan){return}if(oEvent.get_KeyCodeForKeyUpDown()==27){this.isEsc=1;this.close();oEvent.preventDefault();oEvent.cancelBubble()}};_oPrototype._onPreShow=function Owa$UIControls$RecipientContextMenu$_onPreShow(){var oRecipient=this.oRecipient;var oParentWell=this.oRecipientSpan.get_ParentElement();var oParentWellId=null;if(oParentWell){oParentWellId=oParentWell.get_Id()}var fSender=0;var fRecipient=0;var fNoProps=0;var fShowJunkEmailMenu=0;var fIsMobileRT=isMobileRoutingType(oRecipient._rt);var fRO=(getRecipientSpanState(this.oRecipientSpan)==READONLY_RECIP_SPAN);var sRecipientSpanId=this.oRecipientSpan.get_Id();if((sRecipientSpanId=="spnFrom")||(sRecipientSpanId=="spnSender")){fSender=1}else if((oParentWellId=="divTo")||(oParentWellId=="divCc")||(oParentWellId=="divBcc")||(oParentWellId=="divFrom")){fRecipient=1}if(!oRecipient._rt&&!oRecipient._em&&!oRecipient._sa){fNoProps=1}var fShowSenderJunkEmailMenu=(fSender&&this.oRecipientSpan.getBoolAttribute("_fJnk"));var fShowJunkEmailMenu=(isJnkEnbl()&&fRO&&(fShowSenderJunkEmailMenu||fRecipient)&&!isPI()&&!fNoProps);var fIsPDL=isPrivateDistributionList(oRecipient._rt);var fIsDL=isDistributionList(oRecipient._rf);this._set_MenuHeader((fIsPDL||fIsDL));if(g_fIsIMEnab&&gtIMMgr()&&!fIsMobileRT){this._conditionInstantMessagingMenuItems()}else{this._hideInstantMessagingMenuItems()}this.showNoOpMenuItems(["divAdOf","divAdPh","divCWPh","divCHPh","divCMPh"],0);this._oElement.getDescendantById("divEmailPropDivider").set_IsShown(0);if(!isChatWindow()){var iAddressOrigin=null;if(oRecipient._ao){iAddressOrigin=validateAddressOrigin(oRecipient._ao)}if(!fIsDL&&!fIsPDL&&!fNoProps){this._conditionPropertyMenuItems(iAddressOrigin)}this.enableMenuItem("divNwEml",!fNoProps);this.showMenuItem("divNwEml",!(fNoProps||fIsMobileRT));if(isFtEnab(FT_CAL)){this.enableMenuItem("divNwMtg",!fNoProps);this.showMenuItem("divNwMtg",!(fNoProps||fIsMobileRT))}this._oElement.getDescendantById("divNewActionDivider").set_IsShown(!fIsMobileRT);if(isFtEnab(FT_CTS)){this.showMenuItem("divAC",(iAddressOrigin!=AO_S))}var fEnablePropertySheet=(!fIsPDL||(isFtEnab(FT_CTS)&&fIsPDL));this.enableMenuItem("divPr",fEnablePropertySheet);this.oRecipientWell=this._get_RecipientWell();var fShowRemove=false;if(this.oRecipientWell){fShowRemove=!this.oRecipientWell.get_IsReadOnly()&&this.oRecipientWell.get_IsEnabled()}this.showMenuItem("divRmv",fShowRemove);if(this._getMenuItem("divJnkSender")){this.showMenuItem("divJnkSender",fShowJunkEmailMenu&&fSender)}if(this._getMenuItem("divJnkRecipient")){this.showMenuItem("divJnkRecipient",fShowJunkEmailMenu&&fRecipient)}}else{this._oElement.getDescendantById("divEmailPropDivider").set_IsShown(0);this._oElement.getDescendantById("divNewActionDivider").set_IsShown(0);this._oElement.getDescendantById("divInstantMessagingDivider").set_IsShown(0);this.showMenuItems(["divNwEml","divNwMtg","divAC","divPr","divRmv"],0);if(this._getMenuItem("divJnkSender")){this.showMenuItem("divJnkSender",0)}if(this._getMenuItem("divJnkRecipient")){this.showMenuItem("divJnkRecipient",0)}}};_oPrototype._conditionPropertyMenuItems=function Owa$UIControls$RecipientContextMenu$_conditionPropertyMenuItems(iAddressOrigin){var fKnownAddressOrigin=(iAddressOrigin==AO_D||iAddressOrigin==AO_S||iAddressOrigin==AO_O);if(!fKnownAddressOrigin){return}var fHasNoEmail=!this.oRecipient._em;var fHasNoExchangeId=hasNoExchangeId(iAddressOrigin,this.oRecipient);if((((iAddressOrigin==AO_D)||(iAddressOrigin==AO_O))&&fHasNoEmail)||((iAddressOrigin==AO_S)&&fHasNoExchangeId)||(((iAddressOrigin==AO_S)||(iAddressOrigin==AO_O))&&!isFtEnab(FT_CTS))){return}this._update_Property("AdOf",L_Elps);this._update_Property("AdPh",L_Elps);this._update_Property("CWPh",L_Elps);this._update_Property("CHPh",L_Elps);this._update_Property("CMPh",L_Elps);var fShowDivider=1;switch(iAddressOrigin){case AO_D:this.showNoOpMenuItems(["divAdOf","divAdPh"],1);break;case AO_S:this.showNoOpMenuItems(["divCWPh","divCHPh","divCMPh"],1);break;case AO_O:fShowDivider=0;break}this._oElement.getDescendantById("divEmailPropDivider").set_IsShown(fShowDivider);this._get_Properties(iAddressOrigin)};_oPrototype._hideInstantMessagingMenuItems=function Owa$UIControls$RecipientContextMenu$_hideInstantMessagingMenuItems(){var rgIMMenuItems=["divCht","divUnblkBdy","divBlkBdy","divRmBdyLst","divAdBdyLst"];var oDivider=this._oElement.getDescendantById("divInstantMessagingDivider");if(oDivider){oDivider.set_IsShown(0)}for(var i=0;i<rgIMMenuItems.length;i++){var oMenuItem=this._getMenuItem(rgIMMenuItems[i]);if(oMenuItem){this.showMenuItem(rgIMMenuItems[i],0)}}};_oPrototype._conditionInstantMessagingMenuItems=function Owa$UIControls$RecipientContextMenu$_conditionInstantMessagingMenuItems(){var fIsDL=isDistributionList(this.oRecipient_rf);var sUri=gtRcpIM(this.oRecipientSpan._get_DomNode());var fisExistingChat=isExistingChatSession(sUri);var fInstantMessagingIsDown=isInstantMessagingIsDown();var fIsSelf=0;var fIsBuddy=0;var fIsBlocked=0;if(!fIsDL&&sUri){fIsSelf=isSlfUri(sUri);if(!fIsSelf){fIsBuddy=isBuddy(sUri);if(!fIsBuddy&&this.oRecipientSpan.getBoolAttribute("_sipTrsp")){var sNwUri=gtStlUri(sUri);if(sNwUri){fIsBuddy=isBuddy(sNwUri)}}fIsBlocked=gtIMMgr().IsBlkd(sUri)}}var fBasicEnableScenario=!fIsDL&&sUri&&!fIsSelf;var fEnableChatButton=(fBasicEnableScenario&&!fisExistingChat&&!fInstantMessagingIsDown&&(isOCSPrv()||(fIsBuddy&&isMSNPrv())));this.showMenuItem("divCht",1);this.enableMenuItem("divCht",fEnableChatButton);var fShowUnblockBuddy=(fBasicEnableScenario&&fIsBlocked);if(this._getMenuItem("divUnblkBdy")){this.showMenuItem("divUnblkBdy",fShowUnblockBuddy)}if(this._getMenuItem("divBlkBdy")){var fEnableBlockBuddy=(fBasicEnableScenario&&!fIsBlocked&&fIsBuddy);this.showMenuItem("divBlkBdy",!fShowUnblockBuddy);this.enableMenuItem("divBlkBdy",fEnableBlockBuddy)}var fShowRemoveFromList=(fBasicEnableScenario&&fIsBuddy);this.showMenuItem("divRmBdyLst",fShowRemoveFromList);this.enableMenuItem("divRmBdyLst",!fInstantMessagingIsDown);var fEnableAddToList=(fBasicEnableScenario&&!fInstantMessagingIsDown);this.showMenuItem("divAdBdyLst",!fShowRemoveFromList);this.enableMenuItem("divAdBdyLst",fEnableAddToList)};_oPrototype._set_MenuHeader=function Owa$UIControls$RecipientContextMenu$_set_MenuHeader(fIsDistributionList){var oSpnHeader=this._oElement.getDescendantById("spnHdr");var sRecipientText=this.oRecipientSpan.get_TextContent();oSpnHeader.set_TextContent(sRecipientText);oSpnHeader.setAttribute("title",sRecipientText);if(fIsDistributionList){oSpnHeader.addCssClass("bld")}else{oSpnHeader.removeCssClass("bld")}};_oPrototype._get_Properties=function Owa$UIControls$RecipientContextMenu$_get_Properties(iAddressOrigin){var oR=new oeReq("RecipWell","GetRecipProps",this.oRecipient,this._createCallback(this._get_PropertiesCallback));oR.add("ao",this.oRecipient._ao);oR.add("em",this.oRecipient._em);oR.add("rt",this.oRecipient._rt);if(this.oRecipient._id){oR.add("id",this.oRecipient._id)}oR.send()};_oPrototype._update_Property=function Owa$UIControls$RecipientContextMenu$_update_Property(sId,sText){var oMenuItem=this._getMenuItem("div"+sId);var oSpnRecipientData=oMenuItem.getDescendantById("spn"+sId).set_TextContent(sText)};_oPrototype._get_PropertiesCallback=function Owa$UIControls$RecipientContextMenu$_get_PropertiesCallback(oR){if(oR.fST){popLgn();return}var fIsError=(oR.sErr!=null);var oRecipient=oR.oCtx;var iAddressOrigin=validateAddressOrigin(oRecipient._ao);if(!fIsError){var oDivR=Owa.Dom.Document.get_Current().createElement("DIV");oDivR=Owa.Dom.Document.get_Current().appendChild(oDivR);oDivR.set_IsShown(false);oDivR.set_InnerHtml(oR.sBody);if(oDivR.getDescendantById("err")){fIsError=true}else{switch(iAddressOrigin){case AO_D:this._update_Property("AdOf",oDivR.getDescendantById("AdOf").get_TextContent());this._update_Property("AdPh",oDivR.getDescendantById("AdPh").get_TextContent());var oSpn=oDivR.getDescendantById("AdId");if(oSpn){this._oElement.setAttribute("_id",oSpn.get_TextContent())}break;case AO_O:this.showNoOpMenuItems(["divCWPh","divCHPh","divCMPh"],1);this._oElement.getDescendantById("divEmailPropDivider").set_IsShown(1);case AO_S:this._update_Property("CWPh",oDivR.getDescendantById("CWPh").get_TextContent());this._update_Property("CHPh",oDivR.getDescendantById("CHPh").get_TextContent());this._update_Property("CMPh",oDivR.getDescendantById("CMPh").get_TextContent());break}}oDivR.remove(true)}if(fIsError){this._set_PropertiesToUnavailable(iAddressOrigin)}};_oPrototype._set_PropertiesToUnavailable=function Owa$UIControls$RecipientContextMenu$_set_PropertiesToUnavailable(iAddressOrigin){switch(iAddressOrigin){case AO_D:this._update_Property("AdOf",L_NotAvailable);this._update_Property("AdPh",L_NotAvailable);break;case AO_O:break;case AO_S:this._update_Property("CWPh",L_NotAvailable);this._update_Property("CHPh",L_NotAvailable);this._update_Property("CMPh",L_NotAvailable);break}};_oPrototype._get_SmtpAddress=function Owa$UIControls$RecipientContextMenu$_get_SmtpAddress(){return htmlEnc(this.oRecipientSpan.getAttribute("title"))};_oPrototype._onSelect=function Owa$UIControls$RecipientContextMenu$_onSelect(oEventArgs){var oRecipientSpanDomElement=this.oRecipientSpan._get_DomNode();this.oRecipientWell=this._get_RecipientWell();var oSubPage=this.oRecipientWell?this.oRecipientWell.get_SubPage():Owa.UIControls.SubPage.get_Instance();switch(oEventArgs.sCommand){case"ac":addRecipientSpanToContacts(oRecipientSpanDomElement);break;case"prps":onClicktoShowPropertiesSheet(oRecipientSpanDomElement);break;case"rmv":this.oRecipientWell=this._get_RecipientWell();if(this.oRecipientWell){this.oRecipientWell._oElement.focus(1);this.oRecipientWell.removeRecipient(this.oRecipientSpan)}break;case"tobsl":if(a_sJnkId==a_sFId||!isDf(typeof(a_sId))){addToJnkLst(oSubPage,BSL,this._get_SmtpAddress(),0,oEventArgs.oMenuItem.get_TextContent(),0,null,null)}else{addToJnkLst(oSubPage,BSL,this._get_SmtpAddress(),0,oEventArgs.oMenuItem.get_TextContent(),!a_fPrv,a_sId,ACTN_ADDBSL)}break;case"tossl":addToJnkLst(oSubPage,SSL,this._get_SmtpAddress(),0,oEventArgs.oMenuItem.get_TextContent(),0,null,null);break;case"dmtossl":addToJnkLst(oSubPage,SSL,this._get_SmtpAddress(),1,oEventArgs.oMenuItem.get_TextContent(),0,null,null);break;case"rcvsrl":addToJnkLst(oSubPage,SRL,this._get_SmtpAddress(),0,oEventArgs.oMenuItem.get_TextContent(),0,null,null);break;case"chat":nwChtFrmRcp(oRecipientSpanDomElement);break;case"ablst":addBdyLstReq(oSubPage,oRecipientSpanDomElement);break;case"rmblst":rmBdyLstReq(oSubPage,oRecipientSpanDomElement);break;case"blkbdy":blockBuddyRequest(gtRcpIM(oRecipientSpanDomElement));break;case"unblkbdy":blockBuddyRequest(gtRcpIM(oRecipientSpanDomElement),1);break;case"nwmtg":case"nweml":if(this.oRecipient._id){newMessageOrMeeting(oSubPage,(oEventArgs.sCommand=="nwmtg"?0:1),new Array(this.oRecipient._id),(this.oRecipient._ao==AO_D))}else if(this.oRecipient._em){var s=this.oRecipientSpan.get_TextContent();opnNwMsg(this.oRecipient._em,s,0,0,oEventArgs.sCommand=="nwmtg"?1:0,oSubPage)}break}};_oPrototype.dispose=function Owa$UIControls$RecipientContextMenu$dispose(){this.oRecipientSpan=null;this._detachEvent(this._get_Element(),"keydown",this._onKeyDown);Owa.UIControls.ContextMenu.callBase(this,"dispose")};_oPrototype._onClose=function Owa$UIControls$RecipientContextMenu$_onClose(){if(this.isEsc==1){this._hideSubmenu()}if(this.oRecipientSpan&&(getRecipientSpanState(this.oRecipientSpan)==READWRITE_RECIP_SPAN)&&(this.isEsc==1)){var oRecipientWell=this._get_RecipientWell();if(oRecipientWell){oRecipientWell._oElement.focus(1)}}};_oPrototype._get_RecipientWell=function Owa$UIControls$RecipientContextMenu$_get_RecipientWell(){var oRecipientWell=null;var oOuterSpan=this.oRecipientSpan.get_ParentElement();if(oOuterSpan){var oDivRecipientWell=oOuterSpan.get_ParentElement();if(oDivRecipientWell){oRecipientWell=oDivRecipientWell.getExpando("_oControl")}}return oRecipientWell};function isChatWindow(){return isDf(typeof(a_fChtWin))}function hasNoExchangeId(iAddressOrigin,sId){return(((iAddressOrigin==AO_S)||(iAddressOrigin==AO_D))&&!sId)}function isPrivateDistributionList(iRoutingType){return(iRoutingType==RT_PDL)}function isMobileRoutingType(iRoutingType){return(iRoutingType==RT_MBL)}function isDistributionList(iRecipientFlags){return(iRecipientFlags&R_DL)}function isExistingChatSession(sUri){return(g_fIsIMEnab&&gtIMMgr()&&sUri&&isDf(typeof(a_fChtWin))&&gtIMMgr().FndExstChtSsn(sUri))}function isInstantMessagingIsDown(){return(g_fIsIMEnab&&gtIMMgr()&&gtMstr()&&gtMstr().g_iIM_SI)}Owa.UIControls.RecipientContextMenu.createClass("Owa.UIControls.RecipientContextMenu",Owa.UIControls.ContextMenu)})();g_fModuleLoaded[".\\uicontrols/RecipientContextMenu.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/LazyLoadContextMenu.js".toLowerCase()])(function(){Owa.UIControls.LazyLoadContextMenu=function Owa$UIControls$LazyLoadContextMenu(){this._fLoading=0;Owa.UIControls.LazyLoadContextMenu.constructBase(this)};var _oPrototype=Owa.UIControls.LazyLoadContextMenu.prototype;_oPrototype.show=function Owa$UIControls$LazyLoadContextMenu$show(iX,iY,fAlignToFarSide){if(this.get_IsDomElementLoaded()){Owa.UIControls.LazyLoadContextMenu.callBase(this,"show",[iX,iY,fAlignToFarSide])}else{this._loadAndShow(iX,iY,fAlignToFarSide)}};_oPrototype._loadAndShow=function Owa$UIControls$LazyLoadContextMenu$_loadAndShow(iX,iY,fFarCorner){this._iX=iX;this._iY=iY;this._fFarCorner=fFarCorner;this._loadHtmlContent()};_oPrototype._loadHtmlContent=function Owa$UIControls$LazyLoadContextMenu$_loadHtmlContent(){if(this._fIsLoading){return}this._fIsLoading=true;this._createLoadHtmlContentRequest(this._createCallback(this._onHtmlContentLoaded)).send()};_oPrototype._onHtmlContentLoaded=function Owa$UIControls$LazyLoadContextMenu$_onHtmlContentLoaded(oResponse){this._fIsLoading=false;if(!cbOeh(oResponse)){return}var oMenu=oResponse.getResponseAsDomElement(false);this._initializeDomElement(oMenu);this.initialize();if(this._oParentPopup){if(this._oParentPopup._oCurrentSubmenu!=this){return}this._iX=this._adjustSubmenuPosX(this,this._oParentPopup,this._iX)}this.show(this._iX,this._iY,this._fFarCorner)};_oPrototype._createLoadHtmlContentRequest=function Owa$UIControls$LazyLoadContextMenu$_createLoadHtmlContentRequest(fnCallback){throw Error("Not implemented")};Owa.UIControls.LazyLoadContextMenu.createClass("Owa.UIControls.LazyLoadContextMenu",Owa.UIControls.ContextMenu)})();g_fModuleLoaded[".\\uicontrols/LazyLoadContextMenu.js".toLowerCase()]=1;var ACTION_RESOLVE=0;var ACTION_CONTEXT=1;var ACTION_ONEOFF=2;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/RecipientAnrContextMenu.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");var oInstance=null;var MENU_ID="divAm";var NAMES_CONTAINER_ID="divAmNms";var REMOVE_NAME_ID="divAmRmv";var MENU_HEADER_ID="spnHdr";var COMMAND_REMOVE="rmv";var COMMAND_ADD="an";var ON_HIDE_CONTEXT="onHideContext";Owa.UIControls.RecipientAnrContextMenu=function Owa$UIControls$RecipientAnrContextMenu(){Owa.UIControls.RecipientAnrContextMenu.constructBase(this);this.get_OnSelect().add(this._createCallback(this._onSelect));this.get_OnClose().add(this._createCallback(this._onClose));this.get_OnPreShow().add(this._createCallback(this._onPreShow))};Owa.UIControls.RecipientAnrContextMenu.createClass("Owa.UIControls.RecipientAnrContextMenu",Owa.UIControls.LazyLoadContextMenu);var _oPrototype=Owa.UIControls.RecipientAnrContextMenu.prototype;Owa.UIControls.RecipientAnrContextMenu.get_Instance=function Owa$UIControls$RecipientAnrContextMenu$get_Instance(){if(!oInstance){oInstance=new Owa.UIControls.RecipientAnrContextMenu();oInstance.set_SubPage(Owa.Components.Application.get_RootSubPage())}return oInstance};_oPrototype.set_Action=function Owa$UIControls$RecipientAnrContextMenu$set_Action(iAction){this.iAction=iAction};_oPrototype.set_Config=function Owa$UIControls$RecipientAnrContextMenu$set_Config(oConfig){this.oConfig=oConfig};_oPrototype.set_FnAnrCallback=function Owa$UIControls$RecipientAnrContextMenu$set_FnAnrCallback(fnCallback){this.fnOnEndAnrCallback=fnCallback};_oPrototype.set_RecipientSpan=function Owa$UIControls$RecipientAnrContextMenu$set_RecipientSpan(oRecipientSpan,fDoNotSetRecipientWell){this.oRecipientSpan=oRecipientSpan;if(!oRecipientSpan){this.oRecipientWell=null}else if(!fDoNotSetRecipientWell){this.oRecipientWell=this._get_RecipientWell()}};_oPrototype.set_AnrRecipientResults=function Owa$UIControls$RecipientAnrContextMenu$set_AnrRecipientResults(rgRecips){this._rgAnrRecipientResults=rgRecips};_oPrototype.showAnrMenu=function Owa$UIControls$RecipientAnrContextMenu$showAnrMenu(){if((this.iAction==ACTION_CONTEXT)||(this.iAction==ACTION_ONEOFF)){Owa.UIControls.AutoCompleteCache.hide()}switch(this.iAction){case ACTION_RESOLVE:this._iWellIndex=0;this._iRecipientIndex=0;this._showMenuOrfinishAnr();break;case ACTION_CONTEXT:this.showUnder(this.oRecipientSpan,0,false);break;case ACTION_ONEOFF:this.showUnder(this.oRecipientSpan,0,false);break}};_oPrototype.show=function Owa$UIControls$RecipientAnrContextMenu$show(iX,iY,fAlignToFarSide){this.fAddMenuHtml=0;this.fAddResolveOne=0;if(!this.get_IsDomElementLoaded()){this.fAddMenuHtml=1}if((this.iAction==ACTION_RESOLVE)||(this.iAction==ACTION_CONTEXT)){this.fAddResolveOne=1}if(!this.fAddResolveOne&&!this.fAddMenuHtml){Owa.UIControls.RecipientAnrContextMenu.callBase(this,"show",[iX,iY,fAlignToFarSide])}else{this._loadAndShow(iX,iY,fAlignToFarSide)}};_oPrototype.dispose=function Owa$UIControls$RecipientAnrContextMenu$dispose(){g_AnrPnd=0;this.oConfig=null;this.oRecipientSpan=null;this.oRecipientWell=null;this._rgAnrRecipientResults=null;this.fnOnEndAnrCallback=null;this.oInstance=null;Owa.UIControls.RecipientAnrContextMenu.callBase(this,"dispose")};_oPrototype.get_OnHideContext=function Owa$UIControls$ContextMenu$get_OnHideContext(){return this._getEventHandlerCollection(ON_HIDE_CONTEXT)};_oPrototype._get_RecipientWell=function Owa$UIControls$RecipientAnrContextMenu$_get_RecipientWell(){var oRecipientWell=null;var oOuterSpan=this.oRecipientSpan.get_ParentElement();if(oOuterSpan){var oDivRecipientWell=oOuterSpan.get_ParentElement();if(oDivRecipientWell){oRecipientWell=oDivRecipientWell.getExpando("_oControl")}}return oRecipientWell};_oPrototype._createLoadHtmlContentRequest=function Owa$UIControls$RecipientAnrContextMenu$_createLoadHtmlContentRequest(fnCallback){var oR=new oeReq("RecipWell","ResolveOneRecipientForAnrMenu",0,fnCallback);if(this.fAddMenuHtml){oR.add("AddMenuMarkup",1)}if(this.fAddResolveOne){oR.add("AddRecipientResults",1);this._addResolveOneRecipientParams(oR)}shwPrgrsInd(L_Ld);return oR};_oPrototype._addResolveOneRecipientParams=function Owa$UIControls$RecipientAnrContextMenu$_addResolveOneRecipientParams(oRequest){oRequest.add("n",this.oRecipientSpan.get_TextContent());Owa.Components.RecipientWellManager.get_Instance().addAnrOptions(this.oRecipientWell.sConsumerId,oRequest)};_oPrototype._onHtmlContentLoaded=function Owa$UIControls$RecipientAnrContextMenu$_onHtmlContentLoaded(oResponse){hdPrgrsInd();this._fIsLoading=false;if(!cbOeh(oResponse)){return}eval(oResponse.sBody);if(this.fAddMenuHtml){this.fAddMenuHtml=0;var oMenu=this._createMenuAsDomElement(sHtmlMenu);this._initializeDomElement(oMenu);this.initialize()}if(this.fAddResolveOne){this.fAddResolveOne=0;this._rgAnrRecipientResults=eval(rgRecips)}Owa.UIControls.RecipientAnrContextMenu.callBase(this,"show",[this._iX,this._iY,this._fFarCorner])};_oPrototype._createMenuAsDomElement=function Owa$UIControls$RecipientAnrContextMenu$_createMenuAsDomElement(sHtmlMenu){var oBody=Owa.Dom.Document.get_Current().get_Body();oBody.insertAdjacentHtml(Owa.ElementInsertionPoint.BeforeEnd,sHtmlMenu);var oElement=oBody.get_LastChild();return oElement};_oPrototype._initializeDomElement=function Owa$UIControls$RecipientAnrContextMenu$_initializeDomElement(oMenu){Owa.UIControls.RecipientAnrContextMenu.callBase(this,"_initializeDomElement",[oMenu]);this._attachEvent(this._get_Element(),"keydown",this._onKeyDown)};_oPrototype._onPreShow=function Owa$UIControls$RecipientAnrContextMenu$_onPreShow(){this.fPnd=1;this._updateMenuData()};_oPrototype._updateMenuData=function Owa$UIControls$RecipientAnrContextMenu$_updateMenuData(){this._oElement.set_IsShown(false);this._buildAnrNamesHtml(this._rgAnrRecipientResults);this._set_MenuHeader();this.setRemoveText();if(this.oRecipientSpan.getBoolAttribute("fDel")||this.oRecipientSpan.get_TextContent()==""){g_AnrPnd=0;return}this._adjustMenu();this._oElement.set_IsShown(true)};_oPrototype._adjustMenu=function Owa$UIControls$RecipientAnrContextMenu$_adjustMenu(){var oDivNames=this._get_NamesContainer();oDivNames.set_ScrollTop(0);this.selectMenuItem(this._rgMenuItems[0],1)};_oPrototype._buildAnrNamesHtml=function Owa$UIControls$RecipientAnrContextMenu$_buildAnrNamesHtml(){var sHtml="";var oDivNames=this._get_NamesContainer();oDivNames.set_IsShown(false);for(var i=0;i<this._rgAnrRecipientResults.length;i++){var sAddress=getSmtpOrCustomRoutingAddress(this._rgAnrRecipientResults[i]);var sDisplayName=htmlEnc(this._rgAnrRecipientResults[i]._dn);sHtml+="<div _lnk=1 class=cmLnk cmd=an";sHtml+=getHtmlEncodedRecipPropsStr(this._rgAnrRecipientResults[i]);sHtml+=" title=\"";if(!isNoE(sAddress)){sHtml+=sAddress}else{sHtml+=sDisplayName}sHtml+="\">";sHtml+="<span class=amCo>";sHtml+="<span class=amDN>"+sDisplayName+"</span><span class=amEM>";if(!isNoE(sAddress)){sHtml+=sAddress}sHtml+="</span>";sHtml+="</span>";sHtml+="</div>"}oDivNames._oDomNode.style.height=(this._rgAnrRecipientResults.length>10)?"15em":"";oDivNames.set_InnerHtml(sHtml);$("divRemoveDivider").set_IsShown(true);oDivNames.set_IsShown(sHtml.length);this.setMenuItems()};_oPrototype._get_NamesContainer=function Owa$UIControls$RecipientAnrContextMenu$_get_NamesContainer(){return this._oElement.getDescendantById(NAMES_CONTAINER_ID)};_oPrototype._get_RemoveName=function Owa$UIControls$RecipientAnrContextMenu$_get_RemoveName(){return this._oElement.getDescendantById(REMOVE_NAME_ID)};_oPrototype._set_MenuHeader=function Owa$UIControls$RecipientAnrContextMenu$_set_MenuHeader(){var oSpnHeader=this._oElement.getDescendantById(MENU_HEADER_ID);var sTitle="";if(this._get_NamesContainer().hasChildNodes()){sTitle=L_MulMtch}else{sTitle=L_NoMtch}oSpnHeader.set_TextContent(sTitle);oSpnHeader.setAttribute("title",sTitle)};_oPrototype.setRemoveText=function Owa$UIControls$RecipientAnrContextMenu$setRemoveText(){var sRemove=L_Rmv;this._get_RemoveName().getDescendantById("spnT").set_TextContent(sRemove)};_oPrototype._onKeyDown=function Owa$UIControls$RecipientAnrContextMenu$_onKeyDown(oEvent){if(!this.oRecipientSpan){return}var iKeyCode=oEvent.get_KeyCodeForKeyUpDown();var iIndex=this._getSelectedMenuItemIndex();switch(iKeyCode){case 39:break;case 37:break;case 40:case 38:case 36:case 35:this._handleNavigation(iKeyCode,iIndex);break;case 9:case 13:if(iIndex>-1){this._rgMenuItems[iIndex].click()}break;case 27:this.close();break;default:break}oEvent.preventDefault();oEvent.cancelBubble()};_oPrototype._getSelectedMenuItemIndex=function Owa$UIControls$RecipientAnrContextMenu$_getSelectedMenuItemIndex(){for(var iIndex=0;iIndex<this._rgMenuItems.length;iIndex++){if(this._rgMenuItems[iIndex].hasCssClass(SELECTED_MENU_ITEM_CLASS)){return iIndex}}return -1};_oPrototype._scrollToMenuItem=function Owa$UIControls$RecipientAnrContextMenu$_scrollToMenuItem(iIndex){var oParent=this._get_NamesContainer();var iItemHeight=oParent.get_ScrollHeight()/(this._rgMenuItems.length-2);var iFirstVisibleItem=oParent.get_ScrollTop()/iItemHeight;if(iIndex<iFirstVisibleItem){oParent.set_ScrollTop(iIndex*iItemHeight)}else{var iLastVisibleItem=(oParent.get_ScrollTop()+oParent.get_OffsetHeight())/iItemHeight-1;if(iIndex>iLastVisibleItem){oParent.set_ScrollTop((iIndex+1)*iItemHeight-oParent.get_OffsetHeight())}}};_oPrototype._handleNavigation=function Owa$UIControls$RecipientAnrContextMenu$_handleNavigation(iKeyCode,iIndex){var iLast=this._rgMenuItems.length-1;var iSelect=0;switch(iKeyCode){case 40:if(iIndex<iLast){iSelect=iIndex+1}else{iSelect=iLast}break;case 38:if(iIndex>0){iSelect=iIndex-1}else{iSelect=0}break;case 35:iSelect=iLast;break;case 36:iSelect=0;break}if(iIndex!=iSelect){if(iIndex!=-1){this.selectMenuItem(this._rgMenuItems[iIndex],0)}this.selectMenuItem(this._rgMenuItems[iSelect],1);if(iSelect!=iLast){this._scrollToMenuItem(iSelect)}}};_oPrototype._onSelect=function Owa$UIControls$RecipientAnrContextMenu$_onSelect(oEventArgs){this.sCommand=oEventArgs.sCommand;switch(oEventArgs.sCommand){case COMMAND_REMOVE:this.oRecipientWell._oElement.focus(1);this.oRecipientWell.removeRecipient(this.oRecipientSpan);break;case COMMAND_ADD:this._addResolvedName(oEventArgs.oMenuItem);break}};_oPrototype._addResolvedName=function Owa$UIControls$RecipientAnrContextMenu$_addResolvedName(oMenuItem){transferBetweenDomObjects(oMenuItem,this.oRecipientSpan);this.oRecipientSpan.setAttribute("_acu","1");this.oRecipientWell._onResize()};_oPrototype._onClose=function Owa$UIControls$RecipientAnrContextMenu$_onClose(){this.fIsCanceled=!this.sCommand;switch(this.iAction){case ACTION_RESOLVE:if(this.sCommand){this._onHideAfterActionForResolve()}else{this._finishAnr()}break;case ACTION_CONTEXT:case ACTION_ONEOFF:this._onHideAfterContextMenu();break}this.selectMenuItem(this._get_RemoveName(),0);this.sCommand=null;this.fIsCanceled=null;if(this.iAction!=ACTION_RESOLVE){g_AnrPnd=0}};_oPrototype._getNextRecipient=function Owa$UIControls$RecipientAnrContextMenu$_getNextRecipient(){var oRecipientSpan=null;this.oRecipientWell=this.oConfig.rgAmbiguousWells[this._iWellIndex];if(!this.oRecipientWell){return null}if(this._iRecipientIndex>=this.oRecipientWell._rgAmbiguousRecipients.length){this._iRecipientIndex=0;this._iWellIndex++;if(this._iWellIndex>=this.oConfig.rgAmbiguousWells.length){return null}this.oRecipientWell=this.oConfig.rgAmbiguousWells[this._iWellIndex]}oRecipientSpan=this.oRecipientWell._rgAmbiguousRecipients[this._iRecipientIndex];this._iRecipientIndex++;return oRecipientSpan};_oPrototype._showMenuOrfinishAnr=function Owa$UIControls$RecipientAnrContextMenu$_showMenuOrfinishAnr(){var oAmbiguousRecipientSpan=this._getNextRecipient();if(this.fIsOpen||!oAmbiguousRecipientSpan){this._finishAnr()}else{if(!Owa.Dom.Node.isInstance(oAmbiguousRecipientSpan)){oAmbiguousRecipientSpan=Owa.Dom.Node.wrapDomNode(oAmbiguousRecipientSpan)}this.set_RecipientSpan(oAmbiguousRecipientSpan,true);this.showUnder(this.oRecipientSpan,0,false)}};_oPrototype._finishAnr=function Owa$UIControls$RecipientAnrContextMenu$_finishAnr(){g_AnrPnd=0;if(!this.oConfig){return}this._resetFocus();var iResult=this._getCommandResult();if(this.fnOnEndAnrCallback){this.fnOnEndAnrCallback([iResult,this.oConfig])}};_oPrototype._onHideAfterActionForResolve=function Owa$UIControls$RecipientAnrContextMenu$_onHideAfterActionForResolve(){this._showMenuOrfinishAnr()};_oPrototype._getCommandResult=function Owa$UIControls$RecipientAnrContextMenu$_getCommandResult(){var iResult=RESOLVE_ANR_COMPLETE;if(this.fIsCanceled){iResult=RESOLVE_ANR_CANCEL}return iResult};_oPrototype._onHideAfterContextMenu=function Owa$UIControls$RecipientAnrContextMenu$_onHideAfterContextMenu(){this._resetFocus();var iResult=this._getCommandResult();this._dispatchEvent(ON_HIDE_CONTEXT,this.oRecipientWell,iResult)};_oPrototype._resetFocus=function Owa$UIControls$RecipientAnrContextMenu$resetFocus(){if(this.oRecipientWell._oElement.get_IsShown()){this.oRecipientWell.setFocus()}if(this.sCommand!=COMMAND_REMOVE&&this.oRecipientSpan){var oSpanOuter=this.oRecipientSpan._oDomNode.parentNode;if(oSpanOuter==null){return}var oR=createSelectionRange();if(!Owa.Utility.isIE()){oR.setCaretAfter(oSpanOuter)}else{oR.moveToElementText(oSpanOuter);oR.setEndPoint("StartToEnd",oR);oR.moveEnd(1);oR.collapse(0)}this.oRecipientWell._onResize()}}})();g_fModuleLoaded[".\\uicontrols/RecipientAnrContextMenu.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/RecipientOneOffDialog.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");var DIALOG_ID="divOneOffPrp";var DIALOG_WIDTH=400;var TEXTBOX_EMAILADDRESS="txtSMTP";var TEXTBOX_DISPLAYNAME="txtDN";Owa.UIControls.RecipientOneOffDialog=function Owa$UIControls$RecipientOneOffDialog(oRecipientSpan,fnOnClose){var sHtml="<table cellpadding=0 cellspacing=0 class=\"oneOffPrp w100\"><tr><td class=\"lbl\" nowrap>"+htmlEnc(L_DispNm)+" </td><td class=oneOffTxtBx><input id=txtDN class=cntTxt type=text maxlength=256></td></tr>"+"<tr><td class=\"lbl\" nowrap>"+htmlEnc(L_Addr)+" </td><td class=oneOffTxtBx><input id=txtSMTP class=cntTxt type=text maxlength=256></td></tr></table>";var rgButtons=isFtEnab(FT_CTS)?new Array(L_AddToCnt,L_OK,L_Cncl):new Array(L_OK,L_Cncl);Owa.UIControls.RecipientOneOffDialog.constructBase(this,[DIALOG_ID,sHtml,L_AddrPrp,rgButtons,DIALOG_WIDTH,null,fnOnClose?fnOnClose:null,null,0,0]);this.get_OnButtonDialogClose().add(this._createCallback(this._onButtonDialogClose));this.oRecipientSpan=oRecipientSpan;this._updateDialogUI()};Owa.UIControls.RecipientOneOffDialog.createClass("Owa.UIControls.RecipientOneOffDialog",Owa.UIControls.ButtonDialog);var _oPrototype=Owa.UIControls.RecipientOneOffDialog.prototype;_oPrototype.dispose=function Owa$UIControls$RecipientOneOffDialog$dispose(){Owa.UIControls.RecipientOneOffDialog.callBase(this,'dispose')};_oPrototype.get_DisplayNameTextBox=function Owa$UIControls$RecipientOneOffDialog$get_DisplayNameTextBox(){return this._oElement.getDescendantById(TEXTBOX_DISPLAYNAME)};_oPrototype.get_EmailAddressTextBox=function Owa$UIControls$RecipientOneOffDialog$get_EmailAddressTextBox(){return this._oElement.getDescendantById(TEXTBOX_EMAILADDRESS)};_oPrototype._updateDialogUI=function Owa$UIControls$RecipientOneOffDialog$_updateDialogUI(){var sEmailAddress=this._get_EmailAddress();var sDisplayName=this.oRecipientSpan.getAttribute("_dn");if(!sDisplayName){sDisplayName=sEmailAddress}this.originalDisplayName=sDisplayName;this.originalEmailAddress=sEmailAddress;var oTxtEmailAddress=this.get_EmailAddressTextBox();var oTxtDisplayName=this.get_DisplayNameTextBox();oTxtDisplayName.set_Value(sDisplayName);oTxtEmailAddress.set_Value(sEmailAddress);var fReadOnly=(getRecipientSpanState(this.oRecipientSpan)==READONLY_RECIP_SPAN);if(fReadOnly){oTxtEmailAddress.set_IsDisabled(true);this.enableButton(L_OK,0)}else{oTxtEmailAddress.set_IsDisabled(false);this.enableButton(L_OK,1)}};_oPrototype._get_EmailAddress=function Owa$UIControls$RecipientOneOffDialog$_get_EmailAddress(){var sAddress="";var sSmtpAddress=this.oRecipientSpan.getAttribute("_sa");if(isNoE(sSmtpAddress)){var sEmailAddress=this.oRecipientSpan.getAttribute("_em");var sRoutingType=this.oRecipientSpan.getAttribute("_rt");if(!isNoE(sRoutingType)&&!isNoE(sEmailAddress)&&(sRoutingType!=gtDftRT())){sAddress=sRoutingType.trim()+": "+sEmailAddress.trim()}else if(!isNoE(sEmailAddress)){sAddress=sEmailAddress.trim()}}else{sAddress=sSmtpAddress.trim()}return sAddress};_oPrototype._get_RecipientWell=function Owa$UIControls$RecipientOneOffDialog$_get_RecipientWell(){if(Owa.UIControls.EditPDLRecipientOneOffDialog.isInstance(this)){throw"Owa.UIControls.EditPDLRecipientOneOffDialog does not support get_RecipientWell method"}var oRecipientWell=null;var oOuterSpan=this.oRecipientSpan.get_ParentElement();if(oOuterSpan){var oDivRecipientWell=oOuterSpan.get_ParentElement();if(oDivRecipientWell){oRecipientWell=oDivRecipientWell.getExpando("_oControl")}}return oRecipientWell};_oPrototype._onButtonDialogClose=function Owa$UIControls$RecipientOneOffDialog$_onButtonDialogClose(iB){if(iB==-1){return}if(!isFtEnab(FT_CTS)){iB++}var oTxtEmailAddress=this.get_EmailAddressTextBox();var oTxtDisplayName=this.get_DisplayNameTextBox();var sDisplayName=oTxtDisplayName.get_Value().trim();var sAddress=oTxtEmailAddress.get_Value().trim();if(sDisplayName||sAddress){switch(iB){case 0:var iIdxColon=sAddress.indexOf(":");var sRouteType=gtDftRT();var sEmailAddress="";if(iIdxColon!=-1){sRouteType=sAddress.substring(0,iIdxColon).trim();sEmailAddress=(sAddress.substring(iIdxColon+1)).trim()}else{sEmailAddress=sAddress}var oSpn=getEm("SPAN");oSpn.setAttribute("_dn",sDisplayName);oSpn.setAttribute("_em",sEmailAddress);oSpn.setAttribute("_ao",AO_O.toString());oSpn.setAttribute("_rt",sRouteType);addRecipientSpanToContacts(oSpn);break;case 1:if(!Owa.UIControls.EditPDLRecipientOneOffDialog.isInstance(this)&&(getRecipientSpanState(this.oRecipientSpan)==READWRITE_RECIP_SPAN)&&((sDisplayName!=this.originalDisplayName)||(sAddress!==this.originalEmailAddress))){if(!sDisplayName){sDisplayName=sAddress}var oCtx=new Object();oCtx.sDN=htmlEnc(sDisplayName);oCtx.sEm=htmlEnc(sAddress);this._resolveOne(sDisplayName,sAddress,oCtx)}break}}};_oPrototype._resolveOne=function Owa$UIControls$RecipientOneOffDialog$_resolveOne(sDisplayName,sAddress,oCtx){if(this._fIsLoading){return}this._fIsLoading=1;var oRequest=new oeReq("RecipWell","ResolveOneRecipient",oCtx,this._createCallback(this._resolveOneCallback));this._addAnrOptions();if(!isDftRT(RT_SMTP)||(sDisplayName.lc().indexOf(sAddress.lc())<0)){oRequest.add("n","\""+sDisplayName+"\""+" ["+sAddress+"]")}else{oRequest.add("n",sDisplayName)}oRequest.send()};_oPrototype._resolveOneCallback=function Owa$UIControls$RecipientOneOffDialog$_resolveOneCallback(oResponse){this._fIsLoading=0;if(!cbOeh(oResponse)){return}var rgRecips=eval(oResponse.sBody);if(rgRecips.length==1){transferFromRecipToSpan(rgRecips[0],this.oRecipientSpan)}else{this._updateRecipientInfo(rgRecips,oResponse.oCtx.sDN,oResponse.oCtx.sEm)}};_oPrototype._addAnrOptions=function Owa$UIControls$RecipientOneOffDialog$_addAnrOptions(oRequest){var oRecipientWell=this._get_RecipientWell();Owa.Components.RecipientWellManager.get_Instance().addAnrOptions(oRecipientWell.sConsumerId,oRequest)};_oPrototype._updateRecipientInfo=function Owa$UIControls$RecipientOneOffDialog$_updateRecipientInfo(rgRecips,sEncDisplayName,sEncEmailAddress){var sDisplayName=sEncDisplayName;if(sEncDisplayName.lc().indexOf(sEncEmailAddress.lc())<0){sDisplayName=sEncDisplayName+" "+g_sDE+"["+sEncEmailAddress+"]"+g_sDE}this.oRecipientSpan.set_InnerHtml(sDisplayName);this.oRecipientSpan.setAttribute("_dn","");this.oRecipientSpan.setAttribute("_sa","");this.oRecipientSpan.setAttribute("_em","");this.oRecipientSpan.setAttribute("_rt","");this.oRecipientSpan.setAttribute("_ao",AO_N.toString());this.oRecipientSpan.set_Title("");this.oRecipientSpan.set_CssClasses(["rwUR"]);this.oRecipientSpan.setAttribute("_acu","0");this._shwAnrMnuForOneOffDialog(rgRecips)};_oPrototype._shwAnrMnuForOneOffDialog=function Owa$UIControls$RecipientOneOffDialog$_shwAnrMnuForOneOffDialog(rgRecips){g_AnrPnd=1;g_AnrCtxMnu=Owa.UIControls.RecipientAnrContextMenu.get_Instance();g_AnrCtxMnu.set_Action(ACTION_ONEOFF);g_AnrCtxMnu.set_Config(null);g_AnrCtxMnu.set_FnAnrCallback(null);g_AnrCtxMnu.set_RecipientSpan(this.oRecipientSpan);g_AnrCtxMnu.set_AnrRecipientResults(rgRecips);Owa.UIControls.AutoCompleteCache.hide();g_AnrCtxMnu.showAnrMenu()};Owa.UIControls.EditPDLRecipientOneOffDialog=function Owa$UIControls$EditPDLRecipientOneOffDialog(oRecipientSpan,fnOnClose){Owa.UIControls.EditPDLRecipientOneOffDialog.constructBase(this,[oRecipientSpan,fnOnClose])};Owa.UIControls.EditPDLRecipientOneOffDialog.createClass("Owa.UIControls.EditPDLRecipientOneOffDialog",Owa.UIControls.RecipientOneOffDialog);var _oPrototype=Owa.UIControls.EditPDLRecipientOneOffDialog.prototype;_oPrototype._updateDialogUI=function Owa$UIControls$EditPDLRecipientOneOffDialog$_updateDialogUI(){Owa.UIControls.EditPDLRecipientOneOffDialog.callBase(this,'_updateDialogUI');this.getButton(L_AddToCnt).set_IsShown(false);this._attachEvent(this.get_EmailAddressTextBox(),"keyup",this._onEmailAddressKeyUp)};_oPrototype._onEmailAddressKeyUp=function Owa$UIControls$EditPDLRecipientOneOffDialog$_onEmailAddressKeyUp(oEvent){var sText=this.get_EmailAddressTextBox().get_Value();this.enableButton(L_OK,sText.trim())}})();g_fModuleLoaded[".\\uicontrols/RecipientOneOffDialog.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/recipientwellmanager.js".toLowerCase()])(function(){Type.createNamespace("Owa.Components");var oInstance=null;Owa.Components.RecipientWellManager=function Owa$Components$RecipientWellManager(){Owa.Components.RecipientWellManager.constructBase(this);this._rgConsumers=new Array()};var _oPrototype=Owa.Components.RecipientWellManager.prototype;Owa.Components.RecipientWellManager.get_Instance=function Owa$Components$RecipientWellManager$get_Instance(){if(!oInstance){oInstance=new Owa.Components.RecipientWellManager()}return oInstance};_oPrototype.dispose=function Owa$Components$RecipientWellManager$dispose(){for(var i=0;i<this._rgConsumers.length;i++){var rgRecipientWells=this._rgConsumers[i].rgRecipientWells;for(var j=0;j<rgRecipientWells.length;j++){rgRecipientWells[j].dispose()}rgRecipientWells=null;this._rgConsumers[i]=null}Owa.Components.RecipientWellManager.callBase(this,"dispose")};_oPrototype.registerWells=function Owa$Components$RecipientWellManager$registerWells(rgRecipientWells,oAnrOptions){if(!rgRecipientWells.length){throw"argument rgRecipientWells cannot be empty"}for(var i=0;i<rgRecipientWells.length;i++){}var sConsumerId=rndm();var oConsumer=new Owa.Components._RecipientWellConsumer(sConsumerId,rgRecipientWells,oAnrOptions);this._addConsumer(oConsumer);return sConsumerId};_oPrototype.addRecipientWell=function Owa$Components$RecipientWellManager$addRecipientWell(sConsumerId,oRecipientWell){var oConsumer=this._get_Consumer(sConsumerId);if(oConsumer){var iWellIndex=this._indexOfConsumerWell(oConsumer,oRecipientWell._oElement);if(iWellIndex<0){oRecipientWell.sConsumerId=oConsumer.sId;oConsumer.rgRecipientWells.push(oRecipientWell);return true}}return false};_oPrototype.removeRecipientWell=function Owa$Components$RecipientWellManager$removeRecipientWell(sConsumerId,oDivRecipientWell){var oConsumer=this._get_Consumer(sConsumerId);if(oConsumer){var iWellIndex=this._indexOfConsumerWell(oConsumer,oDivRecipientWell);if(iWellIndex>=0){var oRecipientWell=oConsumer.rgRecipientWells.splice(iWellIndex,1)[0];oRecipientWell.dispose();return true}}return false};_oPrototype.get_RecipientWell=function Owa$Components$RecipientWellManager$get_RecipientWell(sConsumerId,oDivRecipientWell){var oConsumer=this._get_Consumer(sConsumerId);if(oConsumer){var iWellIndex=this._indexOfConsumerWell(oConsumer,oDivRecipientWell);if(iWellIndex>=0){return oConsumer.rgRecipientWells[iWellIndex]}}return null};_oPrototype.get_RecipientWells=function Owa$Components$RecipientWellManager$get_RecipientWells(sConsumerId){var oConsumer=this._get_Consumer(sConsumerId);if(oConsumer){return oConsumer.rgRecipientWells}return[]};_oPrototype.cloneRecipientWell=function Owa$Components$RecipientWellManager$cloneRecipientWell(sConsumerId,oRecipientWell){var oConsumer=this._get_Consumer(sConsumerId);if(oConsumer){return oRecipientWell.clone()}else{return null}};_oPrototype.disposeWells=function Owa$Components$RecipientWellManager$disposeWells(sConsumerId){var iIndex=this._indexOfConsumer(sConsumerId);if(iIndex>=0){var oConsumer=this._rgConsumers.splice(iIndex,1)[0];var rgRecipientWells=oConsumer.rgRecipientWells;for(var i=0;i<rgRecipientWells.length;i++){rgRecipientWells[i].dispose()}oConsumer.rgRecipientWells=null;oConsumer=null}};_oPrototype.set_AreWellsEnabled=function Owa$Components$RecipientWellManager$set_AreWellsEnabled(sConsumerId,fEnable){var oConsumer=this._get_Consumer(sConsumerId);if(oConsumer){var rgRecipientWells=oConsumer.rgRecipientWells;for(var iIndex=0;iIndex<rgRecipientWells.length;iIndex++){var oRecipientWell=rgRecipientWells[iIndex];if(!oRecipientWell.get_IsReadOnly()){oRecipientWell.set_IsEnabled(fEnable)}}oConsumer.fIsEnabled=fEnable}};_oPrototype.set_AreWellsReadOnly=function Owa$Components$RecipientWellManager$set_AreWellsReadOnly(sConsumerId,fReadOnly){var oConsumer=this._get_Consumer(sConsumerId);if(oConsumer){var rgRecipientWells=oConsumer.rgRecipientWells;for(var iIndex=0;iIndex<rgRecipientWells.length;iIndex++){var oRecipientWell=rgRecipientWells[iIndex];oRecipientWell.set_IsReadOnly(fReadOnly,false)}}};_oPrototype.get_AreWellsEnabled=function Owa$Components$RecipientWellManager$get_IsEnabled(sConsumerId){var oConsumer=this._get_Consumer(sConsumerId);if(oConsumer){return oConsumer.fIsEnabled}return false};_oPrototype.get_AllRecipientsByState=function Owa$Components$RecipientWellManager$get_AllRecipientsByState(sConsumerId,iRecipientState){if(!iRecipientState){iRecipientState=Owa.RecipientState.All}var oConsumer=this._get_Consumer(sConsumerId);var rgTotalRecipientByState=new Array();if(oConsumer){var rgRecipientWells=oConsumer.rgRecipientWells;for(var i=0;i<rgRecipientWells.length;i++){var oRecipientWell=rgRecipientWells[i];var fIsFromWell=(oRecipientWell.get_RecipientType()==Owa.RecipientType.From);if(Owa.UIControls.EditRecipientWell.isInstance(oRecipientWell)&&!fIsFromWell){var rgRecipientsByState=oRecipientWell.get_Recipients(iRecipientState);if(rgRecipientsByState.length){rgTotalRecipientByState=rgTotalRecipientByState.concat(rgRecipientsByState)}}}}return rgTotalRecipientByState};_oPrototype.get_AllResolvedRecipientSpans=function Owa$Components$RecipientWellManager$get_AllResolvedRecipientSpans(sConsumerId){var oConsumer=this._get_Consumer(sConsumerId);var rgTotalResolvedRecipientSpans=new Array();if(oConsumer){var rgRecipientWells=oConsumer.rgRecipientWells;for(var i=0;i<rgRecipientWells.length;i++){var oRecipientWell=rgRecipientWells[i];var fIsFromWell=(oRecipientWell.get_RecipientType()==Owa.RecipientType.From);if(Owa.UIControls.EditRecipientWell.isInstance(oRecipientWell)&&!fIsFromWell){var rgResolvedRecipientSpans=oRecipientWell.get_ResolvedRecipientSpans();if(rgResolvedRecipientSpans.length){rgTotalResolvedRecipientSpans=rgTotalResolvedRecipientSpans.concat(rgResolvedRecipientSpans)}}}}return rgTotalResolvedRecipientSpans};_oPrototype.validateMaxRecipients=function Owa$Components$RecipientWellManager$validateMaxRecipients(sConsumerId){var oConsumer=this._get_Consumer(sConsumerId);var iTotal=0;if(oConsumer){var rgRecipientWells=oConsumer.rgRecipientWells;for(var i=0;i<rgRecipientWells.length;i++){var oRecipientWell=rgRecipientWells[i];var fIsFromWell=(oRecipientWell.get_RecipientType()==Owa.RecipientType.From);if(Owa.UIControls.EditRecipientWell.isInstance(oRecipientWell)&&!fIsFromWell){iTotal+=oRecipientWell.countRecipients()}}}return checkMaxRecipients(iTotal)};_oPrototype.loadAllRecipientData=function Owa$Components$RecipientWellManager$loadAllRecipientData(sConsumerId,oRecipientWell){var oConsumer=this._get_Consumer(sConsumerId);if(oConsumer){oConsumer.iCountPending=0;oConsumer.iCountResolved=0;oConsumer.iCountAmbiguous=0;oConsumer.iTotalRecipients=0;this._resetAllRecipientData(oConsumer);if(oRecipientWell){this._loadRecipientData(oConsumer,oRecipientWell)}else{var rgRecipientWells=oConsumer.rgRecipientWells;for(var i=0;i<rgRecipientWells.length;i++){this._loadRecipientData(oConsumer,rgRecipientWells[i])}}}};_oPrototype._resetAllRecipientData=function Owa$Components$RecipientWellManager$_resetAllRecipientData(oConsumer){var rgRecipientWells=oConsumer.rgRecipientWells;for(var i=0;i<rgRecipientWells.length;i++){rgRecipientWells[i]._resetRecipientData()}};_oPrototype._loadRecipientData=function Owa$Components$RecipientWellManager$_loadRecipientData(oConsumer,oRecipientWell){var fIsFromWell=(oRecipientWell.get_RecipientType()==Owa.RecipientType.From);oRecipientWell._loadRecipientData();oConsumer.iCountPending+=oRecipientWell._rgPendingRecipients.length;oConsumer.iCountResolved+=oRecipientWell._rgResolvedRecipients.length;oConsumer.iCountAmbiguous+=oRecipientWell._rgAmbiguousRecipients.length;if(!fIsFromWell){oConsumer.iTotalRecipients=(oConsumer.iCountPending+oConsumer.iCountResolved+oConsumer.iCountAmbiguous)}};_oPrototype.resolveWells=function Owa$Components$RecipientWellManager$resolveWells(sConsumerId,fnConsumerCallback,fNoANR,oRecipientWell){var oConsumer=this._get_Consumer(sConsumerId);if(oConsumer==null){return}var oContext={};oContext.oConsumer=oConsumer;oContext.fnConsumerCallback=fnConsumerCallback;oContext.fDoANR=!fNoANR;oContext.oRecipientWell=oRecipientWell;if(!this.get_AreWellsEnabled(sConsumerId)){this._fireOnResolveComplete([RESOLVE_IN_PROGRESS,oContext]);return}this.set_AreWellsEnabled(sConsumerId,false);if(!this.validateMaxRecipients(sConsumerId)){this.set_AreWellsEnabled(true);this._fireOnResolveComplete([RESOLVE_MAX_RECIPIENTS,oContext]);return}this.loadAllRecipientData(sConsumerId,oRecipientWell);if(!oConsumer.iTotalRecipients&&!oConsumer.iCountPending){this.set_AreWellsEnabled(true);this._fireOnResolveComplete([RESOLVE_NO_RECIPIENTS,oContext]);return}if(!oConsumer.iCountPending){this._handleAmbiguous(oConsumer,oContext);return}var oRequest=new oeReq("RecipWell","Resolve",oContext,this._createCallback(this._cbResolveNames));this._addAllPendingRecipientsToRequest(oConsumer,oRequest);this.addCacheOehData(sConsumerId,oRequest);this.addAnrOptions(sConsumerId,oRequest);shwPrgrsInd(L_Ld);oRequest.send()};_oPrototype.addCacheOehData=function Owa$Components$RecipientWellManager$addCacheOehData(sConsumerId,oRequest){var rgAllAutoComplete=new Array();var oConsumer=this._get_Consumer(sConsumerId);if(oConsumer!=null){var rgRecipientWells=oConsumer.rgRecipientWells;for(var i=0;i<rgRecipientWells.length;i++){var oRecipientWell=rgRecipientWells[i];var rg=oRecipientWell._addCacheOehData(oRequest);if(rg.length){rgAllAutoComplete=rgAllAutoComplete.concat(rg)}}}if(rgAllAutoComplete.length){oRequest.addRgSt("Recips",rgAllAutoComplete)}};_oPrototype.addAnrOptions=function Owa$Components$RecipientWellManager$addAnrOptions(sConsumerId,oRequest){var oConsumer=this._get_Consumer(sConsumerId);if(!oConsumer||!oConsumer.oAnrOptions){return}Owa.Components.RecipientWellManager.addAnrOptionsToRequest(oConsumer.oAnrOptions,oRequest)};Owa.Components.RecipientWellManager.addAnrOptionsToRequest=function Owa$Components$RecipientWellManager$addAnrOptionsToRequest(oAnrOptions,oRequest){if(oAnrOptions.fResolveOnlyFromAddressBook){oRequest.add("AB",1)}if(oAnrOptions.fResolveAgainstAllContacts){oRequest.add("FSoneAnr",1)}if(oAnrOptions.sDefaultRoutingType){oRequest.add("DefaultRT",oAnrOptions.sDefaultRoutingType)}if(oAnrOptions.fOnlyAllowDefaultRoutingType){oRequest.add("OnlyDefaultRT",1)}if(oAnrOptions.iRecipientBlockType){oRequest.add("RBT",oAnrOptions.iRecipientBlockType)}};_oPrototype.replaceAllPendingNodes=function Owa$Components$RecipientWellManager$replaceAllPendingNodes(sConsumerId,oResponseDiv){var oConsumer=this._get_Consumer(sConsumerId);if(oConsumer){for(var iIndex=0;iIndex<oConsumer.rgRecipientWells.length;iIndex++){var oRecipientWell=oConsumer.rgRecipientWells[iIndex];if(oRecipientWell._rgPendingRecipients.length){var sTypeName=oRecipientWell.get_WellTypeName();oRecipientWell._replacePendingNodes(oResponseDiv.getDescendantById(sTypeName))}}}};_oPrototype.addRecipientOehData=function Owa$Components$RecipientWellManager$addRecipientOehData(sConsumerId,oRequest){var oConsumer=this._get_Consumer(sConsumerId);if(oConsumer){for(var iIndex=0;iIndex<oConsumer.rgRecipientWells.length;iIndex++){var oRecipientWell=oConsumer.rgRecipientWells[iIndex];if((oRecipientWell.get_RecipientType()==Owa.RecipientType.From)&&oRecipientWell.get_IgnoreFromData()){continue}oRecipientWell._addAllRecipientsToRequest(oRequest)}}};_oPrototype._cbResolveNames=function Owa$Components$RecipientWellManager$_cbResolveNames(oResponse){var oContext=oResponse.oCtx;var oConsumer=oContext.oConsumer;hdPrgrsInd();var oInforDiv=$("divSmsReNumMis");if(oInforDiv)hideErr(oInforDiv);if(!cbOeh(oResponse)){this.set_AreWellsEnabled(oConsumer.sId,true);this._fireOnResolveComplete([RESOLVE_REQUEST_ERROR,oContext]);return}var oDivResponse=Owa.Dom.Document.get_Current().createElement("DIV");oDivResponse.set_InnerHtml(oResponse.sBody);this.replaceAllPendingNodes(oConsumer.sId,oDivResponse);this.loadAllRecipientData(oConsumer.sId);this._handleAmbiguous(oConsumer,oContext)};_oPrototype._handleAmbiguous=function Owa$Components$RecipientWellManager$_handleAmbiguous(oConsumer,oContext){var fHaveAmbiguous;if(oContext.oRecipientWell){fHaveAmbiguous=oContext.oRecipientWell._rgAmbiguousRecipients.length}else{fHaveAmbiguous=oConsumer.iCountAmbiguous}if(fHaveAmbiguous&&oContext.fDoANR){this._beginAnrForResolve(oContext)}else{var iEventResults=(fHaveAmbiguous?RESOLVE_UNRESOLVED_RECIPIENTS:RESOLVE_COMPLETE);this._fireOnResolveComplete([iEventResults,oContext])}};_oPrototype._beginAnrForResolve=function Owa$Components$RecipientWellManager$_beginAnrForResolve(oContext){if(g_AnrPnd||isAnrMenuOpen()){return}var oConsumer=oContext.oConsumer;var rgAmbiguousWells=new Array();if(!oContext.oRecipientWell){for(var iIndex=0;iIndex<oConsumer.rgRecipientWells.length;iIndex++){var oRecipientWell=oConsumer.rgRecipientWells[iIndex];this._addAmbiguousRecipientWell(rgAmbiguousWells,oRecipientWell)}}else{this._addAmbiguousRecipientWell(rgAmbiguousWells,oContext.oRecipientWell)}oContext.rgAmbiguousWells=rgAmbiguousWells;oContext.fnCb=this._createCallback(this._fireOnResolveComplete,[RESOLVE_COMPLETE,oContext]);shwAnrMnuForResolveNames(oContext)};_oPrototype._addAmbiguousRecipientWell=function Owa$Components$RecipientWellManager$_addAmbiguousRecipientWell(rgAmbiguousWells,oRecipientWell){if(oRecipientWell._rgAmbiguousRecipients.length){rgAmbiguousWells.push(oRecipientWell);var iRecipientType=oRecipientWell.get_RecipientType();if(iRecipientType==Owa.RecipientType.Bcc){shwBcc(1)}if(iRecipientType==Owa.RecipientType.From){shwFrom(1)}}};_oPrototype._fireOnResolveComplete=function Owa$Components$RecipientWellManager$_fireOnResolveComplete(rgResults){var iEventResults=rgResults[0];var oContext=rgResults[1];var oConsumer=oContext.oConsumer;var ofnCallBack=oContext.fnConsumerCallback;if(ofnCallBack){if((iEventResults!=RESOLVE_ANR_CANCEL)&&(iEventResults!=RESOLVE_COMPLETE)){this.loadAllRecipientData(oConsumer.sId);if(oConsumer.iTotalRecipients==0){iEventResults=RESOLVE_NO_RECIPIENTS}if(oConsumer.iCountPending||oConsumer.iCountAmbiguous){iEventResults=RESOLVE_UNRESOLVED_RECIPIENTS}}ofnCallBack(iEventResults)}this.set_AreWellsEnabled(oConsumer.sId,true)};_oPrototype._addAllPendingRecipientsToRequest=function Owa$Components$RecipientWellManager$_addAllPendingRecipientsToRequest(oConsumer,oRequest){if(oConsumer.iCountPending){for(var iIndex=0;iIndex<oConsumer.rgRecipientWells.length;iIndex++){var oRecipientWell=oConsumer.rgRecipientWells[iIndex];if(oRecipientWell._rgPendingRecipients.length){oRecipientWell._addPendingRecipientsToRequest(oRequest)}}}};Owa.Components._RecipientWellConsumer=function Owa$Components$_RecipientWellConsumer(sConsumerId,rgRecipientWells,oAnrOptions){this.sId=sConsumerId;this.rgRecipientWells=rgRecipientWells;this.oAnrOptions=oAnrOptions;this.fIsEnabled=true};_oPrototype._addConsumer=function Owa$Components$RecipientWellManager$_addConsumer(oConsumer){this._rgConsumers.push(oConsumer);for(var i=0;i<oConsumer.rgRecipientWells.length;i++){var oRecipientWell=oConsumer.rgRecipientWells[i];oRecipientWell.sConsumerId=oConsumer.sId}};_oPrototype._get_Consumer=function Owa$Components$RecipientWellManager$_get_Consumer(sConsumerId){var oConsumer=null;var iIndex=this._indexOfConsumer(sConsumerId);if(iIndex>=0){oConsumer=this._rgConsumers[iIndex]}return oConsumer};_oPrototype._indexOfConsumer=function Owa$Components$RecipientWellManager$_indexOfConsumer(sConsumerId){for(var iConsumerIndex=0;iConsumerIndex<this._rgConsumers.length;++iConsumerIndex){if(sConsumerId==this._rgConsumers[iConsumerIndex].sId){return iConsumerIndex}}return -1};_oPrototype._indexOfConsumerWell=function Owa$Components$RecipientWellManager$_indexOfConsumerWell(oConsumer,oDivRecipientWell){for(var iIndex=0;iIndex<oConsumer.rgRecipientWells.length;++iIndex){var oRecipientWell=oConsumer.rgRecipientWells[iIndex];if(oRecipientWell.isEqual(oDivRecipientWell)){return iIndex}}return -1};Owa.Components.RecipientWellManager.createClass("Owa.Components.RecipientWellManager",Owa.Components.Control)})();g_fModuleLoaded[".\\components/recipientwellmanager.js".toLowerCase()]=1;var FT_GAL=0x1;var FT_CAL=0x2;var FT_CTS=0x4;var FT_ORG=0x80;var FT_NOTIF=0x100;var FT_SIG=0x2000;var FT_THM=0x8000;var FT_OWALIGHT=0x20000000;var FT_DLGACC=0x40000000;var FT_DUMPSTER=0x2000000;function isSpC(){return(isDf(typeof(a_fSp))&&Owa.Utility.isIE()&&Owa.Utility.isWin())}function isFtEnab(iFt){return(a_iSeg&iFt)}function getThmF(sF){var o=Owa.Dom.Document.get_Current().getElementById("divThm");var s_CDN=isDf(typeof(a_sCDN))?a_sCDN:"";return s_CDN+(o.getDescendantById(sF)?o.getAttribute("_cur"):o.getAttribute("_def"))+sF}var g_winMgr=new WinMgr();function WinMgr(){this.rgoWinTbl=new Object()}WinMgr.prototype.AddWin=function WinMgr$AddWin(oWin){if(!oWin)return;var sHash;while(1){sHash=rndm();if(!this.rgoWinTbl[sHash])break}oWin.sHash=sHash;this.rgoWinTbl[sHash]=oWin};WinMgr.prototype.RmWin=function WinMgr$RmWin(sHash){this.rgoWinTbl[sHash]=0};WinMgr.prototype.PushPrsnc=function WinMgr$PushPrsnc(rgiPrsnc){var oWin;for(var oHash in this.rgoWinTbl){oWin=this.rgoWinTbl[oHash];try{if(oWin&&oWin.pushPrsnc)oWin.pushPrsnc(rgiPrsnc)}catch(e){}}};WinMgr.prototype.SetMapiDrty=function WinMgr$SetMapiDrty(id,f){var oWin;for(var oHash in this.rgoWinTbl){oWin=this.rgoWinTbl[oHash];try{if(oWin&&oWin.stMapiDrtyInternal&&!(isDf(typeof(oWin.a_isMstr)))){oWin.stMapiDrtyInternal(id,f)}}catch(e){}}};WinMgr.prototype.Disp=function WinMgr$Disp(){delete this.rgoWinTbl};WinMgr.prototype.GetActiveWindow=function WinMgr$GetActiveWindow(){var oWin;for(var oHash in this.rgoWinTbl){oWin=this.rgoWinTbl[oHash];try{if(!oWin.closed&&oWin._fIsWinFocused)return oWin}catch(e){continue}}return null};var JNKDLG_W=400;var g_fJnkRq=0;function shwNtJnkDlg(oCallerSubPage,sId,fFrmLstVw,sSEm){if(g_fJnkRq)return;var oCtx=new Object();oCtx.iActn=ACTN_NTJNK;oCtx.sId=sId;oCtx.fCls=!fFrmLstVw;oCtx.sSEm=sSEm;oCtx.oCallerSubPage=oCallerSubPage;if((sSEm==null)||(sSEm=="")){mvItm(oCtx)}else{var oNtJnkDlg=wtda("dvNtJnkDlg");if(oNtJnkDlg)rn(oNtJnkDlg);var sHtml="<table cellpadding=0 cellspacing=0 class=w100><tr><td colspan=2>"+L_NtJnkActn+"</td></tr>"+"<tr><td class=ntJnkChk><input id=chkNtJnk type=checkbox checked></td><td class=ntJnkChkLbl>"+L_NtJnkChk+" "+htmlEnc(sSEm)+"</td></tr></table>";oNtJnkDlg=new BtnDlg("dvNtJnkDlg",sHtml,L_MrkNtJnk,new Array(L_OK,L_Cncl),null,Owa.BUTTON_DIALOG_ICON.INFORMATION,onClsNtJnkDlg,null,0,1,null,null,oCtx);oNtJnkDlg.show()}}function onClsNtJnkDlg(i,oC){if(i==0){var oDvNtJnkDlg=wtda("dvNtJnkDlg");if(oDvNtJnkDlg&&getOneDescendant(oDvNtJnkDlg,"chkNtJnk").checked){var oCallerSubPage=oC.oCallerSubPage;addToJnkLst(oCallerSubPage,SSL,oC.sSEm,0,L_MrkNtJnk,oC.fCls,oC.sId,oC.iActn)}else{mvItm(oC)}}}function addToJnkLst(oCallerSubPage,iLT,sEm,fDmn,sTtl,fCls,sId,iActn){if(!isJnkEnbl()||g_fJnkRq)return;var oCtx=new Object();oCtx.sTtl=sTtl;oCtx.fCls=fCls;oCtx.sId=sId;oCtx.iActn=iActn;oCtx.oCallerSubPage=oCallerSubPage;if((sEm==null)||(sEm=="")){shwAddToJnkLstOkDlg(L_NoVldSndrRcp,1,oCtx)}else{if(fDmn){sEm=sEm.substr(sEm.indexOf('@'),sEm.length-1)}var oR=new oeReq("JunkEmail","Add",oCtx,cbAddToJnkLst);oR.add("iLT",iLT);oR.add("sNE",sEm);oR.add("fFrmOpt",0);oR.send();g_fJnkRq=1}}function addSndToJnkLst(oCallerSubPage,iLT,sId,fDmn,sTtl){if(!isJnkEnbl()||g_fJnkRq)return;var oCtx=new Object();oCtx.sTtl=sTtl;oCtx.fCls=0;oCtx.sId=sId;oCtx.oCallerSubPage=oCallerSubPage;var oR=new oeReq("JunkEmail","AddSender",oCtx,cbAddToJnkLst);oR.add("iLT",iLT);oR.add("sId",sId);oR.add("fDmn",fDmn);oR.send();g_fJnkRq=1}function cbAddToJnkLst(oR){g_fJnkRq=0;if(oR.sErr){if(oR.fST)popLgn();shwErrDlg(oR)}else{var oDivR=Owa.Dom.Document.get_Current().createElement("DIV");oDivR.set_InnerHtml(oR.sBody);var sMsg=oDivR.getDescendantById("sMsg").get_TextContent();var fErr=(oDivR.getDescendantById("fErr")!=null);shwAddToJnkLstOkDlg(sMsg,fErr,oR.oCtx)}}function shwAddToJnkLstOkDlg(sMsg,fErr,oCtx){var okDlg=wda("dvAddJnkLstDlg");if(okDlg)rn(okDlg);okDlg=new BtnDlg("dvAddJnkLstDlg",htmlEnc(sMsg),oCtx.sTtl,new Array(L_OK),JNKDLG_W,fErr?Owa.BUTTON_DIALOG_ICON.ERROR:Owa.BUTTON_DIALOG_ICON.INFORMATION,fErr?null:onClsAddToJnkLstOkDlg,null,null,null,null,null,oCtx);okDlg.show()}function onClsAddToJnkLstOkDlg(i,oC){if((i==-1)||!oC)return;var iActn=oC.iActn;if((iActn==ACTN_NTJNK)||(iActn==ACTN_ADDBSL)){mvItm(oC)}}if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/colorpicker.js".toLowerCase()])(function(){var ON_COLORSELECTED="onColorSelected";var IE_OPEN_ANCHOR_MARKUP="<a onclick=\"event.returnValue=false;\" href=\"#\" unselectable=\"on\">";var IE_CLOSE_ANCHOR_MARKUP="</a>";Owa.UIControls.ColorPicker=function Owa$UIControls$ColorPicker(oSubPage,oParent,sId,iRows,iCols,fnColorProperties,rgsMoreNoneStrings,sDefaultColor,fShowNoneButton,oDialogHelper){var oColorPickerElement=this._generatePickerElement(oParent,sId,iRows,iCols,fnColorProperties,rgsMoreNoneStrings,fShowNoneButton,oDialogHelper);Owa.UIControls.ColorPicker.constructBase(this,[oColorPickerElement,oParent]);this.set_SubPage(oSubPage);this.sDefaultColorValue=sDefaultColor;this.sColorValue=sDefaultColor;this.oDialogHelper=oDialogHelper;Owa.UIControls.ColorPicker.callBase(this,"initialize");this._attachEvent(this._get_Element(),"click",this._onClick)};Owa.UIControls.ColorPicker.prototype.dispose=function Owa$UIControls$ColorPicker$dispose(){this._get_Element().detachAllEvents();this._get_Element().remove(true);Owa.UIControls.ColorPicker.callBase(this,"dispose")};Owa.UIControls.ColorPicker.prototype._onClick=function Owa$UIControls$ColorPicker$_onClick(oEvent){var oColor=oEvent.get_Target();if(oColor.hasCssClass("colorCell")){oColor=oColor.get_ParentElement()}if(!oColor.hasCssClass("colorPickerCell")&&!oColor.hasCssClass("colorPickerButton")){return}if(oColor.get_Id()=="spanColorPickerMoreCell"){var sColor=this.oDialogHelper.ChooseColorDlg(this.sColorValue);sColor=sColor.toString(16);if(sColor.length<6){var sTempString="000000".substring(0,6-sColor.length);sColor=sTempString.concat(sColor)}this.sColorValue=sColor}else if(oColor.get_Id()=="spanColorPickerNoneCell"){this.sColorValue=this.sDefaultColorValue}else{this.sColorValue=oColor.getAttribute("sV")}this._dispatchEvent(ON_COLORSELECTED,this)};Owa.UIControls.ColorPicker.prototype.get_OnColorSelected=function Owa$UIControls$ColorPicker$get_OnColorSelected(){return this._getEventHandlerCollection(ON_COLORSELECTED)};Owa.UIControls.ColorPicker.prototype._generatePickerElement=function Owa$UIControls$ColorPicker$_generatePickerElement(oParent,sId,iRows,iCols,fnColorProperties,rgsMoreNoneStrings,fShowNoneButton,oDialogHelper){var sOpenAnchor=Owa.Utility.isIE()?IE_OPEN_ANCHOR_MARKUP:"";var sCloseAnchor=Owa.Utility.isIE()?IE_CLOSE_ANCHOR_MARKUP:"";if(oDialogHelper&&Owa.Utility.isDefined(typeof(oDialogHelper.ChooseColorDlg))){var fShowMoreButton=1}var s="";s+="<DIV id=\"divColors\">";for(var i=0;i<iRows;i++){for(var j=0;j<iCols;j++){var o=fnColorProperties(i,j,iRows,iCols);s+=sOpenAnchor;s+="<DIV class=\"fltBefore colorPickerCell\"";s+=(o.sValue!=null)?(" sV="+o.sValue):"";s+="><DIV";s+=" class=\"colorCell ";s+=o.sClass?o.sClass:"";s+="\"";s+=o.sStyle?(" style="+o.sStyle):"";s+="></DIV></DIV>";s+=sCloseAnchor}s+="<DIV class=\"clear\"></DIV>"}s+="</DIV>";if(fShowMoreButton||fShowNoneButton){s+=sOpenAnchor;s+="<DIV class=\"colorPickerActions\">";if(fShowMoreButton){s+=sOpenAnchor;s+="<SPAN class=\"colorPickerButton\" id=\"spanColorPickerMoreCell\">"+rgsMoreNoneStrings[0]+"</SPAN>";s+=sCloseAnchor}if(fShowNoneButton){s+=sOpenAnchor;s+="<SPAN class=\"colorPickerButton\" id=\"spanColorPickerNoneCell\">"+rgsMoreNoneStrings[1]+"</SPAN>";s+=sCloseAnchor}s+="</DIV>";s+=sCloseAnchor}var oDoc=oParent?oParent.get_OwnerDocument():Owa.Dom.Document.get_Current();var oDiv=oDoc.createElement("div");oDiv.set_Id(sId);oDiv.set_CssClasses(["colorPicker"]);oDiv.set_InnerHtml(s);var oDivColors=oDiv.getDescendantById("divColors");oDivColors.set_Width(iCols*20);oDivColors.set_Height(iRows*20);return oDiv};Owa.UIControls.ColorPicker.createClass("Owa.UIControls.ColorPicker",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/colorpicker.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/colorpickerpopup.js".toLowerCase()])(function(){Owa.UIControls.ColorPickerPopup=function Owa$UIControls$ColorPickerPopup(oSubPage,oParent,sId,iRows,iCols,fnColorProperties,fnOnPick,rgsMoreNoneStrings,sDefaultColor,fShowNoneButton,oDialogHelper,fDisableOffscreenBox){this.fnOnPick=fnOnPick;this.oColorPicker=new Owa.UIControls.ColorPicker(oSubPage,oParent,sId,iRows,iCols,fnColorProperties,rgsMoreNoneStrings,sDefaultColor,fShowNoneButton,oDialogHelper);var oColorPickerElement=this.oColorPicker._get_Element();var oDoc=oParent.get_OwnerDocument();oDoc.get_Body().insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,oColorPickerElement);oColorPickerElement.addCssClass("pu");oColorPickerElement.set_IsShown(false);Owa.UIControls.ColorPickerPopup.constructBase(this,[oColorPickerElement,oParent,fDisableOffscreenBox]);this.set_SubPage(oSubPage);this.oColorPicker.get_OnColorSelected().add(this._createCallback(this._onPickInternal));Owa.UIControls.ColorPickerPopup.callBase(this,"initialize")};Owa.UIControls.ColorPickerPopup.prototype.dispose=function Owa$UIControls$ColorPickerPopup$dispose(){this.oColorPicker.dispose();Owa.UIControls.ColorPickerPopup.callBase(this,"dispose")};Owa.UIControls.ColorPickerPopup.prototype._onPickInternal=function Owa$UIControls$ColorPickerPopup$_onPickInternal(oColorPicker){this.sColorValue=oColorPicker.sColorValue;if(this.fnOnPick)this.fnOnPick(this);this.close()};Owa.UIControls.ColorPickerPopup.prototype.showUnderParent=function Owa$UIControls$ColorPickerPopup$showUnderParent(){this.showUnder(this._get_Parent(),0)};Owa.UIControls.ColorPickerPopup.createClass("Owa.UIControls.ColorPickerPopup",Owa.UIControls.Popup)})();g_fModuleLoaded[".\\uicontrols/colorpickerpopup.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/editcategorydialog.js".toLowerCase()])(function(){Owa.UIControls.EditCategoryDialog=function Owa$UIControls$EditCategoryDialog(sTitle,sClass){sClass=sClass||"catB noClr";var s="<table id=tblEdtCtg cellpadding=0 cellspacing=4><tr><td nowrap=\"nowrap\">"+L_Clr+"</td><td class=\"edtCtgC2\">"+L_CtgNm+'</td></tr><tr><td><div id=divCtgClr class="cmb">'+'<img id="divCmbDd" src="'+getThmF("drparw.gif")+'">'+'<div class="cmbVis"><div class="cmbCont"><img class="cmbVASp"><span id="spanCmbSel"><img id=imgSw class="'+sClass+"\"></span></div></div></div>"+'</td><td class=\"edtCtgC2\"><input id=txtCtgNm type=text maxlength=255></td></tr></table>';Owa.UIControls.EditCategoryDialog.constructBase(this,["divEdtCtg",s,sTitle,[L_OK,L_Cncl]]);this._attachEvent(this._getDescendant("divCtgClr"),"click",this.showColorPicker)};Owa.UIControls.EditCategoryDialog.createClass("Owa.UIControls.EditCategoryDialog",Owa.UIControls.ButtonDialog);Owa.UIControls.EditCategoryDialog.NO_COLOR=-1;Owa.UIControls.EditCategoryDialog.prototype.showColorPicker=function Owa$UIControls$EditCategoryDialog$showColorPicker(e){if(!this._oColorPicker){var fnColorProperty=function(iR,iC){var i=iR*5+iC;var o=new Object();o.sClass="cat"+i;o.sValue=i;return o};this._oColorPicker=new Owa.UIControls.ColorPickerPopup(this.get_SubPage(),this._getDescendant("divCtgClr"),"divCatClrPk",5,5,fnColorProperty,this._createCallback(this._onClickColorPicker),new Array(L_MrClrs,L_None),Owa.UIControls.EditCategoryDialog.NO_COLOR)}this._oColorPicker.showUnderParent()};Owa.UIControls.EditCategoryDialog.prototype._onClickColorPicker=function Owa$UIControls$EditCategoryDialog$_onClickColorPicker(oPicker){this._sChangedColor=oPicker.sColorValue;this._getDescendant("imgSw").set_CssClasses([Owa.UIControls.EditCategoryDialog.getCategoryClass(oPicker.sColorValue)]);oPicker.close()};Owa.UIControls.EditCategoryDialog.prototype.get_ChangedColor=function Owa$UIControls$EditCategoryDialog$get_ChangedColor(){return this._sChangedColor};Owa.UIControls.EditCategoryDialog.prototype.dispose=function Owa$UIControls$EditCategoryDialog$dispose(){this._getDescendant("divCtgClr").dispose();if(this._oColorPicker){this._oColorPicker.dispose();delete this._oColorPicker}Owa.UIControls.ManageCategoriesDialog.callBase(this,'dispose')};Owa.UIControls.EditCategoryDialog.getCategoryClass=function getCategoryClass(sV){return"catB "+(sV==Owa.UIControls.EditCategoryDialog.NO_COLOR?"noClr":"cat"+sV)}})();g_fModuleLoaded[".\\uicontrols/editcategorydialog.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/createcategorydialog.js".toLowerCase()])(function(){Owa.UIControls.CreateCategoryDialog=function Owa$UIControls$CreateCategoryDialog(){Owa.UIControls.CreateCategoryDialog.constructBase(this,[L_CrtCtg]);this.get_OnButtonDialogClose().add(this._createCallback(this._onButtonDialogClose));this._fFocus=false;this.get_OnShow().add(this._createCallback(this._focusOnInput))};Owa.UIControls.CreateCategoryDialog.createClass("Owa.UIControls.CreateCategoryDialog",Owa.UIControls.EditCategoryDialog);Owa.UIControls.CreateCategoryDialog.prototype._focusOnInput=function Owa$UIControls$CreateCategoryDialog$_focusOnInput(){this._getDescendant("txtCtgNm").focus(1)};Owa.UIControls.CreateCategoryDialog.prototype._onButtonDialogClose=function Owa$UIControls$CreateCategoryDialog$_onButtonDialogClose(iB){if(iB==-1||iB==1)return;if(this._fCreating)return 1;var iColor=this.get_ChangedColor();iColor=(iColor==null)?Owa.UIControls.EditCategoryDialog.NO_COLOR:iColor;var oR=new oeReq("Cat","CrtCtg",null,this._createCallback(this.cbCreateCategory));oR.add("nm",this._getDescendant("txtCtgNm").get_Value());oR.add("clr",iColor);oR.send();this._fCreating=true;return 1};Owa.UIControls.CreateCategoryDialog.prototype.cbCreateCategory=function Owa$UIControls$CreateCategoryDialog$cbCreateCategory(oR){this._fCreating=false;if(!cbOeh(oR))return;var oDiv=oR.getResponseAsDomElement(false,this._get_Element().get_OwnerDocument());if(oDiv.get_Id()=="divEIB"){var oError=this._getDescendant("divEIB");if(oError){oError.remove(true)}this._getDescendant("divBtnDlgBdy").insertAdjacentElement(Owa.ElementInsertionPoint.AfterBegin,oDiv)}else{this._dispatchEvent(ON_CATEGORY_CREATED,oDiv);this.hide()}};var ON_CATEGORY_CREATED="OnCategoryCreated";Owa.UIControls.CreateCategoryDialog.prototype.get_OnCategoryCreated=function Owa$UIControls$CreateCategoryDialog$get_OnCategoryCreated(){return this._getEventHandlerCollection(ON_CATEGORY_CREATED)}})();g_fModuleLoaded[".\\uicontrols/createcategorydialog.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/changecategorycolordialog.js".toLowerCase()])(function(){Owa.UIControls.ChangeCategoryColorDialog=function Owa$UIControls$ChangeCategoryColorDialog(sCategoryName,sClass){Owa.UIControls.ChangeCategoryColorDialog.constructBase(this,[L_ChgClr,sClass]);this._sCategoryName=sCategoryName;var oInput=this._getDescendant("txtCtgNm");oInput.set_Value(sCategoryName);oInput.set_IsDisabled(true);this.get_OnButtonDialogClose().add(this._createCallback(this._onButtonDialogClose))};Owa.UIControls.ChangeCategoryColorDialog.createClass("Owa.UIControls.ChangeCategoryColorDialog",Owa.UIControls.EditCategoryDialog);Owa.UIControls.ChangeCategoryColorDialog.prototype._onButtonDialogClose=function Owa$UIControls$ChangeCategoryColorDialog$_onButtonDialogClose(iB){if(iB==-1||iB==1)return;var iColor=this.get_ChangedColor();if(iColor==null){return}var oR=new oeReq("Cat","ChgCtg",0,cbOeh);oR.add("nm",this._sCategoryName);oR.add("clr",iColor);oR.send();this._dispatchEvent(ON_CATEGORY_COLOR_CHANGED,Owa.UIControls.EditCategoryDialog.getCategoryClass(iColor))};var ON_CATEGORY_COLOR_CHANGED="OnCategoryColorChanged";Owa.UIControls.ChangeCategoryColorDialog.prototype.get_OnCategoryColorChanged=function Owa$UIControls$ChangeCategoryColorDialog$get_OnCategoryColorChanged(){return this._getEventHandlerCollection(ON_CATEGORY_COLOR_CHANGED)}})();g_fModuleLoaded[".\\uicontrols/changecategorycolordialog.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/managecategoriesdialog.js".toLowerCase()])(function(){var oInstance=null;var fLoading=0;Owa.UIControls.ManageCategoriesDialog=function Owa$UIControls$ManageCategoriesDialog(oOehResponse){if(Owa.UIControls.ManageCategoriesDialog._get_Instance())throw"Cannot create the singleton ManageCategoriesDialog more than once";var oResponseElement=Owa.Dom.Document.get_Current().createElement("DIV");oResponseElement.set_InnerHtml(oOehResponse.sBody);this._oStringDiv=oResponseElement.getDescendantById("divStr");var sTitle=this._oStringDiv.getAttribute("L_MngCtgs");Owa.UIControls.ManageCategoriesDialog.constructBase(this,["divMngCtgs",oOehResponse.sBody,sTitle,[L_OK],290,null,null,null,1]);var oCategoryListsPane=this._getDescendant("divCtgLst");this._attachEvent(oCategoryListsPane,"keydown",this._OnKeyDownCategoryList);this._attachEvent(oCategoryListsPane,"click",this._OnClickCategoryList);this._attachEvent(this._getDescendant("lnkCrtCat"),"click",this._onClickCreateCategoryLink);this._attachEvent(this._getDescendant("lnkChgCatClr"),"click",this._onClickChangeCategoryColorLink);this._attachEvent(this._getDescendant("lnkDelCat"),"click",this._onClickDeleteCategoryLink);this.get_OnButtonDialogClose().add(this._createCallback(this._onButtonDialogClose));var rgCategories=oCategoryListsPane.getDescendantsByTagName("DIV");if(rgCategories.length)this._selectCategory(rgCategories[0])};Owa.UIControls.ManageCategoriesDialog.createClass("Owa.UIControls.ManageCategoriesDialog",Owa.UIControls.ButtonDialog);Owa.UIControls.ManageCategoriesDialog.prototype.dispose=function Owa$UIControls$ManageCategoriesDialog$dispose(){var oCategoryListsPane=this._getDescendant("divCtgLst");oCategoryListsPane.dispose();this._getDescendant("lnkCrtCat").dispose();this._getDescendant("lnkChgCatClr").dispose();this._getDescendant("lnkChgCatClr").dispose();Owa.UIControls.ManageCategoriesDialog.callBase(this,"dispose")};Owa.UIControls.ManageCategoriesDialog.prototype._OnClickCategoryList=function Owa$UIControls$ManageCategoriesDialog$_OnClickCategoryList(oEvent){var oTarget=oEvent.get_Target();var oCategoryListsPane=this._getDescendant("divCtgLst");while(!oTarget.equals(oCategoryListsPane)){var oParent=oTarget.get_ParentElement();if(oParent.equals(oCategoryListsPane)&&oTarget.get_TagName().lc()=="div"){this._selectCategory(oTarget);break}oTarget=oParent}};Owa.UIControls.ManageCategoriesDialog.prototype._OnKeyDownCategoryList=function Owa$UIControls$ManageCategoriesDialog$_OnKeyDownCategoryList(oEvent){if(!this._oSelectedCategory)return;var iKeyCode=oEvent.get_KeyCodeForKeyUpDown();var oNextCategoryDiv=null;if(iKeyCode==UP){oNextCategoryDiv=this._oSelectedCategory.get_PreviousSibling()}else if(iKeyCode==DOWN){oNextCategoryDiv=this._oSelectedCategory.get_NextSibling()}if(oNextCategoryDiv)this._selectCategory(oNextCategoryDiv)};Owa.UIControls.ManageCategoriesDialog.prototype._onClickCreateCategoryLink=function Owa$UIControls$ManageCategoriesDialog$_onClickCreateCategoryLink(oE){var oDialog=new Owa.UIControls.CreateCategoryDialog();oDialog.get_OnCategoryCreated().add(this._createCallback(this._onCategoryCreated));oDialog.show();return false};Owa.UIControls.ManageCategoriesDialog.prototype._onCategoryCreated=function Owa$UIControls$ManageCategoriesDialog$_onCategoryCreated(oCategoryDiv){this._getDescendant("divCtgLst").appendChild(oCategoryDiv)};Owa.UIControls.ManageCategoriesDialog.prototype._onClickChangeCategoryColorLink=function Owa$UIControls$ManageCategoriesDialog$_onClickChangeCategoryColorLink(oE){if(this._oSelectedCategory){var sCategoryName=this._getCategoryName(this._oSelectedCategory);var sSwatchClassName=this._oSelectedCategory.getDescendantsByTagName("IMG")[0].get_CssClasses().join(" ");var oDialog=new Owa.UIControls.ChangeCategoryColorDialog(sCategoryName,sSwatchClassName);oDialog.get_OnCategoryColorChanged().add(this._createCallback(this._onCategoryColorChanged));oDialog.show()}return false};Owa.UIControls.ManageCategoriesDialog.prototype._onCategoryColorChanged=function Owa$UIControls$ManageCategoriesDialog$_onCategoryColorChanged(sNewClassName){this._oSelectedCategory.getDescendantsByTagName("IMG")[0].set_CssClasses(sNewClassName.split(" "))};Owa.UIControls.ManageCategoriesDialog.prototype._onClickDeleteCategoryLink=function Owa$UIControls$ManageCategoriesDialog$_onClickDeleteCategoryLink(oE){if(!this._oSelectedCategory){return}var oDlg=new BtnDlg("divDelCtg",htmlEnc(this._oStringDiv.getAttribute("L_CnfDlt"))+"<br><br>"+htmlEnc(this._oStringDiv.getAttribute("L_ExpDlt")),this._oStringDiv.getAttribute("L_DltCtg"),[L_OK,L_Cncl],388,Owa.BUTTON_DIALOG_ICON.QUESTION,this._createCallback(this._onDeleteCategoryDialogClose));oDlg.show();return false};Owa.UIControls.ManageCategoriesDialog.prototype._onDeleteCategoryDialogClose=function Owa$UIControls$ManageCategoriesDialog$prototype$_onDeleteCategoryDialogClose(iB){if(iB==-1||iB==1)return;var oR=new oeReq("Cat","DltCtg",0,this._createCallback(this._onCategoryDeleted));oR.add("nm",this._getCategoryName(this._oSelectedCategory));oR.send()};Owa.UIControls.ManageCategoriesDialog.prototype._onCategoryDeleted=function Owa$UIControls$ManageCategoriesDialog$prototype$_onCategoryDeleted(oR){if(!cbOeh(oR))return;var oSibling=this._oSelectedCategory.get_NextSibling()||this._oSelectedCategory.get_PreviousSibling();this._oSelectedCategory.remove(true);this._oSelectedCategory=null;if(oSibling){this._selectCategory(oSibling)}};Owa.UIControls.ManageCategoriesDialog.prototype._onButtonDialogClose=function Owa$UIControls$ManageCategoriesDialog$prototype$_onButtonDialogClose(){Owa.UIControls.CategoryMenu.removeInstance()};Owa.UIControls.ManageCategoriesDialog.prototype._selectCategory=function Owa$UIControls$ManageCategoriesDialog$prototype$_selectCategory(oCategoryDiv){if(this._oSelectedCategory){this._oSelectedCategory.removeCssClass("sel")}oCategoryDiv.addCssClass("sel");this._oSelectedCategory=oCategoryDiv};Owa.UIControls.ManageCategoriesDialog.prototype._getCategoryName=function Owa$UIControls$ManageCategoriesDialog$prototype$_getCategoryName(oCategoryDiv){var sCN=oCategoryDiv.getAttribute("title")||oCategoryDiv.get_TextContent();return sCN.trim()};Owa.UIControls.ManageCategoriesDialog.loadInstanceAndShow=function Owa$UIControls$ManageCategoriesDialog$loadInstanceAndShow(){if(fLoading)return;var oR=new oeReq("Cat","MngCtgs",0,cbLoadInstanceAndShow);oR.send();fLoading=1};Owa.UIControls.ManageCategoriesDialog._get_Instance=function Owa$UIControls$ManageCategoriesDialog$_get_Instance(){return oInstance};function cbLoadInstanceAndShow(oR){fLoading=0;if(!cbOeh(oR))return;oInstance=null;oInstance=new Owa.UIControls.ManageCategoriesDialog(oR);oInstance.show()}})();g_fModuleLoaded[".\\uicontrols/managecategoriesdialog.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/categorymenu.js".toLowerCase()])(function(){Owa.CATEGORY_STATE={UNCHECKED:0,PARTIAL:1,CHECKED:2};var oInstance=null;var rgCategoryStateIcons=["chk-unchk.gif","chk-prtl.gif","chk-chkd.gif"];Owa.UIControls.CategoryMenu=function Owa$UIControls$CategoryMenu(oSubPage){Owa.UIControls.CategoryMenu.constructBase(this);this.set_SubPage(oSubPage);this.get_OnDataBind().add(this._createCallback(this._applyStates));this.get_OnPreShow().add(this._createCallback(this._onPreShow));this.get_OnSelect().add(this._createCallback(this._onSelect));this.get_OnClose().add(this._createCallback(this._onClose))};Owa.UIControls.CategoryMenu.createClass("Owa.UIControls.CategoryMenu",Owa.UIControls.LazyLoadContextMenu);var _oPrototype=Owa.UIControls.CategoryMenu.prototype;_oPrototype.set_ItemType=function Owa$UIControls$CategoryMenu$set_ItemType(oValue){this._iItemType=oValue};_oPrototype.get_ItemType=function Owa$UIControls$CategoryMenu$get_ItemType(){return this._iItemType};_oPrototype.set_FolderId=function Owa$UIControls$CategoryMenu$set_FolderId(oValue){this._sFolderId=oValue};_oPrototype.get_FolderId=function Owa$UIControls$CategoryMenu$get_FolderId(){return this._sFolderId};_oPrototype._reset=function Owa$UIControls$CategoryMenu$_reset(){if(this._resetting)return;this._resetting=1;try{if(this.get_IsShown())this.close();this.get_OnChangeCategory().clear();this.get_OnClearCategory().clear();this.set_ItemType(null);this.set_FolderId(null)}finally{this._resetting=0}};_oPrototype.updateStates=function Owa$UIControls$CategoryMenu$updateStates(rgCategoriesOfItems,oCategoryButton){this._oCategoryButton=oCategoryButton;var iItemCount=rgCategoriesOfItems.length;var rgCountPerCategory={};for(var i=0;i<iItemCount;i++){var rgCategories=rgCategoriesOfItems[i];for(var j=0;j<rgCategories.length;j++){var sCategory=rgCategories[j].trim();if(!rgCountPerCategory[sCategory]){rgCountPerCategory[sCategory]=0}rgCountPerCategory[sCategory]++}}this._rgCategoryStates={};this._iCategoryCount=0;for(var sCategory in rgCountPerCategory){this._rgCategoryStates[sCategory]=(rgCountPerCategory[sCategory]==iItemCount)?Owa.CATEGORY_STATE.CHECKED:Owa.CATEGORY_STATE.PARTIAL;this._iCategoryCount++}};_oPrototype._applyStates=function Owa$UIControls$CategoryMenu$_applyStates(){if(!this._rgCategoryStates)return;var oMenuElement=this._get_Element();for(var i=0;i<this._rgAllMenuItems.length;i++){var oMenuItem=this._rgAllMenuItems[i];if(!isCategoryMenuItem(oMenuItem,oMenuElement))continue;var sCategoryName=getCategoryNameOfMenuItem(oMenuItem,oMenuElement);var iCategoryState=this._rgCategoryStates[sCategoryName]||Owa.CATEGORY_STATE.UNCHECKED;this._setMenuItemState(oMenuItem,iCategoryState)}this.enableMenuItemByCommand("clr",this._iCategoryCount!=0)};_oPrototype._setMenuItemState=function Owa$UIControls$CategoryMenu$_setMenuItemState(oMenuItem,iCategoryState){oMenuItem.setIntAttribute("iState",iCategoryState);Owa.Components.CssSprites.updateImage(oMenuItem.getDescendantById("imgI"),rgCategoryStateIcons[iCategoryState])};_oPrototype._onPreShow=function Owa$UIControls$CategoryMenu$_onPreShow(){if(this._oCategoryButton){this._oCategoryButton.set_IsPushed(true)}};_oPrototype._onSelect=function Owa$UIControls$CategoryMenu$_onSelect(oEventArgs){var sCmd=oEventArgs.sCommand;var oMenuItem=oEventArgs.oMenuItem;this._sLatestCommand=sCmd;if(sCmd=="mng"){Owa.UIControls.ManageCategoriesDialog.loadInstanceAndShow();return}if(sCmd=="clr"){this._dispatchEvent(ON_CLEAR_CATEGORY);return}var iNewState;if(getMenuItemState(oMenuItem)==Owa.CATEGORY_STATE.CHECKED)iNewState=Owa.CATEGORY_STATE.UNCHECKED;else iNewState=Owa.CATEGORY_STATE.CHECKED;this._setMenuItemState(oMenuItem,iNewState);return 1};_oPrototype._onClose=function Owa$UIControls$CategoryMenu$_onClose(){if(this._oCategoryButton){this._oCategoryButton.set_IsPushed(false)}if(!this._sLatestCommand||this._sLatestCommand=="clr"){this._sLatestCommand=null;return}var rgAdd=new Array();var rgRem=new Array();var oMenuElement=this._get_Element();for(var i=0;i<this._rgAllMenuItems.length;++i){var oMenuItem=this._rgAllMenuItems[i];if(!isCategoryMenuItem(oMenuItem,oMenuElement))continue;var sCategoryName=getCategoryNameOfMenuItem(oMenuItem,oMenuElement);var iOldState=this._rgCategoryStates[sCategoryName]||Owa.CATEGORY_STATE.UNCHECKED;var iNewState=getMenuItemState(oMenuItem);if(iOldState!=iNewState){if(iNewState==Owa.CATEGORY_STATE.CHECKED)rgAdd.push(sCategoryName);else rgRem.push(sCategoryName)}}if(!rgAdd.length&&!rgRem.length)return;this._dispatchEvent(ON_CHANGE_CATEGORY,{"rgAdd":rgAdd,"rgRem":rgRem});this._reset()};_oPrototype._createLoadHtmlContentRequest=function Owa$UIControls$CategoryMenu$_createLoadHtmlContentRequest(fnCallback){var oR=new oeReq("Cat","gtCM",null,fnCallback,GET);if(this._sFolderId)oR.add("fId",this._sFolderId);oR.add("typ",this._iItemType);return oR};Owa.UIControls.CategoryMenu.get_Instance=function Owa$UIControls$CategoryMenu$get_Instance(fReset){if(!oInstance)oInstance=this.createInstance();if(fReset)oInstance._reset();return oInstance};Owa.UIControls.CategoryMenu.createInstance=function Owa$UIControls$CategoryMenu$createInstance(){oInstance=new Owa.UIControls.CategoryMenu(Owa.Components.Application.get_RootSubPage());return oInstance};Owa.UIControls.CategoryMenu.removeInstance=function Owa$UIControls$CategoryMenu$removeInstance(){if(!oInstance)return;oInstance._get_Element().remove(true);oInstance.dispose();oInstance=null};function getMenuItemState(oMenuItem){return oMenuItem.getIntAttribute("iState")}function isCategoryMenuItem(oMenuItem,oCategoryMenuElement){return !!getCategoryNameOfMenuItem(oMenuItem,oCategoryMenuElement)}function getCategoryNameOfMenuItem(oMenuItem,oMenuElement){var sCategoryName=null;var sCommand=oMenuItem.getAttribute("cmd");if(sCommand){sCategoryName=sCommand.substr(oMenuElement.getAttribute("sPfx").length)}return sCategoryName}var ON_CHANGE_CATEGORY="onChangeCategory";var ON_CLEAR_CATEGORY="onClearCategory";_oPrototype.get_OnChangeCategory=function Owa$UIControls$CategoryMenu$get_OnChangeCategory(){return this._getEventHandlerCollection(ON_CHANGE_CATEGORY)};_oPrototype.get_OnClearCategory=function Owa$UIControls$CategoryMenu$get_OnClearCategory(){return this._getEventHandlerCollection(ON_CLEAR_CATEGORY)}})();g_fModuleLoaded[".\\uicontrols/categorymenu.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/copymovecontextmenu.js".toLowerCase()])(function(){Owa.UIControls.CopyMoveContextMenu=function Owa$UIControls$CopyMoveContextMenu(){Owa.UIControls.CopyMoveContextMenu.constructBase(this);this.get_OnSelect().add(this._createCallback(this._onSelectMenuItem));this.get_OnClose().add(this._createCallback(this._onClose));this.get_OnPreShow().add(this._createCallback(this._onPreShow));this.fCopyItemVisible=true};var _oInstance=null;var _dtLastLoadTime=null;Owa.UIControls.CopyMoveContextMenu.get_Instance=function Owa$UIControls$CopyMoveContextMenu$get_Instance(){if(_oInstance){var dtMRUUpdateTime=null;var sMRUUpdateTime=getCSVAsStr(CSV_MRU_UPD_DT);if(sMRUUpdateTime)dtMRUUpdateTime=new Date(Date.parse(sMRUUpdateTime));if(dtMRUUpdateTime&&_dtLastLoadTime&&_dtLastLoadTime.eThn(dtMRUUpdateTime)){_oInstance.dispose();_oInstance=null}}if(!_oInstance){_oInstance=new Owa.UIControls.CopyMoveContextMenu()}return _oInstance};Owa.UIControls.CopyMoveContextMenu.prototype.set_CopyMoveButton=function Owa$UIControls$CopyMoveContextMenu$set_CopyMoveButton(oCopyMoveButton){this._oCopyMoveButton=oCopyMoveButton};Owa.UIControls.CopyMoveContextMenu.prototype.set_OnTargetFolderSelected=function Owa$UIControls$CopyMoveContextMenu$set_OnTargetFolderSelected(fnCallback){this._fnCallback=fnCallback};Owa.UIControls.CopyMoveContextMenu.prototype._onSelectMenuItem=function Owa$UIControls$CopyMoveContextMenu$_onSelectMenuItem(oEventArgs){var sCommand=oEventArgs.sCommand;var oMenuItem=oEventArgs.oMenuItem;var fShowFolderPicker=0;var sButton;var sTitle;if(sCommand=="MvToMruF"){if(this._fnCallback)this._fnCallback(oMenuItem.get_Id().substring(1),false,oMenuItem.getAttribute("sT"),0)}else if(sCommand=="MvToF"){fShowFolderPicker=1;sButton=L_Mv;sTitle=L_MvToFld}else if(sCommand=="CpToF"){fShowFolderPicker=1;sButton=L_Cp;sTitle=L_CpToFld}if(fShowFolderPicker){var oFolderPickerDialog=Owa.UIControls.FolderPickerDialog.get_Default();oFolderPickerDialog.set_IsShowPublicFolder(true);oFolderPickerDialog.set_ButtonCaptions([sButton]);oFolderPickerDialog.set_Title(sTitle);oFolderPickerDialog.onButtonClick=cbCopyMoveItem;oFolderPickerDialog.onCheckCustomButtons=updateFolderPickerCopyMoveItemButton;if(this._fnCallback)cbCopyMoveItem.fnCallback=this._fnCallback;oFolderPickerDialog.show()}};Owa.UIControls.CopyMoveContextMenu.prototype.set_CopyItemVisible=function Owa$UIControls$CopyMoveContextMenu$set_CopyItemVisible(fVisible){this.fCopyItemVisible=fVisible};Owa.UIControls.CopyMoveContextMenu.prototype.show=function Owa$UIControls$CopyMoveContextMenu$show(iX,iY,fAlignToFarSide){if(this.get_IsDomElementLoaded()){this.showMenuItem("divCopyToFolder",this.fCopyItemVisible)}Owa.UIControls.CopyMoveContextMenu.callBase(this,"show",[iX,iY,fAlignToFarSide])};Owa.UIControls.CopyMoveContextMenu.prototype._onClose=function Owa$UIControls$CopyMoveContextMenu$_onClose(){if(this._oCopyMoveButton)this._oCopyMoveButton.set_IsPushed(false)};Owa.UIControls.CopyMoveContextMenu.prototype._onPreShow=function Owa$UIControls$CopyMoveContextMenu$_onPreShow(){if(this._oCopyMoveButton)this._oCopyMoveButton.set_IsPushed(true)};Owa.UIControls.CopyMoveContextMenu.prototype._initializeDomElement=function Owa$UIControls$CopyMoveContextMenu$_initializeDomElement(oMenu){_dtLastLoadTime=new Date();Owa.UIControls.CopyMoveContextMenu.callBase(this,"_initializeDomElement",[oMenu])};Owa.UIControls.CopyMoveContextMenu.prototype._createLoadHtmlContentRequest=function Owa$UIControls$CopyMoveContextMenu$_createLoadHtmlContentRequest(fnCallback){return new oeReq("MsgVLV2","GetCopyMoveMenu",0,fnCallback)};Owa.UIControls.CopyMoveContextMenu.createClass("Owa.UIControls.CopyMoveContextMenu",Owa.UIControls.LazyLoadContextMenu)})();g_fModuleLoaded[".\\uicontrols/copymovecontextmenu.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/monthpicker.js".toLowerCase()])(function(){var ON_MONTHSELECTED="onMonthSelected";var MIN_MONTH_WIDTH=41;Owa.UIControls.MonthPicker=function MonthPicker(oDiv,fnOnSMs){Owa.UIControls.MonthPicker.constructBase(this,[oDiv]);this.iCM=this._getIntAttribute("_cm");this.iCY=this._getIntAttribute("_cy");this.iShwY=this.iCY;this.selYM(this.iCY,this.iCM,1);this._attachEvent(this._get_Element(),"click",this._onClick);this._getEventHandlerCollection(ON_MONTHSELECTED).add(fnOnSMs)};var _oPrototype=Owa.UIControls.MonthPicker.prototype;_oPrototype._onClick=function Owa$UIControls$MonthPicker$_onClick(oEvent){var oE=oEvent.get_Target();while(oE&&oE.get_TagName().toLowerCase()!="div"){oE=oE.get_ParentElement();if(oE==this._get_Element()){oE=null;break}}if(oE){if(oE.get_Id()=="divMonthPickerNext")this.rfrsh(this.iShwY+1);else if(oE.get_Id()=="divMonthPickerPrevious")this.rfrsh(this.iShwY-1);else if(oE.getIntAttribute("_m"))this.selYM(this.iShwY,oE.getIntAttribute("_m"))}oEvent.cancelBubble()};_oPrototype.selYM=function Owa$UIControls$MonthPicker$selYM(iY,iM,fS){if((!iY||(this.iSY==iY&&this.iShwY==iY))&&(!iM||this.iSM==iM))return;if(iY)this.iSY=iY;if(iM)this.iSM=iM;this.rfrsh();if(!fS){this._dispatchEvent(ON_MONTHSELECTED,this)}};_oPrototype.rfrsh=function Owa$UIControls$MonthPicker$rfrsh(iY){if(!iY)iY=this.iSY;this.iShwY=iY;var oSpan=this._getDescendant("spnMpDt");oSpan.set_TextContent(iY.toString());function stCelFlg(o,iT,iS){var rgClasses=["monthPickerCell","fltBefore"];if(iT)rgClasses.push("monthlyPickerToday");if(iS)rgClasses.push("monthlyPickerSelected");o.set_CssClasses(rgClasses)}var rgM=this._get_Element().getDescendantsByTagName("div");for(var i=0;i<rgM.length;i++){var iM=rgM[i].getIntAttribute("_m");if(iM){stCelFlg(rgM[i],this.iCM==iM&&this.iCY==iY,this.iSM==iM&&this.iSY==iY)}}};_oPrototype.shw=function Owa$UIControls$MonthPicker$shw(f){var oElement=this._get_Element();oElement.set_IsShown(!f);var rgM=oElement.getDescendantsByTagName("div");var iMaxWidth=MIN_MONTH_WIDTH;if(!f&&!this.resized){for(var i=0;i<rgM.length;i++){var iM=rgM[i].getIntAttribute("_m");if(iM){var iWidth=rgM[i].get_ScrollWidth();if(iWidth>iMaxWidth)iMaxWidth=iWidth}}for(var i=0;i<rgM.length;i++){var iM=rgM[i].getIntAttribute("_m");if(iM){rgM[i].set_Width(iMaxWidth)}}var iMonthPerLine=3;oElement.set_Width((iMaxWidth+6)*iMonthPerLine);this.resized=true}};_oPrototype.getSelDts=function Owa$UIControls$MonthPicker$getSelDts(){return new Array(toDate(this.iSY,this.iSM,1))};Owa.UIControls.MonthPicker.createClass("Owa.UIControls.Popup",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/monthpicker.js".toLowerCase()]=1;var DP_DAY=1;var DP_WK=2;var DP_WWK=3;var DP_MTH=4;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/DatePicker.js".toLowerCase()])(function(){var MLT_SEL=0x01;var WK_NUM=0x02;var TDY_BTN=0x04;var NONE_BTN=0x08;var WK_SEL=0x10;window.UNSEL="us";window.SEL="s";var C_SEL="dpSel";var DP_MAX_DAYS=7;Owa.UIControls.DatePicker=function DatePicker(o,fnOnSDs,fnOnNv,fDisableMonthList){this.fDisableMonthList=fDisableMonthList;Owa.UIControls.DatePicker.constructBase(this,[o]);this.iMode=DP_DAY;this._rgMonthLists={};var oM=this._get_Element().get_FirstChild();this.dt=toDate(oM.getAttribute("y"),oM.getAttribute("m"),1);this._iFeatureMask=this._getIntAttribute("ui");this.workWeekMask=this._getIntAttribute("ww");if(fnOnSDs){this.get_OnDateSelection().add(fnOnSDs)}if(fnOnNv){this.get_OnMonthNavigate().add(fnOnNv)}this.initM(oM)};var _oPrototype=Owa.UIControls.DatePicker.prototype;_oPrototype.dispose=function Owa$UIControls$DatePicker$dispose(){for(var oChildEnumerator=this._get_Element().get_Enumerator();oChildEnumerator.moveNext();){if(oChildEnumerator.get_Current().hasCssClass("dpMonth")){this.dispM(oChildEnumerator.get_Current())}}Owa.UIControls.DatePicker.callBase(this,"dispose")};_oPrototype.shw=function Owa$UIControls$DatePicker$shw(f){this._get_Element().set_IsShown(f?false:true)};_oPrototype.navM=function Owa$UIControls$DatePicker$navM(dtM,rgD,fE){var oM=this.getM(dtM);var oS=rgD;if(!oS){oS=this.getSelDts();fE=0}if(oM==null){this._rndrM(dtM,oS,fE)}else{this.getM(this.dt).set_IsShown(false);oM.set_IsShown(true);this.oDivMnthLst=this._rgMonthLists[oM.get_Id()];this.dt=dtM;this.restSel(oS,fE);this.adjustWidth();this._dispatchEvent(ON_AFTER_MONTH_NAVIGATE,this)}};_oPrototype.restSel=function Owa$UIControls$DatePicker$restSel(oS,fE){if(!oS)return;if(oS.push!=null){this.setSDs(oS,1,fE)}else{var oM=this.getM(this.dt);for(var i=0;i<6;i++){var oW=oM.getDescendantById("divWeek"+i).get_FirstChild();if(oW.getIntAttribute("w")==oS)this.selW(oW)}}};_oPrototype.setSDs=function Owa$UIControls$DatePicker$setSDs(rgD,fR,fE){if(!fR)this.unselAll();if(rgD){for(var i=0;i<rgD.length;i++){var oTd=this.findDy(rgD[i]);if(!oTd){if(!fR){this.navM(rgD[i],rgD,fE);return}}else{this.selItem(oTd,1)}}}if(fE)this._dispatchEvent(ON_DATE_SELECTION,this)};_oPrototype.findDy=function Owa$UIControls$DatePicker$findDy(dt,oM){var iC=0;var iS=0;var iM=7;if(this._iFeatureMask&(WK_SEL|WK_NUM)){++iS;++iM}if(!oM)oM=this.getM(this.dt);for(var iR=0;iR<6;iR++){var oEnumerator=oM.getDescendantById("divWeek"+(iR)).get_Enumerator();var iC=0;while(oEnumerator.moveNext()&&iC<iM){if(iC>=iS){if(cmpDy(this.getDayDt(oEnumerator.get_Current()),dt)){return oEnumerator.get_Current()}}iC++}}};_oPrototype.updateFb=function Owa$UIControls$DatePicker$updateFb(s,dt){var oM=this.getM(dt);oM.setAttribute("_fb",s);this.procDys([rFbUI],oM)};_oPrototype.updateSg=function Owa$UIControls$DatePicker$updateSg(s,dt){var oM=this.getM(dt);oM.setAttribute("_sg",s);this.procDys([rSgUI],oM)};var rgDayCellFbClasses=["fb0","fb1"];var rgDayCellFbClassIndexes=[0,1,1,1,0];function rFbUI(oD,oM,idx){for(var i=0;i<rgDayCellFbClasses.length;i++)oD.removeCssClass(rgDayCellFbClasses[i]);oD.addCssClass(rgDayCellFbClasses[rgDayCellFbClassIndexes[getInt(oM.getAttribute("_fb").charAt(idx))]])}var rgDayCellSuggestionStyles=["grt","gd","fr","por","sgNd"];function rSgUI(oD,oM,idx){for(var i=0;i<rgDayCellSuggestionStyles.length;i++)oD.removeCssClass(rgDayCellSuggestionStyles[i]);oD.addCssClass(rgDayCellSuggestionStyles[getInt(oM.getAttribute("_sg").charAt(idx))])}_oPrototype.procDys=function Owa$UIControls$DatePicker$procDys(rgFn,oM){var iT=0;var iC=0;var iS=0;var iM=7;if(this._iFeatureMask&(WK_SEL|WK_NUM)){iS=1;iM=8}for(var iR=0;iR<6;iR++){for(iC=iS;iC<iM;iC++){}var oEnumerator=oM.getDescendantById("divWeek"+(iR)).get_Enumerator();var iC=0;while(oEnumerator.moveNext()&&iC<iM){if(iC>=iS){var oD=oEnumerator.get_Current();for(var i=0;i<rgFn.length;i++){rgFn[i](oD,oM,iT)}iT++}iC++}}};_oPrototype.getM=function Owa$UIControls$DatePicker$getM(dt){return this._getDescendant("div"+(dt.gmo()+1)+dt.gyr())};_oPrototype.isMChd=function Owa$UIControls$DatePicker$isMChd(dt){return(this.getM(dt)!=null)};_oPrototype.onClkNP=function Owa$UIControls$DatePicker$onClkNP(e){var oS=e.get_CurrentTarget();var dt=toDate(oS.getIntAttribute("y"),oS.getIntAttribute("m"),1);if(!this.get_OnMonthNavigate().get_IsEmpty()){this._dispatchEvent(ON_MONTH_NAVIGATE,dt)}else{this.navM(dt,0,0)}};_oPrototype.onMdMl=function Owa$UIControls$DatePicker$onMdMl(e){var oS=e.get_Target();while(oS&&!(oS.hasCssClass&&oS.hasCssClass("dpMnuItm"))){oS=oS.get_ParentElement()}if(!oS||(!oS.getIntAttribute("m")))return;var dt=toDate(oS.getIntAttribute("y"),oS.getIntAttribute("m"),1);if(dt==this.dt)return;if(!this.get_OnMonthNavigate().get_IsEmpty()){this._dispatchEvent(ON_MONTH_NAVIGATE,dt)}else{this.navM(dt,0,0)}this._dispatchEvent(ON_AFTER_MONTH_LIST_SELECTED,this);this.oDivMnthLst.set_IsShown(false)};_oPrototype.onClkD=function Owa$UIControls$DatePicker$onClkD(e){var o=e.get_CurrentTarget();if(o.getAttribute("w")!=null)return;if(((e.isShiftKeyDown())||(e.isCtrlKeyDown()))&&(MLT_SEL&this._iFeatureMask)){var rgSDs=this.getSelDts();if(o.get_Id()==SEL){if(1<rgSDs.length){this.unselItem(o);this.iMode=DP_DAY}}else if(rgSDs.length!=DP_MAX_DAYS){this.selItem(o,1);this.iMode=DP_DAY}}else{this.unselAll();switch(this.iMode){case DP_DAY:this.selItem(o,1);break;case DP_WK:this.selW(o);break;case DP_WWK:this.selWW(o);break;case DP_MTH:this.selItem(o,1);this.iMode=DP_DAY;break}}this._dispatchEvent(ON_DATE_SELECTION,this)};_oPrototype.onClkW=function Owa$UIControls$DatePicker$onClkW(e){if(!(this._iFeatureMask&MLT_SEL)){return}this.selW(e.get_CurrentTarget());this._dispatchEvent(ON_DATE_SELECTION,this)};_oPrototype.selW=function Owa$UIControls$DatePicker$selW(o){this.unselAll();var trWk=o.get_ParentElement();var rgS=trWk.getChildrenSnapshot();for(var i=1;i<8;i++)this.selItem(rgS[i],1);this.iMode=DP_WK};_oPrototype.selWW=function Owa$UIControls$DatePicker$selWW(o){this.unselAll();var trWk=o.get_ParentElement();var rgS=trWk.getChildrenSnapshot();for(var i=1;i<8;i++){if((this.workWeekMask>>(i-1))&1)this.selItem(rgS[i],1)}this.iMode=DP_WWK};_oPrototype.getSelDts=function Owa$UIControls$DatePicker$getSelDts(){var rgS=this.getDyCells(this._get_Element(),SEL);var rgSDs=new Array();for(var i=0;i<rgS.length;i++){if(!rgS[i].getIntAttribute("w")){var dt=this.getDayDt(rgS[i]);for(var j=0;j<rgSDs.length;j++){if(rgSDs[j].toString()==dt.toString())break}if(j==rgSDs.length)rgSDs.push(dt)}}if(rgSDs.length==0)return null;if(!(MLT_SEL&this._iFeatureMask))rgSDs=rgSDs[0];return rgSDs};_oPrototype.setM=function Owa$UIControls$DatePicker$setM(dtM,dvM){this.getM(this.dt).set_IsShown(false);if(this.getM(dtM)){this.oDivMnthLst=this._rgMonthLists[this.getM(dtM).get_Id()];return}this._get_Element().insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,dvM);this.dt=dtM;this.initM(dvM)};_oPrototype.initM=function Owa$UIControls$DatePicker$initM(oM){this._attachEvent(oM.getDescendantById("imgNext"),"click",this.onClkNP);this._attachEvent(oM.getDescendantById("imgPrev"),"click",this.onClkNP);var iM=7;var iS=0;if(this._iFeatureMask&(WK_SEL|WK_NUM)){iS=1;iM=8}for(var iR=0;iR<6;iR++){var oR=oM.getDescendantById("divWeek"+(iR));var rgChildNodes=oR.getChildrenSnapshot();if(this._iFeatureMask&(WK_SEL|WK_NUM)){this._attachEvent(rgChildNodes[0],"click",this.onClkW)}for(var iC=iS;iC<iM;iC++){this._attachEvent(rgChildNodes[iC],"click",this.onClkD)}}if(this._iFeatureMask&TDY_BTN){var oBT=oM.getDescendantById("divToday");this._attachEvent(oBT,"click",this.onClkB)}if(this._iFeatureMask&NONE_BTN){var oBN=oM.getDescendantById("divNone");this._attachEvent(oBN,"click",this.onClkB)}if(!this.fDisableMonthList){this._attachEvent(oM.getDescendantById("spanDate"),"mousedown",this.onMdDh);this._attachEvent(oM.getDescendantById("spanMonthListDropDown"),"mousedown",this.onMdDh)}else{var oSpanDate=oM.getDescendantById("spanDate");oSpanDate._get_DomNode().style.cursor="default";var oImgDropDown=oM.getDescendantById("imgDropDwn");oImgDropDown.set_IsShown(false)}this.oDivMnthLst=oM.getDescendantById("divMnthLst");this._attachEvent(this.oDivMnthLst,"mousedown",this.onMdMl);this._attachEvent(this.oDivMnthLst,"mouseout",this.onMOutML);this.oDivMnthLst.set_PositionalParent(this._get_Element().get_OwnerDocument().get_Body());this._rgMonthLists[oM.get_Id()]=this.oDivMnthLst;this.adjustWidth()};_oPrototype.dispM=function Owa$UIControls$DatePicker$dispM(oM){oM.getDescendantById("imgNext").detachAllEvents();oM.getDescendantById("imgPrev").detachAllEvents();for(var iR=0;iR<6;iR++){var oR=oM.getDescendantById("divWeek"+(iR));var rgChildNodes=oR.getChildrenSnapshot();for(var iC=0;iC<rgChildNodes.length;iC++){rgChildNodes[iC].detachAllEvents()}}if(this._iFeatureMask&TDY_BTN){oM.getDescendantById("divToday").detachAllEvents()}if(this._iFeatureMask&NONE_BTN){oM.getDescendantById("divNone").detachAllEvents()}if(!this.fDisableMonthList){oM.getDescendantById("spanDate").detachAllEvents();oM.getDescendantById("spanMonthListDropDown").detachAllEvents()}this._rgMonthLists[oM.get_Id()].detachAllEvents()};_oPrototype.onClkB=function Owa$UIControls$DatePicker$onClkB(oEvent){var oTarget=oEvent.get_CurrentTarget();if(oTarget.get_Id()=="divToday"){this.setSDs(new Array(toDate(oTarget.getIntAttribute("y"),oTarget.getIntAttribute("m"),oTarget.getIntAttribute("d"))),0,1)}else{this.setSDs(null,0,1)}};Owa.UIControls.DatePicker.prototype.adjustWidth=function Owa$UIControls$DatePicker$adjustWidth(){var oM=this.getM(this.dt);var iWidth=0;var oHeader=oM.getDescendantById("divDpHdr");oHeader.forEachChild(function(oChild){iWidth+=oChild.get_OffsetWidth();iWidth+=oChild._getEffectiveMargin(Owa.Style.Side.Left,false)+oChild._getEffectiveMargin(Owa.Style.Side.Right,false)});iWidth+=oHeader.getEffectiveMargin(Owa.Style.Side.Left)+oHeader.getEffectiveMargin(Owa.Style.Side.Right);this._get_Element().set_Width(iWidth)};_oPrototype.onMOutML=function Owa$UIControls$DatePicker$onMOutML(e){var oF=e.get_Target();while(oF!=null&&oF.get_Id()!="divMnthLst"){oF=oF.get_ParentElement()}var oT=e.get_ToElementForMouseOut();while(oT!=null&&oT.get_Id()!="divMnthLst"){oT=oT.get_ParentElement()}if((oT!=null&&oT.get_Id)||oF==null)return;oF.set_IsShown(false);e.cancelBubble()};_oPrototype.onMdDh=function Owa$UIControls$DatePicker$onMdDh(oEvent){var oM=this.getM(this.dt);this.oDivMnthLst.set_IsShown(true);if(!this.oDivMnthLst.getBoolAttribute("fWidthAddjusted")){var iMaxWidth=0;this.oDivMnthLst.forEachChild(function(oChild){var iWidth=oChild.get_OffsetWidth();if(iWidth>iMaxWidth)iMaxWidth=iWidth});this.oDivMnthLst.set_Width(iMaxWidth);this.oDivMnthLst.setBoolAttribute("fWidthAddjusted",true);if(Owa.Utility.isIE()){this.oDivMnthLst.set_IsShown(false);this.oDivMnthLst.set_IsShown(true)}}var iT=this.oDivMnthLst.get_OffsetHeight()*(-3/7);var oHeaderDiv=oEvent.get_Target();while(oHeaderDiv&&oHeaderDiv.get_Id()!="divDpHdr"){oHeaderDiv=oHeaderDiv.get_ParentElement()}var iL=oHeaderDiv.get_DocumentLeft();iT+=oM.get_DocumentTop();if(iT<0){iT=0}if(iL<0){iL=0}this.oDivMnthLst.set_Top(iT);this.oDivMnthLst.set_Left(iL);this.oDivMnthLst.moveToTop()};_oPrototype.selItem=function Owa$UIControls$DatePicker$selItem(oDayCell,f){if(oDayCell.get_Id()==SEL)return;oDayCell.set_Id(SEL);if(f)oDayCell.addCssClass(C_SEL)};_oPrototype.unselItem=function Owa$UIControls$DatePicker$unselItem(o){if(o.get_Id()==UNSEL)return;function unsel(oDayCell){oDayCell.set_Id(UNSEL);oDayCell.removeCssClass(C_SEL)}unsel(o);var dt=new Date(this.dt);dt.smo(dt.gmo()+1);var dtTd=this.getDayDt(o);var oM=this.getM(dt);var rgS=0;if(oM){rgS=this.findDy(dtTd,oM);if(rgS)unsel(rgS)}dt.smo(dt.gmo()-2);oM=this.getM(dt);rgS=0;if(oM){rgS=this.findDy(dtTd,oM);if(rgS)unsel(rgS)}};_oPrototype.unselAll=function Owa$UIControls$DatePicker$unselAll(oM){var rgS=this.getDyCells(oM?oM:this._get_Element(),SEL);for(var i=0;i<rgS.length;++i){this.unselItem(rgS[i])}};_oPrototype.getDayDt=function Owa$UIControls$DatePicker$getDayDt(o){var oM=o;while(oM){if(oM.hasCssClass("dpMonth")){break}oM=oM.get_ParentElement()}var iY=oM.getIntAttribute("y");var iM=oM.getIntAttribute("m");if(o.getAttribute("y")){iY=o.getIntAttribute("y")}if(o.getAttribute("m")){iM=o.getIntAttribute("m")}var sT=o.get_TextContent();return toDate(iY,iM,getInt(sT))};_oPrototype.getDyCells=function Owa$UIControls$DatePicker$getDyCells(o,sId){var rgE=o.getAllDescendantsById(sId);var rg=new Array();if(rgE){if(rgE.length==null){rg[0]=rgE}else{for(var i=0;i<rgE.length;++i){rg[i]=rgE[i]}}}return rg};_oPrototype._rndrM=function Owa$UIControls$DatePicker$_rndrM(dtM,oS,fE){if(this.fBsy)return;this.fBsy=1;var oC=new Object();oC.dtM=dtM;oC.fE=fE;oC.oS=oS;var oR=new oeReq("DatePicker","RenderMonth",oC,this._createCallback(this._cbRndrM),GET);oR.add("m",dtM);oR.add("uF",this._iFeatureMask);oR.send()};_oPrototype._cbRndrM=function Owa$UIControls$DatePicker$_cbRndrM(oR){if(oR.fST){popLgn();return}var oC=oR.oCtx;this.fBsy=0;if(oR.sErr){if(!this.get_OnError().get_IsEmpty())this._dispatchEvent(ON_ERROR,oR,1);else shwErrDlg(oR);return}var oD=this._get_Element().get_OwnerDocument();var oT=oD.createElement("div");oT.set_InnerHtml(oR.sBody);this.setM(oC.dtM,oT.get_FirstChild());this.restSel(oC.oS,oC.fE);this._dispatchEvent(ON_AFTER_MONTH_NAVIGATE,this);this._dispatchEvent(ON_ERROR,oR,0)};var ON_ERROR="error";var ON_DATE_SELECTION="dateSelection";var ON_MONTH_NAVIGATE="monthNavigate";var ON_AFTER_MONTH_NAVIGATE="afterMonthNavigate";var ON_AFTER_MONTH_LIST_SELECTED="afterMonthListSelected";_oPrototype.get_OnError=function Owa$UIControls$DatePicker$get_OnError(){return this._getEventHandlerCollection(ON_ERROR)};_oPrototype.get_OnDateSelection=function Owa$UIControls$DatePicker$get_OnDateSelection(){return this._getEventHandlerCollection(ON_DATE_SELECTION)};_oPrototype.get_OnMonthNavigate=function Owa$UIControls$DatePicker$get_OnMonthNavigate(){return this._getEventHandlerCollection(ON_MONTH_NAVIGATE)};_oPrototype.get_OnAfterMonthNavigate=function Owa$UIControls$DatePicker$get_OnAfterMonthNavigate(){return this._getEventHandlerCollection(ON_AFTER_MONTH_NAVIGATE)};_oPrototype.get_OnAfterMonthListSelected=function Owa$UIControls$DatePicker$get_OnAfterMonthListSelected(){return this._getEventHandlerCollection(ON_AFTER_MONTH_LIST_SELECTED)};Owa.UIControls.DatePicker.createClass("Owa.UIControls.DatePicker",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/DatePicker.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/DatePickerDropDown.js".toLowerCase()])(function(){var ON_CHANGE="onchange";Owa.UIControls.DatePickerDropDown=function(oElement,oParent){Owa.UIControls.DatePickerDropDown.constructBase(this,[oElement,oParent]);this._oDatePicker=null};Owa.UIControls.DatePickerDropDown.prototype.initialize=function Owa$UIControls$DatePickerDropDown$prototype$initialize(){Owa.UIControls.DatePickerDropDown.callBase(this,"initialize");var oDatePickerElement=this._getDescendant(this._get_Parent().get_Id()+"DP");this._oDatePicker=new Owa.UIControls.DatePicker(oDatePickerElement,this._createCallback(this._onChanged));this._oDatePicker.set_SubPage(this.get_SubPage());this._oDatePicker.get_OnAfterMonthListSelected().add(this._createCallback(this._onAfterMonthListSelected));this.get_OnPreShow().add(this._createCallback(this._onPreShow))};Owa.UIControls.DatePickerDropDown.prototype.dispose=function Owa$UIControls$DatePickerDropDown$prototype$dispose(){Owa.UIControls.DatePickerDropDown.callBase(this,"dispose")};Owa.UIControls.DatePickerDropDown.prototype.get_OnChange=function Owa$UIControls$DatePickerDropDown$prototype$get_OnChange(){return this._getEventHandlerCollection(ON_CHANGE)};Owa.UIControls.DatePickerDropDown.prototype._onKeyDown=function Owa$UIControls$DatePickerDropDown$prototype$_onKeyDown(oEvent){if(oEvent.get_KeyCodeForKeyUpDown()==9){this.close()}};Owa.UIControls.DatePickerDropDown.prototype._onChanged=function Owa$UIControls$DatePickerDropDown$prototype$_onChanged(){this._dispatchEvent(ON_CHANGE,this);this.close()};Owa.UIControls.DatePickerDropDown.prototype._onAfterMonthListSelected=function Owa$UIControls$DatePickerDropDown$prototype$_onAfterMonthListSelected(){this._suppressClose(true)};Owa.UIControls.DatePickerDropDown.prototype._onPreShow=function Owa$UIControls$DatePickerDropDown$prototype$_onPreShow(){this._oDatePicker.adjustWidth()};Owa.UIControls.DatePickerDropDown.prototype.close=function Owa$UIControls$DatePickerDropDown$prototype$close(){this._oDatePicker.oDivMnthLst.set_IsShown(false);Owa.UIControls.DatePickerDropDown.callBase(this,"close")};Owa.UIControls.DatePickerDropDown.prototype.get_SelectedValue=function Owa$UIControls$DatePickerDropDown$prototype$get_SelectedValue(){return this._oDatePicker.getSelDts()};Owa.UIControls.DatePickerDropDown.prototype.hasValue=function Owa$UIControls$DatePickerDropDown$prototype$hasValue(oValue){return Date.isInstance(oValue)};Owa.UIControls.DatePickerDropDown.prototype.selectValue=function Owa$UIControls$DatePickerDropDown$prototype$selectValue(oValue){var rgValue=oValue?[oValue]:null;this._oDatePicker.setSDs(rgValue)};Owa.UIControls.DatePickerDropDown.createClass("Owa.UIControls.DatePickerDropDown",Owa.UIControls.Popup)})();g_fModuleLoaded[".\\uicontrols/DatePickerDropDown.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/datecombobox.js".toLowerCase()])(function(){Owa.UIControls.DateComboBox=function Owa$UIControls$DateComboBox(oElement,oParent){Owa.UIControls.DateComboBox.constructBase(this,[oElement,oParent]);this._fSelectedValueCanBeNull=true};Owa.UIControls.DateComboBox.prototype._initializeDropDown=function Owa$UIControls$DateComboBox$prototype$_initializeDropDown(){this._oDropDownList=new Owa.UIControls.DatePickerDropDown(this._getDescendant(Owa.Strings.Ids.DatePickerDropDown),this);this._oDropDownList.set_SubPage(this.get_SubPage());this._oDropDownList.initialize()};Owa.UIControls.DateComboBox.prototype._initializeSelection=function Owa$UIControls$DateComboBox$prototype$_initializeSelection(){fmtDt.rgAbrDN=eval(this._getAttribute("rgAbrDN"));fmtDt.rgAbrMN=eval(this._getAttribute("rgAbrMN"));this._selectValue(this._oDropDownList.get_SelectedValue())};Owa.UIControls.DateComboBox.prototype._renderSelectedValue=function Owa$UIControls$DateComboBox$prototype$_renderSelectedValue(){var sV;if(!this._oSelectedValue){sV=L_None}else{sV=fmtDt(this._oSelectedValue,this._getAttribute("sWkdDtFmt"))}this._get_Element().getDescendantById(Owa.Strings.Ids.ComboTextDisplaySpan).set_TextContent(sV)};Owa.UIControls.DateComboBox.createClass("Owa.UIControls.DateComboBox",Owa.UIControls.ComboBox)})();g_fModuleLoaded[".\\uicontrols/datecombobox.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/PolicyContextMenuBase.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");var CHECKED_IMAGE="mtg-accept.gif";var UNCHECKED_IMAGE="clear.gif";Owa.UIControls.PolicyContextMenuBase=function Owa$UIControls$PolicyContextMenuBase(oSubPage){Owa.UIControls.PolicyContextMenuBase.constructBase(this);this.set_SubPage(oSubPage);this.get_OnSelect().add(this._createCallback(this._onSelectMenuItem));if(!Owa.Components.Application.get_ShouldExplicitDisposeResource()){this._attachEvent(Owa.Dom.Window.get_Current(),"unload",this.dispose)}};Owa.UIControls.PolicyContextMenuBase.prototype.dispose=function Owa$UIControls$PolicyContextMenuBase$dispose(){if(!Owa.Components.Application.get_ShouldExplicitDisposeResource()){this._detachEvent(Owa.Dom.Window.get_Current(),"unload",this.dispose)}Owa.UIControls.PolicyContextMenuBase.callBase(this,"dispose")};Owa.UIControls.PolicyContextMenuBase.prototype.set_LocalFolderId=function Owa$UIControls$PolicyContextMenuBase$set_LocalFolderId(sLocalFolderId){this._sLocalFolderId=sLocalFolderId};Owa.UIControls.PolicyContextMenuBase.prototype.set_SelectedIds=function Owa$UIControls$PolicyContextMenuBase$set_SelectedIds(rgSelectedIds){if(!this._rgSelectedIds||(rgSelectedIds.length==1&&(this._rgSelectedIds.length!=1||rgSelectedIds[0]!=this._rgSelectedIds[0]))){this._markDirty()}else if(rgSelectedIds.length>1&&this._get_Element()){this._uncheckAll()}this._rgSelectedIds=rgSelectedIds};Owa.UIControls.PolicyContextMenuBase.prototype._markDirty=function Owa$UIControls$PolicyContextMenuBase$_markDirty(){if(this._get_Element()){this._get_Element().remove(true);this._oElement=null}};Owa.UIControls.PolicyContextMenuBase.prototype._uncheckAll=function Owa$UIControls$PolicyContextMenuBase$_uncheckAll(){var rgAllIds=this.getAllMenuItemIds();for(var iIndex=0;iIndex<rgAllIds.length;iIndex++){if(rgAllIds[iIndex]!="divS1"){this.replaceMenuItemIcon(rgAllIds[iIndex],UNCHECKED_IMAGE)}}};Owa.UIControls.PolicyContextMenuBase.prototype._onSelectMenuItem=function Owa$UIControls$PolicyContextMenuBase$_onSelectMenuItem(oEventArgs){var sTag=oEventArgs.sCommand;if(sTag=="inheritPolicy"){this._inheritPolicy()}else{this._applyPolicy(sTag)}if(this._oParentPopup){this._oParentPopup._fireOnSelect(oEventArgs)}};Owa.UIControls.PolicyContextMenuBase.prototype._createLoadHtmlContentRequest=function Owa$UIControls$PolicyContextMenuBase$_createLoadHtmlContentRequest(fnCallback){var oR=this._createGetMenuReq(fnCallback);if(this._rgSelectedIds&&this._rgSelectedIds.length==1){oR.add("id",this._rgSelectedIds[0])}return oR};Owa.UIControls.PolicyContextMenuBase.prototype._createGetMenuReq=function Owa$UIControls$PolicyContextMenuBase$_createGetMenuReq(fnCallback){throw Error("Not implemented")};Owa.UIControls.PolicyContextMenuBase.prototype._applyPolicy=function Owa$UIControls$PolicyContextMenuBase$_applyPolicy(sTag){throw Error("Not implemented")};Owa.UIControls.PolicyContextMenuBase.prototype._inheritPolicy=function Owa$UIControls$PolicyContextMenuBase$_inheritPolicy(){throw Error("Not implemented")};Owa.UIControls.PolicyContextMenuBase.prototype._cbPolicyChanged=function Owa$UIControls$PolicyContextMenuBase$_cbPolicyChanged(oR,oSndr,rgIds,sTag){if(!cbOeh(oR,true))return;var fSndBM=oSndr==this;if(fSndBM){if(oR.isErr()){shwErrDlg(oR);return}this._uncheckAll();this.replaceMenuItemIcon(sTag,CHECKED_IMAGE)}else{this._markDirty()}};Owa.UIControls.PolicyContextMenuBase.createClass("Owa.UIControls.PolicyContextMenuBase",Owa.UIControls.LazyLoadContextMenu)})();g_fModuleLoaded[".\\uicontrols/PolicyContextMenuBase.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/deletepolicycontextmenu.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");Owa.UIControls.DeletePolicyContextMenu=function Owa$UIControls$DeletePolicyContextMenu(oSubPage){Owa.UIControls.DeletePolicyContextMenu.constructBase(this,[oSubPage]);g_oEd.attachEvent("ApplyDeletePolicy",this,"_cbApplyDeletePolicy");g_oEd.attachEvent("InheritDeletePolicy",this,"_cbInheritDeletePolicy")};Owa.UIControls.DeletePolicyContextMenu.prototype.dispose=function Owa$UIControls$DeletePolicyContextMenu$dispose(){this.get_SubPage()._oDeletePolicyContextMenu=null;g_oEd.detachEvent("ApplyDeletePolicy",this,"_cbApplyDeletePolicy");g_oEd.detachEvent("InheritDeletePolicy",this,"_cbInheritDeletePolicy");Owa.UIControls.DeletePolicyContextMenu.callBase(this,"dispose")};Owa.UIControls.DeletePolicyContextMenu.get_Instance=function Owa$UIControls$DeletePolicyContextMenu$get_Instance(oSubPage){oSubPage=oSubPage||Owa.UIControls.SubPage.get_Instance();if(!oSubPage._oDeletePolicyContextMenu){oSubPage._oDeletePolicyContextMenu=new Owa.UIControls.DeletePolicyContextMenu(oSubPage)}return oSubPage._oDeletePolicyContextMenu};Owa.UIControls.DeletePolicyContextMenu.prototype._createGetMenuReq=function Owa$UIControls$DeletePolicyContextMenu$_createGetMenuReq(fnCallback){return new oeReq("DeletePolicy","GetPolicyMenu",0,fnCallback,GET)};Owa.UIControls.DeletePolicyContextMenu.prototype._applyPolicy=function Owa$UIControls$DeletePolicyContextMenu$_applyPolicy(sTag){g_oPtgMgr.applyPolicy("DeletePolicy",this,this._rgSelectedIds,sTag,this._sLocalFolderId)};Owa.UIControls.DeletePolicyContextMenu.prototype._inheritPolicy=function Owa$UIControls$DeletePolicyContextMenu$_inheritPolicy(){g_oPtgMgr.inheritPolicy("DeletePolicy",this,this._rgSelectedIds,this._sLocalFolderId)};Owa.UIControls.DeletePolicyContextMenu.prototype._cbApplyDeletePolicy=function Owa$UIControls$DeletePolicyContextMenu$_cbApplyDeletePolicy(oR,oSndr,rgIds,sTag){this._cbPolicyChanged(oR,oSndr,rgIds,sTag)};Owa.UIControls.DeletePolicyContextMenu.prototype._cbInheritDeletePolicy=function Owa$UIControls$DeletePolicyContextMenu$_cbInheritDeletePolicy(oR,oSndr,rgIds){this._cbPolicyChanged(oR,oSndr,rgIds,"inheritPolicy")};Owa.UIControls.DeletePolicyContextMenu.createClass("Owa.UIControls.DeletePolicyContextMenu",Owa.UIControls.PolicyContextMenuBase)})();g_fModuleLoaded[".\\uicontrols/deletepolicycontextmenu.js".toLowerCase()]=1;var FA_None=0;var FA_Dflt=1;var FA_SpDt=7;var FA_DtRem=8;var FA_MrkCmpl=9;var FA_ClrFlg=10;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/flagcontextmenu.js".toLowerCase()])(function(){Owa.UIControls.FlagContextMenu=function Owa$UIControls$FlagContextMenu(oSubPage){Owa.UIControls.FlagContextMenu.constructBase(this);this.set_SubPage(oSubPage);this._iSelectCount=1;this._fConversation=false;this.get_OnSelect().add(this._createCallback(this._onSelectMenuItem));this.get_OnClose().add(this._createCallback(this._onClose));this.get_OnPreShow().add(this._createCallback(this._onPreShow))};Owa.UIControls.FlagContextMenu.createClass("Owa.UIControls.FlagContextMenu",Owa.UIControls.LazyLoadContextMenu);var _oPrototype=Owa.UIControls.FlagContextMenu.prototype;_oPrototype.initialize=function Owa$UIControls$FlagContextMenu$initialize(){Owa.UIControls.FlagContextMenu.callBase(this,"initialize");this._iDefaultFlagAction=getInt(this._get_Element().getAttribute("iFlgDft"));if(!this._iFlagAction)this.set_FlagAction(getInt(this._get_Element().getAttribute("iFA")));this._getMenuItem("divFA"+new String(FA_SpDt)).getDescendantById("imgI").addCssClass("opacity100");this._oDateCombo=new Owa.UIControls.DateComboBox(this._getDescendant("divFlgD"));this._oDateCombo.set_SubPage(this.get_SubPage());this._oDateCombo.initialize();this._oDateCombo.get_DropDownList().get_OnClose().add(this._createCallback(this._onDatePickerClose));this._oDateCombo.get_OnChange().add(this._createCallback(this._onDateComboValueChanged));this._oDateCombo.get_OnShow().add(this._createCallback(this._onDatePickerPreShow))};_oPrototype.dispose=function Owa$UIControls$FlagContextMenu$dispose(){Owa.UIControls.FlagContextMenu.callBase(this,"dispose");if(this._oDateCombo){this._oDateCombo.dispose()}};_oPrototype._reset=function Owa$UIControls$FlagContextMenu$_reset(){if(this._resetting)return;this._resetting=1;try{if(this.get_IsShown())this.close();this.get_OnSelectFlag().clear();this.set_SelectCount();this.set_FlagAction();this.set_ItemId();this.set_DueDate();this.set_IsSelectedItemTask();this.set_FlagButton()}finally{this._resetting=0}};_oPrototype.set_SelectCount=function Owa$UIControls$FlagContextMenu$set_SelectCount(iCount){this._iSelectCount=iCount};_oPrototype.set_FlagAction=function Owa$UIControls$FlagContextMenu$set_FlagAction(iAction){this._iFlagAction=iAction};_oPrototype.set_ItemId=function Owa$UIControls$FlagContextMenu$set_ItemId(sId){this._sItemId=sId};_oPrototype.set_DueDate=function Owa$UIControls$FlagContextMenu$set_ItemDueDate(dtDate){this._sDueDate=dtDate};_oPrototype.set_IsSelectedItemTask=function Owa$UIControls$FlagContextMenu$set_IsSelectedItemTask(f){this._fIsSelectedItemTask=f};_oPrototype.set_FlagButton=function Owa$UIControls$FlagContextMenu$set_FlagButton(oButton){this._oFlagButton=oButton};_oPrototype.set_IsOnConversationHeader=function Owa$UIControls$FlagContextMenu$set_IsOnConversationHeader(fC){this._fConversation=fC};_oPrototype._onPreShow=function Owa$UIControls$FlagContextMenu$_onPreShow(){if(this._oFlagButton){this._oFlagButton.set_IsPushed(true)}if(this._iFlagAction==FA_Dflt){this._iFlagAction=this._iDefaultFlagAction}this.enableMenuItemByCommand(new String(FA_DtRem),!this._fConversation&&this._iSelectCount==1);if(this._iSelectCount==1){this._updateFlagIconSelection();this.enableMenuItemByCommand(new String(FA_ClrFlg),Owa.UIControls.FlagContextMenu.isFlagAction(this._iFlagAction)||this._iFlagAction==FA_MrkCmpl);if(this._fConversation){this._oDateCombo.set_IsEnabled(false);this._oDateCombo.set_SelectedValue(new Date(),true)}else{this._oDateCombo.set_IsEnabled(true);if(this._sDueDate)this._oDateCombo.set_SelectedValue(this._sDueDate,true)}this.showMenuItem("divFlgDlt",this._fIsSelectedItemTask);this.showMenuItem("divFlgClr",!this._fIsSelectedItemTask);this.showMenuItem("divFlgClrDlt",false)}else{this.set_FlagAction(0);this._updateFlagIconSelection();this.showMenuItem("divFlgClrDlt",true);this.showMenuItem("divFlgDlt",false);this.showMenuItem("divFlgClr",false)}};_oPrototype._updateFlagIconSelection=function Owa$UIControls$FlagContextMenu$_updateFlagIconSelection(){if(Owa.UIControls.FlagContextMenu.isFlagAction(this._iUISelectedFlagAction)){var oDivFA=this._getDescendant("divFA"+this._iUISelectedFlagAction);var oImageSpanFA=oDivFA.getDescendantById("spnImg");oImageSpanFA.removeCssClass("sel");this._iUISelectedFlagAction=null}if(Owa.UIControls.FlagContextMenu.isFlagAction(this._iFlagAction)){var oDivFA=this._getDescendant("divFA"+this._iFlagAction);var oImageSpanFA=oDivFA.getDescendantById("spnImg");oImageSpanFA.addCssClass("sel");this._iUISelectedFlagAction=this._iFlagAction}};_oPrototype._onSelectMenuItem=function Owa$UIControls$FlagContextMenu$_onSelectMenuItem(oEventArgs){var sCommand=oEventArgs.sCommand;this._onSelect(sCommand,null)};_oPrototype._onSelect=function Owa$UIControls$FlagContextMenu$_onSelect(sCommand,dtDate){if(typeof(sCommand)=="string"&&sCommand.startsW('d')){var iFA=getInt(sCommand.substring(1));if(iFA==this._iDefaultFlagAction)return;var oR=new oeReq("Flg","PFA",0,cbOeh);oR.add("flga",iFA);oR.send();var oDiv=this._getDescendant("divDFA"+this._iDefaultFlagAction);var oFlag=oDiv.getDescendantById("spnImg").getDescendantById("imgI");var oDiv=this._getDescendant("divDFA"+iFA);var oSpacer=oDiv.getDescendantById("spnImg").getDescendantById("imgI");oFlag.swap(oSpacer);this._iDefaultFlagAction=iFA}else{this.set_FlagAction(getInt(sCommand));this._dispatchEvent(ON_SELECT_FLAG,{"sCommand":sCommand,"dtDate":dtDate})}};_oPrototype._onClose=function Owa$UIControls$FlagContextMenu$_onClose(){if(this._oFlagButton){this._oFlagButton.set_IsPushed(false)}this._reset()};_oPrototype._onDatePickerPreShow=function Owa$UIControls$FlagContextMenu$_onDatePickerPreShow(){this._suppressClose(false)};_oPrototype._onDatePickerClose=function Owa$UIControls$FlagContextMenu$_onDatePickerClose(){this._setTimeout(this._enableClose,1)};_oPrototype._onDateComboValueChanged=function Owa$UIControls$FlagContextMenu$_onDateComboValueChanged(){this._onSelect(FA_SpDt,this._oDateCombo._oDropDownList.get_SelectedValue());this.close()};_oPrototype._createLoadHtmlContentRequest=function Owa$UIControls$FlagContextMenu$_createLoadHtmlContentRequest(fnCallback){var oR=new oeReq("Flg","gtFM",0,fnCallback,GET);if(this._sItemId)oR.add("id",this._sItemId);return oR};var oInstance;Owa.UIControls.FlagContextMenu.get_Instance=function Owa$UIControls$FlagContextMenu$get_Instance(fReset){if(!oInstance)oInstance=Owa.UIControls.FlagContextMenu._createInstance();if(fReset)oInstance._reset();return oInstance};Owa.UIControls.FlagContextMenu._createInstance=function Owa$UIControls$FlagContextMenu$_createInstance(){return oInstance=new Owa.UIControls.FlagContextMenu(Owa.Components.Application.get_RootSubPage())};Owa.UIControls.FlagContextMenu.isFlagAction=function Owa$UIControls$FlagContextMenu$isFlagAction(iFA){return iFA&&iFA<=FA_SpDt};var ON_SELECT_FLAG="onSelectFlag";_oPrototype.get_OnSelectFlag=function Owa$UIControls$FlagContextMenu$get_OnSelectFlag(){return this._getEventHandlerCollection(ON_SELECT_FLAG)}})();g_fModuleLoaded[".\\uicontrols/flagcontextmenu.js".toLowerCase()]=1;Type.createNamespace("Owa.Components");if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/startduedatecomboboxpaircontroller.js".toLowerCase()])(function(){Owa.Components.StartDueDateComboBoxPairController=function Owa$Components$StartDueDateComboBoxPairController(oStartDateComboBox,oEndDateComboBox){Owa.Components.StartDueDateComboBoxPairController.constructBase(this);this._oStartDateComboBox=oStartDateComboBox;this._oEndDateComboBox=oEndDateComboBox;oStartDateComboBox.get_OnChange().add(this._createCallback(this._onChangeStartDate));oEndDateComboBox.get_OnChange().add(this._createCallback(this._onChangeEndDate))};Owa.Components.StartDueDateComboBoxPairController.createClass("Owa.Components.StartDueDateComboBoxPairController",Owa.Components.Control);var _oPrototype=Owa.Components.StartDueDateComboBoxPairController.prototype;_oPrototype._onChangeStartDate=function Owa$Components$StartDueDateComboBoxPairController$_onChangeStartDate(){var dtStart=this._oStartDateComboBox.get_SelectedValue();var dtEnd=this._oEndDateComboBox.get_SelectedValue();if(dtStart&&!dtEnd)this._oEndDateComboBox.set_SelectedValue(dtStart,true);else if(dtEnd<dtStart)this._oEndDateComboBox.set_SelectedValue(dtStart,true)};_oPrototype._onChangeEndDate=function Owa$Components$StartDueDateComboBoxPairController$_onChangeEndDate(){var dtStart=this._oStartDateComboBox.get_SelectedValue();var dtEnd=this._oEndDateComboBox.get_SelectedValue();if(dtEnd<dtStart){this._oStartDateComboBox.set_SelectedValue(dtEnd,true)}}})();g_fModuleLoaded[".\\components/startduedatecomboboxpaircontroller.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/flagdialog.js".toLowerCase()])(function(){Owa.UIControls.FlagDialog=function Owa$UIControls$FlagDialog(sHtmlContent,sTitle){Owa.UIControls.FlagDialog.constructBase(this,["divFD",sHtmlContent,sTitle,[L_OK,L_Cncl],300])};Owa.UIControls.FlagDialog.createClass("Owa.UIControls.FlagDialog",Owa.UIControls.ButtonDialog);var _oPrototype=Owa.UIControls.FlagDialog.prototype;_oPrototype.initialize=function Owa$UIControls$FlagDialog$initialize(){this.get_OnButtonDialogClose().add(this._createCallback(this._onButtonDialogClose));this._oStartCombo=new Owa.UIControls.DateComboBox(this._getDescendant("tblFlgSD"));this._oEndCombo=new Owa.UIControls.DateComboBox(this._getDescendant("tblFlgDD"));this._oStartCombo.set_SubPage(this.get_SubPage());this._oEndCombo.set_SubPage(this.get_SubPage());this._oStartCombo.initialize();this._oEndCombo.initialize();new Owa.Components.StartDueDateComboBoxPairController(this._oStartCombo,this._oEndCombo);var oReminderMe=this._getDescendant("tblFlgRD");if(oReminderMe){this._oReminderDate=new Owa.UIControls.DateComboBox(this._getDescendant("tblFlgRD"));this._oReminderDate.set_SubPage(this.get_SubPage());this._oReminderDate.initialize();this._oReminderDate.get_OnChange().add(this._createCallback(this._onReminderDateChange));this._oReminderTime=new Owa.UIControls.TimeComboBox(this._getDescendant("divFlgRT"));this._oReminderTime.set_SubPage(this.get_SubPage());this._oReminderTime.initialize();this._oReminderTime.get_OnChange().add(this._createCallback(this._onReminderTimeChange));this._attachEvent(this._getDescendant("chkRM"),"click",this._updateReminderCombosState);this._updateReminderCombosState()}};_oPrototype.dispose=function Owa$UIControls$FlagDialog$dispose(){this._oStartCombo.dispose();this._oEndCombo.dispose();if(this._oReminderDate){this._oReminderDate.dispose()}if(this._oReminderTime){this._oReminderTime.dispose()}Owa.UIControls.FlagDialog.callBase(this,"dispose")};_oPrototype._onButtonDialogClose=function Owa$UIControls$FlagDialog$_onButtonDialogClose(iB){oInstance=null;if(iB!=0)return;var oR=new oeReq("Flg","dtRm",{"onFlagDialogValueSet":g_fnOnFlagDialogValueSet},cbFlagDialogValueSet);if(!g_sId){if(isDf(typeof(g_sFolderId))&&g_sFolderId)oR.add("fldrId",g_sFolderId);oR.add("typ",g_iType)}else{oR.add("id",g_sId);if(g_sChangeKey)oR.add("ck",g_sChangeKey)}var dtS=this._oStartCombo.get_SelectedValue();if(dtS)oR.add("sdt",dtS);var dtD=this._oEndCombo.get_SelectedValue();if(dtD)oR.add("ddt",dtD);var oCheckBox=this._getDescendant("chkRM");if(oCheckBox&&oCheckBox.get_IsChecked()){oR.add("rem",this._oReminderTime.get_SelectedValue())}oR.send()};function cbFlagDialogValueSet(oR){if(!cbOeh(oR))return;eval(oR.sBody);if(!iError){oR.oCtx.onFlagDialogValueSet(iFA,sId,sCK,sIBMsg,dtDD)}}_oPrototype._onReminderDateChange=function Owa$UIControls$FlagDialog$_onReminderDateChange(oReminderDate){var dt=cpyDt(this._oReminderDate.get_SelectedValue(),new Date(this._oReminderTime.get_SelectedValue()));this._oReminderTime.set_SelectedValue(dt,true)};_oPrototype._onReminderTimeChange=function Owa$UIControls$FlagDialog$_onReminderTimeChange(oReminderTime){this._oReminderDate.set_SelectedValue(this._oReminderTime.get_SelectedValue(),true)};_oPrototype._updateReminderCombosState=function Owa$UIControls$FlagDialog$_updateReminderCombosState(){var f=this._getDescendant("chkRM").get_IsChecked();this._oReminderDate.set_IsEnabled(f);this._oReminderTime.set_IsEnabled(f);var oTxtTime=this._getDescendant("divFlgRT").getDescendantById("txtTime");oTxtTime.set_IsDisabled(!f)};var oInstance=null;var fLoading=false;var g_sId;var g_sChangeKey;var g_sFolderId;var g_iType;var g_fnOnFlagDialogValueSet;Owa.UIControls.FlagDialog.loadInstanceAndShow=function Owa$UIControls$FlagDialog$loadInstanceAndShow(fnOnFlagDialogValueSet,sId,sCK,sFldId,iT){if(fLoading||oInstance)return;g_sId=sId;g_sChangeKey=sCK;g_sFolderId=sFldId;g_iType=iT;g_fnOnFlagDialogValueSet=fnOnFlagDialogValueSet;var oR=new oeReq("Flg","gtFD",null,cbGetFlagDialog,GET);if(sId)oR.add("id",sId);if(isDf(typeof(a_sFldId))&&a_sFldId)oR.add("fldrId",a_sFldId);oR.send();fLoading=1};function cbGetFlagDialog(oR){fLoading=0;if(!cbOeh(oR))return;eval(oR.sBody);oInstance=new Owa.UIControls.FlagDialog(sD,sDT);oInstance.initialize();oInstance.show()}})();g_fModuleLoaded[".\\uicontrols/flagdialog.js".toLowerCase()]=1;function initHBtns(rgBtn,fIn){for(var i=0;i<rgBtn.length;++i){var oB=rgBtn[i];oB.onmouseover=fIn?onHBOvr:null;oB.onmouseout=fIn?onHBOut:null;oB.onmousedown=fIn?onHBDn:null;oB.onmouseup=fIn?onHBUp:null}}function onHBDn(){ApplyButtonStyle(this,this._tbb?g_oDwnTB:g_oDwn)}function onHBUp(){ApplyButtonStyle(this,g_oFlt)}function onHBOvr(){ApplyButtonStyle(this,this._tbb?g_oRsdTB:g_oRsd)}function onHBOut(){ApplyButtonStyle(this,g_oFlt)}function CtxMnu(divMnu,fnOnSel,fnOnHid,oPM,fnOnSubHid,fnOnBfHid,fNSM,fnOnShw){divMnu.fnOnSel=fnOnSel;divMnu.fnOnHid=fnOnHid;divMnu.fnOnBfHid=fnOnBfHid;divMnu.fnOnShw=fnOnShw;divMnu.show=ctxMnuShw;divMnu.hide=ctxMnuHd;divMnu.getCMW=ctxMnuGetCMW;if(!oPM)divMnu.onfocusout=ctxMnuOnFcsO;attchEvt(divMnu,"click",ctxMnuOnClk);divMnu.oncontextmenu=new Function("return(0)");divMnu.onkeydown=new Function("e","cmKyDn(e, this)");divMnu.onmouseover=new Function("e","cmMs(e, this, 1)");divMnu.onmouseout=new Function("e","cmMs(e, this, 0)");divMnu.oPM=oPM;divMnu.sCmd=null;divMnu._isMnu=1;var rgChld=getAllDescendants(divMnu);for(var i=0;i<rgChld.length;i++){var oI=rgChld[i];if(gtAttrN(oI,"_lnk")==1&&oI.getAttribute("sSmId"))CtxMnu(wda(oI.getAttribute("sSmId")),fnOnSel,fnOnSubHid,divMnu,fnOnSubHid,0,fNSM,fnOnShw)}divMnu.lnks=cmLnks(divMnu,0,fNSM);divMnu._fNSM=fNSM;if(divMnu.fScrl){divMnu.onkeydown=ctxMnuOnKD;divMnu.style.height=(divMnu.lnks.length>10)?"21em":""}}function ctxChngImg(oMI,sIcn){var oImg=getOneDescendant(oMI,"imgI");if(oImg)Owa.Components.CssSprites.updateImage(Owa.Dom.Node.wrapDomNode(oImg),sIcn)}function dispCtxMnu(divMnu){divMnu.getCMW=divMnu.fnOnSel=divMnu.fnOnHid=divMnu.show=divMnu.hide=divMnu.onfocusout=null;divMnu.oncontextmenu=divMnu.onkeydown=divMnu.onmouseover=divMnu.onmouseout=null;divMnu.getCMW=null;dtchEvt(divMnu,"click",ctxMnuOnClk);divMnu.oPM=null;divMnu.sCmd=null;var rgAll=getAllDescendants(divMnu);for(var i=0;i<rgAll.length;i++){var oI=rgAll[i];if(oI.getAttribute("sSmId"))dispCtxMnu($(oI.getAttribute("sSmId"))._get_DomNode())}if(divMnu.lnks){for(var i=0;i<divMnu.lnks.length;++i){divMnu.lnks[i]=null}divMnu.lnks=null}divMnu.cachedItmColl=null}function ctxMnuShw(oE,iX,iY){setVsblEm(this);showEm(this);this.lnks=cmLnks(this,0,this._fNSM);this.fPH=0;var fFW=gtStl(this,"width")!="auto";var iM;if(!fFW)iM=this.getCMW();if((fFW&&!this.fWS)||!fFW){for(var i=0;i<this.lnks.length;++i){var oS=getOneChild(this.lnks[i],"spnT");if(!oS)continue;if(fFW)iM=this.getCMW(oS.parentNode);if(this.lnks[i].getAttribute("sSmId")){var iSpacerWidth=iM-gow(oS);if(iSpacerWidth<1)iSpacerWidth=1;oS.nextSibling.style.width=iSpacerWidth+"px"}oS.style.overflowX="hidden";oS.style.textOverflow="ellipsis"}}this.fWS=1&&fFW;cmShow(this,oE,iX,iY);setVsblEm(this,1);setFcs(this);if(this.fnOnShw)this.fnOnShw(this.sCmd)}function ctxMnuGetCMW(oMI){var fFW=gtStl(this,"width")!="auto";var fFW=0;if(fFW&&!oMI)return 0;var iM=0;var i=0;var iAW=0;var iIcw=0;if(!fFW){for(;i<this.lnks.length;++i){var oMI=this.lnks[i];var oS=getOneDescendant(oMI,"spnT");if(!oS)continue;var iW=gtw(oS);if(iM<iW)iM=iW}}else{var oIcn=getOneDescendant(oMI,"spnImg");if(!oIcn){var oImg=getOneDescendant(oMI,"imgRA");if(oImg)oIcn=oImg.parentNode}if(oIcn){var iW=gtw(oIcn);if(iIcw<iW)iIcw=iW}var oSA=getOneDescendant(oMI,"imgRA");if(oSA)iAW=gtw(oSA)}if(fFW){var fPx=this.currentStyle.width.indexOf("px")>=0;var iTW=fPx?parseInt(0+this.currentStyle.width,10):gsw(this);iM=iTW-parseInt(0+this.currentStyle.borderLeftWidth,10)-parseInt(0+this.currentStyle.borderRightWidth,10)-parseInt(0+this.currentStyle.paddingLeft,10)-parseInt(0+this.currentStyle.paddingRight,10)-parseInt(0+oMI.currentStyle.paddingLeft,10)-parseInt(0+oMI.currentStyle.paddingRight,10)-iIcw-iAW}return iM}function ctxMnuOnClk(e){var iL=cmSelIdx(this.lnks);if(0<=iL){var oMI=this.lnks[iL];if(oMI.getAttribute("sSmId"))return;this.sCmd=oMI.getAttribute("cmd");this.fPH=1;var fKO=0;if(this.fnOnSel)fKO=this.fnOnSel(this.sCmd,this.lnks[iL],e);if(!fKO){this.hide(1,1)}else{this.fPH=0}}}function ctxMnuOnFcsO(e){e=e?e:event;if(this._fStick){return}if(this.fSuppressHide){return}var oTo=e.toElement;while(oTo&&oTo.id!=this.id&&oTo.tagName!="BODY"){if(this.subMnu&&oTo.id==this.subMnu.id){break}oTo=oTo.parentNode}if(oTo&&oTo.tagName!="BODY"){return}this.hide()}function ctxMnuOnKD(e){e=e?e:event;switch(getKeyCode(e)){case 40:case 38:case 36:cmKyDn(e,this);var iIdx=cmSelIdx(this.lnks);ctxMnuScrl(this.lnks,iIdx);break;default:cmKyDn(e,this);break}canEvt()}function ctxMnuHd(fFH,fCP){if(this.fnOnBfHid&&this.fnOnBfHid())return;if(this.fPH&&!fFH){return}this.fPH=1;cmHdSM(this);hideEm(this);cmClrItmFx(this.lnks);if(this.oPM&&fCP)this.oPM.hide();if(this.fnOnHid)this.fnOnHid(this.sCmd)}function ctxMnuDsbl(o,fD){if(!ctxMnuDsbl.oDsbl)ctxMnuDsbl.oDsbl=getStyle("cmDsbld");var oS=o.style;oS.color=fD?ctxMnuDsbl.oDsbl.color:"";oS.cursor=fD?ctxMnuDsbl.oDsbl.cursor:"";o.setAttribute("_lnk",!fD?1:0)}function ctxMnuScrl(rg,iIdx){var iIdx=cmSelIdx(rg);if(iIdx>-1){var o=rg[iIdx];var i=isClpd(o);var oP=gtScrPrnt(o,1);if(oP){if(i<0){oP.scrollTop=getCY(o,0,oP)}else if(i>0){var iCy=getCY(o,0,oP);var iOh=iCy-(goh(oP)-goh(o));oP.scrollTop=(iOh>=0?iOh:iCy)}}}}function isClpd(o){if(o.offsetParent.scrollTop>o.offsetTop)return -1;if(o.offsetTop+goh(o)-o.offsetParent.scrollTop>goh(o.offsetParent))return 1;return 0}function cmLnks(o,fAll,fNSM){var rg=new Array();var rgE=getAllDescendants(o);for(var i=0;i<rgE.length;i++){var oC=rgE[i];if((gtAttrN(oC,"_lnk")==1||fAll)&&Owa.Dom.Node.wrapDomNode(oC).get_IsShown())if(!fNSM||gtCtxMnu(oC)==o)rg.push(oC)}return rg}function gtCtxMnu(oLnk){var o=oLnk;while(o.parentNode){if(o.parentNode._isMnu)return o.parentNode;o=o.parentNode}}function cmClrItmFx(rg){for(var i=0;i<rg.length;i++)cmItmFx(rg[i],0)}function cmSelIdx(rg){for(var i=0;i<rg.length;i++){if(rg[i].uniqueID){var oE=wda(rg[i].uniqueID)}else{var oE=rg[i]}if((oE==null)&&rg[i].id)oE=wda(rg[i].id);if(oE._sel==1)return i}return -1}function cmGetEmByC(o,sC){var rg=cmLnks(o,1);for(var i=0;i<rg.length;i++){if(rg[i].getAttribute("cmd")==sC)return rg[i]}return 0}function cmDsblC(o,sC,f){var oEm=cmGetEmByC(o,sC);if(oEm)ctxMnuDsbl(oEm,f)}function cmSelByC(o,sC){var oEm=cmGetEmByC(o,sC);if(oEm)cmItmFx(oEm,1)}function cmStyle(){var oEm=getEm("DIV");oEm.style.display="none";ibe(document.body,oEm);g_ocmS=new ButtonStyle(oEm,"cmHiLite");rn(oEm)}function cmItmFx(o,f){if(!g_ocmS){cmStyle()}o.style.backgroundColor=f?g_ocmS.backgroundColor:"";o.style.borderColor=f?g_ocmS.borderColor:"";o._sel=f?1:0;if(f){try{o.focus()}catch(e){}}}function cmShow(o,oE,iX,iY){showEm(o);if(oE&&!iX&&!iY){iX=getEvtCX(oE);iY=getEvtCY(oE);if(g_fRtl)iX-=gcw(o)}if(g_fRtl){iX-=gow(o)}o.style.left=getVisiblePositionX(o,iX)+"px";o.style.top=getVisiblePositionY(o,iY)+"px";if(g_fRtl&&oE)o.style.left=getVisiblePositionX(o,getEvtCX(oE)-o.clientWidth)+"px"}function cmKyDn(e,oM){if(oM._fNoHkKey)return;e=e?e:event;var fSp=oM.word?1:0;var rg=oM.lnks;var iIdx=cmSelIdx(rg);switch(getKeyCode(e)){case 27:oM.hide();if(fSp)posElm(oM.word,1);break;case 37:if(fSp)posElm(oM.word,1);break;case 39:if(fSp)posElm(oM.word,0);break;case 40:if(iIdx>-1){if(iIdx<rg.length-1){cmItmFx(rg[iIdx],0);cmItmFx(rg[iIdx+1],1)}}else{if(rg.length)cmItmFx(rg[0],1)}break;case 38:if(iIdx>-1){if(iIdx>0){cmItmFx(rg[iIdx],0);cmItmFx(rg[iIdx-1],1)}}break;case 13:if(iIdx>-1){Owa.Dom.Node.wrapDomNode(rg[iIdx]).click()}break;case 35:if(iIdx>-1)cmItmFx(rg[iIdx],0);cmItmFx(rg[rg.length-1],1);break;case 36:if(iIdx>-1)cmItmFx(rg[iIdx],0);cmItmFx(rg[0],1);break}canEvt(e)}function posElm(o,f){if(o.fR){var oR=o.duplicate();doCllps(oR,f)}else{mvIP(o,f,edDoc())}}function cmMs(e,oM,f){e=e?e:event;var o=getEvtTgt(e);var rg=oM.lnks;canEvt(e);while(o&&o!=document){var iLnk=gtAttrN(o,"_lnk");if(iLnk){if(iLnk==1){if(f)cmClrItmFx(rg);cmItmFx(o,f);if(!oM.oSM||(oM.oSM&&oM.oSM.id!=o.getAttribute("sSmId"))){if(f&&o.getAttribute("sSmId")){cmHdSM(oM);var oSM=wda(o.getAttribute("sSmId"));var oNode=Owa.Dom.Node.wrapDomNode(o);var iL=oNode.get_PositionalLeft();var iX=oNode.get_OffsetWidth();var iY=oNode.get_PositionalTop();if(g_fRtl)iX=0;var iOffY=Owa.Dom.Node.wrapDomNode(oSM).getExpando("_iOffY");if(iOffY)oSM.show(null,iX,iY+iOffY);else oSM.show(null,iX,iY);var iW=gow(oSM);var fMO=0;if(g_fRtl){if(0<iW+gol(oSM))fMO=1}else{if(4<gow(oM)-gol(oSM))fMO=1}if(fMO){var iDmwL=getCX(oM);var iDmwR=gow(wdb())-gow(oM)-iDmwL;var iXL=iL-iW;var iXR=iL+gow(o);splc(oSM,iDmwL>iDmwR?iXL:iXR)}oM.oSM=oSM}else if(oM.oSM&&oM.oSM.id!=o.getAttribute("sSmId")&&!cntns(oM.oSM,o)){cmHdSM(oM)}}else if(oM.oSM&&oM.oSM.id==o.getAttribute("sSmId")){cmItmFx(o,1)}}return}o=o.parentNode}}function cntns(oC,oE,fU){while(oE&&((!fU&&oE.id!=oC.id)||(fU&&oE.uniqueID!=oC.uniqueID)))oE=oE.parentNode;return oE!=null}function cmHdSM(oM){if(!oM.oSM)return;oM.oSM.hide();oM.oSM=null}function cmShwEm(rg,fH,fG,fC){var o;for(var i=0;i<rg.length;i++){o=rg[i];if(isDf(typeof(fC))){var img=getOneDescendant(o,"spnImg");if(img)img.className=fC?"cmPnChk":"cmIco"}if(isDf(typeof(fG))&&fG){showEm(o);errSty(o,1);o.setAttribute("_lnk","0")}else{showEm(o,fH);if(!fH)errSty(o,0);o.setAttribute("_lnk",fH?"0":"1")}}}function getAllDescendants(oE){return oE.all?oE.all:oE.getElementsByTagName("*")}function gtAttrN(o,sN){return parseInt(o.getAttribute(sN))}if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/movepolicycontextmenu.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");Owa.UIControls.MovePolicyContextMenu=function Owa$UIControls$MovePolicyContextMenu(oSubPage){Owa.UIControls.MovePolicyContextMenu.constructBase(this,[oSubPage]);g_oEd.attachEvent("ApplyMovePolicy",this,"_cbApplyMovePolicy");g_oEd.attachEvent("InheritMovePolicy",this,"_cbInheritMovePolicy")};Owa.UIControls.MovePolicyContextMenu.prototype.dispose=function Owa$UIControls$MovePolicyContextMenu$dispose(){this.get_SubPage()._oMovePolicyContextMenu=null;g_oEd.detachEvent("ApplyMovePolicy",this,"_cbApplyMovePolicy");g_oEd.detachEvent("InheritMovePolicy",this,"_cbInheritMovePolicy");Owa.UIControls.MovePolicyContextMenu.callBase(this,"dispose")};Owa.UIControls.MovePolicyContextMenu.get_Instance=function Owa$UIControls$MovePolicyContextMenu$get_Instance(oSubPage){oSubPage=oSubPage||Owa.UIControls.SubPage.get_Instance();if(!oSubPage._oMovePolicyContextMenu){oSubPage._oMovePolicyContextMenu=new Owa.UIControls.MovePolicyContextMenu(oSubPage)}return oSubPage._oMovePolicyContextMenu};Owa.UIControls.MovePolicyContextMenu.prototype._createGetMenuReq=function Owa$UIControls$MovePolicyContextMenu$_createGetMenuReq(fnCallback){return new oeReq("MovePolicy","GetPolicyMenu",0,fnCallback,GET)};Owa.UIControls.MovePolicyContextMenu.prototype._applyPolicy=function Owa$UIControls$MovePolicyContextMenu$_applyPolicy(sTag){g_oPtgMgr.applyPolicy("MovePolicy",this,this._rgSelectedIds,sTag,this._sLocalFolderId)};Owa.UIControls.MovePolicyContextMenu.prototype._inheritPolicy=function Owa$UIControls$MovePolicyContextMenu$_inheritPolicy(){g_oPtgMgr.inheritPolicy("MovePolicy",this,this._rgSelectedIds,this._sLocalFolderId)};Owa.UIControls.MovePolicyContextMenu.prototype._cbApplyMovePolicy=function Owa$UIControls$MovePolicyContextMenu$_cbApplyMovePolicy(oR,oSndr,rgIds,sTag){this._cbPolicyChanged(oR,oSndr,rgIds,sTag)};Owa.UIControls.MovePolicyContextMenu.prototype._cbInheritMovePolicy=function Owa$UIControls$MovePolicyContextMenu$_cbInheritMovePolicy(oR,oSndr,rgIds){this._cbPolicyChanged(oR,oSndr,rgIds,"inheritPolicy")};Owa.UIControls.MovePolicyContextMenu.createClass("Owa.UIControls.MovePolicyContextMenu",Owa.UIControls.PolicyContextMenuBase)})();g_fModuleLoaded[".\\uicontrols/movepolicycontextmenu.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/openmailboxdialog.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");var DIALOG_CLOSEX_ID="imgX";var DIALOG_ID="divOpnMbxUsr";var DIALOG_RECIPIENTWELL_ID="divOpnMbxRw";var DIALOG_OPENDIV_ID="divOpnMbxDlg";var DIALOG_BUTTON_OPEN_ID="btnOpnMbx";var BUTTON_TO_SHOW_DIALOG="aUserTile";var oInstance=null;Owa.UIControls.OpenMailboxDialog=function Owa$UIControls$OpenMailboxDialog(){Owa.UIControls.OpenMailboxDialog.constructBase(this)};Owa.UIControls.OpenMailboxDialog.get_Instance=function Owa$UIControls$OpenMailboxDialog$get_Instance(){return oInstance};Owa.UIControls.OpenMailboxDialog.createInstance=function Owa$UIControls$OpenMailboxDialog$createInstance(){oInstance=new Owa.UIControls.OpenMailboxDialog();oInstance.set_SubPage(getNavigationPage());oInstance.initialize();return oInstance};Owa.UIControls.OpenMailboxDialog.hideDialog=function Owa$UIControls$OpenMailboxDialog$hideDialog(){if(!oInstance){return}if(oInstance._oDialog&&oInstance._oDialog._get_Element().get_IsShown()){oInstance._closeAndHideDialog()}};Owa.UIControls.OpenMailboxDialog.showDialog=function Owa$UIControls$OpenMailboxDialog$showDialog(){if(!oInstance){oInstance=Owa.UIControls.OpenMailboxDialog.createInstance()}oInstance.clickButton()};var _oPrototype=Owa.UIControls.OpenMailboxDialog.prototype;_oPrototype.initDialog=function Owa$UIControls$OpenMailboxDialog$initDialog(){this._fReady=0;this._createAndShowDialog();this._oRecipientWell.setFocus();this._setTimeout(this.isReady,1)};_oPrototype.release=function Owa$UIControls$OpenMailboxDialog$release(){this._oCloseXButton.detachAllEvents();this._oCloseXButton=null;this._oOpenButton.detachAllEvents();this._oOpenButton=null;this._oDialog.dispose();this._oDialog=null;Owa.Components.RecipientWellManager.get_Instance().disposeWells(this.sConsumerId)};_oPrototype.clickButton=function Owa$UIControls$OpenMailboxDialog$clickButton(){if((this._fIsLoading&&!this._sRecipientWellMarkup)||(this._oDialog&&this._oDialog._oElement.get_IsShown())){return}if(this._sRecipientWellMarkup){this.initDialog()}else{this._fIsLoading=1;var oRequest=new oeReq("RecipWell","GetOpnMbxRcp",null,this._createCallback(this._cbGetRecipientWellData));oRequest.send()}};_oPrototype.hideDialog=function Owa$UIControls$OpenMailboxDialog$prototype$hideDialog(){if(this._oDialog&&this._oDialog._get_Element().get_IsShown()){this._closeAndHideDialog()}};_oPrototype.isReady=function Owa$UIControls$OpenMailboxDialog$isReady(){this._fReady=1;updCmp(window)};_oPrototype._onKeyDown=function Owa$UIControls$OpenMailboxDialog$_onKeyDown(oEvent){var oElement=oEvent.get_Target();var sId=oElement.get_Id();var fShiftDown=oEvent.isShiftKeyDown();switch(oEvent.get_KeyCodeForKeyUpDown()){case 9:if(sId==DIALOG_BUTTON_OPEN_ID){if(!fShiftDown){this._oCloseXButton.focus(1);oEvent.preventDefault()}}else if(sId==DIALOG_CLOSEX_ID){if(fShiftDown){this._oOpenButton.focus(1);oEvent.preventDefault()}}else{return}break;case 13:if(sId==DIALOG_BUTTON_OPEN_ID){this._oOpenButton.click();oEvent.preventDefault()}else if(sId==DIALOG_CLOSEX_ID){this._closeAndHideDialog();oEvent.preventDefault()}break;default:return}oEvent.cancelBubble()};_oPrototype._createAndShowDialog=function Owa$UIControls$OpenMailboxDialog$_createAndShowDialog(){this._createDialog();var oButtonLink=$(BUTTON_TO_SHOW_DIALOG);var oDialogElement=this._oDialog._oElement;var iY=oButtonLink.get_DocumentTop()+oButtonLink.get_OffsetHeight();var iX=oButtonLink.get_DocumentLeft()+(g_fRtl?-1:(oButtonLink.get_OffsetWidth()-oDialogElement.get_OffsetWidth()+1));this._oDialog.show(iX,iY)};_oPrototype._createDialog=function Owa$UIControls$OpenMailboxDialog$_createDialog(){var sHtml="<div id=\""+DIALOG_OPENDIV_ID+"\"><div class=\"opnMbxDlgTtl\">"+"<img id=\""+DIALOG_CLOSEX_ID+"\" class=\"opnMbxClsImg\" src=\""+getThmF("closedlg.gif")+"\" tabindex=\"0\">"+this._strings["L_OpenOtherMailbox"]+"</div><div class=\"opnMbxDlgMn\"><div>"+this._strings["L_SelectMailbox"]+"</div>"+this._sRecipientWellMarkup+"<button id=\""+DIALOG_BUTTON_OPEN_ID+"\">"+this._strings["L_OpenEllipsis"]+"</button></div></div>";this._oDialog=new Owa.UIControls.Dialog(DIALOG_ID,sHtml,0,1,0,1,0);this._oDialog.get_OnClose().add(this._createCallback(this._closeDialog));var oDialogElement=this._oDialog._oElement;this._oCloseXButton=oDialogElement.getDescendantById(DIALOG_CLOSEX_ID);this._attachEvent(this._oCloseXButton,"click",this._closeAndHideDialog);this._oOpenButton=oDialogElement.getDescendantById(DIALOG_BUTTON_OPEN_ID);this._attachEvent(this._oOpenButton,"click",this._onClickOpenButton);this._attachEvent(oDialogElement,"keydown",this._onKeyDown);this._createRecipientWellControl()};_oPrototype._createRecipientWellControl=function Owa$UIControls$OpenMailboxDialog$_createRecipientWellControl(){var oDialogElement=this._oDialog._oElement;var oRecipientWellElement=oDialogElement.getDescendantById(DIALOG_RECIPIENTWELL_ID);this._oRecipientWell=Owa.UIControls.SingleEditRecipientWell.create(oRecipientWellElement);this._oRecipientWell.set_SubPage(this.get_SubPage());this._oRecipientWell.set_IsADRecipientOnly();this._oRecipientWell.set_OnAutoResolveCallback(this._createCallback(this._resolveRecipientWell));this._oRecipientWell.initialize();this.oAnrOptions=getAnrOptions(true);this.sConsumerId=Owa.Components.RecipientWellManager.get_Instance().registerWells([this._oRecipientWell],this.oAnrOptions)};_oPrototype._resolveRecipientWell=function Owa$UIControls$OpenMailboxDialog$_resolveRecipientWell(){Owa.Components.RecipientWellManager.get_Instance().resolveWells(this.sConsumerId,this._createCallback(this._onCompleteResolveNames))};_oPrototype._onCompleteResolveNames=function Owa$UIControls$OpenMailboxDialog$_onCompleteResolveNames(iEventResults){this._oRecipientWell.setFocus()};_oPrototype._cbGetRecipientWellData=function Owa$UIControls$OpenMailboxDialog$_cbGetRecipientWellData(oResponse){if(!cbOeh(oResponse)){return}var oDivR=Owa.Dom.Document.get_Current().createElement("DIV");oDivR=Owa.Dom.Document.get_Current().appendChild(oDivR);oDivR.set_InnerHtml(oResponse.sBody);var oDivPayload=oDivR.getDescendantById("divMbxCntr");this._sRecipientWellMarkup=oDivPayload.get_InnerHtml();this._strings={L_OpenEllipsis:oDivPayload.getAttribute("L_OpnMbx"),L_Cancel:oDivPayload.getAttribute("L_CnclMbx"),L_OpenOtherMailbox:oDivPayload.getAttribute("L_OpnOtMbx"),L_SelectMailbox:oDivPayload.getAttribute("L_SlctMbx"),L_ErrorDialogTitle:oDivPayload.getAttribute("L_ErrMbxTtl"),L_ErrorMessage:oDivPayload.getAttribute("L_ErrMbx")};oDivR.remove(true);this._fIsLoading=0;this.clickButton()};_oPrototype._onClickOpenButton=function Owa$UIControls$OpenMailboxDialog$_onClickOpenButton(){var oRecipient=this._oRecipientWell.get_Recipient();if(!oRecipient){this._oRecipientWell.setFocus(1);return}var fActionOpen=(this._oOpenButton.get_TextContent()==this._strings["L_OpenEllipsis"]);if(!fActionOpen){this._closeAndHideDialog()}else{var iRecipientType=getRecipientType(oRecipient);if(iRecipientType==RCP_RES){this._oOpenButton.set_TextContent(this._strings["L_Cancel"]);this._openMailbox(oRecipient)}else if(iRecipientType==RCP_PND){this._resolveRecipientWell()}else if(iRecipientType==RCP_AMB){new OKDlg(this._strings["L_ErrorMessage"],this._oDialog._oElement,this._createCallback(this._onCloseMailboxAlert),Owa.BUTTON_DIALOG_ICON.WARNING,this._strings["L_ErrorDialogTitle"]).show()}}};_oPrototype._openMailbox=function Owa$UIControls$OpenMailboxDialog$_openMailbox(oRecipient){var oRequest=new oeReq("RecipWell","UpdateAC");var rgUpdateCache=new Array();rgUpdateCache.push(convtToOEHStrct(oRecipient,oRequest));oRequest.addRgSt("Recips",rgUpdateCache);oRequest.send();var oWindow=Owa.Dom.Window.get_Current();oWindow.navigate("/owa/"+oRecipient._sa)};_oPrototype._onCloseMailboxAlert=function Owa$UIControls$OpenMailboxDialog$_onCloseMailboxAlert(){this._oRecipientWell.setFocus()};_oPrototype._closeAndHideDialog=function Owa$UIControls$OpenMailboxDialog$_closeAndHideDialog(){this._oDialog.hide()};_oPrototype._closeDialog=function Owa$UIControls$OpenMailboxDialog$_closeDialog(){Owa.UIControls.AutoCompleteCache.hide();this.release()};Owa.UIControls.OpenMailboxDialog.createClass("Owa.UIControls.OpenMailboxDialog",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/openmailboxdialog.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/addressbookpickerrecipientwell.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");var ENABLED_BUTTON_CLASS=["flatHvr"];var DISABLED_BUTTON_CLASS=["flatNR","dsbl"];var DEFAULT_BUTTON_STYLE="addrBkBtn";var ON_RESIZE="onResize";var ON_UPDATE_FROM_CACHE="onUpdateFromCache";Owa.UIControls.AddressBookPickerRecipientWell=function Owa$UIControls$AddressBookPickerRecipientWell(oConfiguration,oElement,oParent){Owa.UIControls.AddressBookPickerRecipientWell.constructBase(this,[oElement,oParent]);this._set_Configuration(oConfiguration)};var _oPrototype=Owa.UIControls.AddressBookPickerRecipientWell.prototype;_oPrototype.dispose=function Owa$UIControls$AddressBookPickerRecipientWell$dispose(){Owa.UIControls.AutoCompleteCache.hide();if(isAnrMenuOpen()){g_AnrCtxMnu.close()}this.fDisposed=1;Owa.Components.RecipientWellManager.get_Instance().disposeWells(this.sConsumerId);Owa.UIControls.AddressBookPickerRecipientWell.callBase(this,"dispose")};_oPrototype.initialize=function Owa$UIControls$AddressBookPickerRecipientWell$initialize(){Owa.UIControls.AddressBookPickerRecipientWell.callBase(this,"initialize");var oRecipientWell=null;if(this.oConfiguration.fOneRcp){oRecipientWell=Owa.UIControls.SingleEditRecipientWell.create(this._oElement,this._oParent)}else{oRecipientWell=Owa.UIControls.EditRecipientWell.create(this._oElement,this._oParent)}oRecipientWell.set_IsADRecipientOnly(this.oConfiguration.fOnlyAD);oRecipientWell.set_OnAutoResolveCallback(this._createCallback(this._resolveRecipientWell));oRecipientWell.set_OnUpdateFromCacheCallback(this._createCallback(this._onUpdateFromCache));oRecipientWell.set_SubPage(this.get_SubPage());oRecipientWell.initialize();this.sConsumerId=Owa.Components.RecipientWellManager.get_Instance().registerWells([oRecipientWell],this.oAnrOptions);if(this._get_PickerButton()){this._attachEvent(this._get_PickerButton(),"click",this._onClickPickerButton);this._enablePickerButton(true)}oRecipientWell.get_OnResize().add(this._createCallback(this._onResize))};_oPrototype.processRecipientWell=function Owa$UIControls$AddressBookPickerRecipientWell$processRecipientWell(fDoNotResolve){this._get_IsAllResolved();if(this.fAllResolved){return this.rgRecipients}else if(this.fHavePending&&!fDoNotResolve){this._resolveRecipientWell(true);return 0}else if(this.fHaveAmbiguous){return 0}};_oPrototype.hasRecipients=function Owa$UIControls$AddressBookPickerRecipientWell$hasRecipients(){this._get_Recipients();return(this.rgRecipients.length>0)};_oPrototype.setFocus=function Owa$UIControls$AddressBookPickerRecipientWell$setFocus(){this._oElement.focus(1)};_oPrototype.set_IsEnabled=function Owa$UIControls$AddressBookPickerRecipientWell$set_IsEnabled(fEnable){Owa.Components.RecipientWellManager.get_Instance().set_AreWellsEnabled(this.sConsumerId,fEnable);this._enablePickerButton(fEnable)};_oPrototype.set_RecipientWellHtml=function Owa$UIControls$AddressBookPickerRecipientWell$set_RecipientWellHtml(sHtml){var oRecipientWell=this._get_RecipientWellControl();oRecipientWell.set_Html(sHtml)};_oPrototype.set_ConsumerCallbackOnResolve=function Owa$UIControls$AddressBookPickerRecipientWell$set_ConsumerCallbackOnResolve(fnConsumerCallback){this._fnConsumerCallback=fnConsumerCallback};_oPrototype.get_ConsumerCallbackOnResolve=function Owa$UIControls$AddressBookPickerRecipientWell$get_ConsumerCallbackOnResolve(fnConsumerCallback){return this._fnConsumerCallback};_oPrototype.get_OnResize=function Owa$UIControls$AddressBookPickerRecipientWell$get_OnResize(){return this._getEventHandlerCollection(ON_RESIZE)};_oPrototype.get_OnUpdateFromCache=function Owa$UIControls$AddressBookPickerRecipientWell$get_OnUpdateFromCache(){return this._getEventHandlerCollection(ON_UPDATE_FROM_CACHE)};_oPrototype._set_Configuration=function Owa$UIControls$AddressBookPickerRecipientWell$_set_Configuration(oConfiguration){this.oConfiguration=oConfiguration;this.oAnrOptions=getAnrOptions(this.oConfiguration.fOnlyAD)};_oPrototype._resolveRecipientWell=function Owa$UIControls$AddressBookPickerRecipientWell$_resolveRecipientWell(){Owa.Components.RecipientWellManager.get_Instance().resolveWells(this.sConsumerId,this._createCallback(this._onCompleteResolveNames))};_oPrototype._onCompleteResolveNames=function Owa$UIControls$AddressBookPickerRecipientWell$_onCompleteResolveNames(iEventResults){var fnCallback=this.get_ConsumerCallbackOnResolve();if(fnCallback){fnCallback(this.processRecipientWell(true))}else{this.setFocus()}};_oPrototype._get_IsAllResolved=function Owa$UIControls$AddressBookPickerRecipientWell$_get_IsAllResolved(){this._get_Recipients();this.fAllResolved=false;this.fHavePending=false;this.fHaveAmbiguous=false;for(var i=0;i<this.rgRecipients.length;i++){var oRecipient=this.rgRecipients[i];var iState=getRecipientType(oRecipient);if(iState==Owa.RecipientState.Pending){this.fHavePending=true}else if(iState==Owa.RecipientState.Ambiguous){this.fHaveAmbiguous=true}}if(this.rgRecipients.length){this.fAllResolved=(!this.fHavePending&&!this.fHaveAmbiguous)}};_oPrototype._get_RecipientWellControl=function Owa$UIControls$AddressBookPickerRecipientWell$_get_RecipientWellControl(){return this._oElement.getExpando("_oControl")};_oPrototype._get_Recipients=function Owa$UIControls$AddressBookPickerRecipientWell$_get_Recipients(){this.rgRecipients=this._get_RecipientWellControl().get_Recipients()};_oPrototype._get_PickerButton=function Owa$UIControls$AddressBookPickerRecipientWell$_get_PickerButton(){return this._oParent.getDescendantById(this.oConfiguration.sBtnId)};_oPrototype._enablePickerButton=function Owa$UIControls$AddressBookPickerRecipientWell$_enablePickerButton(fEnable){this.fBtnEnb=fEnable;var oButton=this._get_PickerButton();var rgClassNames=fEnable?ENABLED_BUTTON_CLASS:DISABLED_BUTTON_CLASS;var sButtonStyle=this.oConfiguration.sButtonStyle?this.oConfiguration.sButtonStyle:DEFAULT_BUTTON_STYLE;rgClassNames.push(sButtonStyle);oButton.set_CssClasses(rgClassNames);if(fEnable){this._attachEvent(oButton,"click",this._onClickPickerButton)}else{this._detachEvent(oButton,"click",this._onClickPickerButton)}};_oPrototype._onResize=function Owa$UIControls$AddressBookPickerRecipientWell$_onResize(){this._dispatchEvent(ON_RESIZE,this)};_oPrototype._onUpdateFromCache=function Owa$UIControls$AddressBookPickerRecipientWell$_onUpdateFromCache(){this._dispatchEvent(ON_UPDATE_FROM_CACHE,this.processRecipientWell(true))};_oPrototype._onClickPickerButton=function Owa$UIControls$AddressBookPickerRecipientWell$_onClickPickerButton(){if(!this.fBtnEnb){return}var oP={};oP.sTgt=this.oConfiguration.sTarget;oP.sTo=this._get_RecipientWellControl().get_Html();shwDlg("AddressBook",a_iABW,a_iABH,DLG_MOD|DLG_CTR|DLG_RSZ,oP,"&a="+this.oConfiguration.sAction);this._get_RecipientWellControl().set_Html(oP.sTo)};Owa.UIControls.AddressBookPickerRecipientWell.createClass("Owa.UIControls.AddressBookPickerRecipientWell",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/addressbookpickerrecipientwell.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/openothermailboxfolder.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");var DIALOG_ID="divOpnOthMbx";var DIALOG_TITLE_ID="divDlgTtl";var REQUEST_GROUP_SECTION="GS";var DIALOG_CLOSEX_ID="imgX";var DIALOG_CANCEL_ID="btn1";var ADDRESS_BOOK_ACTION="PickSelectMailbox";var ADDRESS_BOOK_BUTTON_ID="btnTo";var ADDRESS_BOOK_TARGET_ID="divTo";var RECIPIENTWELL_PICKER_ID="divOpnOthMbxRw";var ADDRESS_BOOK_BUTTON_STYLE="addrBkBtn";Owa.UIControls.OpenOtherMailboxFolder=function Owa$UIControls$OpenOtherMailboxFolder(){Owa.UIControls.OpenOtherMailboxFolder.constructBase(this);this._iMod=0};var _oPrototype=Owa.UIControls.OpenOtherMailboxFolder.prototype;_oPrototype.initialize=function Owa$UIControls$OpenOtherMailboxFolder$initialize(){Owa.UIControls.OpenOtherMailboxFolder.callBase(this,"initialize");this._createAndShowDialog();this._oAddressBookPickerRecipientWell.setFocus();this._setTimeout(this.isReady,1)};_oPrototype.dispose=function Owa$UIControls$OpenOtherMailboxFolder$dispose(){if(this._oAddressBookPickerRecipientWell){this._oAddressBookPickerRecipientWell.dispose()}Owa.UIControls.OpenOtherMailboxFolder.callBase(this,"dispose")};_oPrototype.requestSharingCalendar=function Owa$UIControls$OpenOtherMailboxFolder$requestSharingCalendar(oTo){var sUrl="?ae=Item&t=IPM.Note&a=New";if(oTo){sUrl+="&to="+urlEnc(oTo.address);sUrl+="&nm="+urlEnc(oTo.displayName);sUrl+="&subject="+urlEnc(L_RequestSharingSubject)}else{sUrl+="&email="+urlEnc("mailto:?subject="+L_RequestSharingSubject)}opnWin(sUrl,null,null,null,null,null,null,this.get_SubPage())};_oPrototype.clickButton=function Owa$UIControls$OpenOtherMailboxFolder$clickButton(iM){if((this._fDispDlg||(this._fIsLoading&&!this._sRecipientWellMarkup))||(this._oDialog&&this._oDialog._oElement.get_IsShown())){return}if(isDf(typeof iM)){this._iMod=iM}if(this._sRecipientWellMarkup){this.initialize()}else{this._fIsLoading=1;var oRequest=new oeReq("RecipWell","GetOpnMbxFldRcp",null,this._createCallback(this._cbGetRecipientWellPickerData));oRequest.send()}};_oPrototype.isReady=function Owa$UIControls$OpenOtherMailboxFolder$isReady(){this._fDispDlg=0;updCmp(window)};_oPrototype._onKeyDown=function Owa$UIControls$OpenOtherMailboxFolder$_onKeyDown(oEvent){var oElement=oEvent.get_Target();var sId=oElement.get_Id();var fShiftDown=oEvent.isShiftKeyDown();switch(oEvent.get_KeyCodeForKeyUpDown()){case 9:if(sId==DIALOG_CANCEL_ID){if(!fShiftDown){this._oDialog._oElement.getDescendantById(DIALOG_CLOSEX_ID).focus(1);oEvent.preventDefault()}}else if(sId==DIALOG_CLOSEX_ID){if(fShiftDown){this._oDialog._oElement.getDescendantById(DIALOG_CANCEL_ID).focus(1);oEvent.preventDefault()}}else{return}break;case 13:if(sId==DIALOG_CLOSEX_ID){this._hideAndCloseDialog()}break;default:return}oEvent.cancelBubble()};_oPrototype._createAndShowDialog=function Owa$UIControls$OpenOtherMailboxFolder$_createAndShowDialog(){this._createDialog();this._oDialog.show()};_oPrototype._createDialog=function Owa$UIControls$OpenOtherMailboxFolder$_createDialog(){this._oDialog=new BtnDlg(DIALOG_ID,this._sRecipientWellMarkup,this._get_DialogTitle(),[this._buttonStrings["OK"],this._buttonStrings["Cancel"]],null,null,this._createCallback(this._onClickDialogButton),null,1);this._oDialog._oElement.attachEvent("keydown",this._createCallback(this._onKeyDown));this._createAddressBookPickerRecipientWell()};_oPrototype._createAddressBookPickerRecipientWell=function Owa$UIControls$OpenOtherMailboxFolder$_createAddressBookPickerRecipientWell(){var oDialogElement=this._oDialog._oElement;var oRecipientWellPickerElement=oDialogElement.getDescendantById(RECIPIENTWELL_PICKER_ID);var oConfiguration={fOneRcp:1,fOnlyAD:1,sAction:ADDRESS_BOOK_ACTION,sBtnId:ADDRESS_BOOK_BUTTON_ID,sTarget:ADDRESS_BOOK_TARGET_ID,sButtonStyle:ADDRESS_BOOK_BUTTON_STYLE};this._oAddressBookPickerRecipientWell=new Owa.UIControls.AddressBookPickerRecipientWell(oConfiguration,oRecipientWellPickerElement,oDialogElement);this._oAddressBookPickerRecipientWell.set_SubPage(this.get_SubPage());this._oAddressBookPickerRecipientWell.initialize()};_oPrototype._cbGetRecipientWellPickerData=function Owa$UIControls$OpenOtherMailboxFolder$_cbGetRecipientWellPickerData(oResponse){if(!cbOeh(oResponse)){return}var oDivR=Owa.Dom.Document.get_Current().createElement("DIV");oDivR=Owa.Dom.Document.get_Current().appendChild(oDivR);oDivR.set_InnerHtml(oResponse.sBody);var oDivPayload=oDivR.getChildById("divPayLoad");this._sRecipientWellMarkup=oDivPayload.get_InnerHtml();this._titles={0:oDivPayload.getAttribute("L_OpnInbx"),1:oDivPayload.getAttribute("L_OpnCal"),2:oDivPayload.getAttribute("L_OpnCnts"),3:oDivPayload.getAttribute("L_OpnTsks")};this._buttonStrings={"AB":oDivPayload.getAttribute("L_Nm"),"Cancel":L_Cncl,"OK":L_OK};oDivR.remove(true);this._fIsLoading=0;this.clickButton()};_oPrototype._get_DialogTitle=function Owa$UIControls$OpenOtherMailboxFolder$_get_DialogTitle(){return this._titles[this._iMod]};_oPrototype._onClickDialogButton=function Owa$UIControls$OpenOtherMailboxFolder$_onClickDialogButton(iButton){if((iButton==-1)||(iButton==1)){this._closeDialog()}else{this._doAction();return 1}return 0};_oPrototype._doAction=function Owa$UIControls$OpenOtherMailboxFolder$_doAction(){var rgRecipients=this._oAddressBookPickerRecipientWell.processRecipientWell();if(rgRecipients){this._openOtherUserFolder(rgRecipients[0]);this._hideAndCloseDialog()}else{this._oAddressBookPickerRecipientWell.setFocus(1)}};_oPrototype._set_RequestForModule=function Owa$UIControls$OpenOtherMailboxFolder$_set_RequestForModule(oRequest){switch(this._iMod){case NM_MAIL:oRequest.add(REQUEST_GROUP_SECTION,2);break;case NM_CAL:oRequest.add(REQUEST_GROUP_SECTION,3);break;case NM_CTS:oRequest.add(REQUEST_GROUP_SECTION,4);break;case NM_TSK:oRequest.add(REQUEST_GROUP_SECTION,5);break}};_oPrototype._openOtherUserFolder=function Owa$UIControls$OpenOtherMailboxFolder$_openOtherUserFolder(oRecipient){if(isExpLgn()){alrt(L_UnableOpnFdr,0,Owa.BUTTON_DIALOG_ICON.ERROR);return}var oRequest=new oeReq("NavigationNode","OpenOthersFolder",null,this._createCallback(this._cbOpenOtherUserFolder));this._set_RequestForModule(oRequest);oRequest.addSt("RCP",convtToOEHStrct(oRecipient,oRequest));var rgUpdateCache=new Array();rgUpdateCache.push(convtToOEHStrct(oRecipient,oRequest));oRequest.addRgSt("Recips",rgUpdateCache);oRequest.send()};_oPrototype._cbOpenOtherUserFolder=function Owa$UIControls$OpenOtherMailboxFolder$_cbOpenOtherUserFolder(oResponse){if(!cbOeh(oResponse)){return -1}if(!oResponse.sBody.trim()){return -1}var oDivR=Owa.Dom.Document.get_Current().createElement("DIV");oDivR=Owa.Dom.Document.get_Current().appendChild(oDivR);oDivR.set_InnerHtml(oResponse.sBody);var oDivNoPermission=oDivR.getDescendantById("divNoPermission");if(oDivNoPermission){var sDisplayName=oDivNoPermission.getAttribute("_displayName");var sAddress=oDivNoPermission.getAttribute("_address");this.showRequestDialog(sDisplayName,sAddress)}oDivR.remove(true)};_oPrototype.showRequestDialog=function Owa$Controls$OpenOtherMailboxFolder$showRequestDialog(sDisplayName,sAddress){var oTo={displayName:sDisplayName,address:sAddress};var sMessage=L_NoPermissionAndRequest.format(htmlEnc(sDisplayName));var oD=new BtnDlg("divDlt",sMessage,"",[L_Yes,L_No],null,Owa.BUTTON_DIALOG_ICON.WARNING,Owa.Utility.createArgumentContextDelegate(this,this._cbRequestPermission,oTo));oD.show()};_oPrototype._cbRequestPermission=function Owa$UIControls$OpenOtherMailboxFolder$_cbRequestPermission(iButton,oTo){if(iButton==0){this.requestSharingCalendar(oTo)}};_oPrototype._hideAndCloseDialog=function Owa$UIControls$OpenOtherMailboxFolder$_hideAndCloseDialog(){this._oDialog.hide()};_oPrototype._closeDialog=function Owa$UIControls$OpenOtherMailboxFolder$_closeDialog(){this._fDispDlg=1;this.dispose()};Owa.UIControls.OpenOtherMailboxFolder.createClass("Owa.UIControls.OpenOtherMailboxFolder",Owa.UIControls.UIControl)})();g_fModuleLoaded[".\\uicontrols/openothermailboxfolder.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/openothermailboxfolderinview.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");Owa.UIControls.OpenOtherFolderInView=function Owa$UIControls$OpenOtherFolderInView(oSubPage){Owa.UIControls.OpenOtherFolderInView.constructBase(this);if(oSubPage){this.set_SubPage(oSubPage)}else{this.set_SubPage(Owa.Components.Application.get_RootSubPage())}};var _oPrototype=Owa.UIControls.OpenOtherFolderInView.prototype;_oPrototype._cbOpenOtherUserFolder=function Owa$UIControls$OpenOtherFolderInView$_cbOpenOtherUserFolder(oResponse){var iResult=Owa.UIControls.OpenOtherFolderInView.callBase(this,"_cbOpenOtherUserFolder",[oResponse]);if(iResult==-1){return}var oDivR=Owa.Dom.Document.get_Current().createElement("DIV");oDivR.set_InnerHtml(oResponse.sBody);var oDivUrl=oDivR.getDescendantById("fldrurl");if(oDivUrl){var sUrl=oDivUrl.get_TextContent();sUrl+=sUrl.indexOf("?")>=0?"&":"?";sUrl+=PARENT_SUBPAGE_ID_ATTR+"="+this.get_SubPage().get_SubPageController().get_UniqueId();sfWinOpn(sUrl)}};Owa.UIControls.OpenOtherFolderInView.createClass("Owa.UIControls.OpenOtherFolderInView",Owa.UIControls.OpenOtherMailboxFolder)})();g_fModuleLoaded[".\\uicontrols/openothermailboxfolderinview.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/openothermailboxfolderinnavpane.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls");Owa.UIControls.OpenOtherFolderInNavPane=function Owa$UIControls$OpenOtherFolderInNavPane(oSubPage){Owa.UIControls.OpenOtherFolderInNavPane.constructBase(this);this.set_SubPage(oSubPage)};var _oPrototype=Owa.UIControls.OpenOtherFolderInNavPane.prototype;_oPrototype._cbOpenOtherUserFolder=function Owa$UIControls$OpenOtherFolderInNavPane$_cbOpenOtherUserFolder(oResponse){var iResult=Owa.UIControls.OpenOtherFolderInNavPane.callBase(this,"_cbOpenOtherUserFolder",[oResponse]);if(iResult==-1){return}if(this._iMod!=NM_MAIL){switch(this._iMod){case NM_CAL:g_oCalTr.rldFrmR(oResponse);return;case NM_CTS:g_oCntTr.rldFrmR(oResponse);return;case NM_TSK:g_oTskTr.rldFrmR(oResponse);default:return}}var oTRg=gtTrRg();if(oTRg){var oDivR=oTRg.get_OwnerDocument().createElement("DIV");oDivR=oTRg.get_OwnerDocument().appendChild(oDivR);oDivR.set_InnerHtml(oResponse.sBody);var oT=oDivR.get_FirstChild();var oBddyTr=g_oMMFrst.gtTr("buddy");if(oBddyTr){oBddyTr.root.get_ParentElement().insertAdjacentElement(Owa.ElementInsertionPoint.BeforeBegin,oT)}else{oTRg.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,oT)}var oJT=new Owa.UIControls.FolderTree(oT.get_FirstChild(),0);oJT.set_SubPage(getNavigationPage());oJT.onSelChng=onMailSelChng;g_oMMFrst.addTr(oT.get_Id(),oJT);oDivR.remove(true)}};Owa.UIControls.OpenOtherFolderInNavPane.createClass("Owa.UIControls.OpenOtherFolderInNavPane",Owa.UIControls.OpenOtherMailboxFolder)})();g_fModuleLoaded[".\\uicontrols/openothermailboxfolderinnavpane.js".toLowerCase()]=1;var g_oDlgPrgInd;var g_iPrgIndTmId;var g_iPrgIndDly=1000;var g_fHKDis;function shwPrgrsInd(sTxt,iT){if(g_iPrgIndTmId){clearTimeout(g_iPrgIndTmId);g_iPrgIndTmId=0}g_iPrgIndTmId=setTimeout("cbShwPrgrsInd(\""+sTxt+"\", 0)",(iT?iT:g_iPrgIndDly))}function cbShwPrgrsInd(sTxt,fCA,x,y){var sHtml="<img src=\""+getThmF("progress.gif")+"\">"+sTxt;g_oDlgPrgInd=new Dlg("divPrgrsInd",sHtml,fCA,!fCA,null,0);g_fHKDis=true;if(x==null||y==null)g_oDlgPrgInd.show();else g_oDlgPrgInd.show(x,y)}function hdPrgrsInd(){if(g_iPrgIndTmId){clearTimeout(g_iPrgIndTmId);g_iPrgIndTmId=0}if(g_oDlgPrgInd&&!g_oDlgPrgInd.fDisposed)g_oDlgPrgInd.hide();g_oDlgPrgInd=0;g_fHKDis=false}if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/timecombobox.js".toLowerCase()])(function(){Owa.UIControls.TimeComboBox=function Owa$UIControls$TimeComboBox(oElement,oParent,oStartTimeComboBox){Owa.UIControls.TimeComboBox.constructBase(this,[oElement,oParent]);this._oStartTimeComboBox=oStartTimeComboBox;this._iStartOffset=0};Owa.UIControls.TimeComboBox.prototype.initialize=function Owa$UIControls$TimeComboBox$initialize(){this._oTextBox=this._getDescendant(Owa.Strings.Ids.TimeTextBox);Owa.UIControls.TimeComboBox.callBase(this,"initialize");this._attachEvent(this._oTextBox,"blur",this._onTextBoxUpdated);if(this._oStartTimeComboBox){this._oStartTimeComboBox.get_OnChange().add(this._createCallback(this._onStartTimeChanged))}};Owa.UIControls.TimeComboBox.prototype.dispose=function Owa$UIControls$TimeComboBox$dispose(){if(this._oStartTimeComboBox){this._oStartTimeComboBox.get_OnChange().remove(this._createCallback(this._onStartTimeChanged))}Owa.UIControls.TimeComboBox.callBase(this,"dispose")};Owa.UIControls.TimeComboBox.prototype._onStartTimeChanged=function Owa$UIControls$TimeComboBox$prototype$_onStartTimeChanged(){var oStartDateTime=this._oStartTimeComboBox._oSelectedValue;var oStartDate=new Date(oStartDateTime);oStartDate.setUTCMilliseconds(oStartDateTime.getUTCMilliseconds()+this._iStartOffset);this._selectValue(oStartDate)};Owa.UIControls.TimeComboBox.prototype._onPreShow=function Owa$UIControls$TimeComboBox$prototype$_onPreShow(){this._fillDropDownList();if(this._oDropDownList.hasValue(this._oSelectedValue)){this._oDropDownList.selectValue(this._oSelectedValue)}};Owa.UIControls.TimeComboBox.prototype._onTextBoxUpdated=function Owa$UIControls$TimeComboBox$prototype$_onTextBoxUpdated(){if(this._oTextBox.get_Value()==fmtDt(this._oSelectedValue,g_sShtTmFmt)){return}var iM;iM=parseTm(this._oTextBox.get_Value(),this._oStartTimeComboBox==null?this._oSelectedValue:this._oStartTimeComboBox._oSelectedValue,this._oStartTimeComboBox!=null?this._oSelectedValue:null);if(iM==-1){this._oTextBox.set_Value(fmtDt(this._oSelectedValue,g_sShtTmFmt));this._oTextBox.focus(1)}else{var dt=new Date(this._oSelectedValue);dt.shrs(0,iM);this._selectValue(dt)}};Owa.UIControls.TimeComboBox.prototype._renderSelectedValue=function Owa$UIControls$TimeComboBox$prototype$_renderSelectedValue(){if(this._oStartTimeComboBox){this._iStartOffset=this._oSelectedValue-this._oStartTimeComboBox._oSelectedValue}this._oTextBox.set_Value(fmtDt(this._oSelectedValue,g_sShtTmFmt))};Owa.UIControls.TimeComboBox.prototype.set_IsEnabled=function Owa$UIControls$TimeComboBox$prototype$set_IsEnabled(fEnable){Owa.UIControls.TimeComboBox.callBase(this,"set_IsEnabled",[fEnable]);this._oTextBox.set_IsDisabled(!fEnable)};Owa.UIControls.TimeComboBox.prototype._initializeSelection=function Owa$UIControls$TimeComboBox$prototype$_initializeSelection(){g_sShtTmFmt=this._getAttribute(Owa.Strings.Attributes.ShortTimeFormatString);parseTm.rxAmPm=new RegExp(this._getAttribute("sAmPmRx"),"gi");fmtDt.sAM=this._getAttribute("L_AM");fmtDt.sPM=this._getAttribute("L_PM");this._selectValue(new Date(this._getAttribute(Owa.Strings.Attributes.TimeValue)))};Owa.UIControls.TimeComboBox.prototype._fillDropDownList=function Owa$UIControls$TimeComboBox$prototype$_fillDropDownList(){this._oDropDownList.clearItems();if(this._oStartTimeComboBox&&(this._oSelectedValue-this._oStartTimeComboBox._oSelectedValue)<(24*60*60*1000)){var startTime=this._oStartTimeComboBox._oSelectedValue;var iMO=(startTime.ghrs()*60)+startTime.gmins();for(var i=0;i<48;i++){var iM=iMO+(i*30);var dt=new Date(startTime);dt.shrs(0,iM);var iMD=iM;if(1440<=iMD)iMD-=1440;var sD=fmtDt(dt,g_sShtTmFmt);var sH=(i>>1).toString(10)+((i%2)?(this._getAttribute("L_Dec")+"5"):"");sD+=a_sDur.format(sH);sD=htmlDec(sD);this._oDropDownList.addItem(sD,dt)}}else{this._fillDropDownListSimple()}};Owa.UIControls.TimeComboBox.prototype._fillDropDownListSimple=function Owa$UIControls$TimeComboBox$prototype$_fillDropDownListSimple(){for(var i=0;i<48;++i){var iM=i*30;var dt=new Date(this._oSelectedValue);dt.shrs(0,iM);this._oDropDownList.addItem(fmtDt(dt,g_sShtTmFmt),dt)}};Owa.UIControls.TimeComboBox.createClass("Owa.UIControls.TimeComboBox",Owa.UIControls.ComboBox);Owa.UIControls.TimeComboBox.prototype._isEditable=function Owa$UIControls$TimeComboBox$prototype$_isEditable(){return true}})();g_fModuleLoaded[".\\uicontrols/timecombobox.js".toLowerCase()]=1;var PARENT_SUBPAGE_ID_ATTR="pspid";if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/subpagecontrollerbase.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls.SubPageControllerBase");Owa.UIControls.SubPageControllerBase=function Owa$UIControls$SubPageControllerBase(oElement){this._oElement=oElement;Owa.UIControls.SubPageControllerBase.constructBase(this)};var _oPrototype=Owa.UIControls.SubPageControllerBase.prototype;_oPrototype._fSupportUniqueId=true;_oPrototype._get_Element=function Owa$UIControls$SubPageControllerBase$prototype$_get_Element(){return this._oElement};_oPrototype.initialize=function Owa$UIControls$SubPageControllerBase$prototype$initialize(){Owa.UIControls.SubPageControllerBase.callBase(this,"initialize")};_oPrototype.dispose=function Owa$UIControls$SubPageControllerBase$prototype$dispose(){Owa.UIControls.SubPageControllerBase.callBase(this,"dispose")};_oPrototype.setExpando=function Owa$UIControls$SubPageControllerBase$setExpando(sVariableName,oValue){this._get_Element().setExpando(sVariableName,oValue)};_oPrototype.getExpando=function Owa$UIControls$SubPageControllerBase$getExpando(sVariableName){return this._get_Element().getExpando(sVariableName)};_oPrototype.set_IsShown=function Owa$UIControls$SubPageControllerBase$set_IsShown(fShow){var fIsVisible=this.get_IsShown(true);this._get_Element().set_IsShown(fShow);if(fIsVisible!=this.get_IsShown(true)){if(this.get_SubPage()){this.get_SubPage().fireIsVisibleChanged(!fIsVisible)}}};_oPrototype.get_IsShown=function Owa$UIControls$SubPageControllerBase$get_IsShown(fActual){var fIsVisible=!!this._get_Element()&&this._get_Element().get_IsShown();if(!fActual){return fIsVisible}var oParentController=this.get_ParentController();if(oParentController&&!oParentController.get_IsShown(true)){return false}return fIsVisible};_oPrototype.remove=function Owa$UIControls$SubPageControllerBase$remove(){var oParentController=this.get_ParentController();if(oParentController){oParentController.removeChildController(this)}if(this._get_Element()){this._get_Element().remove(true)}};_oPrototype.get_ChildrenControllers=function Owa$UIControls$SubPageControllerBase$get_ChildrenControllers(){if(!this._rgChildrenControllers){this._rgChildrenControllers=[]}return this._rgChildrenControllers};_oPrototype.addChildController=function Owa$UIControls$SubPageControllerBase$addChildController(oSubPageController){if(!this._rgChildrenControllers){this._rgChildrenControllers=[]}for(var i=0;i<this._rgChildrenControllers.length;i++){if(oSubPageController.equals(this._rgChildrenControllers[i])){return}}var oElement=oSubPageController._get_Element();oElement.setAttribute(PARENT_SUBPAGE_ID_ATTR,this.get_UniqueId());this._rgChildrenControllers.push(oSubPageController)};_oPrototype.removeChildController=function Owa$UIControls$SubPageControllerBase$removeChildController(oSubPageController){if(this._rgChildrenControllers){for(var i=0;i<this._rgChildrenControllers.length;i++){if(oSubPageController.equals(this._rgChildrenControllers[i])){this._rgChildrenControllers.removeAt(i);return}}}};_oPrototype.equals=function Owa$UIControls$SubPageControllerBase$equals(oSubPageController){var oElement1=this._get_Element();var oElement2=oSubPageController._get_Element();if(oElement1&&oElement2){return oElement1.equals(oElement2)}else{return false}};Owa.UIControls.SubPageControllerBase.createClass("Owa.UIControls.SubPageControllerBase",Owa.Components.Control)})();g_fModuleLoaded[".\\uicontrols/subpagecontrollerbase.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/iSubPageController.js".toLowerCase()])(function(){Type.createNamespace("Owa.Components.ISubPageController");Owa.UIControls.ISubPageController=function Owa$UIControls$ISubPageController(){throw new Error("Cannot create an instance of interface")};Owa.UIControls.ISubPageController.prototype.initialize=function Owa$UIControls$ISubPageController$initialize(){throw new Error("Not implemented")};Owa.UIControls.ISubPageController.prototype.remove=function Owa$UIControls$ISubPageController$remove(){throw new Error("Not implemented")};Owa.UIControls.ISubPageController.prototype.get_LocationURL=function Owa$UIControls$ISubPageController$get_LocationURL(){throw new Error("Not implemented")};Owa.UIControls.ISubPageController.prototype.navigate=function Owa$UIControls$ISubPageController$navigate(sUrl){throw new Error("Not implemented")};Owa.UIControls.ISubPageController.prototype.getVariable=function Owa$UIControls$ISubPageController$getVariable(sVariableName){throw new Error("Not implemented")};Owa.UIControls.ISubPageController.prototype.invokeFunction=function Owa$UIControls$ISubPageController$invokeFunction(sFunctionName){throw new Error("Not implemented")};Owa.UIControls.ISubPageController.prototype.set_IsShown=function Owa$UIControls$ISubPageController$set_IsShown(fShow){throw new Error("Not implemented")};Owa.UIControls.ISubPageController.prototype.get_IsShown=function Owa$UIControls$ISubPageController$get_IsShown(){throw new Error("Not implemented")};Owa.UIControls.ISubPageController.prototype.getElementById=function Owa$UIControls$ISubPageController$getElementById(sId){throw new Error("Not implemented")};Owa.UIControls.ISubPageController.prototype.get_ParentController=function Owa$UIControls$ISubPageController$get_ParentController(){throw new Error("Not implemented")};Owa.UIControls.ISubPageController.prototype.get_OpenerController=function Owa$UIControls$ISubPageController$get_OpenerController(){throw new Error("Not implemented")};Owa.UIControls.ISubPageController.prototype.close=function Owa$UIControls$ISubPageController$close(){throw new Error("Not implemented")};Owa.UIControls.ISubPageController.createInterface("Owa.UIControls.ISubPageController")})();g_fModuleLoaded[".\\components/iSubPageController.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/iframesubpagecontroller.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls.IframeSubPageController");Owa.UIControls.IframeSubPageController=function Owa$UIControls$IframeSubPageController(oElement){Owa.UIControls.IframeSubPageController.constructBase(this,[oElement])};Owa.UIControls.IframeSubPageController.prototype.initialize=function Owa$UIControls$IframeSubPageController$initialize(){};Owa.UIControls.IframeSubPageController.prototype._getContentWindow=function Owa$UIControls$IframeSubPageController$_getContentWindow(){try{return this._get_Element().get_ContentWindow()}catch(e){return null}};Owa.UIControls.IframeSubPageController.prototype.getVariable=function Owa$UIControls$IframeSubPageController$getVariable(sVariableName){var oSubPage=this.get_SubPage();if(oSubPage){return oSubPage.getSubPageVariable(sVariableName)}else{return null}};Owa.UIControls.IframeSubPageController.prototype.invokeFunction=function Owa$UIControls$IframeSubPageController$invokeFunction(sFunctionName,rgArgs,oThis){var oSubPage=this.get_SubPage();if(!oSubPage){return}if(!oThis||(oThis.equals&&oThis.equals(oSubPage))){return oSubPage.invokeSubPageFunction(sFunctionName,rgArgs)}else{return Owa.Dom.Window.get_Current().invokeFunction(sFunctionName,rgArgs,oThis)}};Owa.UIControls.IframeSubPageController.prototype.remove=function Owa$UIControls$IframeSubPageController$remove(){this.navigate("about:blank");Owa.UIControls.IframeSubPageController.callBase(this,"remove");this.dispose()};Owa.UIControls.IframeSubPageController.prototype.dispose=function Owa$UIControls$IframeSubPageController$dispose(){this.navigate("about:blank");Owa.UIControls.IframeSubPageController.callBase(this,"dispose")};Owa.UIControls.IframeSubPageController.prototype.get_SubPage=function Owa$UIControls$IframeSubPageController$get_SubPage(){var oContentWindow=this._getContentWindow();if(oContentWindow&&oContentWindow.getGlobalVariable("g_fOwa")){var oOwa=oContentWindow.getGlobalVariable("Owa");return oOwa&&oOwa.Components.Application.get_RootSubPage()}else{return null}};Owa.UIControls.IframeSubPageController.prototype.getElementById=function Owa$UIControls$IframeSubPageController$getElementById(sId){var oContentWindow=this._getContentWindow();if(oContentWindow){var oDocument=oContentWindow.get_Document();if(oDocument){return oDocument.getElementById(sId)}}return null};Owa.UIControls.IframeSubPageController.prototype.get_LocationURL=function Owa$UIControls$IframeSubPageController$get_LocationURL(){var oContentWindow=this._getContentWindow();return oContentWindow.get_Location().search};Owa.UIControls.IframeSubPageController.prototype.navigate=function Owa$UIControls$IframeSubPageController$navigate(sUrl){this._get_Element().set_Source(sUrl)};Owa.UIControls.IframeSubPageController.prototype.get_OpenerController=function Owa$UIControls$IframeSubPageController$get_OpenerController(){return null};Owa.UIControls.IframeSubPageController.prototype.get_ParentController=function Owa$UIControls$IframeSubPageController$get_ParentController(){var oParentWindow=this._get_Element().get_OwnerDocument().get_ContainerWindow();var sParentControllerID=this._get_Element().getAttribute(PARENT_SUBPAGE_ID_ATTR);if(sParentControllerID){return oParentWindow.invokeFunction("getControllerByUniqueId",[sParentControllerID])}else if(oParentWindow.getGlobalVariable("g_fOwa")){return Owa.Components.SubPageControllerFactory.getControllerByWindow(oParentWindow)}else{return null}};Owa.UIControls.IframeSubPageController.createClass("Owa.UIControls.IframeSubPageController",Owa.UIControls.SubPageControllerBase,Owa.Components.ISubPageController)})();g_fModuleLoaded[".\\uicontrols/iframesubpagecontroller.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/windowsubpagecontroller.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls.WindowSubPageController");Owa.UIControls.WindowSubPageController=function Owa$UIControls$WindowSubPageController(oWindow){if(!oWindow){oWindow=Owa.Dom.Window.get_Current()}this._oWindow=oWindow;Owa.UIControls.WindowSubPageController.constructBase(this,[null])};Owa.UIControls.WindowSubPageController.prototype.initialize=function Owa$UIControls$WindowSubPageController$initialize(){};Owa.UIControls.WindowSubPageController.prototype._get_Element=function Owa$UIControls$WindowSubPageController$_get_Element(){var oElement=this._oWindow.get_FrameElement();if(!oElement){oElement=this._oWindow.get_Document().get_Body()}return oElement};Owa.UIControls.WindowSubPageController.prototype._get_ContentWindow=function Owa$UIControls$WindowSubPageController$_get_ContentWindow(){return this._oWindow};Owa.UIControls.WindowSubPageController.prototype.getVariable=function Owa$UIControls$WindowSubPageController$getVariable(sVariableName){var oSubPage=this.get_SubPage();if(oSubPage){return oSubPage.getSubPageVariable(sVariableName)}else{return null}};Owa.UIControls.WindowSubPageController.prototype.invokeFunction=function Owa$UIControls$WindowSubPageController$invokeFunction(sFunctionName,rgArgs,oThis){var oSubPage=this.get_SubPage();if(!oSubPage){return}if(!oThis||(oThis.equals&&oThis.equals(oSubPage))){return oSubPage.invokeSubPageFunction(sFunctionName,rgArgs)}else{return Owa.Dom.Window.get_Current().invokeFunction(sFunctionName,rgArgs,oThis)}};Owa.UIControls.WindowSubPageController.prototype.remove=function Owa$UIControls$WindowSubPageController$remove(){throw new Error("WindowSubPageController cannot be removed")};Owa.UIControls.WindowSubPageController.prototype.get_SubPage=function Owa$UIControls$WindowSubPageController$get_SubPage(){var oContentWindow=this._get_ContentWindow();var oOwa=oContentWindow.getGlobalVariable("Owa");return oOwa.Components.Application.get_RootSubPage()};Owa.UIControls.WindowSubPageController.prototype.getElementById=function Owa$UIControls$WindowSubPageController$getElementById(sId){var oContentWindow=this._get_ContentWindow();var oDocument=oContentWindow.get_Document();return oDocument.getElementById(sId)};Owa.UIControls.WindowSubPageController.prototype.get_LocationURL=function Owa$UIControls$WindowSubPageController$get_LocationURL(){var oContentWindow=this._get_ContentWindow();return oContentWindow.get_Location().search};Owa.UIControls.WindowSubPageController.prototype.navigate=function Owa$UIControls$WindowSubPageController$navigate(sUrl){var oContentWindow=this._get_ContentWindow();oContentWindow.navigate(sUrl)};function getParentControllerIDFromUrl(sUrl){var oParseResult={};var sQueryString=sUrl.split("?")[1];if(sQueryString){var rgParameters=sQueryString.split("&");for(var i=0;i<rgParameters.length;i++){var rgNameValuePair=rgParameters[i].split("=");var sName=rgNameValuePair[0];var sValue=rgNameValuePair[1];if(sName==PARENT_SUBPAGE_ID_ATTR){return sValue}}}return null}Owa.UIControls.WindowSubPageController.prototype.get_OpenerController=function Owa$UIControls$WindowSubPageController$get_OpenerController(){try{var oContentWindow=this._get_ContentWindow();var oOpenerWindow=oContentWindow.get_Opener();if(oOpenerWindow){var sParentControllerID=getParentControllerIDFromUrl(this.get_LocationURL());if(sParentControllerID){return oOpenerWindow.invokeFunction("getControllerByUniqueId",[sParentControllerID])}else{return new Owa.UIControls.WindowSubPageController(oOpenerWindow)}}}catch(e){}return null};Owa.UIControls.WindowSubPageController.prototype.get_ParentController=function Owa$UIControls$WindowSubPageController$get_ParentController(){var oContentWindow=this._get_ContentWindow();var oFrameElement=oContentWindow.get_FrameElement();if(oFrameElement){var oSubPageController=Owa.Components.SubPageControllerFactory.getControllerByElement(oFrameElement);return oSubPageController&&oSubPageController.get_ParentController()}else{return null}};Owa.UIControls.WindowSubPageController.prototype.close=function Owa$UIControls$WindowSubPageController$close(){var oContentWindow=this._get_ContentWindow();oContentWindow.close()};Owa.UIControls.WindowSubPageController.prototype.reload=function Owa$UIControls$WindowSubPageController$reload(){var oContentWindow=this._get_ContentWindow();return oContentWindow.get_Location().reload()};Owa.UIControls.WindowSubPageController.prototype.equals=function Owa$UIControls$WindowSubPageController$equals(oSubPageController){var oWindow1=this._get_ContentWindow();var oWindow2=oSubPageController._get_ContentWindow();if(oWindow1&&oWindow2){return oWindow1.equals(oWindow2)}else{return false}};Owa.UIControls.WindowSubPageController.createClass("Owa.UIControls.WindowSubPageController",Owa.UIControls.SubPageControllerBase,Owa.Components.ISubPageController)})();g_fModuleLoaded[".\\uicontrols/windowsubpagecontroller.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\uicontrols/divsubpagecontroller.js".toLowerCase()])(function(){Type.createNamespace("Owa.UIControls.DivSubPageController");Owa.UIControls.DivSubPageController=function Owa$UIControls$DivSubPageController(oElement){Owa.UIControls.DivSubPageController.constructBase(this,[oElement])};var _oPrototype=Owa.UIControls.DivSubPageController.prototype;_oPrototype.getVariable=function Owa$UIControls$DivSubPageController$getVariable(sVariableName){var oSubPage=this.get_SubPage();return oSubPage&&oSubPage.getSubPageVariable(sVariableName)};_oPrototype.invokeFunction=function Owa$UIControls$DivSubPageController$invokeFunction(sFunctionName,rgArgs,oThis){var oSubPage=this.get_SubPage();if(!oSubPage){return}if(!oThis||(oThis.equals&&oThis.equals(oSubPage))){return oSubPage.invokeSubPageFunction(sFunctionName,rgArgs)}else{return Owa.Dom.Window.get_Current().invokeFunction(sFunctionName,rgArgs,oThis)}};_oPrototype.get_SubPage=function Owa$UIControls$DivSubPageController$get_SubPage(){var sUniqueId=this._get_Element().getExpando("__sSubPageUniqueId");return UniqueIdHashSet.get_Instance().get(sUniqueId)};_oPrototype.set_SubPage=function Owa$UIControls$DivSubPageController$set_SubPage(oSubPage){return this._get_Element().setExpando("__sSubPageUniqueId",oSubPage.get_UniqueId())};_oPrototype.remove=function Owa$UIControls$DivSubPageController$remove(){var oSubPage=this.get_SubPage();this._get_Element().setExpando("__oSubPage",null);if(oSubPage){oSubPage.dispose()}Owa.UIControls.DivSubPageController.callBase(this,"remove");Owa.Components.Application.removePendingController(this);this.dispose()};_oPrototype.getElementById=function Owa$UIControls$DivSubPageController$getElementById(sId){var oElement=this._get_Element();if(oElement){return oElement.getDescendantById(sId)}else{return null}};_oPrototype.get_LocationURL=function Owa$UIControls$DivSubPageController$get_LocationURL(){var oElement=this._get_Element();return oElement.getAttribute("url")};_oPrototype.navigate=function Owa$UIControls$DivSubPageController$navigate(sUrl){var oElement=this._get_Element();var oR=new oeReq("","",null,this._createCallback(this.cbGetSubPageContent),GET,null,null,null,null,null,null,true);oR.sUrl=sUrl;shwPrgrsInd(L_Ld);oR.send()};_oPrototype.cbGetSubPageContent=function Owa$UIControls$DivSubPageController$cbGetSubPageContent(oR){var oElement=this._get_Element();if(!cbOeh(oR)){hdPrgrsInd();oElement.setBoolAttribute("fError",true);return}oElement.setBoolAttribute("fError",false);oElement.setAttribute("url",htmlEnc(oR.sUrl));oElement.set_InnerHtml(oR.sBody);oElement.setAttribute("_PageType",oElement.get_FirstChild().getAttribute("_PageType"));oElement.get_FirstChild().remove(true);this._oElement=oElement;this._setTimeout(this.cbGetSubPageContentStep2,1)};_oPrototype.cbGetSubPageContentStep2=function Owa$UIControls$DivSubPageController$cbGetSubPageContentStep2(){this.initialize();hdPrgrsInd()};_oPrototype.get_OpenerController=function Owa$UIControls$DivSubPageController$get_OpenerController(){return null};_oPrototype.get_ParentController=function Owa$UIControls$DivSubPageController$get_ParentController(){var oParentWindow=this._get_Element().get_OwnerDocument().get_ContainerWindow();if(!oParentWindow.getGlobalVariable("g_fOwa")){return null}var sParentControllerID=this._get_Element().getAttribute(PARENT_SUBPAGE_ID_ATTR);if(sParentControllerID){return oParentWindow.invokeFunction("getControllerByUniqueId",[sParentControllerID])}else{return Owa.Components.SubPageControllerFactory.getControllerByWindow(oParentWindow)}};_oPrototype._createSubPage=function Owa$UIControls$DivSubPageController$_createSubPage(){var oSubPage;if(this._get_Element().getAttribute("_PageType")){var oSubPageType=eval("Owa.Pages."+this._get_Element().getAttribute("_PageType"));oSubPage=new oSubPageType(this._get_Element())}else{oSubPage=new Owa.UIControls.SubPage(this._get_Element())}oSubPage.initialize();this.set_SubPage(oSubPage);if(this.get_IsShown()){this.get_SubPage().fireFirstShow()}updCmp(window,null,false,true)};_oPrototype.notifyScriptReady=function Owa$UIControls$DivSubPageController$notifyScriptReady(){var fReady=true;var rgExternalScriptFiles=this.rgExternalScriptFiles;for(var iIndex=0;iIndex<rgExternalScriptFiles.length;iIndex++){if(!Owa.Components.Application.isScriptLoaded(rgExternalScriptFiles[iIndex])){fReady=false;break}}if(fReady){Owa.Components.Application.removePendingController(this);this._createSubPage()}};_oPrototype.initialize=function Owa$UIControls$DivSubPageController$initialize(){var oExternalScriptFiles=this._get_Element().getChildById("divExternalScriptFiles");var rgExternalScriptFiles=[];oExternalScriptFiles.forEachChild(function(oChild){rgExternalScriptFiles.push(oChild.get_InnerHtml())});this.rgExternalScriptFiles=rgExternalScriptFiles;Owa.Components.Application.loadExternalScript(rgExternalScriptFiles);Owa.Components.Application.addPendingController(this);this.notifyScriptReady()};Owa.UIControls.DivSubPageController.createClass("Owa.UIControls.DivSubPageController",Owa.UIControls.SubPageControllerBase,Owa.Components.ISubPageController)})();g_fModuleLoaded[".\\uicontrols/divsubpagecontroller.js".toLowerCase()]=1;if(!g_fModuleLoaded)var g_fModuleLoaded={};if(!g_fModuleLoaded[".\\components/subpagecontrollerfactory.js".toLowerCase()])(function(){Type.createNamespace("Owa.Components.SubPageControllerFactory");Owa.Components.SubPageControllerFactory.getControllerByElement=function Owa$Components$SubPageControllerFactory$getControllerByElement(oElement){var oSubPageController=null;if(!Owa.DomUtility.isOwaWindow(oElement.get_OwnerDocument().get_ContainerWindow())){return null}oSubPageController=oElement.getExpando("subPageController");if(!oSubPageController){var sTagName=oElement.get_TagName().toLowerCase();if(sTagName=="div"){oSubPageController=new Owa.UIControls.DivSubPageController(oElement,oElement.get_ParentElement())}else if(sTagName=="iframe"){oSubPageController=new Owa.UIControls.IframeSubPageController(oElement,oElement.get_ParentElement())}else if(sTagName=="body"){oSubPageController=this.get_CurrentWindowSubPageController()}else{throw new Error("Don't support creating sub page controller from "+sTagName)}oElement.setExpando("subPageController",oSubPageController)}return oSubPageController};Owa.Components.SubPageControllerFactory.getControllerByWindow=function Owa$Components$SubPageControllerFactory$getControllerByWindow(oWindow){var oSubPageController=null;var oElement=oWindow.get_Document().get_Body();if(oElement){oSubPageController=oElement.getExpando("subPageController")}if(!oSubPageController){var oOwa=oWindow.getGlobalVariable("Owa");if(oOwa){oSubPageController=new oOwa.UIControls.WindowSubPageController();if(oElement){oElement.setExpando("subPageController")}}}return oSubPageController};Owa.Components.SubPageControllerFactory.createControllerByUrl=function Owa$Components$SubPageControllerFactory$createControllerByUrl(oParent,sUrl){if(isOwaSubPageRequest(sUrl)){var oElement=Owa.Dom.Document.get_Current().createElement("div")}else{var oElement=Owa.Dom.Document.get_Current().createElement("iframe");oElement.initFrameBorder(false);oElement.initAllowTransparency(true)}var oSubPageController=Owa.Components.SubPageControllerFactory.getControllerByElement(oElement);if(Owa.Utility.isSafari()){oParent.appendChild(oElement);oSubPageController.navigate(sUrl)}else{oSubPageController.navigate(sUrl);oParent.appendChild(oElement)}return oSubPageController};Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController=function Owa$Components$SubPageControllerFactory$get_CurrentWindowSubPageController(){var oWindow=Owa.Dom.Window.get_Current();return Owa.Components.SubPageControllerFactory.getControllerByWindow(oWindow)};function parseUrl(sUrl){var oParseResult={};var sQueryString=sUrl.split("?")[1];var rgParameters=sQueryString.split("&");for(var i=0;i<rgParameters.length;i++){var rgNameValuePair=rgParameters[i].split("=");var sName=rgNameValuePair[0];var sValue=rgNameValuePair[1];oParseResult[sName]=sValue}return oParseResult}var rgUserControlRegistry=[{"ae":"Folder","t":"IPF.Note"},{"ae":"Folder","t":"IPF.StickyNote"}];function isOwaSubPageRequest(sUrl){var oParseResult=parseUrl(sUrl);for(var i=0;i<rgUserControlRegistry.length;i++){var oRecord=rgUserControlRegistry[i];var fMatched=true;for(var sName in oRecord){if(sName=="t"){if(!isOfClss(oParseResult[sName],oRecord[sName])){fMatched=false;break}}else if(oRecord[sName].toLowerCase()!=oParseResult[sName].toLowerCase()){fMatched=false;break}}if(fMatched){return true}}return false}})();g_fModuleLoaded[".\\components/subpagecontrollerfactory.js".toLowerCase()]=1;function getControllerByUniqueId(sUniqueId){return UniqueIdHashSet.get_Instance().get(sUniqueId)}var QT_NRM=1;var QT_AW=2;var QT_EXCD=3;var APV_APP="Approve";var APV_REJ="Reject";var APV_EDT="ApvEd";var APV_SND="ApvSnd";var CBS_OTH=1;var CBS_32BIE7=2;var CBS_64BIE7=3;var CBS_VLD=CBS_32BIE7;var MR_DELAYED=0;var MR_SELCHANGE=1;var MR_NEVER=2;if(!Owa){var Owa={}}if(!Owa.Clipboard){Owa.Clipboard={}}var Font=function $Font$(sFace,sClr,iStl,sCS){if(!isDf(typeof(sFace))||!sFace)this.sFace=0;else this.sFace=sFace;if(!isDf(typeof(sClr))||!sClr)this.sClr=0;else this.sClr=sClr;if(!isDf(typeof(iStl))||!iStl)this.iStl=0;else this.iStl=iStl;if(!isDf(typeof(sCS))||!sCS)this.sCS=0;else this.sCS=sCS};Font.prototype.ToChtFrmt=function Font$ToChtFrmt(){return"X-MMS-IM-Format: FN="+this.sFace+"; EF="+"; CO="+this.sClr+"; CS=1; PF=00%13%10%13%10"};Font.prototype.PrsChtFnt=function Font$PrsChtFnt(str){if(!str||!str.trim().length)return;if(str.indexOf('X-MMS-IM-Format')==-1)return;str=str.replace('\n\r\n\r','').trim();str=str.replace('X-MMS-IM-Format:','').trim();var tmp=str.split(';');for(var i=0;i<tmp.length;++i){var pair=tmp[i].split('=');if(pair.length<2)continue;var key=pair[0].trim();var value=pair[1].trim();if(key=='FN'){value=value.replace(/%20/g,' ');if(!this.sFace)this.sFace=value}else if(key=='EF'){var iStl=0;if(value.indexOf('B')!=-1)iStl=(iStl|1);if(value.indexOf('I')!=-1)iStl=(iStl|2);if(value.indexOf('U')!=-1)iStl=(iStl|4);this.iStl=iStl}else if(key=='CO'){this.sClr='#'+this.RvrsRGB(value.toUpperCase());if(this.sClr=="#FFFFFF")this.sClr="#000000"}}};Font.prototype.RvrsRGB=function Font$RvrsRGB(sClr){var iL=sClr.length;if(iL<6){sClr="000000"+sClr;sClr=sClr.substr(iL,6)}return sClr.substr(4,2)+sClr.substr(2,2)+sClr.substr(0,2)};Owa.Dom.AjaxRequest.get_OnRequestCreated().add(cllctPrfDt);Owa.Dom.AjaxRequest.get_OnResponseReceived().add(strCbTmr);Owa.Dom.AjaxRequest.get_OnCallbackCompleted().add(fnshCllctDt);function strCbTmr(o){if(o.oPrfDt)o.oPrfDt.oCbTmr=new Date()}function fnshCllctDt(oAjaxRequest){try{if(oAjaxRequest.oPrfDt){var prfCnsWn=rtvPrfCnsl(window);if((prfCnsWn)&&(prfCnsWn.clctOeh)){var oDtNw=new Date();var diff=Math.ceil(oDtNw.getTime()-oAjaxRequest.oPrfDt.oStrtDt.getTime());prfCnsWn.chngTblInnerHtml(oAjaxRequest.oPrfDt.Id,prfCnsWn.CL_EXCTM,diff+"&nbsp;ms",1);diff=Math.ceil(oDtNw.getTime()-oAjaxRequest.oPrfDt.oCbTmr.getTime());prfCnsWn.chngTblInnerHtml(oAjaxRequest.oPrfDt.Id,prfCnsWn.CL_CLT_LTC,diff+"&nbsp;ms",1);prfCnsWn.fnshRq(oAjaxRequest.oPrfDt.Id,oAjaxRequest.oPrfDt)}}}catch(e){}}function rtvPrfCnsl(oWin){var oMstWin=gtMstr();if(oMstWin&&isDf(typeof(oMstWin.g_oPrfCnsl)))return oMstWin.g_oPrfCnsl}function cllctPrfDt(oAjaxRequest){if(!Owa.Utility.isIE())return;try{var prfCnsWn=rtvPrfCnsl(window);if((prfCnsWn)&&(prfCnsWn.clctOeh)){var id="cl"+prfCnsWn.iRqCnt;var o=new PrfDt(oAjaxRequest.sUrl,oAjaxRequest,id);try{var rowId=prfCnsWn.dtFrmSrv(oAjaxRequest.sUrl,id,o)}catch(e){}o.Id=rowId;try{oAjaxRequest.setRequestHeader("X-OWA-PerfConsoleRowId",rowId)}catch(e){}}}catch(e){}}function PrfDt(sUrl,oAjaxRequest,iId){this.sUrl=sUrl;this.oAjaxRequest=oAjaxRequest;oAjaxRequest.oPrfDt=this;this.Id=iId;this.oStrtDt=new Date();return this}function onrpddmclk(oEvent,oContext){var oCallerSubPage;if(oContext)oCallerSubPage=oContext.oCallerSubPage;else oCallerSubPage=Owa.UIControls.SubPage.get_Instance();var oTarget=oEvent.get_Target();var oDiv=oTarget;while(oDiv&&!oDiv.getIntAttribute("rdCnt"))oDiv=oDiv.get_ParentElement();if(!oDiv)return;var oA=oTarget;while(oA.get_TagName()!="A"&&!oA.equals(oDiv)&&oA)oA=oA.get_ParentElement();if(!oA||oA.equals(oDiv))return;var rgImg=oDiv.getAllDescendantsById("rdImg");for(var i=0;i<rgImg.length;i++){Owa.Components.CssSprites.updateImage(rgImg[i],"rd-unsel.gif");rgImg[i].setIntAttribute("checked",0)}var oImg=oA.getDescendantById("rdImg");Owa.Components.CssSprites.updateImage(oImg,"rd-sel.gif");oImg.setIntAttribute("checked",1);oEvent.cancelBubble();oEvent.preventDefault();onrpddmapply(oCallerSubPage)}function updRPddm(oCallerSubPage){var sCmd="";var iRP;if(isFolderViewSubPageObject(oCallerSubPage))iRP=oCallerSubPage.get_ReadingPanePosition();else if(isDf(typeof(g_oView)))iRP=g_oView.iRP;switch(iRP){case RP_OFF:case RP_NONE:sCmd="rpo";break;case RP_RIGHT:sCmd="rpr";break;case RP_BOTTOM:sCmd="rpb";break}updRd(oCallerSubPage._getDescendant("divRPddm"),sCmd)}function updRd(oDiv,sCmd){if(!oDiv){return}var rgImg=oDiv.getAllDescendantsById("rdImg");for(var i=0;i<rgImg.length;i++){if(rgImg[i].getAttribute("cmd")==sCmd){Owa.Components.CssSprites.updateImage(rgImg[i],"rd-sel.gif");rgImg[i].setIntAttribute("checked",1);rgImg[i].setIntAttribute("selected",1)}else{Owa.Components.CssSprites.updateImage(rgImg[i],"rd-unsel.gif");rgImg[i].setIntAttribute("checked",0);rgImg[i].setIntAttribute("selected",0)}}}function updRPNLVddm(oCallerSubPage){updRPddm(oCallerSubPage);if(isDf(typeof updMlddm))updMlddm(oCallerSubPage)}function onrpddmapply(oCallerSubPage){onReadingPaneDropDownMenuApplyOrCancel(oCallerSubPage,false)}function onrpddmcancel(oCallerSubPage){onReadingPaneDropDownMenuApplyOrCancel(oCallerSubPage,true)}function onReadingPaneDropDownMenuApplyOrCancel(oCallerSubPage,fCancel){if(!isFolderViewSubPageObject(oCallerSubPage)&&!isCalendarPageObject(oCallerSubPage)){return}var oDiv=oCallerSubPage._oDivRPddm;var rgImg=oDiv.getAllDescendantsById("rdImg");for(var i=0;i<rgImg.length;i++){if(rgImg[i].getIntAttribute("checked")&&!rgImg[i].getIntAttribute("selected")){if(fCancel){Owa.Components.CssSprites.updateImage(rgImg[i],"rd-unsel.gif");rgImg[i].setIntAttribute("checked",0)}else{rgImg[i].setIntAttribute("selected",1);(oCallerSubPage.get_ActionHandler())(rgImg[i].getAttribute("cmd"))}}else if(rgImg[i].getIntAttribute("selected")&&!rgImg[i].getIntAttribute("checked")){if(fCancel){rgImg[i].setIntAttribute("checked",1);Owa.Components.CssSprites.updateImage(rgImg[i],"rd-sel.gif")}else{rgImg[i].setIntAttribute("selected",0)}}}Owa.UIControls.MenuButton.hideAnyPopupMenu()}function spltVer(sV){var rgV=new Array();var rgsV=sV.split(".");for(var i=0;i<rgsV.length;i++)rgV.push(getInt(rgsV[i]));return rgV}function getBool(s){return(parseInt(s,10)==1)}function getWCX(o){var iX=getCX(o);var oW=god(o).parentWindow;if(!isWP()){while(1){try{var oFE=oW.frameElement;var oF=oFE.document.parentWindow;if(!oF.g_fOwa)break;iX+=getCX(oFE);oW=oF}catch(e){break}}}return iX}function setMaxHeight(o,iMaxH){if(("max-height" in o.style)&&(o.style.maxHeight>iMaxH)){return}o.style.maxHeight=iMaxH+"px"}function items(s,oPar){var rgS;if(oPar)rgS=getDescendants(oPar,s);else if(this==window)rgS=wda(s);else rgS=getDescendants(this,s);var rg=new Array();if(rgS){if(rgS.length==null){rg[0]=rgS}else{for(var i=0;i<rgS.length;++i){rg[i]=rgS[i]}}}return rg}(function(){Owa.Controls.Popup=function Owa$Controls$Popup(o,fnOnDataBind,fnOnPreShow,fnOnClose,iZ){Owa.Controls.Popup.baseClass.call(this,o);this.iZ=iZ?iZ:100;this.fIsOpen=0;this.oContainer=god(o).body;this.fnOnDataBind=fnOnDataBind;this.fnOnPreShow=fnOnPreShow;this.fnOnClose=fnOnClose};Owa.Utility.inherit(Owa.Controls.Popup,Owa.Controls.Control);Owa.Controls.Popup.prototype.init=function Owa$Controls$Popup$init(){attchEvt(window,"resize",this.crtCb("close"));this.oTextBox=getEm("input");this.oTextBox.type="text";this.oTextBox.className="offscreen";ibe(god(this.getEl()).body,this.oTextBox);this._cbOnBlurTextBox=this.addEvent(this.oTextBox,"blur","onBlurTextBox");this._cbOnMouseDown=this.addEvent(this.getEl(),"mousedown","onMouseDown");this._cbOnSelectStart=this.addEvent(this.getEl(),"selectstart","onSelectStart");this._cbClick=this.addEvent(this.getEl(),"click","forwardEvent");this._cbKeyDown=this.addEvent(this.oTextBox,"keydown","forwardEvent");makeBodyPositioned(this.getEl())};Owa.Controls.Popup.prototype.dispose=function Owa$Controls$Popup$dispose(){this.removeEvent(this.getEl(),"mousedown","_cbOnMouseDown");this.removeEvent(this.getEl(),"selectstart","_cbOnSelectStart");this.removeEvent(this.getEl(),"click","_cbClick");this.removeEvent(this.oTextBox,"blur","_cbOnBlurTextBox");this.removeEvent(this.oTextBox,"keydown","_cbKeyDown");rn(this.oTextBox);this.oTextBox=0;this.oContainer=0;this.getEl().oOriginalParent=null};Owa.Controls.Popup.prototype.showRelative=function Owa$Controls$Popup$showRelative(iX,iY,fUR){var oP=getRelativePosition(this.getEl());this.show(oP.iX+iX,oP.iY+iY,fUR)};Owa.Controls.Popup.prototype.show=function Owa$Controls$Popup$show(iX,iY,fUR){if(this.fnOnDataBind)this.fnOnDataBind(this);this.iX=iX;this.iY=iY;this.fUR=fUR;this.stTmout("tShow",1)};Owa.Controls.Popup.prototype.tShow=function Owa$Controls$Popup$tShow(){var oPU=this.getEl();showEm(oPU);this.fIsOpen=1;if(this.fnOnPreShow)this.fnOnPreShow(this);oPU.style.zIndex=this.iZ;spl(oPU,getVisiblePositionX(oPU,this.iX));spt(oPU,getVisiblePositionY(oPU,this.iY));this.enableClose()};Owa.Controls.Popup.prototype.close=function Owa$Controls$Popup$close(){if(this.fIsOpen){var oPU=this.getEl();hideEm(oPU);this.fIsOpen=0;if(this.fnOnClose)this.fnOnClose(this)}};Owa.Controls.Popup.prototype.suppressClose=function Owa$Controls$Popup$suppressClose(){this.fSuppressClose=1};Owa.Controls.Popup.prototype.enableClose=function Owa$Controls$Popup$enableClose(){this.fSuppressClose=0;this.oTextBox.style.top=god(this.oTextBox).body.scrollTop+"px";this.oTextBox.style.left=god(this.oTextBox).body.scrollLeft+"px";this.oTextBox.focus();this.oTextBox.style.top="";this.oTextBox.style.left=""};Owa.Controls.Popup.prototype.onBlurTextBox=function Owa$Controls$Popup$onBlurTextBox(){if(this.fIsOpen&&!this.fSuppressClose)this.close();if(this.fIsOpen)this.stTmout("enableClose",1)};Owa.Controls.Popup.prototype.onMouseDown=function Owa$Controls$Popup$onMouseDown(evt){this.suppressClose();this.forwardEvent(evt);cnclBbl(evt)};Owa.Controls.Popup.prototype.onSelectStart=function Owa$Controls$Popup$onSelectStart(evt){prvntDft(evt);cnclBbl(evt)};Owa.Controls.Popup.prototype.forwardEvent=function Owa$Controls$Popup$forwardEvent(evt){var sE="on"+evt.type;if(this[sE])this[sE](evt)}})();function Cmb(o,oPU,fnOnShwCmb){o.oPU=oPU;o.divCmbDd=getOneDescendant(o,"divCmbDd");o.divCmbDd.oCmb=o;o.enbl=cmbEnbl;o.shw=cmbShw;o.hide=cmbHid;o.fnOnShwCmb=fnOnShwCmb;o.onmousedown=onMDCmb;o.divCmbDd.onkeydown=onKDCmb;o.enbl(o.getAttribute("fEnbld")=="1")}function dispCmb(o){o.hide=o.enbl=o.shw=o.onmousedown=null;if(o.divCmbDd)o.divCmbDd.onkeydown=o.divCmbDd.oCmb=null;o.divCmbDd=o.oPU=null}function cmbEnbl(fE){if(fE){this.style.color="";this.divCmbDd.style.filter="";this.divCmbDd.tabIndex=0;this.setAttribute("fEnbld","1")}else{this.divCmbDd.style.filter="alpha(opacity=50)";this.divCmbDd.tabIndex=-1;this.style.color="#808080";this.setAttribute("fEnbld","0")}}function onKDCmb(e){e=e?e:getEvt(this);if((getKeyCode(e)==9)&&this.oCmb.oDP)this.oCmb.close();if(getKeyCode(e)!=13)return;this.oCmb.shw()}function onMDCmb(e){e=e?e:getEvt(this);if(this.getAttribute("fEnbld")=="0"){return}var o=getEvtTgt(e);if((o.id!="divCmbDd"&&!this.fd)||!isLBDwn(e))return;this.shw()}function cmbHid(){this.oPU.close()}function cmbShw(){if(this.oPU.fIsOpen){this.oPU.close()}else{if(this.fnOnShwCmb)this.fnOnShwCmb();this.oPU.showRelative(0,goh(this)+2,0)}}function DpCmb(o,fnOnChg,fnOnShw,fnOnHd){var oElement=Owa.Dom.Node.wrapDomNode(o);var divDP=getOneDescendant(o,o.id+"DP");o.oDP=new Owa.UIControls.DatePicker(Owa.Dom.Node.wrapDomNode(divDP),dpCmbOnChg,null,true);o.oDP.dpCmb=o;o.dt=o.oDP.getSelDts();o.setV=dpCmbSetV;o.close=dpCmbCls;fmtDt.rgAbrDN=eval(oElement.getAttribute("rgAbrDN"));fmtDt.rgAbrMN=eval(oElement.getAttribute("rgAbrMN"));o.oDPPU=new Owa.Controls.Popup(getOneDescendant(o,"divDP"),dpCmbOnShw,0,fnOnHd,150);o.oDPPU.init();o.oDPPU.onkeydown=function(e){onKDDP.call(o,e)};o.oDPPU.oDPCmb=o;Cmb(o,o.oDPPU,fnOnShw);o.oDP.cmbOnChg=fnOnChg}function dispDPCmb(o){if(o.oDP)o.oDP.dpCmb=null;o.oDP=null;o.dt=o.setV=o.close=null;dispCmb(o);if(o.oDPPU)o.oDPPU.dispose()}function onKDDP(e){if(getKeyCode(e)==9)this.hide()}function dpCmbOnShw(oPU){var o=oPU.oDPCmb;if(o.dt)o.oDP.setSDs(new Array(o.dt))}function dpCmbCls(){showEms(wda("divMnthLst"),1);this.hide()}function dpCmbSetV(dt){var sV;if(!dt)sV=this.L_None;else sV=fmtDt(dt,this.getAttribute("sWkdDtFmt"));getOneDescendant(this,"spanCmbSel").innerText=sV;this.dt=dt}function dpCmbOnChg(oDatePicker){oDatePicker.dpCmb.hide();var dt=oDatePicker.getSelDts();oDatePicker.dpCmb.setV(dt);if(oDatePicker.cmbOnChg)oDatePicker.cmbOnChg(dt)}function canItmRpl(sT){return(!isOfClss(sT,IT_CNT)&&!isOfClss(sT,IT_PDL)&&!isOfClss(sT,IT_TSK))}function addCls(o,sC){if(cntnCls(o,sC))return;if(o.className.length)o.className+=" "+sC;else o.className=sC}function rmvCls(o,sC){var s=o.className;var rx=new RegExp("(^|\\s)"+sC+"(\\s|$)");while(s.match(rx))s=s.replace(rx," ");o.className=s.trim()}function cntnCls(o,sC){var s=o.className;var rx=new RegExp("(^|\\s)"+sC+"(\\s|$)");if(s.match(rx))return 1;else return 0}function getVMAtt(sVm,fId,sExt){var oLoc=window.location;var sUrl=oLoc.protocol+"//"+oLoc.host+oLoc.pathname;if(fId)sUrl+="attachment.ashx?attach=1&id="+sVm+"&MSWMExt="+sExt;else sUrl+=sVm;return sUrl}function delWoSCDlg(){var oD=new BtnDlg("divDelCnfm",htmlEnc(L_CDMWOSC),null,new Array(L_Yes,L_Cncl),null,null,onClsDMWoSC);return oD}function delRcrWoSCDlg(){var oD=new BtnDlg("divDelRcrWoSC",htmlEnc(L_PRDMWOSC),L_DRM,new Array(L_DO,L_DS,L_Cncl),null,null,onClsDRWoSC);return oD}function delRcrDlg(sT,fPD){var oD=new BtnDlg("divDelRcr",htmlEnc(fPD?L_PRDRA:L_DRP),sT,fPD?new Array(L_DO,L_DS,L_Cncl):new Array(L_DO,L_DS),null,null,onClsDR);return oD}function SendDeclineResponseContext(sCId,sCK){this._sCId=sCId;this._sCK=sCK}SendDeclineResponseContext.prototype.get_CId=function SendDeclineResponseContext$prototype$get_CId(){return this._sCId};SendDeclineResponseContext.prototype.get_CK=function SendDeclineResponseContext$prototype$get_CK(){return this._sCK};function sndRspDlg(sCId,sCK){var oCtx=new SendDeclineResponseContext(sCId,sCK);var oD=new BtnDlg("divCnfDel",htmlEnc(L_RspDelM),L_RspDelT,new Array(L_Yes,L_No,L_Cncl),null,null,onClsSR,null,null,null,null,null,oCtx);oD.sCId=sCId;oD.sCK=sCK;return oD}function gtMtRspUrl(sId,iR){var sCls;switch(iR){case R_TNT:sCls="IPM.Schedule.Meeting.Resp.Tent";break;case R_ACC:sCls="IPM.Schedule.Meeting.Resp.Pos";break;case R_DEC:sCls="IPM.Schedule.Meeting.Resp.Neg";break}return"?ae=Item&a=New&s=Draft&t="+sCls+"&id="+sId}function onClkEISnd(){var o=getEvtTgt(event);if(o._fSent)return;var sErrDbg=o._sErrDbg;if(!sErrDbg)return;var rgE=items("exceptionType");var sE=null;if(0<rgE.length)sE=rgE[0].innerText;else sE="no exception";var oR=new oeReq("Error","SendReport",null,cbEISnd);oR.add("s","Error Report: "+sE);oR.add("b",sErrDbg);oR.oCtx=o;oR.send()}function cbEISnd(oR){if(oR.sErr){shwErrDlg(oR)}else{var o=oR.oCtx;o.title=o._msgSent;o._fSent=1}}function onClkEICpy(){var o=getEvtTgt(event);if(o._sErrDbg)setData(o._sErrDbg)}function wrnOof(){var oDlg=new BtnDlg("oofDlg",htmlEnc(L_OofOn),L_Oof,new Array(L_Yes,L_No),270,Owa.BUTTON_DIALOG_ICON.OOF,cbWrnOof);oDlg.show()}function cbWrnOof(i){if(i==0){var oR=new oeReq("Options","DsblOof",0,cbDsblOof);oR.send()}}function cbDsblOof(oR){if(oR.sErr){if(oR.fST)rplLgn();else shwErrDlg(0,L_ErrOof)}}function Slct(o,fnOnChg,fnOnShw,fIUpdCmb,z){if(Owa.Dom.Node.isInstance(o))o=o._get_DomNode();o.oPU=new Owa.Controls.Popup(getOneDescendant(o,"divCmbList"),slctOnDB,slctOnPreShw,0,z);o.oPU.init();o.oPU.oSlct=o;setMaxHeight(o.oPU.getEl(),150);o.clr=slctClr;o.add=slctAdd;o.getV=slctGetV;o.setV=slctSetV;o.fnOnShw=fnOnShw;o.fnOnChg=fnOnChg;o.oPU.onkeydown=function(e){onKDSlct.call(o,e)};o.oPU.onclick=function(e){onClkSlct.call(o,e)};o.oPU.onmousedown=function(e){onMDSlct.call(o,e)};o.fIUpdCmb=fIUpdCmb;o.pg=slctPg;o.sel=slctSelItm;o.oSel=null;if(o.getAttribute("oV")!=null){o.setV(o.getAttribute("oV"))}else{o.oSel=o.oPU.getEl().firstChild}Cmb(o,o.oPU)}function dispSlct(o){if(Owa.Dom.Node.isInstance(o)){o=o._get_DomNode()}o.clr=o.add=o.getV=o.setV=null;if(o.oPU&&o.oPU.dispose)o.oPU.dispose();dispCmb(o);o.fnOnShw=o.fnOnChg=null;o.pg=o.sel=null}function slctGetV(){return this.oSel?this.oSel.getAttribute("oV"):null}function slctSetV(oV){var oS=this.oPU.getEl();if(oV===null){this.sel(null,this.oPU.fIsOpen,1);return 1}var rgC=oS.childNodes;for(var i=0;i<rgC.length;++i){var oI=rgC[i];if(oI.nodeType!=1)continue;if(oI.getAttribute("oV")==oV||(oV&&oV.getDate&&(oI.getAttribute("oV")-oV)==0)){this.sel(oI,this.oPU.fIsOpen,1);return 1}}return 0}function slctSelItm(oI,fSF,fEvt){var fChg=1;if(this.oSel){fChg=!oI||oI.getAttribute("oV").valueOf()!=this.oSel.getAttribute("oV").valueOf();rmvCls(this.oSel,"cmbSel")}else{fChg=(oI!=null)}this.oSel=oI;var sHtml=oI?oI.innerHTML:"";var oV=oI?oI.oV:null;if(fChg){if(!this.fIUpdCmb){var oSpan=getOneDescendant(this,"spanCmbSel");oSpan.innerHTML=sHtml}if(!fEvt&&this.fnOnChg){this.fnOnChg(oV,this,sHtml)}}if(oI){this.oSel.className+=" cmbSel";scrollIntoView(this.oSel,this.oPU.getEl())}}function slctClr(){this.oPU.getEl().innerHTML="";this.oSel=null}function slctAdd(oV,sD){var o=getEm("DIV",god(this));o.noWrap=1;o.tabIndex=0;o.oV=oV;o.innerHTML="<span class=\"listItm\">"+sD+"</span>";ibe(this.oPU.getEl(),o)}function slctOnDB(oPU){if(oPU.oSlct.fnOnShw)oPU.oSlct.fnOnShw(oPU.oSlct);sph(oPU.getEl(),150)}function slctOnPreShw(oPU){var o=oPU.getEl();o.style.width="";var iMinW=gow(oPU.oSlct)-5;var iW=gow(o);if(iW<iMinW)iW=iMinW;spw(o,iW+5);if(o.scrollHeight<=o.clientHeight)o.style.height="";if(oPU.oSlct.oSel)oPU.oSlct.sel(oPU.oSlct.oSel,1)}function onMDSlct(){var oDivSpl=$("divSpl");if(isSpC()&&isDisp(oDivSpl.getExpando("oSpellCheckerComboBox"))){oDivSpl.getExpando("oSpellCheckerComboBox").oSpSel=crtSelTxR()}}function onKDSlct(e){var oI=null;var fCls=0;switch(getKeyCode(e)){case 9:fCls=1;break;case 40:oI=this.oSel.nextSibling;break;case 38:oI=this.oSel.previousSibling;break;case 13:fCls=1;oI=this.oSel;break;case 36:oI=this.oPU.getEl().firstChild;break;case 35:oI=this.oPU.getEl().lastChild;break;case 34:oI=this.pg(DOWN);break;case 33:oI=this.pg(UP);break;default:return}if(fCls)this.hide();if((oI==null)||!isDisp(oI))return;this.sel(oI,!fCls);canEvt(e)}function slctGetLItm(o){while(o.oV==null)o=o.parentNode;return o}function slctPg(iD){var oE=this.oPU.getEl();var iItms=oE.children.length;var iAH=oE.scrollHeight/iItms;var iV=oE.offsetHeight/iAH;var oI=this.oSel;var oN=oI;for(;0<iV&&oN;--iV){oI=oN;if(iD==UP)oN=oI.previousSibling;else oN=oI.nextSibling}return oI}function onClkSlct(e){cnclBbl(e);var o=getEvtTgt(e);if(o==this.oPU.getEl())return;this.hide();this.sel(slctGetLItm(o),0)}var TM_S=0;var TM_E=1;var TM_R=2;var g_sShtTmFmt;function TmSlct(oElement,fnOnChg,iT,oSE){var o=oElement._get_DomNode();Slct(o,tmSlctOnSlct,tmSlctOnShw,1);o.setT=tmSlctSetT;o.isVld=tmSlctOnFcsO;o.fnOnChgTm=fnOnChg;o.udUI=tmSlctUI;o.dt=new Date(oElement.getAttribute("sTm"));g_sShtTmFmt=oElement.getAttribute("sStf");parseTm.rxAmPm=new RegExp(o.sAmPmRx,"gi");fmtDt.sAM=oElement.getAttribute("L_AM");fmtDt.sPM=oElement.getAttribute("L_PM");rndrTLst.L_Dec=oElement.getAttribute("L_Dec");rndrTLst.L_InvldTm=oElement.getAttribute("L_InvldTm");if(iT==TM_E)o.oS=oSE;else if(iT==TM_S)o.oE=oSE;o.iT=iT;var oTxtTime=getOneDescendant(o,"txtTime");oTxtTime.onfocusout=function(){tmSlctOnFcsO.call(o)}}function dispTmSlct(o){dispSlct(o);o.setT=null;o.isVld=null;o.fnOnChgTm=null;o.udUI=null;o.dt=null;o.oSE=null;o.oE=null;o.oS=null;var oTxtTime=getOneDescendant(o,"txtTime");oTxtTime.onfocusout=null;g_sShtTmFmt=o.sStf=null;parseTm.rxAmPm=null;fmtDt.sAM=o.L_AM=null;fmtDt.sPM=o.L_PM=null;rndrTLst.L_Dec=o.L_Dec=null;rndrTLst.L_InvldTm=o.L_InvldTm=null}function tmSlctSetT(dt,fSE,fAU){var dtO=this.dt;this.dt=dt;this.udUI();if(this.iT==TM_S){var iD=this.oE.dt-dtO;if(0<=iD){var dtE=new Date(this.dt);dtE.setUTCMilliseconds(dtE.getUTCMilliseconds()+iD);this.oE.setT(dtE,0,1)}}var fC=!cmpDt(dtO,this.dt);if(!fSE&&fC&&this.fnOnChgTm)this.fnOnChgTm(fAU)}function tmSlctOnShw(oCmb){rndrTLst(oCmb,oCmb.dt,oCmb.iT==TM_E?oCmb.oS.dt:null);var iM=(30<=oCmb.dt.gmins())?30:0;var dt=new Date(oCmb.dt);dt.smins(iM);oCmb.setV(dt)}function tmSlctOnSlct(dt,oCmb){oCmb.setT(dt)}function tmSlctOnFcsO(){var oCmb=this;var oTxtTime=getOneDescendant(oCmb,"txtTime");if(oTxtTime.value==fmtDt(oCmb.dt,g_sShtTmFmt)){return 1}var iM;iM=parseTm(oTxtTime.value,oCmb.iT==TM_E?oCmb.oS.dt:null,oCmb.iT==TM_E?oCmb.dt:null);if(iM==-1){alert(oCmb.L_InvldTm);oCmb.udUI();setFcs(oTxtTime);return 0}else{var dt=new Date(oCmb.dt);dt.shrs(0,iM);oCmb.setT(dt);return 1}}function tmSlctUI(){var oTxtTime=getOneDescendant(this,"txtTime");oTxtTime.value=fmtDt(this.dt,g_sShtTmFmt)}function rndrTLst(tblT,dt1,dt2){if(!dt2){rndrATLst(tblT,dt1)}else if((dt1-dt2)<(24*60*60*1000)){tblT.clr();var iMO=(dt2.ghrs()*60)+dt2.gmins();for(var i=0;i<48;i++){var iM=iMO+(i*30);var dt=new Date(dt2);dt.shrs(0,iM);var iMD=iM;if(1440<=iMD)iMD-=1440;var sD=fmtDt(dt,g_sShtTmFmt);var sH=(i>>1).toString(10)+((i%2)?(rndrTLst.L_Dec+"5"):"");sD+=a_sDur.format(sH);tblT.add(dt,sD)}}else{rndrATLst(tblT,dt1)}}rndrTLst.L_Dec;function cbMvItm(oR){g_fJnkRq=0;if(oR.sErr){if(oR.fST)popLgn();shwErrDlg(oR)}else{var oC=oR.oCtx;var oCallerSubPage=oC.oCallerSubPage;var oSubPageController;var oLst;try{oSubPageController=Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController();if(oC.fCls){oSubPageController=oSubPageController.get_ParentController();oLst=Owa.PageHierarchy.getVirtualListViewFromSubPageController(oSubPageController)}else{var oListView=Owa.PageHierarchy.getVirtualListViewFromSubPageController(oSubPageController);if(oListView&&(oC.iActn==ACTN_ADDBSL)){oSubPageController=oSubPageController.get_ParentController();oLst=oListView}else if(isFolderViewSubPageObject(oCallerSubPage)){oLst=oCallerSubPage.get_VirtualListView()}}oSubPageController=oSubPageController.get_ParentController();oSubPageController.invokeFunction("stDrty",[oC.sDstFId])}catch(e){}rfrshLst(oLst,oR)}}function rfrshLst(oLst,oMvR){if(oLst&&oMvR){oLst.updCnts(oMvR);oLst.rmvRws(oMvR.oCtx.rgIds);if(oMvR.oCtx.fCls){window.close()}}}function shwPont(iPT,sMsg,sTtl,rgBtn,iIcn,cb,oCtx,sId){var oC=new Object();oC.oCtx=oCtx;oC.cb=cb;oC.iPT=iPT;var sHtml="<div><div>"+sMsg+"</div><div>&nbsp;</div><div><input type=checkbox id=chkPont><span>&nbsp;</span><label for=chkPont>"+L_DntShw+"</label></div></div>";var oDlg=new BtnDlg(sId?sId:"divPont",sHtml,sTtl,rgBtn,390,iIcn,cbShwPont,0,0,0,0,0,oC);oDlg.show();return oDlg}function cbShwPont(iB,oC){if(iB==-1)return;if(wtda("chkPont").checked){var oR=new oeReq("Options","DisablePont");oR.add("pt",oC.iPT);oR.send();if(isDf(typeof(a_iEnblPnt)))a_iEnblPnt&=~oC.iPT}if(oC.cb)oC.cb(iB,oC.oCtx)}function shwDelRcrTskDlg(cb,sSbj,oC){var oCtx=new Object();oCtx.cb=cb;oCtx.oC=oC;var sHtml="<div>"+htmlEnc(L_TskRcrs).format(sSbj)+"</div>"+"<div><input id=rdoDO type=radio name=rdoDRT checked><label for=rdoDO>"+L_DelOcc+"</label></div>"+"<div><input id=rdoDA type=radio name=rdoDRT><label for=rdoDA>"+L_DelAOcc+"</label></div>";var oDlg=new BtnDlg("divDRT"+rndm(),sHtml,L_DelRT,new Array(L_OK,L_Cncl),367,null,cbShwDelRcrTskDlg,0,0,0,0,0,oCtx);oDlg.show();return oDlg}function cbShwDelRcrTskDlg(iB,oCtx){if(iB==-1)return;oCtx.cb(iB,wtda("rdoDO").checked,oCtx.oC)}function updQB(oQB,iPrcntUsd,iQtLvl){var oQtUsd=oQB.getDescendantById("elcQuotaUsed");if(iPrcntUsd<=0){oQtUsd.set_Width(0,Owa.Style.Unit.Percent);oQtUsd.set_IsShown(0)}else{oQtUsd.set_Width((iPrcntUsd>100?100:iPrcntUsd),Owa.Style.Unit.Percent);oQtUsd.set_IsShown(1)}switch(iQtLvl){case QT_NRM:oQtUsd.set_CssClasses(new Array("elcQtNorm"));break;case QT_AW:oQtUsd.set_CssClasses(new Array("elcQtWarn"));break;case QT_EXCD:oQtUsd.set_CssClasses(new Array("elcQtExc"));break}}var g_sRFId="";var g_fDltDrft=0;var g_fFcsLV=1;var g_rgFntSz=[0,8,10,12,14,18,24,36];function onCtxAtch(oEvent){var oE=oEvent.get_Target();if(oE&&oE.get_Id()=="lnkAtmt"){var oP=oE.get_ParentElement();if(oP!=null){var sUrl=oP.getAttribute("_url");if(sUrl){oE.setAttribute("href",sUrl)}else{if(!(oP.getAttribute("_idx"))){oE.setAttribute("href",gtAttUrl(oP))}}}}}function rszAw(oEvent){var divAt=$("divAtch");var divAtHr=$("divAttachHr");var divWellAt=$("divWellAttach");if(divAt){if(!divAt.hasChildNodes()&&divWellAt){if(divAtHr){divAtHr.set_IsShown(false)}divWellAt.set_IsShown(false);return}}else{return}if(divAtHr){divAtHr.set_IsShown(true)}if(divWellAt){divWellAt.set_IsShown(true)}safeResizeBodies()}function opnAtt(oSpn,oEvent,isIrmCopyRestrictedConv){if(oSpn.className=="dsbl"){canEvt(oEvent);return}var iA=getInt(oSpn.getAttribute("_level"));if(isNaN(iA)||iA<1||iA>3){canEvt(oEvent);return}if(iA==1&&getBool(oSpn.parentNode.getAttribute("_isRW"))){alert(L_AttWrnLevOne);canEvt(oEvent)}if(iA==2){if(isIrmCopyRestrictedConv){alert(L_IrmCopyRestrictedConv)}else{alert(L_AttWrnLevTwo)}canEvt(oEvent)}else if(iA==3){var sQueryString=oSpn.getAttribute("_qs");var iIdx=getInt(oSpn.getAttribute("_idx"));var fEmbedded=getBool(oSpn.getAttribute("_emb"));if(sQueryString&&sQueryString.indexOf("t="+IT_CNT)>=0){openItm(gtAttUrl(oSpn),0,0,RF_W,RF_H)}else if(sQueryString&&sQueryString.indexOf("t="+IT_PDL)>=0){openItm(gtAttUrl(oSpn),0,0)}else if(!isNaN(iIdx)&&!fEmbedded){var fRW=getBool(oSpn.parentNode.getAttribute("_isRW"));if(fRW||!g_oMmBdy.IEIsProtectedModeProcess){alert(L_AttWrnSaveToDisk)}else{self.location=g_oMmBdy.attachments.item(iIdx).href}}else if(!isNaN(iIdx)&&fEmbedded){opnMmEmbItm(iIdx)}else{if(Owa.Utility.isIE()||sQueryString&&(sQueryString.indexOf("ae=Item")>=0||sQueryString.indexOf("ae=PreFormAction")>=0)){opnWin(gtAttUrl(oSpn)+gtMmPar(),0,0,0,"_blank")}else{self.location=gtAttUrl(oSpn)+gtMmPar()}}canEvt(oEvent)}}function gtAttUrl(oSpn,f){var fEmb=typeof(a_rgsIds)!="undefined";var s;var sQueryString=oSpn.getAttribute("_qs");if(sQueryString){s="?"+sQueryString+"&"}else{if(f){s=""}else{s="attachment.ashx?attach=1&"}}var sId=oSpn.getAttribute("_sId");if(sId){s+="id="+urlEnc(sId)}else{s+="id="+urlEnc(fEmb?a_rgsIds[0]:a_sId)}if(fEmb){for(var i=1;i<a_rgsIds.length;i++){s+="&attid"+(i-1)+"="+urlEnc(a_rgsIds[i])}}var iA=fEmb?a_rgsIds.length:1;s+="&attid"+(iA-1)+"="+urlEnc(oSpn.getAttribute("_attid"));s+="&attcnt="+iA;return s}function selAtt(oSpn){var oRng;onKeyDownAw.oLastAttSpn=oSpn;oRng=createTextRange(document);oRng.moveToElementText(oSpn._get_DomNode());oRng.moveStart(1);oRng.select();oSpn.focus()}function onKeyDownAw(oEvent){var oSpn=oEvent.get_Target();var oAttachWell=oSpn.get_ParentElement();var iKeyCode=oEvent.get_KeyCodeForKeyUpDown();var isRW=false;if(Owa.Utility.isSafari()){if(onKeyDownAw.oLastAttSpn){oSpn=onKeyDownAw.oLastAttSpn;oAttachWell=oSpn.get_ParentElement();isRW=oAttachWell.getBoolAttribute("_isRW")}}else{isRW=oAttachWell.getBoolAttribute("_isRW")}if(oSpn.get_Id()!="spnAtmt")return;switch(iKeyCode){case 46:case 8:if(isRW){dltAtt(oSpn);canEvt(oEvent)}break;case 13:opnAtt(oSpn._get_DomNode(),oEvent);canEvt(oEvent);break}onKeyDownAw.oLastAttSpn=null}function getAttachmentSpan(oE){if(oE.get_TagName()=="IMG"){oE=oE.get_ParentElement()}if(oE.get_Id()=="lnkAtmt"){oE=oE.get_ParentElement()}if(oE.get_Id()=="spnAtmt"){return oE}return null}function onClickAw(oEvent,isIrmCopyRestrictedConv){var oE=oEvent.get_Target();var oSpn=getAttachmentSpan(oE);if(!oSpn){return}if(getBool(oSpn.get_ParentElement().getAttribute("_isRW"))){selAtt(oSpn)}else{opnAtt(oSpn._get_DomNode(),oEvent,isIrmCopyRestrictedConv)}canEvt(oEvent)}function onAwBlur(oEvent){var oE=oEvent.get_Target();onKeyDownAw.oLastAttSpn=null}function onDblClickAw(oEvent){var oE=oEvent.get_Target();var oSpn=getAttachmentSpan(oE);if(!oSpn){return}opnAtt(oSpn._get_DomNode(),oEvent);canEvt(oEvent)}function dltAtt(oSpn){var oR;if(Owa.Components.OehRequest.hasPendingRequests())return;if(oSpn.get_Id()!="spnAtmt")return;if(g_oMmBdy){dltSmAtt(oSpn._get_DomNode())}else{oR=new oeReq("Attachments","Delete",oSpn._get_DomNode().parentNode,cbDltAtt);oR.add("Id",a_sId);oR.add("CK",a_sCK);oR.add("AttId",oSpn.getAttribute("_attid"));oR.send()}}function cbDltAtt(oR){if(oR.fST){popLgn();return}if(oR.sErr){alert(oR.sErr)}else{var oDivR=Owa.Dom.Document.get_Current().createElement("DIV");oDivR=Owa.Dom.Document.get_Current().appendChild(oDivR);oDivR.set_InnerHtml(oR.sBody);var oFirstChild=oDivR.getDescendantById("attWD");var oSecondChild=oDivR.getDescendantById("iBData");a_sCK=oDivR.getDescendantById("ck").get_TextContent();if(oFirstChild){Owa.Dom.Node.wrapDomNode(oR.oCtx).set_InnerHtml(oFirstChild.get_InnerHtml())}if(oSecondChild){var oNewDivIDAMessage=oSecondChild.getDescendantById("divIDA");if(oNewDivIDAMessage){replaceOrInsertInfobarMessageElement(oNewDivIDAMessage)}else{checkRemoveInfobarMessage("divIDA")}}updateInfobarForUnprotectableAttachments();oDivR.remove(true);rszAw();drty();safeResizeBodies()}}function onClkSubj(){var oDivSubj=$("divSubj");var oTxtSubj=$("txtSubj");oTxtSubj.set_Value(oDivSubj.get_TextContent());oDivSubj.set_Visibility(Owa.Style.Visibility.Hidden);oTxtSubj.set_IsShown(true);adjustSubjectPosition();oTxtSubj._get_DomNode().select()}function onCmnEdtSubEd(){if(Owa.Components.OehRequest.hasPendingRequests()){return}var fS=0;var oDivSubj=$("divSubj");var oTxtSubj=$("txtSubj");if((oDivSubj.get_TextContent()!=oTxtSubj.get_Value())&&!g_fdelMsg){fS=savRMsg(a_sNmSpc,"Subj",oTxtSubj.get_Value(),a_fPrv)}if(fS){oDivSubj.set_TextContent(oTxtSubj.get_Value())}oDivSubj.set_Visibility(Owa.Style.Visibility.Visible);oTxtSubj.set_IsShown(false)}function adjustSubjectPosition(){var oTxtSubj=$("txtSubj");if(oTxtSubj){if(Owa.Utility.isFirefox()){oTxtSubj.set_Padding(Owa.Style.Side.Top,1)}else if(Owa.Utility.isIE()){oTxtSubj.set_Padding(Owa.Style.Side.Left,1);oTxtSubj.set_Padding(Owa.Style.Side.Right,1);oTxtSubj.set_Padding(Owa.Style.Side.Top,1)}}}function isRichTextEditorSupported(){return(isDf(typeof(a_fRichTextEditorSupported))&&a_fRichTextEditorSupported)}function insFnt(oEdD,oEdB,isReplyForward){var fInsertEmptySpace=isReplyForward||Owa.Utility.isSafari()||Owa.Utility.isFirefox();var sBlankSpace=fInsertEmptySpace?"&nbsp;":"";oEdB.set_InnerHtml("<div>"+sBlankSpace+"</div>"+oEdB.get_InnerHtml());applyCssToDomNode(oEdB.get_FirstChild()._get_DomNode(),a_sDefFntBIUStyl);if(Owa.Utility.isFirefox()){var oR=createSelectionRange(oEdD._get_DomDocument());oR.moveToElementText(oEdB.get_FirstChild()._get_DomNode());oR.collapse(1);oR.select()}}function wrapHtmlBodyWithDefaultFont(oEdD,oEdB,sCssText){var divFnt=oEdD.createElement("div");applyCssToDomNode(divFnt._get_DomNode(),sCssText);divFnt.set_InnerHtml(oEdB.get_InnerHtml());oEdB.set_InnerHtml(divFnt.get_OuterHtml())}function applyCssToDomNode(oDomNode,sCssText){if(Owa.Utility.isIE()){oDomNode.style.setAttribute("cssText",sCssText)}else{oDomNode.setAttribute("style",sCssText)}}function addSignature(fAutomaticallyAdd,fIsHtml){if(!a_sSigHtml&&!a_sSigTxt){return}var fIsReplyOrForward=isRepFw();if(Owa.Utility.isIE()||fIsHtml){var oEditorDocument=edDoc(1);var oEditorBody=oEditorDocument.get_Body();var oDivSignature=oEditorDocument.createElement("DIV");var oBodyFirstChild=oEditorBody.get_FirstChild();oDivSignature.set_InnerHtml("<BR>"+(fIsHtml?a_sSigHtml:htmlEnc(a_sSigTxt)));var oDivSignatureStyleTags=oDivSignature.getDescendantsByTagName("STYLE");for(var i=0;i<oDivSignatureStyleTags.length;i++){oDivSignatureStyleTags[i].remove(true)}if(!oBodyFirstChild){oDivSignature=oEditorDocument.appendChild(oDivSignature)}else{if(fAutomaticallyAdd){oDivSignature=oBodyFirstChild.insertAdjacentElement(Owa.ElementInsertionPoint.AfterEnd,oDivSignature)}else{if(fIsReplyOrForward){$("ifBdy").get_ContentWindow()._domWindow.focus();var oSelectionRange=createSelectionRange(edDoc());oSelectionRange.pasteHtml(oDivSignature.get_OuterHtml())}else{oDivSignature=oEditorBody.insertAdjacentElement(Owa.ElementInsertionPoint.BeforeEnd,oDivSignature)}}}if(!fAutomaticallyAdd){setFcsBdy()}}else{var oTextBody=$("txtBdy");var sSigTxt="\n"+a_sSigTxt;var sBodyText=oTextBody.get_Value();var oTxtBdyNode=oTextBody._oDomNode;if(fIsReplyOrForward){var iCursorPosition=oTxtBdyNode.selectionStart;var sStartText=(oTxtBdyNode.value).substring(0,iCursorPosition);var sEndText=(oTxtBdyNode.value).substring(iCursorPosition,oTxtBdyNode.value.length);oTextBody.set_Value(sStartText+sSigTxt+sEndText);if(!fAutomaticallyAdd){oTxtBdyNode.selectionStart=iCursorPosition+sSigTxt.length;oTxtBdyNode.selectionEnd=iCursorPosition;oTxtBdyNode.focus()}}else{oTextBody.set_Value(sBodyText+sSigTxt);if(!fAutomaticallyAdd){var iCursorPosition=oTxtBdyNode.selectionStart;oTxtBdyNode.selectionStart=iCursorPosition;oTxtBdyNode.selectionEnd=iCursorPosition;oTxtBdyNode.focus()}}}}function addSignatureToNewMessage(){var fIsHtml=!(isDf(typeof(a_fTxt))&&a_fTxt);if(!isDf(typeof(a_fSig))||!a_fSig||isExpDft()||(!fIsHtml&&isRepFw())){return}addSignature(true,fIsHtml)}function addSignatureToExistingMessage(){var fIsHtml=isHtml();addSignature(false,fIsHtml);drty()}function wrtBdy(oD,sB){oD.open();oD.write(sB);oD.close()}function initializeIFrameBodyReader(oEdD,oEdB,fnRsz){initializeIFrameBodyReaderHotkeys(oEdD);initializeIFrameBody(oEdD,oEdB,fnRsz)}function initializeIFrameBody(oEdD,oEdB,fnRsz){oEdD.set_IsRtl(Owa.Dom.Document.get_Current().get_IsRtl());if(!oEdB.getBoolAttribute("ocsi")){apBdyStl(oEdD)}fnRsz();if(Owa.Utility.isFirefox()){oEdD.attachEvent("keypress",Owa.Components.Application.preventFirefoxDefaultKeyEvent)}}var g_oIFrameBodyActionTable;var g_oIFrameBodyHotkeyManager;function initializeIFrameBodyEditorHotkeys(oDocument){g_oIFrameBodyActionTable=new Owa.Components.ClientActionTable();g_oIFrameBodyActionTable.addAsAction("bold",[onEditorEnhancedAction]).addAsAction("italic",[onEditorEnhancedAction]).addAsAction("underline",[onEditorEnhancedAction]).addAsAction("createlink",[onEditorEnhancedAction]).addAsAction("cut",[onEditorDefaultAction]).addAsAction("copy",[onEditorDefaultAction]).addAsAction("paste",[onEditorDefaultAction]).addAsAction("undo",[onEditorDefaultAction]).addAsAction("redo",[onEditorDefaultAction]).addAsAction("selectall",[onEditorDefaultAction]).addAsAction("indent",[onEditorEnhancedAction]).addAsAction("outdent",[onEditorEnhancedAction]);g_oIFrameBodyHotkeyManager=new Owa.Components.HotKeyManagerDom(g_oIFrameBodyActionTable,oDocument,Owa.UIControls.SubPage.get_Instance().get_HotKeyManager());g_oIFrameBodyHotkeyManager.addHotKey(L_HkB,"bold").addHotKey(L_HkI,"italic").addHotKey(L_HkU,"underline").addHotKey(L_HkLnk,"createlink").addHotKey(L_HkCut,"cut").addHotKey(L_HkCpy,"copy").addHotKey(L_HkUndo,"undo").addHotKey(L_HkRedo,"redo").addHotKey(L_HkSel,"selectall")}function initializeIFrameBodyReaderHotkeys(oDocument){g_oIFrameBodyActionTable=new Owa.Components.ClientActionTable();g_oIFrameBodyHotkeyManager=new Owa.Components.HotKeyManagerDom(g_oIFrameBodyActionTable,oDocument,Owa.UIControls.SubPage.get_Instance().get_HotKeyManager())}function onEditorDefaultAction(oSender,oEventArgs){if(oEventArgs.fIsHotkey){return true}else{Owa.ExecCommand.execute(edDoc(0),oEventArgs.sActionName);return false}}function onEditorEnhancedAction(oSender,oEventArgs){if((!Owa.Utility.isFirefox()||oEventArgs.sActionName.toLowerCase()!="createlink")&&isHtml()){Owa.ExecCommand.execute(edDoc(0),oEventArgs.sActionName)}}function initTxtBdy(oCallerSubPage,sId){var oTxt=$(sId);if(oTxt){oTxt.attachEvent("keydown",onKDTxt);if(!chkMime()){var oContext={};oContext.oCallerSubPage=oCallerSubPage;oTxt.attachEvent("drop",Owa.Utility.createArgumentContextDelegate(window,procIA,oContext));oTxt.attachEvent("paste",Owa.Utility.createArgumentContextDelegate(window,procIA,oContext));initDE(sId)}}}function initRead(sB,oFrame,fnRsz){if(!oFrame)return;var s="";if(!a_fTxt){s=sB;oFrame.set_IsShown(false)}wrtBdy(oFrame.get_ContentDocument(),s);var oEdD=oFrame.get_ContentDocument();var oEdB=oEdD.get_Body();initializeIFrameBodyReader(oEdD,oEdB,fnRsz);oEdB.attachEvent("dragenter",canEdEvt);oEdB.attachEvent("dragover",canEdEvt);oEdB.attachEvent("drop",canEdEvt);var fCopyRestricted=isDf(typeof(a_fCopyRestricted))&&(a_fCopyRestricted==1);if(fCopyRestricted){oEdB.attachEvent("copy",canEvt);oEdB.attachEvent("contextmenu",canEvt);oEdB.attachEvent("dragstart",canEvt);oEdB.attachEvent("selectstart",canEvt)}var oTxt=$("txtBdy");if(a_fTxt){oFrame.set_IsShown(false);oTxt.set_IsShown(true);oTxt.setBoolAttribute("readOnly",true);rszBdy(oTxt,1)}else{if(fCopyRestricted){oTxt.set_Value("")}oFrame.set_IsShown(true)}}function isFormatBarInitialized(oDivFmtBr){return(oDivFmtBr&&oDivFmtBr.getExpando("formatBar"))}function procIA(e,oContext){if(!wda("divAtch"))return;e=e?e:edEvt();if(!e)e=getEvt(this);var oEvent=Owa.Dom.Event.isInstance(e)?e:new Owa.Dom.Event(e);var fCp=oEvent.get_Type()=="paste";var oStorage=fCp?new Owa.Components.Storage.Clipboard():new Owa.Components.Storage.DragDrop(oEvent);var oDraggableObject=Owa.Components.Storage.StorableObject.createFromStorage(oStorage);if(!oDraggableObject)return 1;if(!canAttach(oDraggableObject)){if(fCp)oStorage.set_Data("");canEvt(e);return}canEvt(e);var oCallerSubPage=oContext.oCallerSubPage;var iT=oCallerSubPage.getSubPageVariable("a_iT");sndIAReq(oCallerSubPage,oDraggableObject,isDf(typeof(iT))&&iT>=a_IT_MSG?iT:a_IT_MSG,cbIA)}var g_fIA=0;function sndIAReq(oCallerSubPage,oDraggableObject,iT,cb){var oRootElement=oDraggableObject.get_RootElement();if((typeof(g_fIA)!="undefined")&&g_fIA)return;else g_fIA=1;var oLV=0;if(isNavigationPageObject(oCallerSubPage)){oLV=oCallerSubPage.getLstVw(oRootElement.get_FolderId())}else if(isFolderViewSubPageObject(oCallerSubPage)){oLV=oCallerSubPage.get_VirtualListView()}if(oLV&&checkLimit(oDraggableObject,oLV))return;var oContext={};oContext.oCallerSubPage=oCallerSubPage;var oR=new oeReq("Attachments","AttachItems",oContext,cb);if(!(typeof(a_sId)=="undefined")&&a_sId)oR.add("Id",a_sId);if(!(typeof(a_sCK)=="undefined")&&a_sCK)oR.add("CK",a_sCK);oR.add("IT",iT);var rgIds=[];oRootElement.foreach_Item(function(oItem){rgIds.push(oItem.get_ItemId())});if(rgIds.length)oR.addRg("ExIds",rgIds);var rgConversation=[];oRootElement.foreach_Conversation(function(oConversation){var oSt=new oeSt(oR,"CnvInf");oSt.add("CT",oConversation.get_Topic());oSt.add("TS",oConversation.get_TimeStamp());rgConversation.push(oSt)});if(rgConversation.length)oR.addRgSt("Cnvs",rgConversation);oR.send();shwPrgrsInd(L_Ld)}function cbIA(o){if(typeof(g_fIA)!="undefined")g_fIA=0;hdPrgrsInd();if(o.fST){popLgn();return}if(o.sErr){alert(o.sErr)}else{var divRsp=Owa.Dom.Document.get_Current().createElement("div");divRsp.set_IsShown(false);Owa.Dom.Document.get_Current().appendChild(divRsp);divRsp.set_InnerHtml(o.sBody);var o=new Object();if(divRsp.getDescendantById("itmId")){o.sId=divRsp.getDescendantById("itmId").get_TextContent()}o.sCK=divRsp.getDescendantById("itmCK").get_TextContent();o.sAtts=divRsp.getDescendantById("attItms").get_InnerHtml();o.sIbd=divRsp.getDescendantById("attIB").get_InnerHtml();procAttRsp(o);divRsp.remove(true)}}function cbFwIA(oR){if(typeof(g_fIA)!="undefined")g_fIA=0;hdPrgrsInd();if(oR.fST){popLgn();return}if(oR.sErr){alert(oR.sErr)}else{if(typeof(a_iDltDrft)!="undefined")g_fDltDrft=a_iDltDrft;else g_fDltDrft=1;var oDivR=Owa.Dom.Document.get_Current().createElement("DIV");oDivR.set_InnerHtml(oR.sBody);if(oDivR.getDescendantById("itmId")){var sId=oDivR.getDescendantById("itmId").get_TextContent();var oContext=oR.oCtx;var oCallerSubPage=oContext?oContext.oCallerSubPage:Owa.UIControls.SubPage.get_Instance();openItm("?ae=Item&t=IPM.Note&a=New&id="+urlEnc(sId),null,null,null,null,oCallerSubPage)}else{alrt(L_ErrFwdIA)}if(oDivR.getDescendantById("attIB")){var oDivTmp=Owa.Dom.Document.get_Current().createElement("DIV");oDivTmp.set_InnerHtml(oDivR.getDescendantById("attIB").get_InnerHtml());var oErr=oDivTmp.getDescendantById("divDAErr");if(oErr){alrt(oErr.get_TextContent(),null,Owa.BUTTON_DIALOG_ICON.WARNING,L_Wrng)}}}}function onPste(){var o=gtWrd();if(o)unmrkW(o);var e=edEvt();if(e&&getEvtType(e)!="paste")return;if(isHtml())return 1;var text=window.clipboardData.getData("Text");setData(text);return 1}function apBdyStl(oDoc,fR){applyParagraphStylesToDocument(oDoc,fR);var oSS=insertSS(oDoc,"owaTempEditStyle");if(!oDoc.get_Body().getBoolAttribute("ocsi")){if(isDf(typeof(a_fPrintRestricted))&&(a_fPrintRestricted==1)){applyNoPrintStylesToDocument(oDoc)}var oS=getStyle("scrlbrs");oSS.addRule("BODY","scrollbar-base-color:"+oS.scrollbarBaseColor+";scrollbar-highlight-color:"+oS.scrollbarHighlightColor+";scrollbar-darkshadow-color:"+oS.scrollbarDarkShadowColor+";scrollbar-track-color:"+oS.scrollbarTrackColor+";scrollbar-arrow-color:"+oS.scrollbarArrowColor);if(isSpC()){oSS.addRule("SPAN#misspelled","BACKGROUND: url('"+(g_oMmBdy?g_oMmBdy.squiggleUrl:getThmF("squiggly.gif"))+"') repeat-x 50% bottom;padding-bottom:1;")}oDoc.get_Body().setIntAttribute("ocsi",1)}}function rmvBdyStl(oDoc){var oDocBdy=oDoc.get_Body();if(oDocBdy.getBoolAttribute("ocsi")){var oSS=getSS(oDoc,"owaTempEditStyle");if(oSS){oSS.remove()}removeNoPrintStylesFromDocument(oDoc);oDocBdy.setIntAttribute("ocsi",0)}}function isExpDft(){return(isDf(typeof(a_iNit))&&(a_iNit==RF_EXPDFT))}function isImpDft(){return(isDf(typeof(a_iNit))&&a_iNit==RF_IMPDFT)}function atLnk(e,iLevel,isIrmCopyRestrictedConv){if(iLevel==2||iLevel==3){var oEvent=new Owa.Dom.Event(e);onClickAw(oEvent,isIrmCopyRestrictedConv)}}function RepositionContactsBody(){if($("divCnts")&&$("divCntsHdr")){$("divCnts")._get_DomNode().style.position=Owa.Style.Positioning.Absolute;$("divCnts").set_Top($("divCntsHdr").get_OffsetHeight());$("divCnts").set_Bottom("0")}}function resizeBodies(){clsEdCtxMs();var oFormMessageHeader=$("divHdrMessage");if(oFormMessageHeader){adjustMessageBody();return}var oFormHeader=$("divHdr");var oFormBody=$("divBdy");if(isDf(typeof(a_fEdtCal))){$("divCalFormTabBody").fillHeight(null,$("divCalFormHdr"),null)}if(oFormHeader){oFormBody.fillHeight(null,oFormHeader,null);if(isDf(typeof(a_fTxt))&&a_fTxt)rszBdy($("txtBdy"))}}function rszBdy(oTextBody){clsEdCtxMs();if($("divHdrMessage")){return}var oParent=oTextBody.get_ParentElement();var iHeight=oParent.get_ClientHeight();var iWidth=oParent.get_ClientWidth();var iPaddingLeft=oTextBody.getEffectivePadding(Owa.Style.Side.Left);var iPaddingRight=oTextBody.getEffectivePadding(Owa.Style.Side.Right);var iPaddingTop=oTextBody.getEffectivePadding(Owa.Style.Side.Top);var iPaddingBottom=oTextBody.getEffectivePadding(Owa.Style.Side.Bottom);iWidth-=iPaddingLeft+iPaddingRight;iHeight-=iPaddingTop+iPaddingBottom;if(iWidth<0)iWidth=0;if(iHeight<0)iHeight=0;oTextBody.set_Width(iWidth);oTextBody.set_Height(iHeight)}function onKDTxt(e){drty()}var g_dtLstKA;function sndKA(){var now=new Date();if(!g_dtLstKA||(now.getTime()-g_dtLstKA.getTime()>120000)){var oRequest=new Owa.Dom.AjaxRequest("keepalive.owa","GET",null,null,0);oRequest.send();g_dtLstKA=new Date()}}function onClkBdy(){Owa.UIControls.AutoCompleteCache.hide();Owa.UIControls.MenuButton.hideAnyPopupMenu();var oR=createSelectionRange(edDoc());if(oR&&!oR.IsTypeControl()&&!cntns(edDoc().body,oR.parentElement())){oR.select()}}function shwFmtBr(fShow){var oDivFmtBr=$("divFmtBr");if(fShow){if(!isFormatBarInitialized(oDivFmtBr)){var oDialogHelper=Owa.Utility.isIE()?dlgHelper:null;var oEditor=GetNewOwaEditor(oDivFmtBr,edDoc(1),oDialogHelper)}}else{if(isFormatBarInitialized(oDivFmtBr)){oDivFmtBr.getExpando("formatBar").deactivateFormatBar()}}oDivFmtBr.set_IsShownAroundIEBug(fShow);var oDivBdy=$("divBdy");if(fShow){oDivBdy.removeCssClass("brd")}else{oDivBdy.addCssClass("brd")}}function onChgHtmlTxt(){var oComboBox=$("divCmbFrmt").getExpando("oComboBox");var fH=isHtml();var oEdB=Owa.Dom.Node.wrapDomNode(edDoc().body);drty();if(!fH){if(oEdB.get_TextContent()==""||confirm(L_WrnFmtLss)){checkRemoveInfobarMessage("divIbImg");if(!Owa.Utility.isIE()){var oTextBody=$("txtBdy");var sHtml=oEdB.get_InnerHtml();sHtml=sHtml.replace(/<BR>/gi,"\n<BR>");if(Owa.Utility.isSafari()){sHtml=sHtml.replace(/<DIV([^>]*)>/gi,"\n<DIV>")}oEdB.set_InnerHtml(sHtml);oTextBody.set_Value(oEdB.get_TextContent());hideEm($("ifBdy"));showEm(oTextBody)}else{var oEditor=$("divFmtBr")?$("divFmtBr").getExpando("formatBar"):null;if(oEditor){oEditor._removeStyleSheetRulesFromEditor();edDoc(1).get_Body().setIntAttribute("ocsi",0);apBdyStl(edDoc(1),0)}oEdB.set_TextContent(getTxtBdy())}shwFmtBr(0)}else{oComboBox.set_SelectedValue("0",1)}}else{var sText=getTxtBdy();if(Owa.Utility.isIE()){oEdB.set_TextContent(sText)}else{sText=htmlEnc(sText);oEdB.set_InnerHtml(sText.replace(/\n/g,"<BR>"));showEm($("ifBdy"));hideEm($("txtBdy"))}shwFmtBr(1);var oEditor=$("divFmtBr")?$("divFmtBr").getExpando("formatBar"):null;if(oEditor){oEditor._removeStyleSheetRulesFromEditor();edDoc(1).get_Body().setIntAttribute("ocsi",0);apBdyStl(edDoc(1),0)}}safeResizeBodies();g_sLstSpTx=SP_RESET}function getTxtBdy(){if(Owa.Utility.isIE()){return edDoc(1).get_Body().get_TextContent()}else{return $("txtBdy").get_Value()}}function getHtmlBdy(cbClr,fSend){var oEdD=edDoc(1);var oEdB=oEdD.get_Body();var oEdDE=oEdD.get_DocumentElement()._get_DomNode();var r=oEdDE.getElementsByTagName("meta");if(r&&r.length){for(var i=0;i<r.length;i++){var o=r[i];if(o.getAttribute("charset",0)!=null){rn(o);break}}}var oEditor=$("divFmtBr").getExpando("formatBar");rmvBdyStl(oEdD);var sOriginalBody=oEdB.get_InnerHtml();if(isSpC()){clrSpUI(0)}var s=oEditor.getHtml(1,!!g_oMmBdy);if(!g_oMmBdy){oEdB.set_InnerHtml(sOriginalBody)}if(cbClr){cbClr()}apBdyStl(oEdD);oEditor._applyDefaultFonts();if(!fSend){setFcsBdy()}return s}function resizeBodyOffset(){if(isDf(typeof(a_fEditContactForm))){contactOffsetBody()}if(isDf(typeof(a_fEditDLForm))){dlOffsetBody()}RepositionContactsBody()}(function(){Owa.Clipboard.getData=function Owa$Clipboard$getData(type){if(window.clipboardData){return window.clipboardData.getData("Text")}else{try{netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');var clip=Components.classes["@mozilla.org/widget/clipboard;1"].getService(Components.interfaces.nsIClipboard);if(!clip)return false;var trans=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!trans)return false;trans.addDataFlavor("text/unicode");clip.getData(trans,clip.kGlobalClipboard);var str=new Object();var strLength=new Object();var pastetext="";trans.getTransferData("text/unicode",str,strLength);if(str)str=str.value.QueryInterface(Components.interfaces.nsISupportsString);if(str)pastetext=str.data.substring(0,strLength.value/2);return pastetext}catch(e){return false}}};Owa.Clipboard.setData=function Owa$Clipboard$setData(type,copytext){if(window.clipboardData){window.clipboardData.setData("Text",copytext)}else{try{netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');var str=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);if(!str)return false;str.data=copytext;var trans=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!trans)return false;trans.addDataFlavor("text/unicode");trans.setTransferData("text/unicode",str,copytext.length*2);var clipid=Components.interfaces.nsIClipboard;var clip=Components.classes["@mozilla.org/widget/clipboard;1"].getService(clipid);if(!clip)return false;clip.setData(trans,null,clipid.kGlobalClipboard)}catch(e){return false}}}})();function shwAttchDlg(){var oP=new Object();oP.sId=a_sId;oP.sCK=a_sCK;var oSubPage=Owa.UIControls.SubPage.get_Instance();oP.iT=oSubPage.getSubPageVariable("a_iT");if(typeof(a_sFldId)!="undefined")oP.sFldId=a_sFldId;var oRslt=shwDlg("AttachFileHost",450,260,DLG_MOD|DLG_CTR,oP);procAttRsp(oRslt)}function procAttRsp(oRslt){if(oRslt!=null){if(oRslt.sId!=null){if(typeof(a_iDltDrft)!="undefined"){g_fDltDrft=a_iDltDrft}else{g_fDltDrft=1}a_sId=oRslt.sId}if(!g_fDltDrft&&(a_sCK==null||a_sCK!=oRslt.sCK)){rfVwAftEdt()}if(oRslt.sCK){a_sCK=oRslt.sCK}var oDivAtch=$("divAtch");if((oDivAtch.get_InnerHtml()!=oRslt.sAtts)&&g_fDltDrft){drty()}oDivAtch.set_InnerHtml(oRslt.sAtts);rszAw();safeResizeWells();var sIbd=oRslt.sIbd;if(sIbd){var oDivInfobarResponse=Owa.Dom.Document.get_Current().createElement("div");oDivInfobarResponse.set_InnerHtml(sIbd);var oDivIDAMessageInResponse=oDivInfobarResponse.getDescendantById("divIDA");if(oDivIDAMessageInResponse){replaceOrInsertInfobarMessageElement(oDivIDAMessageInResponse)}var oDivDAErrMessageInResponse=oDivInfobarResponse.getDescendantById("divDAErr");if(oDivDAErrMessageInResponse){replaceOrInsertInfobarMessageElement(oDivDAErrMessageInResponse)}else{checkRemoveInfobarMessage("divDAErr")}oDivInfobarResponse=0}else{checkRemoveInfobarMessage("divDAErr")}resizeBodyOffset();updateInfobarForUnprotectableAttachments()}}function updateInfobarForUnprotectableAttachments(){var oDivAtch=$("divAtch");if(isDf(typeof(a_fIsIrmProtected))&&(a_fIsIrmProtected==0)){checkRemoveInfobarMessage("attNtPtbl")}else{var fAllAttachmentsProtectable=true;var spnAtmts=oDivAtch.getAllDescendantsById("spnAtmt");for(var i=0;i<spnAtmts.length;i++){if(spnAtmts[i].getAttribute("_protectable")=="0"){fAllAttachmentsProtectable=false;break}}if(isDf(typeof(L_AttNtPtbl))&&!fAllAttachmentsProtectable){replaceOrInsertInfobarMessage(L_AttNtPtbl,"attNtPtbl")}else{checkRemoveInfobarMessage("attNtPtbl")}}}function setStckBtn(sId,f){var o=wda(sId);if(o&&((o._pushed=='1')^f))o.click()}function getImp(){var oImpHigh=Owa.Components.ToolbarCollection.get_Current().getButton("imphigh");var oImpLow=Owa.Components.ToolbarCollection.get_Current().getButton("implow");if(oImpHigh.get_IsPushed()){return I_HI}else if(oImpLow.get_IsPushed()){return I_LO}return I_N}function setImp(iImp){var oImpHigh=Owa.Components.ToolbarCollection.get_Current().getButton("imphigh");var oImpLow=Owa.Components.ToolbarCollection.get_Current().getButton("implow");var fImpHigh=oImpHigh.get_IsPushed();var fImpLow=oImpLow.get_IsPushed();if(!fImpHigh&&(iImp==I_HI)){oImpHigh.click()}else if(!fImpLow&&(iImp==I_LO)){oImpLow.click()}else if(iImp==I_N){if(fImpHigh){oImpHigh.click()}if(fImpLow){oImpLow.click()}}}function replaceOrInsertInfobarMessage(sHtml,sDivId,iType){var oInfobar=new Owa.UIControls.Infobar($("divInfobar"));return oInfobar.buildReplaceOrInsertMessageAndRefresh(sHtml,sDivId,iType)}function replaceOrInsertInfobarMessageInCurrentInfobar(oInfobar,sHtml,sDivId,iType){return oInfobar.buildReplaceOrInsertMessageAndRefresh(sHtml,sDivId,iType)}function replaceOrInsertInfobarMessageElement(oNewMessageElement){var oInfobar=new Owa.UIControls.Infobar($("divInfobar"));oInfobar.replaceOrInsertMessage(oNewMessageElement);oInfobar.set_IsShown(1);safeResizeBodies()}function checkRemoveInfobarMessage(sDivId){var oInfobar=new Owa.UIControls.Infobar($("divInfobar"));oInfobar.checkRemoveMessageAndRefresh(sDivId)}function getUrl(sT,sA,sS,fPhsh,fWb,fSvDrft,sO,fRR){var sAe="Item";if(isCal(sT)&&(!sA||(sA.lc()=="open")||(sA.lc()=="reply")||(sA.lc()=="replyall")||(sA.lc()=="forward"))){sAe="PreFormAction";if(!sA)sA="Open"}sAe=getApplicationElementForItem(sAe,sA,sT,isJnkFld(),fPhsh);var url=("?ae="+sAe+"&t="+sT+"&"+getIdQS());if(sS&&sS!='')url+="&s="+sS;if(sA&&sA!='')url+="&a="+sA;if(fPhsh){url+="&ph=0"}if(fWb){url+="&cb=0"}if(fRR){url+="&rr=1"}if(g_fDltDrft){g_fDltDrft=0;if(!fSvDrft)url+="&exdltdrft=1"}url+=(sO?sO:"");return url}function sendUrl(url,oAnchor){var szURL=window.document.location.protocol+"//"+window.document.location.host+window.document.location.pathname+url;oAnchor._get_DomNode().href=szURL}function repFwItm(sT,sRepFw,fNW,sReqs){return openItm(("?ae=PreFormAction&a="+sRepFw+"&t="+sT+"&"+getIdQS())+((sReqs)?sReqs:""),fNW?0:window.name)}function opnPrntFrm(sT){var sUrl=getUrl(sT,"Print",0,isFhshEnb(),isWBEnb());opnWin(sUrl,0,0,0,0,1)}function isWBEnb(){return crtUrlCntn("&cb=")}function isFhshEnb(){return crtUrlCntn("&ph=")}function crtUrlCntn(s){return location.href.lc().indexOf(s.lc())!=-1}function getItmSt(){return(isRepFw()?"":"Draft")}function getItm(sCId,sN,fNI){try{var oSubPageController=Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().get_OpenerController();var oListView=Owa.PageHierarchy.getVirtualListViewFromSubPageController(oSubPageController);oListView.selNPRw(sCId,sN,fNI)}catch(e){window.close()}}function getAc(){if(a_iNit==RF_RPLY)return"Reply";else if(a_iNit==RF_FWD)return"Forward";else if(a_iNit==RF_PSTRPLY)return"PostReply";else return"Open"}function getIdQS(){var s="id=";if(typeof(a_sId)!="undefined"){s+=urlEnc(a_sId)}else{s+=urlEnc(a_rgsIds[0]);for(var i=1;i<a_rgsIds.length;i++)s+="&attid"+(i-1)+"="+urlEnc(a_rgsIds[i]);s+="&attcnt="+(a_rgsIds.length-1)}return s}function shwCnfrmPrDelDlg(fnOnCnfrmd){(new BtnDlg("divDelPmpt",htmlEnc(L_PrDelPrp),"",new Array(L_OK,L_Cncl),400,Owa.BUTTON_DIALOG_ICON.QUESTION,cbCnfrmPrDelDlg,0,0,0,0,0,fnOnCnfrmd)).show()}function cbCnfrmPrDelDlg(iB,fnOnCnfrmd){if(iB)return;fnOnCnfrmd(1)}function savRMsg(sNS,sN,sV,fP){var oReq=new oeReq(sNS,"Save",null,null,POST,null,1);oReq.add("Id",a_sId);oReq.add("CK",a_sCK);oReq.add(sN,sV);var oRsp=oReq.send();if(oRsp.fST){popLgn();return}var oDivErr=$("divErr");if(oRsp.sErr){if(oRsp.fST){popLgn()}showErr(oDivErr._get_DomNode(),oRsp.sErr,oRsp.sErrDbg);return 0}else{hideErr(oDivErr);var oDivR=Owa.Dom.Document.get_Current().createElement("DIV");oDivR=Owa.Dom.Document.get_Current().appendChild(oDivR);oDivR.set_InnerHtml(oRsp.sBody);a_sCK=oDivR.getDescendantById("ck").get_TextContent();rfMailVw(fP,1);oDivR.remove(true);return 1}}function rfVwAftEdt(fUpdateView){fUpdateView=fUpdateView||false;var fPrv=isPrvFrm();var oLv=gtPrntLV(fPrv);if(oLv){rfMailVw(fPrv,!fUpdateView)}else{rfCalVw(fPrv,a_sId)}}var g_fIgnoreNotification=false;function ignoreNotificationOnce(){g_fIgnoreNotification=true}function cancelIgnoreNotificationOnce(){if(g_fIgnoreNotification){g_fIgnoreNotification=false}else{throttledRefresh()}}var THROTTLED_REFRESH_DURATION=1000;var THROTTLED_REFRESH_DURATION_LONGER=5000;var THROTTLED_REFRESH_DURATION_FOR_EXTERNAL_CALENDAR=30000;function throttledRefresh(fIsFromNotification,fIsExternalCalendar,sSelId,fForceRefresh){var oCallerSubPage=this;if(oCallerSubPage==window)oCallerSubPage=Owa.UIControls.SubPage.get_Instance();if(!oCallerSubPage.isSubPageFunctionExists("refresh"))return;if(fIsFromNotification&&g_fIgnoreNotification){g_fIgnoreNotification=false;oCallerSubPage.invokeSubPageFunction("clearDirtyFlagOnView");return}var sThrottledRefreshingPendingVariableName;var iTimeout;if(fIsExternalCalendar){sThrottledRefreshingPendingVariableName="g_iThrottledRefreshPendingForExternalCalendar";iTimeout=THROTTLED_REFRESH_DURATION_FOR_EXTERNAL_CALENDAR}else{sThrottledRefreshingPendingVariableName="g_iThrottledRefreshPending";var oVLV=isFolderViewSubPageObject(oCallerSubPage)?oCallerSubPage.get_VirtualListView():null;if(oVLV&&oVLV.isCnvVw&&oVLV.isCnvVw())iTimeout=THROTTLED_REFRESH_DURATION_LONGER;else iTimeout=THROTTLED_REFRESH_DURATION}if(!oCallerSubPage.getSubPageVariable(sThrottledRefreshingPendingVariableName)){var oContext={};oContext.sSelId=sSelId;oContext.fForceRefresh=fForceRefresh;oCallerSubPage.setSubPageVariable(sThrottledRefreshingPendingVariableName,oCallerSubPage._setTimeout(cbThrottledRefreshTimeout,iTimeout,oContext))}}function cbThrottledRefreshTimeout(oContext){var sSelId=oContext.sSelId;var fForceRefresh=oContext.fForceRefresh;this.setSubPageVariable("g_iThrottledRefreshPending",0);this.setSubPageVariable("g_iThrottledRefreshPendingForExternalCalendar",0);this.invokeSubPageFunction("refresh",[sSelId,fForceRefresh])}function cancelPendingThrottledRefresh(oCallerSubPage){if(!oCallerSubPage)oCallerSubPage=Owa.UIControls.SubPage.get_Instance();if(oCallerSubPage.getSubPageVariable("g_iThrottledRefreshPending")){clearTimeout(oCallerSubPage.getSubPageVariable("g_iThrottledRefreshPending"));oCallerSubPage.setSubPageVariable("g_iThrottledRefreshPending",0)}}function removeItemFromView(sId){var fPrv=isPrvFrm();var oLV=gtPrntLV(fPrv);if(oLV&&oLV.getEl&&!oLV.getEl().fDL){oLV.rmvRws(new Array(sId))}else if(!oLV){rfCalVw(fPrv)}}function rfMailVw(fPrv,f){var oLv=gtPrntLV(fPrv);if(oLv&&(!oLv.getEl||!oLv.getEl().fDL)){if(oLv.isCnvVw&&oLv.isCnvVw()){var oOpenerController=Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().get_OpenerController();try{if(fPrv){oOpenerController.get_ParentController().invokeFunction("refreshConversationRP")}else{oOpenerController.invokeFunction("refreshConversationRP")}}catch(e){}}else{oLv.get_SubPage().udRP(true)}if(!f||!oLv.isPushNotificationEnabled()){oLv.rfrsh(0)}}}function gtPrntLV(fPrv){var oLv=null;try{var oCurrentSubPageController=Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController();var oParentController=oCurrentSubPageController.get_ParentController();var oOpenerController=oCurrentSubPageController.get_OpenerController();if(fPrv){oLv=Owa.PageHierarchy.getVirtualListViewFromSubPageController(oParentController);if(!oLv)oLv=Owa.PageHierarchy.getVirtualListViewFromSubPageController(oOpenerController.get_ParentController())}else{if(oOpenerController){oLv=Owa.PageHierarchy.getVirtualListViewFromSubPageController(oOpenerController)}}}catch(e){}return oLv}function rfCalVw(fPrv,sId){try{var oParent=fPrv?Owa.Dom.Window.get_Current().get_ParentWindow():Owa.Dom.Window.get_Current().get_Opener();oParent.invokeFunction("throttledRefresh",[false,false,sId])}catch(e){}}function setRPRefreshDelayFlag(){var oOpenerController=Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().get_OpenerController();if(oOpenerController){try{oOpenerController.invokeFunction("setRPRefreshDelayFlag")}catch(e){}}}function isNxtPrvEnabled(){try{var oOpenerController=Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().get_OpenerController();if(oOpenerController){var oListView=Owa.PageHierarchy.getVirtualListViewFromSubPageController(oOpenerController);if(oListView&&!oListView.isCnvVw()){return true}}return false}catch(e){return false}}function isPrvFrm(){return isDf(typeof(a_fPrv))&&a_fPrv}function updIdCkForFR(oR){if(!oR.divCustom)return;if(!a_sId&&oR.divCustom.getAttribute("itemId"))a_sId=oR.divCustom.getAttribute("itemId");if(oR.divCustom.getAttribute("ck"))a_sCK=oR.divCustom.getAttribute("ck")}var g_iMDDW=400;var g_fLMDC;var g_oDlgMDtl;var L_MDtl;function ldMDtl(){if(g_fLMDC){return}if(!$("divMDtl")){g_fLMDC=1;ldMDtlDlg();return}shwMDtlDlg()}function ldMDtlDlg(){var oR=new oeReq("ReadMessage","LMD",0,cbLdMDtlDlg,GET);oR.add("Id",getIdQS());oR.send()}function cbLdMDtlDlg(oR){if(!cbOeh(oR)){return}var oDivR=Owa.Dom.Document.get_Current().createElement("DIV");oDivR=Owa.Dom.Document.get_Current().appendChild(oDivR);oDivR.set_InnerHtml(oR.sBody);eval(oDivR.getDescendantById("divMDtlScrpt").get_TextContent());g_oDlgMDtl=new BtnDlg("divMDtl",oDivR.get_InnerHtml(),L_MDtl,new Array(L_Cls),g_iMDDW,null,null,null,0,1);oDivR.remove(true);shwMDtlDlg();g_fLMDC=0}function shwMDtlDlg(){var oDivSctBdy=$("divSctBdy");var oTxtMailHdrs=$("txtMailHdrs");var iOffstHt=250;var iMH=15;var iH=iOffstHt-oDivSctBdy._get_OffsetTop();if(iH<iMH){iH=iMH}oDivSctBdy.set_Height(iH);oTxtMailHdrs.set_Height(oDivSctBdy.get_Height()-iMH);oTxtMailHdrs.set_Width(g_iMDDW-100);g_oDlgMDtl.show()}function shwFlgMnu(){var oFlagMenu=Owa.UIControls.FlagContextMenu.get_Instance(true);oFlagMenu.set_SelectCount(1);oFlagMenu.set_ItemId(a_sId);oFlagMenu.set_IsSelectedItemTask(false);oFlagMenu.get_OnSelectFlag().add(flgItm);if(isDf(typeof(a_iFlgAction))){oFlagMenu.set_FlagAction(a_iFlgAction)}var oFlagButton=Owa.Components.ToolbarCollection.get_Current().getButton("flag");oFlagMenu.set_FlagButton(oFlagButton);oFlagMenu.showUnder(oFlagButton._get_ButtonFrame())}function flgItm(oEventArgs){var sC=oEventArgs.sCommand;var dt=oEventArgs.dtDate;var iFlagAction=getInt(sC);var oSubPage=Owa.UIControls.SubPage.get_Instance();var sFldId;if(isDf(typeof(a_sFldId))){sFldId=a_sFldId}if(iFlagAction==FA_DtRem){Owa.UIControls.FlagDialog.loadInstanceAndShow(onClsFD,a_sId,a_sCK,sFldId,oSubPage.getSubPageVariable("a_iT"));return}var oR=new oeReq("Flg","flgItm",iFlagAction,cbFlgItms);if(!a_sId){if(sFldId){oR.add("fldrId",sFldId)}oR.add("typ",oSubPage.getSubPageVariable("a_iT"))}else{oR.add("id",a_sId);oR.add("ck",a_sCK)}oR.add("flga",sC);if(dt){oR.add("ddt",dt)}oR.send()}function cbFlgItms(oR){if(!cbOeh(oR))return;if(!a_sId)g_fDltDrft=1;eval(oR.sBody);updFlgIBM(sIBMsg);rfVwAftEdt(isPI());if(isDf(typeof(a_iFlgAction))){a_iFlgAction=oR.oCtx}}function onClsFD(iFA,sId,sCK,sIB,dtDD){if(!a_sId)g_fDltDrft=1;a_sId=sId;a_sCK=sCK;var oFlagMenu=Owa.UIControls.FlagContextMenu.get_Instance();oFlagMenu.set_FlagAction(iFA);if(dtDD)oFlagMenu.set_DueDate(dtDD);updFlgIBM(sIB);rfVwAftEdt(isPI())}function updFlgIBM(sIB){if(sIB.length==0){checkRemoveInfobarMessage("divFlg")}else{var oDiv=Owa.Dom.Document.get_Current().createElement("DIV");oDiv.set_InnerHtml(sIB);var oNewDivFlgMessage=oDiv.getDescendantById("divFlg");if(oNewDivFlgMessage){replaceOrInsertInfobarMessageElement(oNewDivFlgMessage)}}resizeBodyOffset()}function frmShwCM(){var oCategoryButton=Owa.Components.ToolbarCollection.get_Current().getButton("cat");var oPosition=oCategoryButton.get_MenuReferencePosition(g_fRtl);var sId=null;if(isDf(typeof(a_sFldId))&&a_sFldId!=null)sId=a_sFldId;else if(isDf(typeof(a_sId))&&a_sId!=null)sId=a_sId;var oCategoryMenu=Owa.UIControls.CategoryMenu.get_Instance(true);var oSubPage=Owa.UIControls.SubPage.get_Instance();oCategoryMenu.set_ItemType(oSubPage.getSubPageVariable("a_iT"));oCategoryMenu.set_FolderId(sId);oCategoryMenu.get_OnChangeCategory().add(onSlctCat);oCategoryMenu.get_OnClearCategory().add(onClrCat);oCategoryMenu.updateStates([a_rgCats],oCategoryButton);oCategoryMenu.show(oPosition.iX,oPosition.iY)}function onClrCat(){var oR=new oeReq("Cat","clr",0,cbOnClrCat);oR.add("id",a_sId);oR.add("ck",a_sCK);oR.send();if($("divWellCategories")){if($("divCategoriesHr")){$("divCategoriesHr").set_IsShown(false)}$("divWellCategories").set_IsShown(false);$("divFieldCategories").set_InnerHtml("")}a_rgCats=new Array();safeResizeBodies();resizeBodyOffset()}function cbOnClrCat(oR){if(!cbOeh(oR))return;eval(oR.sBody);rfVwAftEdt(isPI())}function onSlctCat(oArgument){var oR=new oeReq("Cat","mdfy",0,cbOnSlctCat);oR.addRg("catAdd",oArgument.rgAdd);oR.addRg("catRem",oArgument.rgRem);var oSubPage=Owa.UIControls.SubPage.get_Instance();if(!a_sId){if(isDf(typeof(a_sFldId))&&a_sFldId)oR.add("fId",a_sFldId);oR.add("typ",oSubPage.getSubPageVariable("a_iT"))}else{oR.add("id",a_sId);oR.add("ck",a_sCK)}oR.send()}function cbOnSlctCat(oR){if(!cbOeh(oR))return;if(isDf(typeof(a_sId))&&!a_sId)g_fDltDrft=1;eval(oR.sBody);var oFieldCategories=$("divFieldCategories");var oCategoriesHr=$("divCategoriesHr");var oWellCategories=$("divWellCategories");if(oFieldCategories){oFieldCategories.set_InnerHtml(sCats)}if(oCategoriesHr){oCategoriesHr.set_IsShown(a_rgCats.length!=0)}if(oWellCategories){oWellCategories.set_IsShown(a_rgCats.length!=0)}safeResizeWells();safeResizeBodies();resizeBodyOffset();rfVwAftEdt(isPI())}function showReadingPane(sReadingPaneId,fShow,oCallerSubPage){var oReadingPaneFrameElement=oCallerSubPage?oCallerSubPage._getDescendant(sReadingPaneId):$(sReadingPaneId);Owa.Components.SubPageControllerFactory.getControllerByElement(oReadingPaneFrameElement).set_IsShown(fShow)}function shwCMMnu(oCallerSubPage,fnCb,fNoCopy){var oMoveButton=Owa.Components.ToolbarCollection.get(oCallerSubPage).getButton("move");var oPosition=oMoveButton.get_MenuReferencePosition(g_fRtl);var oContextMenu=Owa.UIControls.CopyMoveContextMenu.get_Instance();oContextMenu.set_CopyItemVisible(!fNoCopy);oContextMenu.set_CopyMoveButton(oMoveButton);oContextMenu.set_OnTargetFolderSelected(fnCb);oContextMenu.show(oPosition.iX,oPosition.iY)}function frmCpMv(sDstFId,fD,sFT,fC){if(!isMvAllw(sFT,a_sT)){alrt(L_MvUnmtchTyp);return}var oSubPage=Owa.UIControls.SubPage.get_Instance();if(!fC&&sDstFId==a_sFId){window.close();return}g_oFldrMgr.cpMvItms(wt(),oSubPage,a_sFId,[a_sId],sDstFId,fC)}var L_Dys;var L_Dy;var L_Hrs;var L_Hr;var L_Mins;var RNGT_NE=0;var RNGT_NM=1;var RNGT_ED=2;var RT_N=1;var RT_D=2;var RT_W=4;var RT_M=8;var RT_Y=16;var RT_DEWD=0x100;var RT_MTH=0x200;var RT_YTH=0x400;var RT_RGD=0x800;var RT_RGW=0x1000;var RT_RGM=0x2000;var RT_RGY=0x4000;var RT_MSK=0x00FF;var g_iRDW=620;var g_fLRC;function rcr(){return a_iRT!=RT_N}function addRcrSt(oR,iRT,iRI,iRDys,iRDy,iRO,iRM,iRRngT,dtRRngS,iRRngO,dtRRngE){oR.add("RcrT",iRT);oR.add("RcrI",iRI);oR.add("RcrDys",iRDys);oR.add("RcrDy",iRDy);oR.add("RcrO",iRO);oR.add("RcrM",iRM);oR.add("RcrRngT",iRRngT);oR.add("RcrRngS",dtRRngS);oR.add("RcrRngO",iRRngO);oR.add("RcrRngE",dtRRngE);return oR}function opnWRDV(o){openItm("WebReadyView.aspx?t=att&"+gtAttUrl(o.parentNode.parentNode,1))}function sndRR(){var oR=new oeReq("ReadMessage","SRR",0,cbSndRR);oR.add("Id",a_sId);oR.send()}function cbSndRR(oR){if(!cbOeh(oR))return;$("divSRR").set_InnerHtml(oR.sBody)}function clnUp(){var oR=new oeReq("EditMessage","CleanupDelete",0,null,POST,null,1);oR.add("Id",a_sId);oR.add("CK",a_sCK);oR.send();if(oR.fST){popLgn()}}var ECPRULEEDITORWIDTH=700;var ECPRULEEDITORHEIGHT=420;function opnEcpNewRul(oCallerSubPage,sMIdQS){var sUrl=getEcpVdir()+"/RulesEditor/NewInboxRule.aspx?";sUrl+=sMIdQS;var oEcpRuleEditorWindowInstance=oCallerSubPage.getSubPageVariable("g_EcpRuleEditorWindowInstance");if(oEcpRuleEditorWindowInstance&&!(oEcpRuleEditorWindowInstance.is_Closed())){try{oEcpRuleEditorWindowInstance.navigate(sUrl)}catch(e){}oEcpRuleEditorWindowInstance._domWindow.focus()}else{oCallerSubPage.setSubPageVariable("g_EcpRuleEditorWindowInstance",new Owa.Dom.Window(opnWin(sUrl,ECPRULEEDITORWIDTH,ECPRULEEDITORHEIGHT,1,null,null,null,oCallerSubPage)))}}function setFcsBdy(fInit){if(Owa.Utility.isIE()||isHtml()){setTimeout("$(\"ifBdy\").get_ContentWindow()._domWindow.focus();",100)}else{if(fInit){var oR=createTextRange();oR.moveTextAreaCursorToStartOrEnd($("txtBdy"),1)}else{$("txtBdy").focus(1)}}}function setFcsLstV(){if(g_fFcsLV){try{var oOpenerController=Owa.Components.SubPageControllerFactory.get_CurrentWindowSubPageController().get_OpenerController();Owa.PageHierarchy.getVirtualListViewFromSubPageController(oOpenerController).makeFocused()}catch(e){}}}function cntFrmNewMsg(sId,fMsg){var oR=new oeReq("ABCA","MsgToPeople",null,cbCntFrmNewMsg);oR.addRg("id",new Array(sId));oR.add("msg",fMsg);oR.send()}function cbCntFrmNewMsg(oR){if(!onCntFrmOehErr(oR))return;openItm(oR.sBody)}function cntFrmDel(sPmpt){var oSubPage=Owa.UIControls.SubPage.get_Instance();var fP=oSubPage.getSubPageVariable("a_fInDelItms")||a_fP;if(fP)new BtnDlg("divDelPmpt",htmlEnc(sPmpt?sPmpt:L_PrDelPrp),"",new Array(L_OK,L_Cncl),400,Owa.BUTTON_DIALOG_ICON.QUESTION,cbCntFrmDelPmpt,0,0,0,0,0,fP).show();else cbCntFrmDelPmpt(0,fP)}function cbCntFrmDelPmpt(iB,oC){if(iB)return;var oR=new oeReq("EditContactItem",oC?"PermanentDelete":"Delete",null,cbCntFrmDel);oR.add("Id",a_sId);oR.send()}function cbCntFrmDel(oR){if(!onCntFrmOehErr(oR))return;var fPrv=isPrvFrm();rfMailVw(fPrv);if(!fPrv){clrDrty();if(isDf(typeof(clrDrtyBdy)))clrDrtyBdy();window.close()}}function onCntFrmOehErr(oR){var fEI=!!wda("divErr");if(fEI)hideErr(wda("divErr"));if(oR.fST){popLgn()}else if(oR.sErr){if(fEI)showErr(wda("divErr"),oR.sErr,oR.sErrDbg);else shwErrDlg(oR)}else return 1;return 0}function isRcntCtrl(s){if(isDf(typeof(a_sLV)))return cmpVer(s,a_sLV)>=0;else return 1}function cmpVer(sV1,sV2){var rgV1=spltVer(sV1);var rgV2=spltVer(sV2);for(var i=0;i<rgV1.length&&i<rgV2.length;i++)if(rgV1[i]!=rgV2[i])return rgV1[i]-rgV2[i];return rgV1.length-rgV2.length}var MM_NtInst=0x0001;var MM_MstUpd=0x0002;var MM_OOD=0x0004;var MM_MstRcnt=0x0008;var MM_CIsSSL=0x0010;var g_fMmSt=-1;var g_oMmBdy=0;function gtMmSt(f){if(g_fMmSt>=0&&!f)return g_fMmSt;if(chkMime()){if(isRcntCtrl(gtMmCtrlVer()))g_fMmSt=MM_MstRcnt;else if(isDf(typeof(a_fMstUpd))&&a_fMstUpd)g_fMmSt=MM_MstUpd;else g_fMmSt=MM_OOD}else{g_fMmSt=MM_NtInst}if(isSSL())g_fMmSt|=MM_CIsSSL;return g_fMmSt}function initMmCtl(){if(!chkMime()||(isDf(typeof(a_sLV)))&&(isFlgSt(gtMmSt(1),MM_NtInst)||isFlgSt(gtMmSt(1),MM_MstUpd))){return}g_oMmBdy=wda("mimeEdit");try{if(!g_oMmBdy||!g_oMmBdy.DOM)g_oMmBdy=0}catch(e){g_oMmBdy=0}}var CTS_LD=1;var CTS_SV=2;var CTS_SE=3;var CTS_SD=4;function showSMErr(divErr,iErr,iCtx,iExtErr,sErrDbg,fTxt){var sErr=mapETS(iErr,iCtx,iExtErr);showErr(divErr,sErr,sErrDbg,fTxt)}function getEvErr(){var oErr=event.getAttribute("result");return(oErr==null)?0:oErr}function getEvExtErr(){var oExtErr=event.getAttribute("extendedResult");return(oExtErr==null)?0:oExtErr}function hres(iErr){return iErr==0?0:iErr+0xffffffff+1}function mapETS(iErr,iCtx,iExtErr){switch(iErr){case 0x800CCEF7:return L_UnsupSig;case 0x80091007:if(iExtErr&0x00000001)return L_BadSig;else if(iExtErr&0x00000002)return L_NoSigCert;else if(iExtErr&0x00000100)return L_CExp;else return L_InvldSig;case 0x3:return L_CSubNotMat;case 0x80096004:return L_CSigFail;case 0x800A0259:return L_MmSzErr;case 0x800B0109:case 0x800B010D:return L_CUntruRoot;case 0x800B010A:return L_CChFail;case 0x800B0110:return L_CWrUsgFSig;case 0x800B0101:return L_CExp;case 0x800B0102:return L_CPerNesErr;case 0x800B0106:return L_CPurErr;case 0x80096019:return L_CBaConErr;case 0x800B0103:return L_CWrRole;case 0x800B010F:return L_CNoCNMat;case 0x80092010:return L_CCryRev;case 0x80092013:case 0x800B010E:case 0x80092012:return L_CRevFail;case 0x800B010C:return L_CRev;case 0x800704c7:switch(iCtx){case CTS_LD:return L_ErrDecyp;case CTS_SE:case CTS_SD:return L_NoSmtCdOnSign;default:return""}case 0x800ccef0:return L_ErrDecyp;case 0x8010006e:return L_SCCancel;case 0x8010001E:case 0x8010001d:switch(iCtx){case CTS_LD:return L_NoSmtCdSrvOnDecyp;case CTS_SE:case CTS_SD:return L_NoSmtCdSrvOnSign;default:return""}case 0x80091002:if(CTS_SE==iCtx){if(0==(iExtErr&0x1)){if(0==(iExtErr&0x2)){return L_EMisEncAlgSav}else{return L_EMisEncAlgSavFE}}else{if(0==(iExtErr&0x4)){return L_EMisSigAlgSav}else{return L_EMisSigAlgSavFS}}}else if(CTS_SD==iCtx){if(0==(iExtErr&0x1)){if(0==(iExtErr&0x2)){return L_EMisEncAlgSnd}else{return L_EMisEncAlgSndFE}}else{if(0==(iExtErr&0x4)){return L_EMisSigAlgSnd}else{return L_EMisSigAlgSndFS}}}else if(CTS_SV==iCtx){return L_SgAlgUnsup}else{return L_EMisAlgLd}case 0x8010002E:return L_NoSmtCdOnSign;case 0x0:return"";default:switch(iCtx){case CTS_LD:return L_UkLdErr.replace("{0}",iErr.toString(16));case CTS_SV:return L_UkSvErr.replace("{0}",iErr.toString(16));case CTS_SE:return L_UkSaErr.replace("{0}",iErr.toString(16));case CTS_SD:return L_UkSdErr.replace("{0}",iErr.toString(16));default:return""}}}function ldMsgMm(s,cb){if(g_oMmBdy){var oR=new oeReq("","",cb,cbLdMsgMm,GET);oR.sUrl="?ae=Item&a=GetMime&"+s;oR.send();shwMLPrgrsInd(L_SMLd,1)}}var g_sMimeBlob=null;function cbLdMsgMm(oR){if(!cbOeh(oR))return hdPrgrsInd();if(g_oMmBdy){g_sMimeBlob=oR.oXmlHttp.responseBody;g_oMmBdy.decodeMime(g_sMimeBlob);if(oR.oCtx)oR.oCtx()}hdPrgrsInd()}function shMmBdy(fC){var oEdD=edDoc(1);var oEdB=oEdD.get_Body();var fnRsz=Owa.Utility.createWindowResizeHandler(Owa.Dom.Window.get_Current(),safeResizeBodies);oEdB.setBoolAttribute("ocsi",false);if(fC){initializeIFrameBodyEditor(oEdD,oEdB,fnRsz)}else{initializeIFrameBodyReader(oEdD,oEdB,fnRsz)}if($("divEcm")){oEdB.attachEvent("contextmenu",onCMEd);oEdD.get_ContainerWindow().attachEvent("scroll",onEdWScr)}if(fC&&isRichTextEditorSupported()){oEdB.attachEvent("paste",onPste);if(isSpC()){oEdB.attachEvent("cut",onPste);oEdB.attachEvent("dragstart",onPste);oEdB.attachEvent("dragend",onPste)}}var oDivFmtBr=$("divFmtBr");if(fC&&oDivFmtBr&&isFormatBarInitialized(oDivFmtBr)){var oEditor=oDivFmtBr.getExpando("formatBar");oEditor._oEditor=oEdD;oEdD.setExpando("formatBar",oEditor);oEditor._attachContentWindowEvents();oEditor._applyEditorStyles()}oEdB.attachEvent("dragover",new Function("return(false)"));showEm(g_oMmBdy)}function gtSgnErCt(iErr){switch(iErr){case 0x0:return 0;case 0x80092013:case 0x800B010E:case 0x800B0101:return 1;case 0x80096004:case 0x800B0109:case 0x800B010D:case 0x800B010A:case 0x800B0110:case 0x800B0102:case 0x800B0106:case 0x80096019:case 0x800B0103:case 0x800B010F:case 0x80092010:case 0x800B010C:return 2;default:return 2}}function shwMLPrgrsInd(sTxt,iT){if(g_oDlgPrgInd)return;if(g_iPrgIndTmId){clearTimeout(g_iPrgIndTmId);g_iPrgIndTmId=0}if(!isDf(typeof(a_fPrv))||a_fPrv==0)g_iPrgIndTmId=setTimeout("cbShwPrgrsInd(\""+sTxt+"\", 1)",(iT?iT:g_iPrgIndDly));else{var oW=wt();var x=(window.screenLeft-oW.screenLeft)+document.body.clientWidth/3;var y=(window.screenTop-oW.screenTop)+document.body.clientHeight/3;g_iPrgIndTmId=setTimeout("cbShwPrgrsInd(\""+sTxt+"\", 1, "+x+", "+y+")",(iT?iT:g_iPrgIndDly))}}function dltSmAtt(o){g_oMmBdy.attachments.remove(o._idx);var rgAIs=getAIs(g_oMmBdy.attachments,g_oAP,g_oMI,AWT_RW,a_fEnIL);if(rgAIs)rdAttWl(rgAIs,AWT_RW,g_oMI,g_oAP,wda("divAtch"),true);drty();rszAw()}function opnShrDlgInVw(oCallerSubPage,sC){try{if(isStPg()){window.parent.opnShrDlg();return}}catch(e){}var iM;switch(sC){case BID_OPNCAL:iM=NM_CAL;break;case BID_OPNCNT:iM=NM_CTS;break;case BID_OPNTSK:iM=NM_TSK;break}new Owa.UIControls.OpenOtherFolderInView(oCallerSubPage).clickButton(iM)}function openSharingCalendarRequestForm(){new Owa.UIControls.OpenOtherFolderInView().requestSharingCalendar()}function hideOpenMailboxDialog(){try{if(isStPg()){window.parent.hideOpenMailboxDialog();return}}catch(e){}}function getCalClrSS(d,title){var rgS=d.styleSheets;var oSS;for(var i=0;i<rgS.length;i++){if(rgS[i].href.indexOf(title)>=0){oSS=rgS[i];break}}return oSS}function applyCalStyle(oCW,sV){var idx=getInt(sV);if(idx<0)return;var s=(idx<10)?"0"+idx:""+idx;var title="calclr"+s;var filename=title+".css";var oStyleSheet=getCalClrSS(oCW.get_Document()._get_DomDocument(),title);if(!oStyleSheet){oStyleSheet=oCW.get_Document().importStyleSheet(getThmF(filename))}}if(document.implementation&&document.implementation.createDocument){Document.prototype.createNode=function Document$createNode(nType,nName,nNSUri){switch(nType){case 1:if(nNSUri==""){return this.createElement(nName)}else{return this.createElementNS(nNSUri,nName)}case 2:return this.createAttribute(nName);case 3:return this.createTextNode("");case 11:return this.createDocumentFragment();default:throw"Node type not supported"}};Document.prototype.loadXML=function Document$loadXML(xmlstring){var oDOMParser=new DOMParser();var newXMLDoc=oDOMParser.parseFromString(xmlstring,"text/xml");while(this.hasChildNodes()){this.removeChild(this.lastChild)}for(var i=0;i<newXMLDoc.childNodes.length;i++){var newNode=this.importNode(newXMLDoc.childNodes[i],true);this.appendChild(newNode)}return 1};if(document.implementation.hasFeature("XPath","3.0")){Document.prototype.selectNodes=function Document$selectNodes(xPath,xNode){if(!xNode){xNode=this}var oNSResolver=this.createNSResolver(this.documentElement);var aNodes=this.evaluate(xPath,xNode,oNSResolver,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);var aResults=[];for(var i=0;i<aNodes.snapshotLength;i++){aResults[i]=aNodes.snapshotItem(i)}return aResults};Element.prototype.selectNodes=function Element$selectNodes(xPath){if(this.ownerDocument.selectNodes){return this.ownerDocument.selectNodes(xPath,this)}};Document.prototype.selectSingleNode=function Document$selectSingleNode(xPath,xNode){if(!xNode){xNode=this}var aResults=this.selectNodes(xPath,xNode);if(aResults.length>0){return aResults[0]}else{return null}};Element.prototype.selectSingleNode=function Element$selectSingleNode(xPath){if(this.ownerDocument.selectSingleNode){return this.ownerDocument.selectSingleNode(xPath,this)}}}Document.prototype.preserveWhiteSpace=1;Node.prototype.__defineGetter__("xml",_Node_getXML);Node.prototype.__defineGetter__("text",_Node_getText);Node.prototype.__defineSetter__("text",_Node_setText)}function _Node_getXML(){var xs=new XMLSerializer();return xs.serializeToString(this)}function _Node_getText(){return this.textContent}function _Node_setText(y){this.textContent=y}function fillHeight(oElem,oFooter){var iH=god(oElem).body.offsetHeight-oElem.offsetTop;if(oFooter!=null){iH=iH-oFooter.offsetHeight}if(iH<0){iH=0}oElem.style.height=iH+"px"}function positionRelative(oC){if(!oC.oOriginalParent)return;var oP=getRelativePosition(oC);oC.style.left=oP.iX+"px";oC.style.top=oP.iY+"px"}function getRelativePosition(oC){var iX=getCX(oC.oOriginalParent)+oC.iOriginalX-getCX(oC.parentNode);var iY=getCY(oC.oOriginalParent)+oC.iOriginalY-getCY(oC.parentNode);if(oC.parentNode!=oC.ownerDocument.body){var oDomParent=Owa.Dom.Node.wrapDomNode(oC.parentNode);iX+=oDomParent.get_ScrollLeft();iY+=oDomParent.get_ScrollTop()}return new Point(iX,iY)}function makeBodyPositioned(oC){var oDomNode=null;if(Owa.Dom.Node.isInstance(oC)){oDomNode=oC;oC=oC._get_DomNode()}else if(oC){oDomNode=Owa.Dom.Node.wrapDomNode(oC)}if((!oC)||(oC.iOriginalX))return;oC.oOriginalParent=oC.parentNode;oC.iOriginalX=oC.offsetLeft;oC.iOriginalY=oC.offsetTop;oC.style.zIndex=oC.parentNode.style.zIndex+100;oC.style.zIndex=oC.parentNode.runtimeStyle?oC.parentNode.runtimeStyle.zIndex+100:window.getComputedStyle(oC.parentNode,"").getPropertyValue("z-index");var oDomParent=oDomNode.get_ParentElement();while(oDomParent){if(Owa.Dom.Element.isInstance(oDomParent)&&(oDomParent.get_OverflowX()==Owa.Style.Overflow.Scroll||oDomParent.get_OverflowX()==Owa.Style.Overflow.Auto||oDomParent.get_OverflowY()==Owa.Style.Overflow.Scroll||oDomParent.get_OverflowY()==Owa.Style.Overflow.Auto)){break}else{oDomParent=oDomParent.get_ParentElement();if(oDomParent&&oDomParent.get_TagName().toLowerCase()=="body"){break}}}if(oDomParent){oDomParent.insertAdjacentElement(Owa.ElementInsertionPoint.AfterBegin,oDomNode)}else{god(oC).body.appendChild(oC)}positionRelative(oC)}function setTitleWidth(oCallerSubPage){if(!oCallerSubPage){oCallerSubPage=Owa.UIControls.SubPage.get_Instance()};var oContext={};oContext.oCallerSubPage=oCallerSubPage;oCallerSubPage._setTimeout(Owa.Utility.createContextDelegate(null,doSetTitleWidth,oContext),1)}function doSetTitleWidth(oContext){var sTitleId="divVwFN";var oCallerSubPage=oContext.oCallerSubPage;var oTopWin=Owa.Utility.getRootOwaWindow();var fn=oTopWin.getGlobalVariable("getTitleWidth");if(!fn)return;var oTitle=oCallerSubPage._getDescendant(sTitleId);if(!oTitle)return;var iWidth=fn();if(iWidth<0)return;iWidth-=oTitle._get_EffectivePaddingBorderWidth();oTitle.set_Width(iWidth<0?0:iWidth)}if(isDf(typeof(stJS)))stJS("uglobal.js");