function yJc(a,b,c){b=ub(a,b.equals,b);0<=b&&b!=c&&(b=Ab(a,b,1),Ab(a,c,0,b[0]))}function J$(a,b){I(a,1,b)}dFa.prototype.gx=ZT(50,function(a){var b=G(this.o,1),c=!Vc(b,3)||!Vc(b,4),d=!Vc(b,1)||!Vc(b,2),e=d?0:ad(b,1),f=a?Lo(a):0,f=d?f:ad(b,2),h=c?0:ad(b,3);a=a?a.gf():0;b=c?a:ad(b,4);return new Rh(e,h,f,b,c,d)});ue.prototype.zJ=ZT(17,function(){return G(this,5)});dFa.prototype.zJ=ZT(16,g("B"));qe.prototype.qn=ZT(15,function(){return ad(this,1)});se.prototype.qn=ZT(14,function(){return ad(this,1)});
ye.prototype.qn=ZT(13,function(){return ad(this,1)});Cd.prototype.getRelativityIndicatorsId=ZT(7,function(){return G(this,5)});function zJc(a,b){var c=new Lg(b);a.j.Ag(function(a){a.Bc(c.contains(a.Ja()))})}function AJc(a,b){var c=eFa.Sc((new ue).$(),b);return kFa(c,a.Vm,a.j,a.fs)}function BJc(a,b,c){function d(a){if(Vc(a,7)){var b=Math.min(e,c),d=Math.max(e,c);a=G(a,7);var l=G(a,1);l==e?J$(a,c):l>=b&&l<=d&&(e>c?J$(a,l+1):e<c&&J$(a,l-1))}}var e=lb(a.Wp,b);yJc(a.Wp,b,c);A(a.Ln,d);A(a.jn,d)}
function CJc(a,b){function c(a){if(Vc(a,7)){var c=G(a,7),f=G(c,1);f==b?Yc(a,7):f>b&&J$(c,f-1)}}Db(a.Wp,b);A(a.Ln,c);A(a.jn,c)}function DJc(a){return a.Wp}function EJc(a,b,c){null!=c?(zb(a.Wp,b,c),b=function(a){if(Vc(a,7)){a=G(a,7);var b=G(a,1);b>=c&&J$(a,b+1)}},A(a.Ln,b),A(a.jn,b)):a.Wp.push(b)}
function FJc(a,b){var c=0,d=0,e=new Cd;b.$d||(c=b.Ob(),I(e,1,c),c=b.tc(),I(e,2,c),c=2);b.Xd()||(d=b.Nb(),I(e,3,d),d=b.Cc(),I(e,4,d),d=2);c=ritz.getRelativityIndicatorsId(c,c,d,d,!0);I(e,5,c);I(e,6,""+a);c=new Bd;I(c,2,0);I(c,1,e);return c}function GJc(a,b){I(a,3,b)}function HJc(a){return ad(a,3)}function IJc(a,b){I(a,2,b)}function K$(a){return G(a,4)}function JJc(a,b){I(a,8,b)}function KJc(a){return ad(a,8)}function LJc(a,b){I(a,2,b)}function MJc(a,b){I(a,3,b)}function NJc(a){return $c(a,2)}
function OJc(a){return G(a,2)}function PJc(a,b){var c=/\d+|\.\d+|\D+/g;if(a==b)return 0;if(!a)return-1;if(!b)return 1;for(var d=a.toLowerCase().match(c),e=b.toLowerCase().match(c),f=Math.min(d.length,e.length),h=0;h<f;h++){var c=d[h],k=e[h];if(c!=k)return d=parseInt(c,10),!isNaN(d)&&(e=parseInt(k,10),!isNaN(e)&&d-e)?d-e:c<k?-1:1}return d.length!=e.length?d.length-e.length:a<b?-1:1}function QJc(){var a=new UC;a.qc=p("goog-menu waffle-pivot-add-field-menu");return a}
var RJc={OMa:"waffle-pivot-zippy-expanded",NMa:"waffle-pivot-zippy-collapsed"};function SJc(a,b,c){var d=b.Ob();b=b.Nb();a=a?a.dd(d,b+c).getDisplayValue():"";""==a&&(a="Column "+Ho(b+c));return a}function TJc(a,b,c){b=Array.prototype.splice.call(a,b,1);Array.prototype.splice.call(a,c,0,b[0])}function UJc(a,b){return PJc(a,b)}function VJc(a,b){TB.call(this,1602,b);this.o=a}z(VJc,TB);VJc.prototype.Ud=p(47);VJc.prototype.Rd=function(){var a=new Rp,b=lFa(this.o);I(a,1,b);return a};function L$(a,b){M.call(this,a,b)}z(L$,M);function WJc(a){a=a||{};a=""+Dt(EZ(ut(a,{title:zt("Report Editor"),Vf:At('<div id="waffle-pivot-pane"><div id="waffle-pivot-range-selection"><div class="input-selection-button goog-inline-block"></div><span class="waffle-pivot-label-text waffle-pivot-range-span" id="waffle-pivot-range-text"></span><span class="waffle-pivot-label-text waffle-pivot-range-span">&nbsp;-&nbsp;</span>'+Dt(Kt({Td:"goog-inline-block waffle-pivot-label-button",content:At("Edit range..."),id:"waffle-pivot-range-selection-button",
style:4}))+'</div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+XJc({$w:zt("Rows"),id:"waffle-pivot-add-field-row"})+'</div><div id="waffle-pivot-row-label" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+XJc({$w:zt("Columns"),id:"waffle-pivot-add-field-column"})+'</div><div id="waffle-pivot-column-label" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+
XJc({$w:zt("Values"),id:"waffle-pivot-add-field-value"})+'<div id="waffle-pivot-aggr"><span id="waffle-pivot-aggr-label" class="waffle-pivot-label-text">as:&nbsp;</span><div id="waffle-pivot-aggr-select"></div></div></div><div id="waffle-pivot-values" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+XJc({$w:zt("Filter"),id:"waffle-pivot-add-field-filter"})+'</div><div id="waffle-pivot-filter" class="waffle-pivot-drop-target"></div></div><div id="waffle-pivot-button-container"><label><input type="radio" name="autoupdate" value="autoupdate" checked id="waffle-pivot-update-auto" />Update table on each change</label><br /><label><input type="radio" name="autoupdate" value="manual" id="waffle-pivot-update-manual"/>Manually</label><button id="waffle-pivot-button-update" disabled="true">Update table</button><br /></div></div>')})));
return et(a)}function XJc(a){var b;b=""+('<strong id="'+Z(a.id)+'-field-label">'+Y(a.$w)+'</strong><span class="waffle-pivot-label-text">&nbsp;-&nbsp;</span>');var c;c=zt("Add field");b+=Dt(Kt({Td:"goog-inline-block waffle-pivot-label-button",content:c,attributes:Bt('aria-label="'+Z(a.$w)+" "+Z(c)+'"'),id:a.id,style:4}));return et(b)}
function YJc(a){return et('<div class="waffle-pivot-pill" role="group" tabindex="0"><table class="waffle-pivot-pill-main-table" role="presentation"><tbody><tr><td class="waffle-pivot-pill-main-table-text"><strong>'+Y(a.Ena)+'&nbsp;</strong><span class="waffle-pivot-pill-title"></span></td><td class="waffle-pivot-pill-main-table-fill"><div class="waffle-pivot-pill-draghandle"></div></td><td class="waffle-pivot-pill-close waffle-pivot-pill-nodrag"></td></tr></tbody></table></div>')};function M$(a,b,c,d,e,f){S.call(this,f);this.J=a;this.V=c;this.O=d;this.M=e;this.Of(b)}z(M$,S);r=M$.prototype;r.ib=function(){this.ma=Bs(YJc,{Ena:this.J})};r.Ua=function(){M$.L.Ua.call(this);var a=this.X(),b=U(this);this.F=um(a,"span","waffle-pivot-pill-title",this.getElement())[0];var c;c=new PD("\u2715",a,4);c.render(um(a,"td","waffle-pivot-pill-close",this.getElement())[0]);wr(c.getElement(),"Close edit field and remove from pivot table");K(this,c);b.K(c,"action",this.mrb)};
r.zx=function(){var a=new L$("pivot-pill-changed",this);a.j=this;this.dispatchEvent(a)};function N$(a,b){a.F&&(a.X().Ig(a.F,b),wr(a.getElement(),"Edit field: "+(a.J+(" "+(b+".")))),a.F.title=b)}function ZJc(a){return a.X().eK(a.F)}function O$(a,b){return SJc(a.vc(),a.M,b)}function P$(a,b,c){a=a.X();return a.oa("span",c,a.createTextNode(b+"\u00a0"))}function Q$(a){return a.X().oa("div","waffle-pivot-pill-nodrag")}
r.gI=function(a){var b=this.X(),c=b.oa("div","waffle-pivot-pill-section",arguments);1<em(this.getElement()).length&&zr(c,"waffle-pivot-pill-section-top-border");b.appendChild(this.getElement(),c)};r.Bw=function(a){U(this).K(a.getElement(),"mouseover",this.x0).K(a.getElement(),"mouseout",this.x0)};r.x0=function(a){a=a.target;var b=!yr(a,"waffle-pivot-select-hover");Dr(a,"waffle-pivot-select-hover",b)};r.gx=g("M");r.vc=function(){var a=Nw(this.V.j,this.O);return a?a.vc():null};
r.mrb=function(){var a=new L$("pivot-remove-pill",this);a.j=this;this.dispatchEvent(a)};r.yma=p(!0);r.vCa=ha;function R$(){}z(R$,aD);ia(R$);R$.prototype.qc=p("waffle-pivot-select");R$.prototype.MI=function(a){return a.oa("div","goog-inline-block "+(this.qc()+"-dropdown"),"\u00a0\u25be")};function S$(a,b,c,d,e){M$.call(this,"Filter:",a,b,c,d,e);this.j=new gD("",null,R$.getInstance(),e);K(this,this.j)}z(S$,M$);r=S$.prototype;r.Ua=function(){S$.L.Ua.call(this);this.Ya();N$(this,O$(this,$Jc(this)));var a=P$(this,"Show:"),b=Q$(this);this.j.ob(b);this.j.rv=!0;this.j.lK("Loading...");wr(this.j.ma,"Show:");var c=new T$;K(this,c);this.j.Jf(c);this.Bw(this.j);this.gI(a,b)};r.Of=function(a){S$.L.Of.call(this,a);N$(this,O$(this,$Jc(this)))};function $Jc(a){return a.Ya().eh()-a.gx().Nb()}
function U$(a){return a.j.dc().j}r.Bw=function(a){S$.L.Bw.call(this,a);U(this).K(U$(this),"filters_selected",this.W1a).K(U$(this),"filtering_cancelled",this.X1a)};function aKc(a,b,c){var d=[];if(!c)return d;a=b.Nb()+a;var e=$h(b,"r");for(b=b.Ob()+1;b<e.end;b++){var f=c.dd(b,a);Rb(d,f.getDisplayValue(),UJc)}return d}function bKc(a){var b=U$(a),c=NJc(OJc(a.Ya())),d=new Lg(c),e=pb(b.getFilterChoices(),function(a,b){return d.contains(b)?a-1:a},b.getFilterChoices().length);zJc(b,c);cKc(a,e)}
function cKc(a,b){var c=U$(a);0==b?a.j.lK("All items"):(c=c.getFilterChoices().length-b,a.j.lK(null!=c?""+c+" items":"All items"))}r.W1a=function(a){this.j.Yd(!1);cKc(this,a.cb.length);this.zx()};r.X1a=function(){this.j.Yd(!1);var a=this.j.ma;try{tf&&this.X().Cb().body.focus(),a.focus()}catch(b){}bKc(this)};function T$(a){WC.call(this,a);this.j=new RZ([],!1,null,a)}z(T$,WC);T$.prototype.Ua=function(){T$.L.Ua.call(this);this.j.render(this.Lb());var a=new pD(this.j.ma,this.X());qD(a);K(this,a)};
T$.prototype.rR=function(a){hm(a.target)&&this.j.Sk(a.target)||T$.L.rR.call(this,a)};function V$(a,b,c,d,e,f){M$.call(this,"Group by:",a,b,c,d,f);this.P=e}z(V$,M$);r=V$.prototype;
r.Ua=function(){V$.L.Ua.call(this);var a=this.Ya();N$(this,O$(this,a.qn()));var b=this.X(),a=P$(this,"Order:"),c=Q$(this),d=new WC;d.$a(new RC(b.Ui("Ascending"),0),!0);d.$a(new RC(b.Ui("Descending"),1),!0);b=this.B=new gD("",d,R$.getInstance(),b);b.ob(c);b.hb(KJc(this.Ya()));wr(b.getElement(),"Order:");this.Bw(b);this.gI(a,c);var b=this.X(),c=P$(this,"Sort by:"),a=Q$(this),d=new WC,e=O$(this,this.Ya().qn());d.$a(new RC(e,-1),!0);d=this.H=new gD("",d,R$.getInstance(),b);d.ob(a);wr(d.getElement(),"Sort by:");
U(this).K(d.getElement(),"mouseover",this.x0).K(d.getElement(),"mouseout",this.x0).K(d,"action",this.QTa);b=v(b.oa,b,"div",["goog-inline-block","waffle-pivot-pill-sort-by"]);c=b(c);this.D=b(a);this.gI(c,this.D);a=this.Ya();a=ad(a,2);c=P$(this,"Show totals","waffle-pivot-pill-align-middle waffle-pivot-pill-nodrag");b=Q$(this);zr(b,"goog-inline-block");this.o=new sL;qL(this.o,c);this.o.Bc(a);this.o.render(b);U(this).K(this.o,"change",this.zx);this.gI(b,c)};
r.Of=function(a){V$.L.Of.call(this,a);N$(this,O$(this,a.qn()));this.o&&this.o.Bc(ad(a,2));this.B&&this.B.hb(KJc(a));dKc(this)};r.Xd=g("P");r.QTa=function(a){a=new L$("pivot-sort-by-change",a.currentTarget);a.j=this;this.dispatchEvent(a)};r.RTa=function(a){a=new L$("pivot-sort-key-change",a.currentTarget);a.j=this;this.dispatchEvent(a)};function eKc(a){var b=[];if(a.j)for(var c=a.j.Ec(),d=0;d<c;d++)0<=a.j.Ic(d).Ja()&&b.push(a.j.Ic(d).dk());return b}
function fKc(a){if(!a.j){var b=a.X(),c=Q$(a);zr(c,"waffle-pivot-multi-select");a.j=new GC("horizontal",null,b);a.j.ob(c);b.appendChild(a.D,c)}}function dKc(a){if(a.j)for(L(a.j),a.j=null;1<a.D.children.length;)cm(a.D.lastElementChild)}r.Bw=function(a){V$.L.Bw.call(this,a);U(this).K(a,"hide",this.zx)};r.R=function(){V$.L.R.call(this);L(this.B);L(this.H);L(this.j);L(this.o);this.D=null};function gKc(){N.call(this);this.o="";this.j=!1}z(gKc,N);gKc.prototype.Ja=g("o");gKc.prototype.hb=function(a){this.o=a;this.j=!0;this.dispatchEvent("change")};function W$(a,b,c,d,e){M$.call(this,"Display:",a,b,c,d,e);this.B=this.D=this.j=null;this.o=0}z(W$,M$);var hKc="SUM COUNTA COUNT COUNTUNIQUE AVERAGE MAX MIN MEDIAN PRODUCT STDEV STDEVP VAR VARP".split(" "),iKc=["SUM"];r=W$.prototype;r.Ua=function(){W$.L.Ua.call(this);N$(this,jKc(this));kKc(this)};
function kKc(a){var b=a.Ya();if(1==K$(b)){var c=new WC;A(hKc,function(a){c.$a(new RC(a),!0)});a.j=lKc(a,c,G(b,5).Xz())}else{var d=G(b,6);a.B=mKc(a,"Name",ad(b,3));a.D=mKc(a,"Formula",HJc(d)||"=");c=new WC;A(iKc,function(a){c.$a(new RC(a),!0)});c.$a(new RC("Custom","CUSTOM"),!0);ad(d,4);a.j=lKc(a,c,nKc(a));U(a).K(a.j,"hide",v(a.NYa,a))}}
function lKc(a,b,c){var d=a.X(),e=P$(a,"Summarize by:"),f=Q$(a);b=new gD("",b,R$.getInstance(),d);K(a,b);b.ob(f);b.hb(c);wr(b.ma,"Summarize by:");a.Bw(b);a.gI(e,f);return b}function mKc(a,b,c){var d=a.X(),e=P$(a,b),f=Q$(a);b=new NU(b,d);K(a,b);b.render(f);b.hb(c);a.gI(e,f);c=new zD(b.ma);K(a,c);e=new Mr(b.ma);K(a,e);U(a).K(c,"input",a.l4a).K(e,"focusout",a.k4a);return b}r.Ja=function(){return this.D?this.D.Ja():this.j.Ja()};function oKc(a){a=a.j.Ja();return"CUSTOM"==a?null:a}
r.Bw=function(a){W$.L.Bw.call(this,a);U(this).K(a,"hide",this.zx)};r.NYa=function(){X.cka.kc()};r.Of=function(a){var b=K$(a);null!=this.Ya()&&K$(this.Ya());W$.L.Of.call(this,a);N$(this,jKc(this));1==b?null!=this.j&&this.j.hb(G(a,5).Xz()):null!=this.B&&null!=this.D&&(Vc(a,3)&&this.B.hb(ad(a,3)),this.D.hb(HJc(G(a,6))||"="),this.j.hb(nKc(this)))};function jKc(a){var b=a.Ya();return Vc(b,3)&&ad(b,3)?ad(b,3):1==K$(b)?O$(a,G(b,5).qn()):"Calculated Field"}
r.l4a=function(){this.o&&(clearTimeout(this.o),this.o=0);this.o=setTimeout(v(function(){this.zx();this.o=0},this),3E3)};r.k4a=function(){this.o&&(clearTimeout(this.o),this.o=0);this.zx()};function nKc(a){a=a.Ya();a=G(a,6);a=G(a,4);return null!=a?a:"CUSTOM"}r.yma=function(){return 1==K$(this.Ya())};r.R=function(){W$.L.R.call(this);L(this.j)};r.vCa=function(){2==K$(this.Ya())&&this.B.getElement().focus()};function X$(a,b,c,d,e){FZ.call(this,e);a=this.X();var f=pKc,h=qKc;this.xb=b;this.Sb=c;this.B=d;this.o={};this.F=!0;this.yb=null;this.P=new gKc;this.cb=new P(this);this.jb=new a_;this.Y=[];this.qb=this.D=null;this.tb=new RC("No fields left to add",void 0,e);this.tb.Ma(!1);this.H=this.J=null;this.La=tc(f.ZFa,h.kX,f.XFa,h.RN,f.YFa,h.rka,f.WFa,h.Lia);this.M=this.V=null;b=new WC(a);b.$a(new RC("Columns",2,a),!0);b.$a(new RC("Rows",1,a),!0);this.O=new gD("",b,R$.getInstance(),a)}z(X$,FZ);
var pKc={kX:"waffle-pivot-values",RN:"waffle-pivot-filter",WGa:"waffle-pivot-column-label",nLa:"waffle-pivot-row-label",ZFa:"waffle-pivot-add-field-value",XFa:"waffle-pivot-add-field-filter",YFa:"waffle-pivot-add-field-row",WFa:"waffle-pivot-add-field-column",iGa:"waffle-pivot-aggr-select",jGa:"waffle-pivot-aggr",qwb:"waffle-pivot-apply",EGa:"waffle-pivot-button-container",KPb:"waffle-pivot-range-selection",LPb:"waffle-pivot-range-selection-button",MPb:"waffle-pivot-range-text",Xka:"waffle-pivot-button-update",
wMa:"waffle-pivot-update-auto",yMa:"waffle-pivot-update-manual"},qKc={rka:"row-breakout",Lia:"col-breakout",RN:"filter",kX:"aggregation"};r=X$.prototype;r.ib=function(){this.ma=Bs(WJc,{id:this.getId()})};
r.Ua=function(){function a(a,b){f.K(Nl(a),"click",b)}X$.L.Ua.call(this);var b=this.X(),c=pKc;R(b.getElement(c.EGa),!1);var d=qKc;this.H=tc(d.kX,b.getElement(c.kX),d.RN,b.getElement(c.RN),d.rka,b.getElement(c.nLa),d.Lia,b.getElement(c.WGa));this.yb=b.getElement(c.Xka);var d=mB(BD,""),e=QJc(),f=U(this),h;for(h in this.La){var k=new bD("",new WC(b,e),d,b);K(this,k);k.ob(b.getElement(h));f.K(k,"show",this.GXa).K(k.dc(),"action",this.FXa)}a(c.Xka,this.tbb);a(c.wMa,this.Vta);a(c.yMa,this.Vta);this.M=b.getElement(c.jGa);
R(this.M,!1);this.O.ob(b.getElement(c.iGa));f.K(this.O,"action",this.XXa);this.qb=new Mr(this.Lb());f.K(this.qb,"focusin",this.wrb).K(this.qb,"focusout",this.xrb);rKc(this)};r.wrb=function(a){this.D=sKc(this,a.target)};r.xrb=function(a){if(a=a.relatedTarget){var b=this.Lb();rm(a,function(a){return a==b})||(this.D=null)}};
function sKc(a,b){if(!b)return null;var c=a.X().iUa(b,"waffle-pivot-pill");if(!c)return null;var d=null,e=null;ac(a.o,function(a,b){return(d=sb(a,function(a){return a.getElement()==c}))?(e=b,!0):!1});return d?{container:e,label:ZJc(d)}:null}
function tKc(a){var b=a.X();if(a.D){var c=a.D.container,d=a.o[c];if(d&&a.D.label)for(var e=0,f;f=d[e];e++)if(ZJc(f)==a.D.label){uKc(a,f.getElement());return}d&&0<d.length?uKc(a,d[d.length-1].getElement()):(d=ic(a.La,function(a){return a==c}),uKc(a,b.getElement(d)))}}
r.Of=function(a){X$.L.Of.call(this,a);a?(vKc(this,function(){function b(a,b){if(a)for(;a.length>b;)L(a.pop())}function c(b,c,d){var k="row-breakout"==b;this.o[b]&&this.o[b][d]?(d=this.o[b][d],d.Of(c),b=new L$("pivot-pill-model-updated"),b.j=d,this.dispatchEvent(b)):(d=new V$(c,this.B,a.Vm,Y$(this),k,this.X()),d.render(),wKc(this,d,b))}var d=a.fs,d=ritz.renderPivotTableCalculatedFieldFormulas(a.K$(),d);a=AJc(a,d);A(a.Ns,function(b,c){if(this.o.filter&&this.o.filter[c]){var d=this.o.filter[c];d.Of(b)}else d=
new S$(b,this.B,a.Vm,Y$(this),this.X()),d.render(),wKc(this,d,"filter")},this);A(a.Ln,za(c,"row-breakout"),this);A(a.jn,za(c,"col-breakout"),this);A(a.Wp,function(b,c){var d=null;this.o.aggregation&&this.o.aggregation[c]&&(d=this.o.aggregation[c]);if(d&&d.Ya()&&K$(d.Ya())==K$(b))d.Of(b);else{var k=new W$(b,this.B,a.Vm,Y$(this),this.X());k.render();d?xKc(this,d,k,"aggregation"):wKc(this,k,"aggregation")}},this);b(this.o["row-breakout"],a.Ln.length);b(this.o["col-breakout"],a.jn.length);b(this.o.filter,
a.Ns.length);b(this.o.aggregation,a.Wp.length);d=(d=(d=Nw(this.B.j,a.Vm))?d.j:null)?Qo(a.gx(yKc(this)),d):"#REF!";zKc(this,d);this.P.hb(d);(d=this.o.aggregation)&&2<=d.length?(R(this.M,!0),this.O.hb(a.zJ())):R(this.M,!1)}),X$.L.Of.call(this,a),AKc(this,function(){var a=this.o.filter;a&&A(a,function(a){var b=U$(a),e;e=aKc($Jc(a),a.gx(),a.vc());bVb(b,e);bKc(a)},this)})):this.reset()};r.focus=function(){X$.L.focus.call(this);uKc(this,Ql("waffle-sidebar-title",this.getElement()))};
function wKc(a,b,c){a.H[c].appendChild(b.getElement());a.o[c]||(a.o[c]=[]);a.o[c].push(b);b.Qc(a);BKc(a,b);rKc(a)}function xKc(a,b,c,d){a.X().hM(c.getElement(),b.getElement());d=a.o[d];var e=lb(d,b);Ab(d,e,1,c);L(b);c.Qc(a);BKc(a,c);rKc(a)}function BKc(a,b){U(a).K(b,"pivot-remove-pill",a.zrb).K(b,"pivot-pill-changed",a.yrb).K(b.getElement(),"keydown",a.b4a);var c=new L$("pivot-pill-created");c.j=b;a.dispatchEvent(c)}
function rKc(a){a.cb.$b();L(a.jb);var b=a.jb=new a_;Yb(a.H,function(a){BVb(b,a)});b.Le();a.cb.K(b,"beforedragstart",a.trb).K(b,"dragstart",a.vrb).K(b,"dragend",a.urb)}r.reset=function(){Yb(this.o,function(a){A(a,L)});this.o={}};function zKc(a,b){var c=a.X();c.Ig(c.getElement("waffle-pivot-range-text"),b)}
r.zrb=function(a){var b=new L$("pivot-pill-removed",this);b.j=a.target;b.container=ic(this.o,function(b){return vb(b,a.target)});b.J=CKc(this,b.container,a.target);b.container&&(Cb(this.o[b.container],a.target),this.D={container:b.container,label:null},this.dispatchEvent(b))};r.yrb=function(a){a.container=ic(this.o,function(b){return vb(b,a.target)})};r.b4a=function(a){!a.shiftKey||38!=a.keyCode&&40!=a.keyCode||DKc(this,a.target,38==a.keyCode)};
function DKc(a,b,c){var d=null,e=-1;ac(a.H,function(a,c){e=lb(a.childNodes,b);return 0<=e?(d=c,!0):!1});var f=a.o[d];if(!(!f||1>=f.length||(c=c?e-1:e+1,0>c||c>f.length-1))){TJc(f,e,c);var h=new L$("pivot-pill-changed",a);h.j=f[c];h.container=d;h.B=d;h.position=c;h.fb=!0;a.dispatchEvent(h)}}r.tbb=function(){this.dispatchEvent("pivot-table-update")};r.Vta=function(a){a=this.F="autoupdate"==a.target.value;(this.yb.disabled=a)&&this.dispatchEvent("pivot-table-update")};r.XXa=function(){this.dispatchEvent("pivot-aggregation-orientation-changed")};
r.zJ=function(){return this.O.Ja()};function EKc(a,b,c,d){Rf(a.J);OUb(a.xb,a.P,a.P.Ja(),!1,!1,!0,v(a.mmb,a,b,c,!!d))}r.mmb=function(a,b,c,d){var e=this.P,f=this.B;e.j=!1;var h=e.Ja();this.J=Pf(d,"afterhide",function(){if(e.j){var d=Oo(e.Ja(),f.j,!0,!0);d?a(d):(e.hb(h),b())}else b();c||uKc(this,Nl("waffle-pivot-range-selection-button"))},!1,this)};
r.GXa=function(a){var b=a.target.getParent(),c=b.dc();this.V=this.La[b.ma.id];vKc(this,function(){var a=this.V,e=yKc(this),f=Y$(this),h=FKc(this,a);c.Kd(!0);for(var k=$h(f,"c"),l=0,m=k.start;m<k.end;m++){var n=SJc(e,f,l);n&&!h[n]&&c.$a(new RC(n,l),!0);l++}"aggregation"==a&&(c.$a(new VC,!0),c.$a(new RC("Calculated Field",-1),!0));0==c.Ec()&&c.$a(this.tb,!0);eU(b,!0);b.by();eU(b,!1)})};function uKc(a,b){try{tf&&a.X().Cb().body.focus(),b.focus(),a.Sb.yc(2)}catch(c){}}
r.FXa=function(a){var b=this.V;a=a.target.Ja();var c=new L$("pivot-pill-added",this);c.container=b;c.F=a;this.D={container:b,label:null};this.dispatchEvent(c)};r.trb=function(a){for(var b=a.event.target||a.event.j.target;b instanceof Element&&!yr(b,"waffle-pivot-pill");b=b.parentNode)if(yr(b,"waffle-pivot-pill-nodrag")){a.preventDefault();break}};r.vrb=function(a){var b=Mn(a.j).width;Cn(a.F,b)};
r.urb=function(a){var b,c,d,e,f=new L$("pivot-pill-changed",this);ac(this.H,function(c,d){e=lb(c.childNodes,a.j);return 0<=e?(b=d,!0):!1});ac(this.o,function(b,e){var l=sb(b,function(b){return b.getElement()==a.j}),m=lb(b,l);return l?(c=e,f.j=d=l,f.qa=m,!0):!1});this.o[b]||(this.o[b]=[]);Cb(this.o[c],d);zb(this.o[b],d,e);f.container=b;f.B=c;f.position=e;this.dispatchEvent(f)};
function FKc(a,b){function c(a){a=h(a.Sz()-k);f[a]=!0}function d(a){a=h(a.qn());f[a]=!0}var e=a.Ya(),f={},h=v(SJc,a,yKc(a),Y$(a)),k=Y$(a).Nb();if(e)switch(b){case "filter":A(e.Ns,c);break;case "row-breakout":case "col-breakout":A(e.Ln,d),A(e.jn,d)}return f}function vKc(a,b){var c=GKc(a);if(c){var d=Y$(a),d=new Rh(d.Ob(),d.Nb(),d.Ob()+1,d.Cc());ll?HKc(a,d,b):yv(c.o,d,v(b,a),U(a))}else b.call(a)}function AKc(a,b){var c=GKc(a);c?ll?HKc(a,Y$(a),b):yv(c.o,Y$(a),v(b,a),U(a)):b.call(a)}
function HKc(a,b,c){b=wv(Ev(GKc(a)),b).addCallback(c,a);a.Y.push(b);hj(b,za(Cb,a.Y,b))}function GKc(a){var b=a.Ya();return Nw(a.B.j,b.Vm)}function yKc(a){return(a=GKc(a))?a.vc():null}function Y$(a){return a.Ya().gx(yKc(a))}function CKc(a,b,c){return ub(a.o[b],function(a){return c.getElement()==a.getElement()})}r.R=function(){X$.L.R.call(this);Yb(this.o,function(a){kf(a)});this.o={};Rf(this.J);this.J=null;L(this.jb);L(this.cb);A(this.Y,AC)};function IKc(a,b){J.call(this);this.j=a;this.C=b;this.o=new P(this);K(this,this.o);this.o.K(a,"pivot-pill-created",this.B).K(a,"pivot-pill-model-updated",this.B)}z(IKc,J);IKc.prototype.D=function(a){var b=a.j;a=a.target.Ja();dKc(b);-1==a?b.zx():0<JKc(this,b).length&&!b.j?(fKc(b),b.j.getElement().focus(),KKc(this,b,-2,!0)):b.zx()};
IKc.prototype.F=function(a){var b=a.j;a=a.target;var c=bo(b.j,a),d=b.X();for(c++;c<b.j.Ec();){var e=b.j.Ic(c),f=d.S$(e.getElement());yr(f,"waffle-pivot-select-divider")&&d.removeNode(f);b.j.removeChild(e,!0)}(0>a.Ja()||!KKc(this,b,-2,!0))&&b.zx()};function LKc(a,b){a.o.K(b,"pivot-sort-by-change",a.D).K(b,"pivot-sort-key-change",a.F)}
IKc.prototype.B=function(a){var b=a.j;if(b instanceof V$){a=b.Ya();for(var c=0<JKc(this,b).length,d=DJc(this.j.Ya()),e=b.H,f=e.Oj()-1;1<=f;f--)e.ZE(f);e.Ae(0).lK(O$(b,a.qn()));e.kf(0);A(d,function(a,d){var f;if(Vc(a,3))f=G(a,3);else if(1==K$(a)){f=G(a,5).getFunctionName();var m=O$(b,G(a,5).qn());f=c?f+(" of "+(m+" in...")):f+(" of "+m)}else f=HJc(G(a,6));e.Ee(new RC(f,d))});Vc(a,7)&&(d=G(a,7),a=$c(d,2),MKc(this,b,a)&&(d=G(d,1),e.hb(d),c&&(fKc(b),A(a,v(function(a){KKc(this,b,a,!1)},this)),KKc(this,
b,-1,!1))));LKc(this,b)}};
function KKc(a,b,c,d){var e=NKc(a,b);if(0==e.length)return!1;var f=b.j.Ec();a=JKc(a,b);if(f>=a.length)return!1;var h=O$(b,a[f].qn()),f=b.X();a=b.j.Ec();var k=new WC,l=new RC(h,-2);l.Ma(!1);k.$a(l,!0);k.$a(new RC(0==a?"Grand Total":"Total",-1),!0);for(l=0;l<e.length;l++)k.$a(new RC(e[l],l),!0);h=new gD(h,k,R$.getInstance(),f);h.hb(-2);b.j.$a(h,!0);0<a&&(a=f.oa("div",["goog-inline-block","waffle-pivot-select-divider"],":"),f.OA(a,h.getElement()));U(b).K(h,"action",b.RTa);f=c;"string"==typeof c&&(f=
lb(e,c),-1==f&&(f=-2));h.hb(f);d&&(b.j.Xf(h),h.Yd(!0));return!0}function NKc(a,b){var c=OKc(a,b),d=eKc(b),e=d.length,f=[];A(c,function(a){a.length==e+1&&rb(d,function(b,c){return a[c]==b})&&Rb(f,a[e])});return f}function MKc(a,b,c){a=OKc(a,b);return 0==c.length||qb(a,function(a){return Qb(c,a)})}function JKc(a,b){return b.Xd()?a.j.Ya().jn:a.j.Ya().Ln}function OKc(a,b){return b.Xd()?fFa(a.j.Ya(),a.C):gFa(a.j.Ya(),a.C)};function PKc(a,b){rq.call(this,1601,b,Th(a.j));this.o=a}z(PKc,rq);PKc.prototype.exec=ba();PKc.prototype.Ud=p(48);PKc.prototype.Rd=function(){var a=new Sp,b=lFa(this.o);I(a,2,b);var b=this.o.j,c=new gd;I(c,1,""+this.o.fs);c.Mv(b.y);I(c,3,b.x);I(a,1,c);return a};function QKc(a,b,c,d,e){DZ.call(this,a,c);this.C=this.J=null;this.j=a;this.o=b;this.P=d;this.O=e;this.V=new IKc(this.j,this.o);K(this,this.V);b=b.j;c=a.X();this.U.K(a,"pivot-table-update",this.xbb).K(a,"pivot-pill-added",this.D7a).K(a,"pivot-pill-removed",this.orb).K(a,"pivot-pill-changed",this.nrb).K(a,"pivot-aggregation-orientation-changed",this.WXa).K(Vm,"show-pivot-ritz",this.qrb).K(e,"activeCellChange",this.cia).K(e,"click",this.rrb,!0).K(e,"pivot_table_zippy_toggle",this.scb).K(b,"ga",this.cia).K(b,
"ja",this.p$a).K(c.getElement("waffle-pivot-range-selection-button"),"click",this.Z7a).K(c.getElement("waffle-pivot-range-selection-button"),"keypress",this.$7a);a=["jb"];a.push("xa");this.U.K(hu(b),a,this.cia)}z(QKc,DZ);r=QKc.prototype;r.Qh=function(){return X.fka};r.Uu=function(){return X.dka};r.Z7a=function(){RKc(this)};r.$7a=function(a){13==a.keyCode&&(a.preventDefault(),a.stopPropagation(),RKc(this))};function RKc(a){EKc(a.j,v(a.prb,a,SKc(a)),ha)}
r.prb=function(a,b){a.Vm=b.Rc;var c=FJc(b.Rc,b.rect);a.Vm=parseInt(G(c,1).ub(),10);a.o=c;Z$(this,a,this.j.F,!1);var c=a.fs,d=this.o.j;qy(d)!=c&&gN(d,c)};
r.qrb=function(){var a;bl.getInstance();var b=this.o.j.j;if(b&&0==b.getSheetType()){a=this.o;var c=b.ub(),b=Vx(b.vc());a=$T(a,c,b)}else a=!1;if(a){c=this.j;if(!c.gb()){a=this.o.j.getActiveGrid();b=$$(this);if(!b&&a){this.j.reset();var c=a.o,b=a.vc(),d=Xx(b),e=Vx(b);d?(ll?Av(c,e,dc(Yg)):Cv(c,e,dc(Yg),this.U)).addCallback(v(this.UCa,this,a)):this.UCa(a,Px(b));return}this.C=b;c.Of(b)}this.Uu().kc()}};
r.nrb=function(a){var b=a.container,c=a.B,d=a.j,e=a.qa,f=d,h=this.j.Ya().clone();if(d&&c&&b!=c){if(!d.yma()){Z$(this,$$(this),!1,!0);return}f=TKc(this,d.Ya(),b);a:{var k=this.j,l;l=k.Ya().Vm;switch(b){case "row-breakout":case "col-breakout":var m="row-breakout"==b,f=new V$(f,k.B,l,Y$(k),m,k.X());break a;case "aggregation":f=new W$(f,k.B,l,Y$(k),k.X());break a;case "filter":f=new S$(f,k.B,l,Y$(k),k.X());break a;default:f=null}}f.render();xKc(this.j,d,f,b)}d=a.position;k=c==b;l=UKc(this,f.Ya());if(c)if(k){f=
f.Ya();switch(b){case "row-breakout":yJc(h.Ln,f,d);break;case "col-breakout":yJc(h.jn,f,d);break;case "filter":yJc(h.Ns,f,d);break;case "aggregation":BJc(h,f,d)}Ym("Field is now in position "+(d+1+"."))}else VKc(this,b,h,l,d);else WKc(this,b,f,h);c&&!k&&null!=e&&XKc(e,c,h);Z$(this,h,this.j.F,!!a.fb)};
function TKc(a,b,c){switch(c){case "row-breakout":case "col-breakout":if(b instanceof qe)return b;break;case "aggregation":if(b instanceof re)return b;break;case "filter":if(b instanceof je)return b;break;default:return null}b=UKc(a,b);-1==b&&(b=0);switch(c){case "row-breakout":case "col-breakout":return c=new qe,I(c,1,b),c;case "aggregation":return c=new re,a=new se,I(a,1,b),IJc(a,"SUM"),I(c,4,1),I(c,5,a),c;case "filter":return c=new je,new ke,a=b+YKc(a).Nb(),I(c,1,a),c;default:return null}}
function UKc(a,b){if(b instanceof qe)return b.qn();if(b instanceof re)switch(K$(b)){case 1:return G(b,5).qn();case 2:return-1;default:return 0}return b instanceof je?b.eh()-YKc(a).Nb():0}function YKc(a){var b=$$(a);return b.gx(Nw(a.o.j,b.Vm).vc())}r.D7a=function(a){var b=a.container,c=SKc(this);VKc(this,b,c,a.F,a.position);Z$(this,c,this.j.F,!1);a=this.j;a.o[b]?(b=a.o[b],b=0<b.length?b[b.length-1]:null):b=null;b&&b.vCa()};
r.orb=function(a){var b=SKc(this);XKc(a.J,a.container,b);L(a.j);Z$(this,b,this.j.F,!1)};r.WXa=function(){var a=SKc(this),b=this.j.zJ();a.B=b;Z$(this,a,this.j.F,!1)};
function VKc(a,b,c,d,e){switch(b){case "row-breakout":a=new qe;I(a,1,d);null!=e?zb(c.Ln,a,e):c.Ln.push(a);break;case "col-breakout":a=new qe;I(a,1,d);null!=e?zb(c.jn,a,e):c.jn.push(a);break;case "filter":b=Nw(a.o.j,c.Vm);if(!b)break;b=b.vc();b=aKc(d,c.gx(b),b);var f=new je;a=YKc(a).Nb()+d;I(f,1,a);ZKc(f,b);null!=e?zb(c.Ns,f,e):c.Ns.push(f);break;case "aggregation":b=new re;if(-1==d){X.bka.kc();d=new te;GJc(d,"=");I(d,4,"SUM");I(b,4,2);I(b,6,d);d=DJc($$(a));for(var h=!1,f="",k=1;!h&&k<=d.length+1;k++){f=
"Calculated Field "+k;a:{for(var h=a,l=f,m=$$(h),n=m.Wp,q=0;q<n.length;q++){var t=n[q];if(Vc(t,3)&&l==G(t,3)){h=!0;break a}if(1==K$(t)){var w=Nw(h.o.j,m.Vm).vc();if(l==SJc(w,m.gx(w),G(t,5).qn())){h=!0;break a}}}h=!1}h=!h}I(b,3,f)}else a=new se,I(a,1,d),IJc(a,"SUM"),I(b,4,1),I(b,5,a);EJc(c,b,e)}}function XKc(a,b,c){if(!(0>a))switch(b){case "row-breakout":Db(c.Ln,a);break;case "col-breakout":Db(c.jn,a);break;case "filter":Db(c.Ns,a);break;case "aggregation":CJc(c,a)}}
function WKc(a,b,c,d){if("aggregation"==b)a=CKc(a.j,b,c),d=d.Wp[a],null!=d&&(a=c.B?c.B.Ja():null,null!=a&&I(d,3,a),1==K$(d)?IJc(G(d,5),c.Ja()):(jb(2==K$(d)),d=G(d,6),GJc(d,c.Ja()),(a=oKc(c))?I(d,4,a):Yc(d,4)));else if("filter"==b)d=sb(d.Ns,function(a){return a.equals(c.Ya())}),null!=d&&ZKc(d,cVb(U$(c),!0));else if(d=sb("row-breakout"==b?d.Ln:d.jn,function(a){return a.equals(c.Ya())}),null!=d)if(LJc(d,c.o.isChecked()),JJc(d,c.B.Ja()),-1!=c.H.Ja()){var e=new pe;J$(e,c.H.Ja());A(eKc(c),function(a){Xc(e,
2,a)});MJc(e,c.B.Ja());I(d,7,e)}else Yc(d,7)}r.xbb=function(){Z$(this,$$(this),!0,!1)};function Z$(a,b,c,d){b&&(c?(c=PB(a.o.j,b.fs),c=new PKc(b,c),a.P.xc(c),a.J=null):a.J=b,c=a.j.Ya(),(d=d||!Dh(c.j,b.j))&&a.j.reset(),a.j.Of(b),d&&tKc(a.j))}r.UCa=function(a,b){var c=a.vc(),d=Xx(c),c=Vx(c);d&&b.equals(c)?EKc(this.j,v(this.bqa,this),v(this.Kfb,this),!0):this.bqa(new li(a.ub(),a.j,b))};r.Kfb=function(){this.Qh().setVisible(!1);this.H.yc(3)};
r.bqa=function(a){var b;b=new ue;var c=FJc(0,new Rh(0,0,1,1));I(b,6,c);I(b,5,2);b=kFa(b,0,new O(0,0),0);b.Vm=a.Rc;a=FJc(a.Rc,a.rect);b.Vm=parseInt(G(a,1).ub(),10);b.o=a;a=qy(this.o.j);this.P.xc(new VJc(b,a))};function $$(a){return a.J?a.J:(a=a.o.j.j)&&0==a.getSheetType()?fHa(a.vc()):null}function SKc(a){return(a=$$(a))?a.clone():null}
r.cia=function(a){var b=$$(this);if(("jb"==a.type||"xa"==a.type)&&!b&&this.C&&(a=this.o.j.getActiveGrid())&&(this.j.Ma(!0),a=a.vc(),a.Mb()==this.C.fs)){var c=this.C.j;c&&(Yx(a,c),b=$$(this))}b?b.equals(this.C,this.o)||this.j.Of(b):this.j.reset();this.C=b;a=!!b;oAb.j&&!this.Qh().gb()||this.Qh().setVisible(a&&!$H(this.o));this.j.Ma(!!b)};r.p$a=function(a){a=a.target;if(this.C&&this.C.fs==a.ub()&&this.j.gb()){a=this.j;var b=Eya(a.xb);b&&a.J&&b.setVisible(!1)}};
r.rrb=function(a){var b=a.target;if(yr(b,RJc.OMa)||yr(b,RJc.NMa)){var b=bu(this.O).Ya(),c=Lx(b,a.zg);$Kc(this,b,c);a.stopPropagation()}};r.scb=function(a){var b=bu(this.O).Ya();a=Lx(b,a.zg);$Kc(this,b,a)};
function $Kc(a,b,c){if(!$H(a.o)){var d=c.jq();b=gHa(b,c);if(c=d.H$()){var e=c.length-1;c=c[e];for(var d="r"==d.$Q()?b.Ln[e]:b.jn[e],e=$c(d,3),f,h=0;h<e.length;h++)if(e[h].Ja()==c){f=e[h];var k=!G(f,3);I(f,3,k)}f||(f=new ne,f.hb(c),I(f,3,!0),Xc(d,3,f));Ym(G(f,3)?"Pivot table field collapsed":"Pivot table field expanded");Z$(a,b,!0,!1)}}}function ZKc(a,b){var c=new ke;Yc(c,2);I(c,1,!1);A(b,function(a){Xc(c,2,a)});I(a,2,c)}r.R=function(){QKc.L.R.call(this)};function aLc(){J.call(this)}z(aLc,Cm);aLc.prototype.o=function(){return X$};aLc.prototype.j=function(){return QKc};Sm("ritzpivottables",aLc);
