function OEc(a,b,c){b=tb(a,b.equals,b);0<=b&&b!=c&&(b=Ab(a,b,1),Ab(a,c,0,b[0]))}function PEc(a){var b=ritz.convertPivotTableDefToRitz(LCa.Ob(RCa(a))),b=LCa.jd((new wj).ya(),b);if(null!=a.F){var c;c=bg(b,6);c=bg(c,1);I(c,6,""+a.F)}return b}function QEc(a,b,c){function d(a){if(a.vr()){var b=Math.min(e,c),d=Math.max(e,c);a=a.cr();var l=a.Wq();l==e?a.Sm(c):l>=b&&l<=d&&(e>c?a.Sm(l+1):e<c&&a.Sm(l-1))}}var e=lb(a.C,b);OEc(a.C,b,c);B(a.B,d);B(a.o,d)}
function REc(a,b){var c=tb(a.C,b.equals,b);if(0<=c){Db(a.C,c);var d=function(a){if(a.vr()){var b=a.cr(),d=b.Wq();d==c?a.YA():d>c&&b.Sm(d-1)}};B(a.B,d);B(a.o,d)}}function SEc(a,b,c){null!=c?(zb(a.C,b,c),b=function(a){if(a.vr()){a=a.cr();var b=a.Wq();b>=c&&a.Sm(b+1)}},B(a.B,b),B(a.o,b)):a.C.push(b)}
function TEc(a,b){var c=new eg;I(c,3,a);var d=b.cd,e=b.isRow(),f=new gg;if(!e){var h=new hg,k=b.Qb();I(h,1,k);I(f,2,h)}d||(h=new hg,k=b.Eb(),I(h,1,k),f.uD(h));I(c,2,f);f=new gg;e||(e=new hg,h=b.jb()+1,I(e,1,h),I(f,2,e));d||(d=new hg,e=b.lb()+1,I(d,1,e),f.uD(d));I(c,1,f);return c}function UEc(a,b){I(a,2,b)}function VEc(a,b){I(a,3,b)}function WEc(a,b){I(a,8,b)}function XEc(a){return bg(a,8)}function YEc(a,b){I(a,3,b)}
function ZEc(a,b,c){var d=b.lb();b=b.jb();a=a?a.zc(d,b+c).getDisplayValue():"";""==a&&(a="Column "+wt(b+c));return a};function r$(a,b){MF.call(this,1602,b);this.o=a}A(r$,MF);r$.prototype.Yc=function(){return r$.K.Yc.call(this)};r$.prototype.sd=p(47);r$.prototype.hd=function(){var a=new Bs,b=PEc(this.o);I(a,1,b);return a};function s$(a,b){M.call(this,a,b)}A(s$,M);function $Ec(a){a=a||{};a=""+fv(fY($u(a,{title:bv("Report Editor"),Se:cv('<div id="waffle-pivot-pane"><div id="waffle-pivot-range-selection"><div class="input-selection-button goog-inline-block"></div><span class="waffle-pivot-label-text waffle-pivot-range-span" id="waffle-pivot-range-text"></span><span class="waffle-pivot-label-text waffle-pivot-range-span">&nbsp;-&nbsp;</span>'+fv(mv({pd:"goog-inline-block waffle-pivot-label-button",content:cv("Edit range..."),id:"waffle-pivot-range-selection-button",
style:4}))+'</div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+aFc({wm:bv("Rows"),id:"waffle-pivot-add-field-row"})+'</div><div id="waffle-pivot-row-label" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+aFc({wm:bv("Columns"),id:"waffle-pivot-add-field-column"})+'</div><div id="waffle-pivot-column-label" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+
aFc({wm:bv("Values"),id:"waffle-pivot-add-field-value"})+'<div id="waffle-pivot-aggr"><span id="waffle-pivot-aggr-label" class="waffle-pivot-label-text">as:&nbsp;</span><div id="waffle-pivot-aggr-select"></div></div></div><div id="waffle-pivot-values" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+aFc({wm:bv("Filter"),id:"waffle-pivot-add-field-filter"})+'</div><div id="waffle-pivot-filter" class="waffle-pivot-drop-target"></div></div><div id="waffle-pivot-button-container"><label><input type="radio" name="autoupdate" value="autoupdate" checked id="waffle-pivot-update-auto" />Update table on each change</label><br /><label><input type="radio" name="autoupdate" value="manual" id="waffle-pivot-update-manual"/>Manually</label><button id="waffle-pivot-button-update" disabled="true">Update table</button><br /></div></div>')})));
return Qu(a)}function aFc(a){var b;b=""+('<strong id="'+Y(a.id)+'-field-label">'+X(a.wm)+'</strong><span class="waffle-pivot-label-text">&nbsp;-&nbsp;</span>');var c;c=bv("Add field");b+=fv(mv({pd:"goog-inline-block waffle-pivot-label-button",content:c,attributes:dv('aria-label="'+Y(a.wm)+" "+Y(c)+'"'),id:a.id,style:4}));return Qu(b)}
function bFc(a){return Qu('<div class="waffle-pivot-pill" role="group" tabindex="0"><table class="waffle-pivot-pill-main-table" role="presentation"><tbody><tr><td class="waffle-pivot-pill-main-table-text"><strong>'+X(a.GS)+'&nbsp;</strong><span class="waffle-pivot-pill-title"></span></td><td class="waffle-pivot-pill-main-table-fill"><div class="waffle-pivot-pill-draghandle"></div></td><td class="waffle-pivot-pill-close waffle-pivot-pill-nodrag"></td></tr></tbody></table></div>')};function t$(a,b,c,d,e){R.call(this,e);this.J=a;this.M=c;this.L=d;this.we(b)}A(t$,R);r=t$.prototype;r.Sa=function(){this.Ca=mu(bFc,{GS:this.J})};r.Ma=function(){t$.K.Ma.call(this);var a=this.la(),b=S(this);this.D=Th(a,"span","waffle-pivot-pill-title",this.getElement())[0];var c=new KA("\u2715",a,4);c.render(Th(a,"td","waffle-pivot-pill-close",this.getElement())[0]);Vm(c.getElement(),"Close edit field and remove from pivot table");K(this,c);b.H(c,"action",this.Dgb)};
r.ND=function(){var a=new s$("pivot-pill-changed",this);a.j=this;this.dispatchEvent(a)};function cFc(a,b){a.la().Hf(a.D,b);Vm(a.getElement(),"Edit field: "+(a.J+(" "+(b+"."))));a.D.title=b}function dFc(a){return a.la().dC(a.D)}function u$(a,b){return ZEc(a.M,a.L,b)}function eFc(a,b,c){a=a.la();return a.Aa("span",c,a.createTextNode(b+"\u00a0"))}function v$(a){return a.la().Aa("div","waffle-pivot-pill-nodrag")}
r.RP=function(a){var b=this.la(),c=b.Aa("div","waffle-pivot-pill-section",arguments);1<Bh(this.getElement()).length&&Ym(c,"waffle-pivot-pill-section-top-border");b.appendChild(this.getElement(),c)};r.Dw=function(a){S(this).H(a.getElement(),"mouseover",this.yY).H(a.getElement(),"mouseout",this.yY)};r.yY=function(a){Sna(a.target,"waffle-pivot-select-hover")};r.Pl=g("L");r.Fb=g("M");r.Dgb=function(){var a=new s$("pivot-remove-pill",this);a.j=this;this.dispatchEvent(a)};function w$(){}A(w$,jC);ja(w$);w$.prototype.Mb=p("waffle-pivot-select");w$.prototype.eB=function(a){return a.Aa("div","goog-inline-block "+(this.Mb()+"-dropdown"),"\u00a0\u25be")};function x$(a,b,c,d){t$.call(this,"Filter:",a,b,c,d);this.j=new vC("",null,w$.getInstance(),d);K(this,this.j)}A(x$,t$);x$.prototype.Ma=function(){x$.K.Ma.call(this);var a=this.getModel();cFc(this,u$(this,a.Xf()));var a=eFc(this,"Show:"),b=v$(this);this.j.Va(b);this.j.yr=!0;this.j.zv("Loading...");Vm(this.j.Ca,"Show:");var c=new y$;K(this,c);this.j.Ee(c);this.Dw(this.j);this.RP(a,b)};function z$(a){return a.j.Cb().j}
x$.prototype.Dw=function(a){x$.K.Dw.call(this,a);S(this).H(z$(this),"filters_selected",this.o).H(z$(this),"filtering_cancelled",this.B)};function fFc(a,b,c){var d=[];if(!c)return d;a=b.jb()+a;var e=Nf(b,"r");for(b=b.lb()+1;b<e.end;b++){var f=c.zc(b,a);Rb(d,f.getDisplayValue(),$Pb)}return d}function gFc(a){var b=z$(a),c=a.getModel().B(),d=new pd(c),e=pb(w0(b),function(a,b){return d.contains(b)?a-1:a},w0(b).length);XPb(b,c);hFc(a,e)}
function hFc(a,b){var c=z$(a);0==b?a.j.zv(YYb()):(c=w0(c).length-b,a.j.zv(YYb(c)))}x$.prototype.o=function(a){this.j.td(!1);hFc(this,a.ba.length);this.ND()};x$.prototype.B=function(){this.j.td(!1);var a=this.j.Ca;try{wd&&this.la().ib().body.focus(),a.focus()}catch(b){}gFc(this)};function y$(a){gC.call(this,a);this.j=new sY([],!1,null,a)}A(y$,gC);y$.prototype.Ma=function(){y$.K.Ma.call(this);this.j.render(this.qb());var a=new yA(this.j.Ca,this.la());zA(a);K(this,a)};
y$.prototype.kC=function(a){Eh(a.target)&&this.j.fj(a.target)||y$.K.kC.call(this,a)};function A$(a,b,c,d,e){t$.call(this,"Group by:",a,b,c,e);this.O=d}A(A$,t$);r=A$.prototype;
r.Ma=function(){A$.K.Ma.call(this);var a=this.getModel();cFc(this,u$(this,a.Xf()));var b=this.la(),a=eFc(this,"Order:"),c=v$(this),d=new gC;d.Oa(new bC(b.Ng("Ascending"),1),!0);d.Oa(new bC(b.Ng("Descending"),2),!0);b=this.F=new vC("",d,w$.getInstance(),b);b.Va(c);b.Ra(XEc(this.getModel()));Vm(b.getElement(),"Order:");this.Dw(b);this.RP(a,c);var b=this.la(),c=eFc(this,"Sort by:"),a=v$(this),d=new gC,e=u$(this,this.getModel().Xf());d.Oa(new bC(e,-1),!0);d=this.B=new vC("",d,w$.getInstance(),b);d.Va(a);
Vm(d.getElement(),"Sort by:");S(this).H(d.getElement(),"mouseover",this.yY).H(d.getElement(),"mouseout",this.yY).H(d,"action",this.Hgb);b=z(b.Aa,b,"div",["goog-inline-block","waffle-pivot-pill-sort-by"]);c=b(c);this.G=b(a);this.RP(c,this.G);a=this.getModel();a=bg(a,3);c=eFc(this,"Show totals","waffle-pivot-pill-align-middle waffle-pivot-pill-nodrag");b=v$(this);Ym(b,"goog-inline-block");this.o=new zJ;xJ(this.o,c);this.o.Xb(a);this.o.render(b);S(this).H(this.o,"change",this.ND);this.RP(b,c)};
r.isRow=g("O");r.Hgb=function(a){a=new s$("pivot-sort-by-change",a.currentTarget);a.j=this;this.dispatchEvent(a)};r.Igb=function(a){a=new s$("pivot-sort-key-change",a.currentTarget);a.j=this;this.dispatchEvent(a)};function iFc(a){var b=[];if(a.j)for(var c=a.j.Vb(),d=0;d<c;d++)0<=a.j.Zb(d).getValue()&&b.push(a.j.Zb(d).Hi());return b}function jFc(a){if(!a.j){var b=a.la(),c=v$(a);Ym(c,"waffle-pivot-multi-select");a.j=new TB("horizontal",null,b);a.j.Va(c);b.appendChild(a.G,c)}}
r.Dw=function(a){A$.K.Dw.call(this,a);S(this).H(a,"hide",this.ND)};r.R=function(){A$.K.R.call(this);L(this.F);L(this.B);L(this.j);L(this.o);this.G=null};function B$(a,b,c,d){t$.call(this,"Display:",a,b,c,d)}A(B$,t$);var kFc="SUM COUNTA COUNT COUNTUNIQUE AVERAGE MAX MIN MEDIAN PRODUCT STDEV STDEVP VAR VARP".split(" ");B$.prototype.Ma=function(){B$.K.Ma.call(this);var a=this.getModel();cFc(this,u$(this,a.Xf()));lFc(this)};
function lFc(a){var b=a.la(),c=eFc(a,"Summarize by:"),d=v$(a),e=new gC;B(kFc,function(a){e.Oa(new bC(a),!0)});b=a.j=new vC("",e,w$.getInstance(),b);b.Va(d);b.Ra(a.getModel().Rs());Vm(b.getElement(),"Summarize by:");a.Dw(b);a.RP(c,d)}B$.prototype.getValue=function(){return this.j.getValue()};B$.prototype.Dw=function(a){B$.K.Dw.call(this,a);S(this).H(a,"hide",this.ND)};B$.prototype.R=function(){B$.K.R.call(this);L(this.j)};function C$(a,b,c,d,e){gY.call(this,e);this.F=null;this.Za=b;this.gb=c;this.Wa=d;this.o={};this.D=!0;this.Pa=new mFc;this.ba=new P(this);this.xa=new CY;this.O=[];this.L=this.B=null;this.eb=new bC("No fields left to add",void 0,e);this.eb.Ja(!1)}A(C$,gY);
var D$={Fu:"waffle-pivot-values",Yr:"waffle-pivot-filter",GZ:"waffle-pivot-column-label",W_:"waffle-pivot-row-label",oZ:"waffle-pivot-add-field-value",mZ:"waffle-pivot-add-field-filter",nZ:"waffle-pivot-add-field-row",lZ:"waffle-pivot-add-field-column",pZ:"waffle-pivot-aggr-select",qZ:"waffle-pivot-aggr",Fza:"waffle-pivot-apply",DZ:"waffle-pivot-button-container",BDa:"waffle-pivot-range-selection",CDa:"waffle-pivot-range-selection-button",DDa:"waffle-pivot-range-text",vK:"waffle-pivot-button-update",
q0:"waffle-pivot-update-auto",r0:"waffle-pivot-update-manual"},E$={qK:"row-breakout",BJ:"col-breakout",Yr:"filter",Fu:"aggregation"};r=C$.prototype;r.Sa=function(){var a=this.la();this.Ca=mu($Ec,{id:this.getId()});var b=new gC(a);b.Oa(new bC("Columns",2,a),!0);b.Oa(new bC("Rows",1,a),!0);this.G=new vC("",b,w$.getInstance(),a)};
r.Ma=function(){function a(a,b){e.H(hh(a),"click",b)}C$.K.Ma.call(this);var b=this.la();O(b.getElement(D$.DZ),!1);this.J=oc(E$.Fu,b.getElement(D$.Fu),E$.Yr,b.getElement(D$.Yr),E$.qK,b.getElement(D$.W_),E$.BJ,b.getElement(D$.GZ));this.Ia=oc(D$.oZ,E$.Fu,D$.mZ,E$.Yr,D$.nZ,E$.qK,D$.lZ,E$.BJ);this.zb=b.getElement(D$.vK);var c=Py(rC,""),d=UYb(),e=S(this),f;for(f in this.Ia){var h=new kC("",new gC(b,d),c,b);K(this,h);h.Va(b.getElement(f));e.H(h,"show",this.Bjb).H(h.Cb(),"action",this.Ajb)}a(D$.vK,this.Ljb);
a(D$.q0,this.Ixa);a(D$.r0,this.Ixa);this.M=b.getElement(D$.qZ);O(this.M,!1);this.G.Va(b.getElement(D$.pZ));e.H(this.G,"action",this.Cjb);this.L||(this.L=new mn(this.qb()));e.H(this.L,"focusin",this.Gjb).H(this.L,"focusout",this.Hjb);nFc(this)};r.Gjb=function(a){this.B=oFc(this,a.target)};r.Hjb=function(a){if(a=a.relatedTarget){var b=this.qb();Oh(a,function(a){return a==b})||(this.B=null)}};
function oFc(a,b){if(!b)return null;var c=a.la().aka(b,"waffle-pivot-pill");if(!c)return null;var d=null,e=null;Xb(a.o,function(a,b){return(d=sb(a,function(a){return a.getElement()==c}))?(e=b,!0):!1});return d?{container:e,label:dFc(d)}:null}
function pFc(a){var b=a.la();if(a.B){var c=a.B.container,d=a.o[c];if(d&&a.B.label)for(var e=0,f;f=d[e];e++)if(dFc(f)==a.B.label){qFc(a,f.getElement());return}d&&0<d.length?qFc(a,d[d.length-1].getElement()):(d=cc(a.Ia,function(a){return a==c}),qFc(a,b.getElement(d)))}}
r.we=function(a){C$.K.we.call(this,a);rFc(this,function(){function b(a,b){var c="row-breakout"==a,c=new A$(b,F$(this),G$(this),c,this.la());c.render();sFc(this,c,a)}this.reset();B(a.Qs(),function(a){a=new x$(a,F$(this),G$(this),this.la());a.render();sFc(this,a,"filter")},this);B(a.En(),ya(b,"row-breakout"),this);B(a.zn(),ya(b,"col-breakout"),this);B(a.Np(),function(a){a=new B$(a,F$(this),G$(this),this.la());a.render();sFc(this,a,"aggregation")},this);var c;c=(c=(c=$v(this.Wa.j,a.Bm()))?c.j:null)?
Et(a.Pl(F$(this)),c):"#REF!";tFc(this,c);this.Pa.Ra(c);(c=this.o.aggregation)&&2<=c.length?(O(this.M,!0),this.G.Ra(a.yo())):O(this.M,!1);pFc(this)});uFc(this,function(){var a=this.o.filter;a&&B(a,function(a){var b=z$(a),e;e=fFc(a.getModel().Xf(),a.Pl(),a.Fb());WPb(b,e);gFc(a)},this)})};r.focus=function(){C$.K.focus.call(this);qFc(this,jh("waffle-sidebar-title",this.getElement()))};function sFc(a,b,c){a.J[c].appendChild(b.getElement());a.o[c]||(a.o[c]=[]);a.o[c].push(b);b.wc(a);vFc(a,b);nFc(a)}
function vFc(a,b){S(a).H(b,"pivot-remove-pill",a.Kjb).H(b,"pivot-pill-changed",a.Jjb).H(b.getElement(),"keydown",a.Ijb);var c=new s$("pivot-pill-created");c.j=b;a.dispatchEvent(c)}function nFc(a){a.ba.Hb();L(a.xa);var b=a.xa=new CY;Ub(a.J,function(a){DY(b,a)});b.Ed();a.ba.H(b,"beforedragstart",a.Djb).H(b,"dragstart",a.Fjb).H(b,"dragend",a.Ejb)}r.reset=function(){Ub(this.o,function(a){B(a,L)});this.o={}};function tFc(a,b){var c=a.la();c.Hf(c.getElement("waffle-pivot-range-text"),b)}
r.Kjb=function(a){var b=new s$("pivot-pill-removed",this);b.j=a.target;b.container=cc(this.o,function(b){return vb(b,a.target)});b.container&&(Cb(this.o[b.container],a.target),this.B={container:b.container,label:null},this.dispatchEvent(b))};r.Jjb=function(a){a.container=cc(this.o,function(b){return vb(b,a.target)})};r.Ijb=function(a){!a.shiftKey||38!=a.keyCode&&40!=a.keyCode||wFc(this,a.target,38==a.keyCode)};
function wFc(a,b,c){var d=null,e=-1;Xb(a.J,function(a,c){e=lb(a.childNodes,b);return 0<=e?(d=c,!0):!1});var f=a.o[d];if(!(!f||1>=f.length||(c=c?e-1:e+1,0>c||c>f.length-1))){$Yb(f,e,c);var h=new s$("pivot-pill-changed",a);h.j=f[c];h.container=d;h.B=d;h.position=c;a.dispatchEvent(h)}}r.Ljb=function(){this.dispatchEvent("pivot-table-update")};r.Ixa=function(a){a=this.D="autoupdate"==a.target.value;(this.zb.disabled=a)&&this.dispatchEvent("pivot-table-update")};r.Cjb=function(){this.dispatchEvent("pivot-aggregation-orientation-changed")};
r.yo=function(){return this.G.getValue()};function xFc(a,b,c,d){var e=a.Pa;Sg(a.F);IPb(a.Za,e,e.getValue(),!1,!1,!0,z(a.Mjb,a,b,c,!!d))}r.Mjb=function(a,b,c,d){var e=this.Pa,f=this.Wa;e.j=!1;var h=e.getValue();this.F=Qg(d,"afterhide",function(){if(e.j){var d=Ct(e.getValue(),f.j,!0,!0);d?a(d):(e.Ra(h),b())}else b();c||qFc(this,hh("waffle-pivot-range-selection-button"))},!1,this)};
r.Bjb=function(a){var b=a.target.getParent(),c=b.Cb();this.Ua=this.Ia[b.Ca.id];rFc(this,function(){var a=this.Ua,e=F$(this),f=G$(this),a=yFc(this,a);c.fd(!0);for(var h=Nf(f,"c"),k=0,l=h.start;l<h.end;l++){var m=ZEc(e,f,k);m&&!a[m]&&c.Oa(new bC(m,k),!0);k++}0==c.Vb()&&c.Oa(this.eb,!0);lU(b,!0);b.Gt();lU(b,!1)})};function qFc(a,b){try{wd&&a.la().ib().body.focus(),b.focus(),a.gb.Tb(2)}catch(c){}}
r.Ajb=function(a){var b=this.Ua;a=a.target.getValue();var c=new s$("pivot-pill-added",this);c.container=b;c.D=a;this.B={container:b,label:null};this.dispatchEvent(c)};r.Djb=function(a){for(var b=a.event.target||a.event.j.target;b instanceof Element&&!Xm(b,"waffle-pivot-pill");b=b.parentNode)if(Xm(b,"waffle-pivot-pill-nodrag")){a.preventDefault();break}};r.Fjb=function(a){var b=Jl(a.j).width;yl(a.B,b)};
r.Ejb=function(a){var b,c,d,e,f=new s$("pivot-pill-changed",this);Xb(this.J,function(c,d){e=lb(c.childNodes,a.j);return 0<=e?(b=d,!0):!1});Xb(this.o,function(b,e){var l=sb(b,function(b){return b.getElement()==a.j});return l?(c=e,f.j=d=l,!0):!1});this.o[b]||(this.o[b]=[]);Cb(this.o[c],d);zb(this.o[b],d,e);f.container=b;f.B=c;f.position=e;this.dispatchEvent(f)};
function yFc(a,b){function c(a){a=f(a.Xf());e[a]=!0}var d=a.getModel(),e={},f=z(ZEc,a,F$(a),G$(a));if(d)switch(b){case "filter":B(d.Qs(),c);break;case "row-breakout":case "col-breakout":B(d.En(),c),B(d.zn(),c)}return e}function rFc(a,b){var c=zFc(a);if(c){var d=G$(a),d=new Df(d.lb(),d.jb(),d.lb()+1,d.Qb());Ve?AFc(a,d,b):Sq(c.B,d,z(b,a),S(a))}else b.call(a)}function uFc(a,b){var c=zFc(a);c?Ve?AFc(a,G$(a),b):Sq(c.B,G$(a),z(b,a),S(a)):b.call(a)}
function AFc(a,b,c){b=Qq(Wv(zFc(a)),b).addCallback(c,a);a.O.push(b);Cm(b,ya(Cb,a.O,b))}function zFc(a){var b=a.getModel();return $v(a.Wa.j,b.Bm())}function F$(a){return(a=zFc(a))?a.Fb():null}function G$(a){return a.getModel().Pl(F$(a))}r.R=function(){C$.K.R.call(this);Ub(this.o,function(a){B(a,L)});this.o={};Sg(this.F);this.F=null;L(this.xa);L(this.ba);B(this.O,Ux)};function mFc(){N.call(this);this.o="";this.j=!1}A(mFc,N);mFc.prototype.getValue=g("o");
mFc.prototype.Ra=function(a){this.o=a;this.j=!0;this.dispatchEvent("change")};function BFc(a,b){J.call(this);this.j=a;this.B=b;this.o=new P(this);K(this,this.o);this.o.H(a,"pivot-pill-created",this.C)}A(BFc,J);BFc.prototype.D=function(a){var b=a.j;-1==a.target.getValue()?(b.j&&(L(b.j),b.j=null),b.ND()):0<CFc(this,b).length&&!b.j?(jFc(b),b.j.getElement().focus(),DFc(this,b,-2,!0)):b.ND()};
BFc.prototype.F=function(a){var b=a.j;a=a.target;var c=xn(b.j,a),d=b.la();for(c++;c<b.j.Vb();){var e=b.j.Zb(c),f=d.cU(e.getElement());Xm(f,"waffle-pivot-select-divider")&&d.zf(f);b.j.removeChild(e,!0)}(0>a.getValue()||!DFc(this,b,-2,!0))&&b.ND()};function EFc(a,b){a.o.H(b,"pivot-sort-by-change",a.D).H(b,"pivot-sort-key-change",a.F)}
BFc.prototype.C=function(a){var b=a.j;if(b instanceof A$){var c=0<CFc(this,b).length;a=this.j.getModel().Np();B(a,function(a,d){var h=a.getFunctionName(),k=u$(b,a.Xf());b.B.Fd(new bC(c?h+(" of "+(k+" in...")):h+(" of "+k),d))});a=b.getModel();if(a.vr()){var d=a.cr();a=d.rP();FFc(this,b,a)&&(d=d.Wq(),b.B.Ra(d),c&&(jFc(b),B(a,z(function(a){DFc(this,b,a,!1)},this)),DFc(this,b,-1,!1)))}EFc(this,b)}};
function DFc(a,b,c,d){var e=GFc(a,b);if(0==e.length)return!1;var f=b.j.Vb();a=CFc(a,b);if(f>=a.length)return!1;var h=u$(b,a[f].Xf()),f=b.la();a=b.j.Vb();var k=new gC,l=new bC(h,-2);l.Ja(!1);k.Oa(l,!0);k.Oa(new bC(0==a?"Grand Total":"Total",-1),!0);for(l=0;l<e.length;l++)k.Oa(new bC(e[l],l),!0);h=new vC(h,k,w$.getInstance(),f);h.Ra(-2);b.j.Oa(h,!0);0<a&&(a=f.Aa("div",["goog-inline-block","waffle-pivot-select-divider"],":"),f.Rv(a,h.getElement()));S(b).H(h,"action",b.Igb);f=c;"string"==typeof c&&(f=
lb(e,c),-1==f&&(f=-2));h.Ra(f);d&&(b.j.bf(h),h.td(!0));return!0}function GFc(a,b){var c=HFc(a,b),d=iFc(b),e=d.length,f=[];B(c,function(a){a.length==e+1&&rb(d,function(b,c){return a[c]==b})&&Rb(f,a[e])});return f}function FFc(a,b,c){a=HFc(a,b);return 0==c.length||qb(a,function(a){return Qb(c,a)})}function CFc(a,b){return b.isRow()?a.j.getModel().zn():a.j.getModel().En()}function HFc(a,b){return b.isRow()?MCa(a.j.getModel(),a.B):NCa(a.j.getModel(),a.B)};function H$(a,b){Ht.call(this,1601,b,Ff(aw(a,b)));this.o=a}A(H$,Ht);H$.prototype.exec=function(){var a=aw(this.o,this.getModel()),b=this.getModel();cEa(b.B,a.y,"r")&&(a=this.getModel().Tka(),b=this.o,(a.Qa=b)||a.Ia?Yl(a,1024):a.j&=-1025)};H$.prototype.Yc=function(){return H$.K.Yc.call(this)};H$.prototype.sd=p(48);H$.prototype.hd=function(){var a=new Cs,b=PEc(this.o);I(a,2,b);var b=aw(this.o,this.getModel()),c=new ki;I(c,1,""+this.o.Ql());c.Kr(b.y);I(c,3,b.x);I(a,1,c);return a};function IFc(a,b,c,d,e){eY.call(this,a,c);this.B=this.G=null;this.j=a;this.o=b;this.M=d;this.L=e;this.O=new BFc(this.j,this.o);K(this,this.O);b=b.j;c=a.la();this.aa.H(a,"pivot-table-update",this.vjb).H(a,"pivot-pill-added",this.njb).H(a,"pivot-pill-removed",this.pjb).H(a,"pivot-pill-changed",this.ojb).H(a,"pivot-aggregation-orientation-changed",this.mjb).H(ro,"show-pivot",this.ujb).H(e,"activeCellChange",this.sba).H(e,"click",this.wjb,!0).H(e,"pivot_table_zippy_toggle",this.xjb).H(b,"a",this.sba).H(b,
"d",this.tjb).H(c.getElement("waffle-pivot-range-selection-button"),"click",this.qjb).H(c.getElement("waffle-pivot-range-selection-button"),"keypress",this.rjb);a=["Ea"];a.push("P");this.aa.H(Lv(b),a,this.sba)}A(IFc,eY);r=IFc.prototype;r.fg=function(){return W.O_};r.Pp=function(){return W.N_};r.qjb=function(){JFc(this)};r.rjb=function(a){13==a.keyCode&&(a.preventDefault(),a.stopPropagation(),JFc(this))};function JFc(a){xFc(a.j,z(a.sjb,a,KFc(a)),ia)}
r.sjb=function(a,b){a.F=b.kc;var c=TEc(b.ag,b.rect);a.G=c;I$(this,a,this.j.D);var c=a.Ql(),d=this.o.j;pt(d)!=c&&EL(d,c)};r.ujb=function(){if(!lea(Le.getInstance())){var a=this.j;if(!a.Ta()){var b=this.o.j.getActiveGrid(),c=LFc(this);if(!c&&b){this.j.reset();var a=b.B,c=b.Fb(),d=hx(c),e=fx(c);d?(Ve?Uq(a,e,$b(Id)):Wq(a,e,$b(Id),this.aa)).addCallback(z(this.Hxa,this,b)):this.Hxa(b,$w(c));return}this.B=c;a.we(c)}this.Pp().fireAction()}};
r.ojb=function(a){var b=a.container,c=a.B,d=a.j,e=a.j.getModel(),f=d;if(d&&c&&b!=c){f=MFc(d.getModel(),b);a:{var h=this.j;switch(b){case "row-breakout":case "col-breakout":var k="row-breakout"==b,f=new A$(f,F$(h),G$(h),k,h.la());break a;case "aggregation":f=new B$(f,F$(h),G$(h),h.la());break a;case "filter":f=new x$(f,F$(h),G$(h),h.la());break a;default:f=null}}f.render();h=this.j;k=f;h.la().hD(k.getElement(),d.getElement());var l=h.o[b],m=lb(l,d);Ab(l,m,1,k);L(d);k.wc(h);vFc(h,k);nFc(h)}d=KFc(this);
a=a.position;h=c==b;k=f.getModel().Xf();if(c)if(h){f=f.getModel();switch(b){case "row-breakout":OEc(d.B,f,a);break;case "col-breakout":OEc(d.o,f,a);break;case "filter":OEc(d.D,f,a);break;case "aggregation":QEc(d,f,a)}uo(XYb(a))}else NFc(this,b,d,k,a);else OFc(b,f,d);c&&!h&&PFc(e,c,d);I$(this,d,this.j.D)};
function MFc(a,b){switch(b){case "row-breakout":case "col-breakout":if(a instanceof jg)return a;var c=new jg,d=a.Xf();I(c,9,d);return c;case "aggregation":if(a instanceof lg)return a;c=new lg;d=a.Xf();I(c,3,d);return c;case "filter":if(a instanceof dg)return a;c=new dg;d=a.Xf();I(c,6,d);return c;default:return null}}r.njb=function(a){var b=a.container,c=KFc(this);NFc(this,b,c,a.D,a.position);I$(this,c,this.j.D)};
r.pjb=function(a){var b=KFc(this);PFc(a.j.getModel(),a.container,b);L(a.j);I$(this,b,this.j.D)};r.mjb=function(){var a=KFc(this),b=this.j.yo();a.J=b;I$(this,a,this.j.D)};
function NFc(a,b,c,d,e){switch(b){case "row-breakout":a=new jg;I(a,9,d);d=a;null!=e?zb(c.B,d,e):c.B.push(d);break;case "col-breakout":a=new jg;I(a,9,d);d=a;null!=e?zb(c.o,d,e):c.o.push(d);break;case "filter":a=$v(a.o.j,c.Bm()).Fb();a=fFc(d,c.Pl(a),a);b=new dg;I(b,6,d);QFc(b,a);null!=e?zb(c.D,b,e):c.D.push(b);break;case "aggregation":a=new lg,I(a,3,d),UEc(a,"SUM"),SEc(c,a,e)}}
function PFc(a,b,c){switch(b){case "row-breakout":Oaa(c.B,a.equals,a);break;case "col-breakout":Oaa(c.o,a.equals,a);break;case "filter":Oaa(c.D,a.equals,a);break;case "aggregation":REc(c,a)}}
function OFc(a,b,c){if("aggregation"==a)a=sb(c.Np(),function(a){return a.equals(b.getModel())}),null!=a&&UEc(a,b.getValue());else if("filter"==a)a=sb(c.Qs(),function(a){return a.equals(b.getModel())}),null!=a&&QFc(a,YPb(z$(b),!0));else if(a=sb("row-breakout"==a?c.En():c.zn(),function(a){return a.equals(b.getModel())}),null!=a)if(YEc(a,b.o.Cc()),WEc(a,b.F.getValue()),-1!=b.B.getValue()){var d=new kg;d.Sm(b.B.getValue());B(iFc(b),function(a){Yf(d,2,a)});VEc(d,b.F.getValue());I(a,10,d)}else a.YA()}
r.vjb=function(){I$(this,LFc(this),!0)};function I$(a,b,c){b&&(c?(c=ft(a.o.j,b.Ql()),c=new H$(b,c),a.M.Rb(c),a.G=null):a.G=b,a.j.we(b))}r.Hxa=function(a,b){var c=a.Fb(),d=hx(c),c=fx(c);d&&b.equals(c)?xFc(this.j,z(this.Gxa,this),z(this.yjb,this),!0):this.Gxa(new No(a.$a(),a.j,b))};r.yjb=function(){this.fg().setVisible(!1);this.D.Tb(3)};
r.Gxa=function(a){var b;b=new mg;var c=new eg,d=new gg,e=new hg,f=new hg;I(e,1,1);I(f,1,1);d.uD(e);I(d,2,f);var e=new gg,f=new hg,h=new hg;I(f,1,1);I(h,1,1);e.uD(f);I(e,2,h);I(c,1,d);I(c,2,e);I(b,6,c);I(b,5,2);b=QCa(b,0,new E(0,0),0);b.F=a.kc;a=TEc(a.ag,a.rect);b.G=a;a=pt(this.o.j);this.M.Rb(new r$(b,a))};function LFc(a){if(a.G)return a.G;(a=a.o.j.j)&&0==a.getSheetType()?(a=a.Fb(),a=ZEa(a,dx(a))):a=null;return a}function KFc(a){return(a=LFc(a))?a.clone():null}
r.sba=function(a){var b=LFc(this);if(("Ea"==a.type||"P"==a.type)&&!b&&this.B&&(a=this.o.j.getActiveGrid())&&(a=a.Fb(),a.ob()==this.B.Ql())){var c=aw(this.B,a);c&&(ix(a,c),b=LFc(this))}b&&!b.equals(this.B,this.o)&&this.j.we(b);this.B=b;this.fg().setVisible(!!b&&!UE(this.o))};r.tjb=function(a){a=a.target;if(this.B&&this.B.Ql()==a.$a()&&this.j.Ta()){a=this.j;var b=XBa(a.Za);b&&a.F&&b.setVisible(!1)}};
r.wjb=function(a){var b=a.target;if(Xm(b,VYb.Yea)||Xm(b,VYb.Xea)){var b=Ev(this.L).getModel(),c=Ww(b,a.of);RFc(this,b,c);a.stopPropagation()}};r.xjb=function(a){var b=Ev(this.L).getModel();a=Ww(b,a.of);RFc(this,b,a)};
function RFc(a,b,c){if(!UE(a.o)){var d=c.Vi();b=ZEa(b,c);if(c=d.CM()){var e=c.length-1;c=c[e];for(var d="r"==d.PB()?b.En()[e]:b.zn()[e],e=ag(d,7),f,h=0;h<e.length;h++)if(e[h].getValue()==c){f=e[h];var k=!G(f,3);I(f,3,k)}f||(f=new ig,f.Ra(c),I(f,3,!0),Yf(d,7,f));uo(G(f,3)?"Pivot table field collapsed":"Pivot table field expanded");I$(a,b,!0)}}}function QFc(a,b){Zf(a,3);I(a,5,!1);B(b,function(b){Yf(a,3,b)})}r.R=function(){IFc.K.R.call(this)};function SFc(){J.call(this)}A(SFc,go);SFc.prototype.o=function(){return C$};SFc.prototype.j=function(){return IFc};oo("pivottables",SFc);
